var Ya=Object.defineProperty;var Xa=(c,t,a)=>t in c?Ya(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a;var ia=(c,t,a)=>(Xa(c,typeof t!="symbol"?t+"":t,a),a);import{d as J,r as H,o as C,c as V,a as e,f as s,w as u,z as O,t as i,u as z,k as B,l as b,m as ae,b as F,g as q,j as ra,R as Ee,G as xe,s as te,S as ca,U as Dt,V as Qa,W as Za,X as eo,Y as to,Z as ao,_ as Ge,$ as Fe,n as re,F as Ce,h as Pe,J as j,i as lt,E as Xe,A as qe,q as ft,v as ga,a0 as Je,a1 as oo,y as qt,B as ct,a2 as Be,a3 as so,e as lo,a4 as da,a5 as no,p as ya,a6 as io}from"./vendor-vue-f1f9849c.js";import{b as Qe,r as X,u as He,i as ot,k as dt,c as ve,d as me,l as ro,m as co,n as uo,s as mo,o as _o,_ as po,p as fo,q as jt,t as wa,v as Bt,w as ba,x as kt,y as Gt,z as Kt,A as xt,B as nt,C as $a,D as Wt,E as ka,F as Rt,G as Jt,H as Ca,I as xa,J as Yt,j as Ht,K as vo,L as Xt,M as Ia,N as ho,O as go,P as Sa,Q as Ta,R as Ma,S as La,T as yo,U as wo,V as bo,W as $o,X as ko,Y as Co,Z as xo,$ as Va,a0 as za,a1 as Ua,a2 as Pa,a3 as Io,a4 as Qt,a5 as So,a6 as To,a7 as Mo,a8 as Lo,a9 as Vo,aa as ua,ab as zo,ac as Zt,ad as Uo,ae as Po,af as Ao,ag as Do,ah as It,ai as Oo,aj as No,ak as Fo,al as Aa,am as qo,an as Ro,ao as Ho,ap as Eo,aq as jo,ar as Bo,as as Go,at as Ko,au as Wo,av as Jo,aw as Yo,ax as st,ay as Xo,az as Qo,aA as Zo,aB as es,aC as ts,aD as as,aE as os,aF as ss,aG as ls,aH as ns,aI as is,aJ as ma,aK as rs,aL as _a,aM as cs,aN as ds,aO as us,aP as ms,aQ as _s,aR as ps,aS as Da,h as Et,aT as fs}from"./core-a975e3c3.js";import{L as ht,T as ea,_ as Y,C as ta,A as G,a as ne,b as K,c as Se,M as ie,d as de,P as it,e as Le,f as Re,S as Oa,g as We,h as ut,i as Ot,j as vs,k as Na,l as tt,m as vt,n as Ct,E as St,o as hs,p as aa,q as gs,r as ys,s as ws}from"./components-dd440e25.js";import{_ as Tt}from"./assets-123e6eb8.js";import{S as Fa,ax as qa}from"./vendor-8fa27e24.js";const bs=""+new URL("../imgs/case-logo/tencent.png",import.meta.url).href,$s=""+new URL("../imgs/case-logo/huawei_logo.png",import.meta.url).href,ks=""+new URL("../imgs/case-logo/baidu.png",import.meta.url).href,Cs=""+new URL("../imgs/case-logo/jingdong.png",import.meta.url).href,xs=""+new URL("../imgs/case-logo/zijie.png",import.meta.url).href,Is=""+new URL("../imgs/case-logo/shunfeng.png",import.meta.url).href,Ss={class:"landing-header"},Ts={class:"header-content"},Ms={class:"nav"},Ls={href:"https://www.showdoc.com.cn/clients",target:"_blank"},Vs={class:"toggle-group"},zs=J({__name:"LandingHeader",setup(c){const t=Qe();return(a,o)=>{const l=H("router-link");return C(),V("header",Ss,[e("div",Ts,[o[1]||(o[1]=e("a",{href:"/",class:"logo"},[e("span",{class:"logo-text"},"ShowDoc")],-1)),e("nav",Ms,[s(l,{to:"/"},{default:u(()=>[O(i(a.$t("index.home")||"首页"),1)]),_:1}),e("a",Ls,i(a.$t("index.clients")||"客户端"),1),o[0]||(o[0]=e("div",{class:"nav-separator"},null,-1)),e("div",Vs,[s(ht),s(ea)]),z(t).isLoggedIn?(C(),B(l,{key:1,to:"/item/index",class:"btn-primary"},{default:u(()=>[O(i(a.$t("index.my_item")),1)]),_:1})):(C(),B(l,{key:0,to:"/user/login"},{default:u(()=>[O(i(a.$t("index.login_or_register")),1)]),_:1}))])])])}}});const Us=Y(zs,[["__scopeId","data-v-ffcc94ed"]]),Ps={class:"landing-footer"},As={class:"footer-content"},Ds={class:"footer-section"},Os={class:"footer-section"},Ns={href:"https://github.com/star7th/showdoc",target:"_blank"},Fs={class:"footer-bottom"},qs={key:0,href:"https://beian.miit.gov.cn/",target:"_blank"},Rs=J({__name:"LandingFooter",setup(c){const t=b("");return ae(async()=>{try{const a=await X("/api/common/homePageSetting",{},"post",!1);a&&a.data&&a.data.beian&&(t.value=a.data.beian)}catch(a){console.error("Failed to load home page setting:",a)}}),(a,o)=>(C(),V("footer",Ps,[e("div",As,[e("div",Ds,[o[0]||(o[0]=e("h4",null,"ShowDoc",-1)),e("p",null,i(a.$t("index.footer_slogan")||"让文档协作更简单"),1)]),e("div",Os,[e("h4",null,i(a.$t("index.about_us")||"关于我们"),1),e("a",Ns,i(a.$t("index.about")||"关于"),1)])]),e("div",Fs,[o[1]||(o[1]=e("span",null,[O("本站基于开源项目"),e("a",{href:"https://github.com/star7th/showdoc",target:"_blank"},"showdoc"),O("构建")],-1)),t.value?(C(),V("a",qs,i(t.value),1)):F("",!0)])]))}});const Hs=Y(Rs,[["__scopeId","data-v-103cb343"]]),Es={class:"hero-illustration"},js={viewBox:"0 0 700 500",xmlns:"http://www.w3.org/2000/svg"},Bs={id:"heroGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Gs={id:"heroShadow"},Ks=["flood-color"],Ws={id:"gridPattern",x:"0",y:"0",width:"40",height:"40",patternUnits:"userSpaceOnUse"},Js=["fill"],Ys=["fill"],Xs=["fill"],Qs=["fill"],Zs={class:"code-editor",filter:"url(#heroShadow)"},el=["fill","stroke"],tl=["fill"],al=["fill"],ol={class:"code-content"},sl=["fill"],ll=["fill"],nl=["fill"],il=["fill"],rl=["fill"],cl=["fill"],dl=["fill"],ul=["fill"],ml=["fill"],_l={class:"method-badge"},pl=["fill"],fl={class:"method-badge"},vl=["fill"],hl=["fill"],gl=["fill"],yl=["fill"],wl=["fill"],bl={class:"main-document",filter:"url(#heroShadow)"},$l=["fill","stroke"],kl=["fill"],Cl=["fill"],xl=["fill"],Il={class:"api-item"},Sl=["fill","stroke"],Tl=["fill"],Ml=["fill"],Ll=["fill"],Vl=["fill"],zl=["fill"],Ul={class:"api-item"},Pl=["fill","stroke"],Al=["fill"],Dl=["fill"],Ol=["fill"],Nl=["fill"],Fl=["fill"],ql={class:"api-item"},Rl=["fill","stroke"],Hl=["fill"],El=["fill"],jl=["fill"],Bl=["fill"],Gl=["fill"],Kl={class:"stats-bar"},Wl=["fill"],Jl=["fill"],Yl={transform:"translate(390, 382)"},Xl=["fill"],Ql=["fill"],Zl=["fill"],en=["fill"],tn=["fill"],an=["fill"],on={class:"mobile-preview float-device-1"},sn=["fill","stroke"],ln=["fill"],nn=["fill"],rn=["fill"],cn=["fill"],dn=["fill"],un=["fill"],mn={class:"browser-preview float-device-2"},_n=["fill","stroke"],pn=["fill"],fn=["fill"],vn=["fill"],hn=["fill"],gn=["fill"],yn=["fill"],wn={class:"team-avatars"},bn={class:"avatar float-avatar-1",transform:"translate(570, 80)"},$n=["fill"],kn=["fill"],Cn={class:"avatar float-avatar-2",transform:"translate(620, 100)"},xn=["fill"],In=["fill"],Sn={class:"avatar float-avatar-3",transform:"translate(655, 65)"},Tn=["fill"],Mn=["fill"],Ln={class:"data-flow"},Vn=["stroke"],zn=["stroke"],Un=["stroke"],Pn={class:"data-packet-1",filter:"url(#glow)"},An=["fill"],Dn={class:"data-packet-2",filter:"url(#glow)"},On=["fill"],Nn={class:"data-packet-3",filter:"url(#glow)"},Fn=["fill"],qn=["stroke"],Rn=["fill"],Hn={class:"float-tag float-tag-1"},En=["fill","stroke"],jn=["fill"],Bn={class:"float-tag float-tag-2"},Gn=["fill","stroke"],Kn=["fill"],Wn={class:"float-tag float-tag-3"},Jn=["fill","stroke"],Yn=["fill"],Xn=["fill"],Qn=J({__name:"HeroIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#4a9eff":"#007bff"),l=q(()=>a.value?"#46c93a":"#28a745"),m=q(()=>a.value?"#ffa940":"#fd7e14"),f=q(()=>a.value?"#1e1e1e":"#ffffff"),d=q(()=>a.value?"#1e1e1e":"#282c34"),p=q(()=>a.value?"#2d2d30":"#21252b"),h=q(()=>a.value?"#252525":"#f8f9fa"),$=q(()=>a.value?"#2d2d2d":"#ffffff"),g=q(()=>a.value?"#000000":"#f5f5f5"),n=q(()=>a.value?"#e0e0e0":"#2c3e50"),w=q(()=>a.value?"#8b949e":"#6c757d"),k=q(()=>a.value?"rgba(255, 255, 255, 0.15)":"rgba(0, 0, 0, 0.1)"),r=q(()=>(a.value,"#000000")),_=q(()=>a.value?"#4a9eff":"#007bff");return(v,y)=>(C(),V("div",Es,[(C(),V("svg",js,[e("defs",null,[e("linearGradient",Bs,[e("stop",{offset:"0%",style:ra(`stop-color:${o.value};stop-opacity:1`)},null,4),e("stop",{offset:"100%",style:ra(`stop-color:${l.value};stop-opacity:1`)},null,4)]),y[0]||(y[0]=e("filter",{id:"glow"},[e("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),e("feMerge",null,[e("feMergeNode",{in:"coloredBlur"}),e("feMergeNode",{in:"SourceGraphic"})])],-1)),e("filter",Gs,[e("feDropShadow",{dx:"0",dy:"8",stdDeviation:"12","flood-color":r.value,"flood-opacity":"0.3"},null,8,Ks)]),e("pattern",Ws,[e("circle",{cx:"2",cy:"2",r:"1.5",fill:_.value,opacity:"0.3"},null,8,Js)]),y[1]||(y[1]=e("linearGradient",{id:"codeGlow",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[e("stop",{offset:"0%",style:{"stop-color":"#28a745","stop-opacity":"0"}}),e("stop",{offset:"50%",style:{"stop-color":"#28a745","stop-opacity":"0.8"}}),e("stop",{offset:"100%",style:{"stop-color":"#28a745","stop-opacity":"0"}})],-1))]),y[30]||(y[30]=e("rect",{x:"0",y:"0",width:"700",height:"500",fill:"url(#gridPattern)",opacity:"0.4"},null,-1)),e("circle",{cx:"550",cy:"100",r:"180",fill:o.value,opacity:"0.05",class:"bg-circle-1"},null,8,Ys),e("circle",{cx:"120",cy:"400",r:"150",fill:l.value,opacity:"0.05",class:"bg-circle-2"},null,8,Xs),e("circle",{cx:"650",cy:"450",r:"100",fill:m.value,opacity:"0.05",class:"bg-circle-3"},null,8,Qs),e("g",Zs,[e("rect",{x:"30",y:"120",width:"220",height:"280",rx:"16",fill:d.value,stroke:k.value,"stroke-width":"2"},null,8,el),e("rect",{x:"30",y:"120",width:"220",height:"35",rx:"16",fill:p.value},null,8,tl),e("rect",{x:"30",y:"140",width:"220",height:"16",fill:p.value},null,8,al),y[10]||(y[10]=e("circle",{cx:"48",cy:"137",r:"5",fill:"#ff5f57"},null,-1)),y[11]||(y[11]=e("circle",{cx:"65",cy:"137",r:"5",fill:"#ffbd2e"},null,-1)),y[12]||(y[12]=e("circle",{cx:"82",cy:"137",r:"5",fill:"#28c840"},null,-1)),e("g",ol,[y[4]||(y[4]=e("text",{x:"45",y:"180","font-size":"10",fill:"#6c757d","font-family":"Monaco, monospace"},"// API Definition",-1)),y[5]||(y[5]=e("rect",{x:"40",y:"190",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-1"},null,-1)),e("text",{x:"45",y:"200","font-size":"11",fill:l.value,"font-family":"Monaco, monospace","font-weight":"600"},"function",8,sl),e("text",{x:"100",y:"200","font-size":"11",fill:n.value,"font-family":"Monaco, monospace"}," getUserInfo()",8,ll),e("text",{x:"45",y:"220","font-size":"10",fill:w.value,"font-family":"Monaco, monospace"},"{",8,nl),y[6]||(y[6]=e("rect",{x:"40",y:"228",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-2"},null,-1)),e("text",{x:"60",y:"238","font-size":"10",fill:m.value,"font-family":"Monaco, monospace"},"const",8,il),e("text",{x:"95",y:"238","font-size":"10",fill:n.value,"font-family":"Monaco, monospace"}," url =",8,rl),y[7]||(y[7]=e("text",{x:"130",y:"238","font-size":"10",fill:"#28a745","font-family":"Monaco, monospace"},"'/api/user'",-1)),y[8]||(y[8]=e("rect",{x:"40",y:"248",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-3"},null,-1)),e("text",{x:"60",y:"258","font-size":"10",fill:m.value,"font-family":"Monaco, monospace"},"return",8,cl),e("text",{x:"105",y:"258","font-size":"10",fill:o.value,"font-family":"Monaco, monospace"}," fetch",8,dl),e("text",{x:"140",y:"258","font-size":"10",fill:n.value,"font-family":"Monaco, monospace"},"(url)",8,ul),e("text",{x:"45",y:"278","font-size":"10",fill:w.value,"font-family":"Monaco, monospace"},"}",8,ml),y[9]||(y[9]=e("text",{x:"45",y:"300","font-size":"9",fill:"#6c757d","font-family":"Monaco, monospace"},"@swagger",-1)),e("g",_l,[e("rect",{x:"45",y:"315",width:"40",height:"20",rx:"6",fill:l.value},null,8,pl),y[2]||(y[2]=e("text",{x:"65",y:"329","font-size":"10",fill:"white","text-anchor":"middle","font-weight":"bold"},"GET",-1))]),e("g",fl,[e("rect",{x:"92",y:"315",width:"45",height:"20",rx:"6",fill:o.value},null,8,vl),y[3]||(y[3]=e("text",{x:"114",y:"329","font-size":"10",fill:"white","text-anchor":"middle","font-weight":"bold"},"POST",-1))]),e("rect",{x:"170",y:"252",width:"2",height:"12",fill:o.value,class:"cursor-blink"},null,8,hl)]),e("rect",{x:"30",y:"385",width:"220",height:"15",fill:p.value},null,8,gl),e("text",{x:"40",y:"396","font-size":"8",fill:w.value},"main.js",8,yl),e("text",{x:"200",y:"396","font-size":"8",fill:l.value,"text-anchor":"end"},"✓ Saved",8,wl)]),e("g",bl,[e("rect",{x:"280",y:"80",width:"260",height:"340",rx:"20",fill:f.value,stroke:k.value,"stroke-width":"3",class:"doc-pulse"},null,8,$l),y[15]||(y[15]=e("rect",{x:"280",y:"80",width:"260",height:"45",rx:"20",fill:"url(#heroGradient)",opacity:"0.12"},null,-1)),y[16]||(y[16]=e("rect",{x:"280",y:"110",width:"260",height:"16",fill:"url(#heroGradient)",opacity:"0.08"},null,-1)),y[17]||(y[17]=e("text",{x:"420",y:"108","font-size":"18",fill:"url(#heroGradient)","text-anchor":"middle","font-weight":"bold"},"ShowDoc",-1)),e("rect",{x:"295",y:"140",width:"230",height:"35",rx:"10",fill:h.value},null,8,kl),e("text",{x:"310",y:"163","font-size":"14",fill:n.value,"font-weight":"600"},"User Management API Docs",8,Cl),e("circle",{cx:"500",cy:"157",r:"4",fill:l.value,class:"status-dot"},null,8,xl),e("g",Il,[e("rect",{x:"295",y:"190",width:"230",height:"40",rx:"8",fill:h.value,stroke:k.value,"stroke-width":"1"},null,8,Sl),e("rect",{x:"305",y:"200",width:"40",height:"20",rx:"5",fill:l.value,opacity:"0.15"},null,8,Tl),e("text",{x:"325",y:"214","font-size":"10",fill:l.value,"text-anchor":"middle","font-weight":"bold"},"GET",8,Ml),e("text",{x:"355",y:"210","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users",8,Ll),e("text",{x:"355",y:"223","font-size":"9",fill:w.value},"Get Users List",8,Vl),e("circle",{cx:"508",cy:"210",r:"3",fill:l.value},null,8,zl)]),e("g",Ul,[e("rect",{x:"295",y:"240",width:"230",height:"40",rx:"8",fill:h.value,stroke:k.value,"stroke-width":"1"},null,8,Pl),e("rect",{x:"305",y:"250",width:"45",height:"20",rx:"5",fill:o.value,opacity:"0.15"},null,8,Al),e("text",{x:"327",y:"264","font-size":"10",fill:o.value,"text-anchor":"middle","font-weight":"bold"},"POST",8,Dl),e("text",{x:"360",y:"260","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users",8,Ol),e("text",{x:"360",y:"273","font-size":"9",fill:w.value},"Create User",8,Nl),e("circle",{cx:"508",cy:"260",r:"3",fill:o.value},null,8,Fl)]),e("g",ql,[e("rect",{x:"295",y:"290",width:"230",height:"40",rx:"8",fill:h.value,stroke:k.value,"stroke-width":"1"},null,8,Rl),e("rect",{x:"305",y:"300",width:"40",height:"20",rx:"5",fill:m.value,opacity:"0.15"},null,8,Hl),e("text",{x:"325",y:"314","font-size":"10",fill:m.value,"text-anchor":"middle","font-weight":"bold"},"PUT",8,El),e("text",{x:"355",y:"310","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users/:id",8,jl),e("text",{x:"355",y:"323","font-size":"9",fill:w.value},"Update User",8,Bl),e("circle",{cx:"508",cy:"310",r:"3",fill:m.value},null,8,Gl)]),e("g",Kl,[y[13]||(y[13]=e("rect",{x:"295",y:"350",width:"230",height:"55",rx:"10",fill:"url(#heroGradient)",opacity:"0.08"},null,-1)),e("text",{x:"310",y:"370","font-size":"10",fill:w.value},"Total APIs",8,Wl),y[14]||(y[14]=e("text",{x:"310",y:"390","font-size":"20",fill:"url(#heroGradient)","font-weight":"bold"},"24",-1)),e("text",{x:"390",y:"368","font-size":"10",fill:w.value},"Team Members",8,Jl),e("g",Yl,[e("circle",{cx:"0",cy:"0",r:"8",fill:o.value},null,8,Xl),e("circle",{cx:"14",cy:"0",r:"8",fill:l.value},null,8,Ql),e("circle",{cx:"28",cy:"0",r:"8",fill:m.value},null,8,Zl),e("text",{x:"42",y:"4","font-size":"12",fill:n.value,"font-weight":"600"},"+5",8,en)]),e("circle",{cx:"500",cy:"380",r:"5",fill:l.value,class:"pulse-dot"},null,8,tn),e("text",{x:"510",y:"384","font-size":"9",fill:l.value},"Real-time",8,an)])]),e("g",on,[e("rect",{x:"580",y:"150",width:"90",height:"160",rx:"12",fill:$.value,stroke:k.value,"stroke-width":"2",filter:"url(#heroShadow)"},null,8,sn),e("rect",{x:"585",y:"155",width:"80",height:"140",rx:"8",fill:g.value},null,8,ln),e("rect",{x:"605",y:"158",width:"40",height:"3",rx:"2",fill:k.value},null,8,nn),y[18]||(y[18]=e("rect",{x:"590",y:"170",width:"70",height:"8",rx:"2",fill:"url(#heroGradient)",opacity:"0.3"},null,-1)),e("rect",{x:"590",y:"185",width:"60",height:"4",rx:"2",fill:w.value,opacity:"0.3"},null,8,rn),e("rect",{x:"590",y:"193",width:"65",height:"4",rx:"2",fill:w.value,opacity:"0.3"},null,8,cn),e("rect",{x:"590",y:"210",width:"70",height:"30",rx:"6",fill:h.value},null,8,dn),e("circle",{cx:"605",cy:"225",r:"8",fill:l.value,opacity:"0.2"},null,8,un)]),e("g",mn,[e("rect",{x:"565",y:"280",width:"120",height:"100",rx:"10",fill:$.value,stroke:k.value,"stroke-width":"2",filter:"url(#heroShadow)"},null,8,_n),e("rect",{x:"565",y:"280",width:"120",height:"18",rx:"10",fill:p.value},null,8,pn),e("rect",{x:"565",y:"293",width:"120",height:"6",fill:p.value},null,8,fn),y[19]||(y[19]=e("circle",{cx:"575",cy:"289",r:"3",fill:"#ff5f57"},null,-1)),y[20]||(y[20]=e("circle",{cx:"585",cy:"289",r:"3",fill:"#ffbd2e"},null,-1)),y[21]||(y[21]=e("circle",{cx:"595",cy:"289",r:"3",fill:"#28c840"},null,-1)),y[22]||(y[22]=e("rect",{x:"572",y:"305",width:"106",height:"10",rx:"3",fill:"url(#heroGradient)",opacity:"0.2"},null,-1)),e("rect",{x:"572",y:"322",width:"90",height:"6",rx:"2",fill:w.value,opacity:"0.3"},null,8,vn),e("rect",{x:"572",y:"332",width:"95",height:"6",rx:"2",fill:w.value,opacity:"0.3"},null,8,hn),e("rect",{x:"572",y:"345",width:"50",height:"20",rx:"5",fill:l.value,opacity:"0.2"},null,8,gn),e("text",{x:"597",y:"359","font-size":"10",fill:l.value,"text-anchor":"middle","font-weight":"600"},"200",8,yn)]),e("g",wn,[e("g",bn,[e("circle",{r:"22",fill:o.value,opacity:"0.2",filter:"url(#glow)"},null,8,$n),e("circle",{r:"18",fill:o.value},null,8,kn),y[23]||(y[23]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"A",-1))]),e("g",Cn,[e("circle",{r:"22",fill:l.value,opacity:"0.2",filter:"url(#glow)"},null,8,xn),e("circle",{r:"18",fill:l.value},null,8,In),y[24]||(y[24]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"B",-1))]),e("g",Sn,[e("circle",{r:"22",fill:m.value,opacity:"0.2",filter:"url(#glow)"},null,8,Tn),e("circle",{r:"18",fill:m.value},null,8,Mn),y[25]||(y[25]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"C",-1))])]),e("g",Ln,[e("path",{d:"M 250 250 Q 265 240 280 240",stroke:o.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,Vn),e("path",{d:"M 540 240 Q 555 200 580 180",stroke:l.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,zn),e("path",{d:"M 540 300 Q 555 310 570 320",stroke:m.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,Un),e("g",Pn,[e("circle",{r:"4",fill:o.value},[...y[26]||(y[26]=[e("animateMotion",{dur:"2.5s",repeatCount:"indefinite",path:"M 250 250 Q 265 240 280 240"},null,-1)])],8,An)]),e("g",Dn,[e("circle",{r:"4",fill:l.value},[...y[27]||(y[27]=[e("animateMotion",{dur:"2.8s",repeatCount:"indefinite",path:"M 540 240 Q 555 200 580 180"},null,-1)])],8,On)]),e("g",Nn,[e("circle",{r:"4",fill:m.value},[...y[28]||(y[28]=[e("animateMotion",{dur:"3s",repeatCount:"indefinite",path:"M 540 300 Q 555 310 570 320"},null,-1)])],8,Fn)]),e("path",{d:"M 520 150 Q 545 130 570 105",stroke:o.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.3"},null,8,qn),e("circle",{r:"3",fill:o.value,opacity:"0.8"},[...y[29]||(y[29]=[e("animateMotion",{dur:"2s",repeatCount:"indefinite",path:"M 520 150 Q 545 130 570 105"},null,-1)])],8,Rn)]),e("g",Hn,[e("rect",{x:"70",y:"50",width:"60",height:"28",rx:"14",fill:o.value,opacity:"0.15",stroke:o.value,"stroke-width":"1.5"},null,8,En),e("text",{x:"100",y:"68","font-size":"11",fill:o.value,"text-anchor":"middle","font-weight":"600"},"API",8,jn)]),e("g",Bn,[e("rect",{x:"30",y:"420",width:"80",height:"28",rx:"14",fill:l.value,opacity:"0.15",stroke:l.value,"stroke-width":"1.5"},null,8,Gn),e("text",{x:"70",y:"438","font-size":"11",fill:l.value,"text-anchor":"middle","font-weight":"600"},"Markdown",8,Kn)]),e("g",Wn,[e("rect",{x:"600",y:"410",width:"80",height:"28",rx:"14",fill:m.value,opacity:"0.15",stroke:m.value,"stroke-width":"1.5"},null,8,Jn),e("circle",{cx:"615",cy:"424",r:"4",fill:m.value,class:"pulse-dot-2"},null,8,Yn),e("text",{x:"650",y:"428","font-size":"11",fill:m.value,"text-anchor":"middle","font-weight":"600"},"Real-time",8,Xn)])]))]))}});const Zn=Y(Qn,[["__scopeId","data-v-30a4bb36"]]),ei={class:"api-illustration"},ti={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},ai=["fill"],oi=["fill"],si={class:"api-request",filter:"url(#apiShadow)"},li=["fill","stroke"],ni=["fill"],ii=["fill","stroke"],ri=["fill"],ci={class:"params-table"},di=["fill"],ui=["fill","stroke"],mi=["fill"],_i=["fill"],pi=["fill","stroke"],fi=["fill"],vi=["fill"],hi=["fill"],gi={class:"api-document",filter:"url(#apiShadow)"},yi=["fill","stroke"],wi=["fill"],bi=["fill"],$i=["fill"],ki=["fill"],Ci=["fill"],xi=["fill"],Ii={class:"copy-icon"},Si=["stroke"],Ti=["fill","stroke"],Mi=["stroke"],Li={id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto"},Vi=["fill"],zi={class:"float-icons"},Ui=["fill","stroke"],Pi=["fill","stroke"],Ai=J({__name:"ApiDocumentIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#1e1e1e":"#f8f9fa"),m=q(()=>a.value?"#252525":"#f9f9f9"),f=q(()=>a.value?"#1e1e1e":"#f5f5f5"),d=q(()=>a.value?"#2d2d2d":"#ffffff"),p=q(()=>a.value?"#e0e0e0":"#343a40"),h=q(()=>a.value?"#8b949e":"#6c757d"),$=q(()=>a.value?"#8b949e":"#6c757d"),g=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),n=q(()=>a.value?"rgba(74, 158, 255, 0.1)":"rgba(0, 123, 255, 0.1)"),w=q(()=>a.value?"#4a9eff":"#007bff");return(k,r)=>(C(),V("div",ei,[(C(),V("svg",ti,[r[7]||(r[7]=Ee('<defs data-v-5474d550><linearGradient id="apiPrimaryGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-5474d550><stop offset="0%" style="stop-color:#007bff;" data-v-5474d550></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-5474d550></stop></linearGradient><filter id="apiShadow" data-v-5474d550><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-5474d550></feGaussianBlur><feOffset dx="0" dy="3" result="offsetblur" data-v-5474d550></feOffset><feComponentTransfer data-v-5474d550><feFuncA type="linear" slope="0.15" data-v-5474d550></feFuncA></feComponentTransfer><feMerge data-v-5474d550><feMergeNode data-v-5474d550></feMergeNode><feMergeNode in="SourceGraphic" data-v-5474d550></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"480",cy:"100",r:"100",fill:n.value,opacity:"0.3"},null,8,ai),e("circle",{cx:"80",cy:"320",r:"60",fill:n.value,opacity:"0.2"},null,8,oi),e("g",si,[e("rect",{x:"50",y:"80",width:"240",height:"260",rx:"16",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,li),e("text",{x:"170",y:"110","font-size":"16",fill:p.value,"text-anchor":"middle","font-weight":"600"},"API Request",8,ni),r[0]||(r[0]=Ee('<g class="method-tags" data-v-5474d550><rect x="70" y="130" width="45" height="24" rx="6" fill="#28a745" data-v-5474d550></rect><text x="92" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>GET</text><rect x="125" y="130" width="50" height="24" rx="6" fill="#007bff" data-v-5474d550></rect><text x="150" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>POST</text><rect x="185" y="130" width="45" height="24" rx="6" fill="#fd7e14" data-v-5474d550></rect><text x="207" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>PUT</text><rect x="240" y="130" width="35" height="24" rx="6" fill="#dc3545" data-v-5474d550></rect><text x="257" y="147" font-size="10" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>DEL</text></g>',1)),e("rect",{x:"70",y:"170",width:"210",height:"30",rx:"6",fill:l.value,stroke:g.value,"stroke-width":"1"},null,8,ii),e("text",{x:"80",y:"191","font-size":"11",fill:h.value,"font-family":"monospace"},"/api/users/login",8,ri),e("g",ci,[e("text",{x:"70",y:"220","font-size":"12",fill:p.value,"font-weight":"600"},"Parameters",8,di),e("rect",{x:"70",y:"230",width:"210",height:"22",fill:m.value,stroke:g.value,"stroke-width":"1"},null,8,ui),e("text",{x:"80",y:"245","font-size":"10",fill:h.value},"username",8,mi),e("text",{x:"180",y:"245","font-size":"10",fill:h.value},"string",8,_i),e("rect",{x:"70",y:"252",width:"210",height:"22",fill:o.value,stroke:g.value,"stroke-width":"1"},null,8,pi),e("text",{x:"80",y:"267","font-size":"10",fill:h.value},"password",8,fi),e("text",{x:"180",y:"267","font-size":"10",fill:h.value},"string",8,vi)]),e("rect",{x:"70",y:"290",width:"210",height:"35",rx:"6",fill:f.value},null,8,hi),r[1]||(r[1]=e("text",{x:"80",y:"307","font-size":"9",fill:"#28a745","font-family":"monospace"},"curl -X POST \\",-1)),r[2]||(r[2]=e("text",{x:"80",y:"318","font-size":"9",fill:"#007bff","font-family":"monospace"}," /api/users/login",-1))]),e("g",gi,[e("rect",{x:"320",y:"80",width:"240",height:"260",rx:"16",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,yi),e("text",{x:"440",y:"110","font-size":"16",fill:p.value,"text-anchor":"middle","font-weight":"600"},"Documentation",8,wi),e("rect",{x:"340",y:"130",width:"200",height:"10",rx:"5",fill:$.value,opacity:"0.6"},null,8,bi),e("rect",{x:"340",y:"150",width:"180",height:"8",rx:"4",fill:$.value,opacity:"0.4"},null,8,$i),e("rect",{x:"340",y:"166",width:"190",height:"8",rx:"4",fill:$.value,opacity:"0.5"},null,8,ki),e("text",{x:"340",y:"195","font-size":"12",fill:p.value,"font-weight":"600"},"Response",8,Ci),e("rect",{x:"340",y:"205",width:"200",height:"50",rx:"6",fill:f.value},null,8,xi),r[3]||(r[3]=Ee('<text x="350" y="223" font-size="9" fill="#28a745" font-family="monospace" data-v-5474d550>{</text><text x="360" y="234" font-size="9" fill="#007bff" font-family="monospace" data-v-5474d550>&quot;status&quot;: &quot;success&quot;,</text><text x="360" y="245" font-size="9" fill="#fd7e14" font-family="monospace" data-v-5474d550>&quot;token&quot;: &quot;abc123&quot;</text><text x="350" y="253" font-size="9" fill="#28a745" font-family="monospace" data-v-5474d550>}</text><rect x="340" y="270" width="60" height="22" rx="6" fill="#28a745" opacity="0.2" data-v-5474d550></rect><text x="370" y="285" font-size="11" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-5474d550>200 OK</text><rect x="410" y="270" width="60" height="22" rx="6" fill="#dc3545" opacity="0.2" data-v-5474d550></rect><text x="440" y="285" font-size="11" fill="#dc3545" text-anchor="middle" font-weight="bold" data-v-5474d550>401</text>',8)),e("g",Ii,[e("rect",{x:"530",y:"135",width:"18",height:"18",rx:"3",fill:"none",stroke:h.value,"stroke-width":"1.5"},null,8,Si),e("rect",{x:"533",y:"138",width:"18",height:"18",rx:"3",fill:d.value,stroke:h.value,"stroke-width":"1.5"},null,8,Ti)])]),e("g",{stroke:w.value,"stroke-width":"2",fill:"none",class:"arrow-animate"},[...r[4]||(r[4]=[e("path",{d:"M 290 200 L 320 200","marker-end":"url(#arrowhead)"},null,-1)])],8,Mi),e("defs",null,[e("marker",Li,[e("polygon",{points:"0 0, 10 3, 0 6",fill:w.value},null,8,Vi)])]),e("g",zi,[e("circle",{cx:"160",cy:"50",r:"20",fill:d.value,stroke:g.value,"stroke-width":"1.5",class:"icon-float-1"},null,8,Ui),r[5]||(r[5]=e("text",{x:"160",y:"58","font-size":"16",fill:"#007bff","text-anchor":"middle","font-weight":"bold"},"API",-1)),e("circle",{cx:"450",cy:"360",r:"18",fill:d.value,stroke:g.value,"stroke-width":"1.5",class:"icon-float-2"},null,8,Pi),r[6]||(r[6]=e("path",{d:"M 445 360 L 455 360 M 450 355 L 450 365",stroke:"#28a745","stroke-width":"2.5","stroke-linecap":"round"},null,-1))])]))]))}});const Di=Y(Ai,[["__scopeId","data-v-5474d550"]]),Oi={class:"data-dictionary-illustration"},Ni={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Fi=["fill"],qi=["fill"],Ri={class:"database-icon",filter:"url(#dbShadow)"},Hi=["fill","stroke"],Ei=["fill"],ji={class:"data-table",filter:"url(#dbShadow)"},Bi=["fill","stroke"],Gi=["fill"],Ki=["fill"],Wi=["fill"],Ji=["fill"],Yi=["fill"],Xi={class:"table-row"},Qi=["fill","stroke"],Zi=["fill"],er=["fill"],tr=["fill"],ar={class:"table-row"},or=["fill","stroke"],sr=["fill"],lr=["fill"],nr=["fill"],ir={class:"table-row"},rr=["fill","stroke"],cr=["fill"],dr=["fill"],ur=["fill"],mr={class:"table-row"},_r=["fill","stroke"],pr=["fill"],fr=["fill"],vr=["fill"],hr={class:"table-row"},gr=["fill","stroke"],yr=["fill"],wr=["fill"],br=["fill"],$r=["stroke"],kr={class:"sql-icon float-icon"},Cr=["fill","stroke"],xr={class:"relation-icon float-icon"},Ir=["fill","stroke"],Sr=J({__name:"DataDictionaryIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),m=q(()=>a.value?"#1e1e1e":"#f0f7ff"),f=q(()=>a.value?"#252525":"#f9f9f9"),d=q(()=>a.value?"#e0e0e0":"#343a40"),p=q(()=>a.value?"#8b949e":"#6c757d"),h=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),$=q(()=>(a.value,"rgba(40, 167, 69, 0.1)")),g=q(()=>a.value?"#3fb950":"#28a745");return(n,w)=>(C(),V("div",Oi,[(C(),V("svg",Ni,[w[9]||(w[9]=Ee('<defs data-v-e2504d87><linearGradient id="dbGradient" x1="0%" y1="0%" x2="0%" y2="100%" data-v-e2504d87><stop offset="0%" style="stop-color:#28a745;" data-v-e2504d87></stop><stop offset="100%" style="stop-color:#20833a;" data-v-e2504d87></stop></linearGradient><filter id="dbShadow" data-v-e2504d87><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-e2504d87></feGaussianBlur><feOffset dx="0" dy="3" data-v-e2504d87></feOffset><feComponentTransfer data-v-e2504d87><feFuncA type="linear" slope="0.15" data-v-e2504d87></feFuncA></feComponentTransfer><feMerge data-v-e2504d87><feMergeNode data-v-e2504d87></feMergeNode><feMergeNode in="SourceGraphic" data-v-e2504d87></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"100",cy:"80",r:"80",fill:$.value,opacity:"0.3"},null,8,Fi),e("circle",{cx:"520",cy:"330",r:"70",fill:$.value,opacity:"0.2"},null,8,qi),e("g",Ri,[e("circle",{cx:"150",cy:"200",r:"70",fill:l.value,stroke:h.value,"stroke-width":"2"},null,8,Hi),w[0]||(w[0]=Ee('<g transform="translate(150, 200)" data-v-e2504d87><ellipse cx="0" cy="-25" rx="35" ry="10" fill="url(#dbGradient)" data-v-e2504d87></ellipse><rect x="-35" y="-25" width="70" height="15" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="-10" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse><rect x="-35" y="-10" width="70" height="15" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="5" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse><rect x="-35" y="5" width="70" height="20" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="25" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse></g>',1)),e("text",{x:"150",y:"290","font-size":"12",fill:d.value,"text-anchor":"middle","font-weight":"600"},"MySQL",8,Ei)]),e("g",ji,[e("rect",{x:"280",y:"60",width:"280",height:"280",rx:"16",fill:o.value,stroke:h.value,"stroke-width":"2"},null,8,Bi),e("text",{x:"420",y:"90","font-size":"14",fill:d.value,"text-anchor":"middle","font-weight":"600"},"users Table Structure",8,Gi),e("rect",{x:"300",y:"110",width:"240",height:"32",rx:"6",fill:m.value},null,8,Ki),e("text",{x:"320",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Field",8,Wi),e("text",{x:"400",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Type",8,Ji),e("text",{x:"480",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Description",8,Yi),e("g",Xi,[e("rect",{x:"300",y:"142",width:"240",height:"28",fill:f.value,stroke:h.value,"stroke-width":"1"},null,8,Qi),w[1]||(w[1]=e("circle",{cx:"310",cy:"156",r:"6",fill:"#ffc107"},null,-1)),w[2]||(w[2]=e("path",{d:"M 307 156 L 310 153 L 313 156 L 310 159 Z M 310 153 L 310 158",stroke:"white","stroke-width":"1.5",fill:"none"},null,-1)),e("text",{x:"320",y:"160","font-size":"10",fill:d.value},"id",8,Zi),e("text",{x:"400",y:"160","font-size":"10",fill:p.value},"INT",8,er),e("text",{x:"480",y:"160","font-size":"9",fill:p.value},"User ID",8,tr)]),e("g",ar,[e("rect",{x:"300",y:"170",width:"240",height:"28",fill:o.value,stroke:h.value,"stroke-width":"1"},null,8,or),e("text",{x:"320",y:"188","font-size":"10",fill:d.value},"username",8,sr),e("text",{x:"400",y:"188","font-size":"10",fill:p.value},"VARCHAR",8,lr),e("text",{x:"480",y:"188","font-size":"9",fill:p.value},"Username",8,nr)]),e("g",ir,[e("rect",{x:"300",y:"198",width:"240",height:"28",fill:f.value,stroke:h.value,"stroke-width":"1"},null,8,rr),e("text",{x:"320",y:"216","font-size":"10",fill:d.value},"email",8,cr),e("text",{x:"400",y:"216","font-size":"10",fill:p.value},"VARCHAR",8,dr),e("text",{x:"480",y:"216","font-size":"9",fill:p.value},"Email",8,ur)]),e("g",mr,[e("rect",{x:"300",y:"226",width:"240",height:"28",fill:o.value,stroke:h.value,"stroke-width":"1"},null,8,_r),e("text",{x:"320",y:"244","font-size":"10",fill:d.value},"password",8,pr),e("text",{x:"400",y:"244","font-size":"10",fill:p.value},"VARCHAR",8,fr),e("text",{x:"480",y:"244","font-size":"9",fill:p.value},"Password",8,vr)]),e("g",hr,[e("rect",{x:"300",y:"254",width:"240",height:"28",fill:f.value,stroke:h.value,"stroke-width":"1"},null,8,gr),e("text",{x:"320",y:"272","font-size":"10",fill:d.value},"created_at",8,yr),e("text",{x:"400",y:"272","font-size":"10",fill:p.value},"DATETIME",8,wr),e("text",{x:"480",y:"272","font-size":"9",fill:p.value},"Created At",8,br)]),w[3]||(w[3]=Ee('<g class="index-badges" data-v-e2504d87><rect x="305" y="295" width="55" height="20" rx="4" fill="#28a745" opacity="0.2" data-v-e2504d87></rect><text x="332" y="308" font-size="9" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-e2504d87>PRIMARY</text><rect x="370" y="295" width="45" height="20" rx="4" fill="#007bff" opacity="0.2" data-v-e2504d87></rect><text x="392" y="308" font-size="9" fill="#007bff" text-anchor="middle" font-weight="bold" data-v-e2504d87>INDEX</text></g>',1))]),e("g",{stroke:g.value,"stroke-width":"2",fill:"none",opacity:"0.5",class:"connection-line"},[...w[4]||(w[4]=[e("path",{d:"M 220 200 L 280 140","stroke-dasharray":"4,4",class:"line-animate"},null,-1)])],8,$r),e("g",kr,[e("circle",{cx:"420",cy:"30",r:"22",fill:l.value,stroke:h.value,"stroke-width":"1.5"},null,8,Cr),w[5]||(w[5]=e("text",{x:"420",y:"37","font-size":"12",fill:"#28a745","text-anchor":"middle","font-weight":"bold"},"SQL",-1))]),e("g",xr,[e("circle",{cx:"180",cy:"350",r:"18",fill:l.value,stroke:h.value,"stroke-width":"1.5"},null,8,Ir),w[6]||(w[6]=e("rect",{x:"173",y:"345",width:"6",height:"10",rx:"1",fill:"#007bff"},null,-1)),w[7]||(w[7]=e("rect",{x:"182",y:"345",width:"6",height:"10",rx:"1",fill:"#fd7e14"},null,-1)),w[8]||(w[8]=e("line",{x1:"176",y1:"350",x2:"185",y2:"350",stroke:"#28a745","stroke-width":"2"},null,-1))])]))]))}});const Tr=Y(Sr,[["__scopeId","data-v-e2504d87"]]),Mr={class:"team-collaboration-illustration"},Lr={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Vr=["fill"],zr=["fill"],Ur={class:"central-document",filter:"url(#teamShadow)"},Pr=["fill","stroke"],Ar=["fill"],Dr=["fill"],Or=["fill"],Nr=["fill"],Fr=["fill","stroke"],qr=["stroke"],Rr=["stroke"],Hr=["stroke"],Er={class:"user-avatar user-1",filter:"url(#teamShadow)"},jr=["fill","stroke"],Br=["fill"],Gr=["fill"],Kr=["stroke"],Wr={class:"user-avatar user-2",filter:"url(#teamShadow)"},Jr=["fill","stroke"],Yr=["fill"],Xr=["fill"],Qr={transform:"translate(500, 100)"},Zr=["stroke"],ec=["stroke"],tc={class:"user-avatar user-3",filter:"url(#teamShadow)"},ac=["fill","stroke"],oc=["fill"],sc=["fill"],lc={transform:"translate(320, 340)"},nc=["stroke"],ic=["fill"],rc=["stroke"],cc={class:"comment-bubble float-element",filter:"url(#teamShadow)"},dc=["fill","stroke"],uc=["fill"],mc=["fill"],_c=["fill"],pc={class:"history-icon float-element",filter:"url(#teamShadow)"},fc=["fill","stroke"],vc=["stroke"],hc=["stroke"],gc=["stroke"],yc={class:"sync-icon float-element",filter:"url(#teamShadow)"},wc=["fill","stroke"],bc={class:"sync-rotate"},$c=["stroke"],kc=["fill"],Cc=["stroke"],xc=["fill"],Ic=J({__name:"TeamCollaborationIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),m=q(()=>a.value?"#1e1e1e":"#f8f9fa"),f=q(()=>a.value?"#2d2d2d":"#fff3cd"),d=q(()=>a.value?"#e0e0e0":"#343a40"),p=q(()=>a.value?"#8b949e":"#6c757d"),h=q(()=>a.value?"#8b949e":"#6c757d"),$=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),g=q(()=>a.value?"rgba(74, 158, 255, 0.1)":"rgba(0, 123, 255, 0.1)"),n=q(()=>a.value?"#4a9eff":"#007bff"),w=q(()=>a.value?"#2d2d2d":"#e3f2fd"),k=q(()=>a.value?"#2d2d2d":"#fff3e0"),r=q(()=>a.value?"#2d2d2d":"#f3e5f5"),_=q(()=>a.value?"#4a9eff":"#007bff"),v=q(()=>a.value?"#ff8c2e":"#fd7e14"),y=q(()=>a.value?"#c77dff":"#9c27b0"),S=q(()=>"#007bff"),x=q(()=>"#fd7e14"),I=q(()=>"#9c27b0"),T=q(()=>a.value?"#ff8c2e":"#fd7e14"),M=q(()=>a.value?"#c77dff":"#9c27b0"),L=q(()=>a.value?"#4a9eff":"#007bff"),P=q(()=>a.value?"#3fb950":"#28a745");return(N,U)=>(C(),V("div",Mr,[(C(),V("svg",Lr,[U[2]||(U[2]=Ee('<defs data-v-804d79a6><linearGradient id="teamGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-804d79a6><stop offset="0%" style="stop-color:#007bff;" data-v-804d79a6></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-804d79a6></stop></linearGradient><filter id="teamShadow" data-v-804d79a6><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-804d79a6></feGaussianBlur><feOffset dx="0" dy="3" data-v-804d79a6></feOffset><feComponentTransfer data-v-804d79a6><feFuncA type="linear" slope="0.15" data-v-804d79a6></feFuncA></feComponentTransfer><feMerge data-v-804d79a6><feMergeNode data-v-804d79a6></feMergeNode><feMergeNode in="SourceGraphic" data-v-804d79a6></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"500",cy:"90",r:"90",fill:g.value,opacity:"0.3"},null,8,Vr),e("circle",{cx:"90",cy:"330",r:"70",fill:g.value,opacity:"0.2"},null,8,zr),e("g",Ur,[e("rect",{x:"230",y:"140",width:"140",height:"180",rx:"12",fill:o.value,stroke:$.value,"stroke-width":"2"},null,8,Pr),U[0]||(U[0]=e("rect",{x:"240",y:"150",width:"120",height:"25",rx:"6",fill:"url(#teamGradient)",opacity:"0.15"},null,-1)),e("text",{x:"300",y:"167","font-size":"11",fill:d.value,"text-anchor":"middle","font-weight":"600"},"Project Doc",8,Ar),e("rect",{x:"245",y:"185",width:"110",height:"6",rx:"3",fill:h.value,opacity:"0.6"},null,8,Dr),e("rect",{x:"245",y:"200",width:"100",height:"6",rx:"3",fill:h.value,opacity:"0.4"},null,8,Or),e("rect",{x:"245",y:"215",width:"105",height:"6",rx:"3",fill:h.value,opacity:"0.5"},null,8,Nr),e("rect",{x:"245",y:"235",width:"110",height:"60",rx:"6",fill:m.value,stroke:$.value,"stroke-width":"1"},null,8,Fr),e("line",{x1:"260",y1:"245",x2:"260",y2:"255",stroke:S.value,"stroke-width":"2",class:"cursor-blink"},null,8,qr),e("line",{x1:"295",y1:"260",x2:"295",y2:"270",stroke:x.value,"stroke-width":"2",class:"cursor-blink",style:{"animation-delay":"0.5s"}},null,8,Rr),e("line",{x1:"275",y1:"280",x2:"275",y2:"290",stroke:I.value,"stroke-width":"2",class:"cursor-blink",style:{"animation-delay":"1s"}},null,8,Hr)]),e("g",Er,[e("circle",{cx:"120",cy:"120",r:"35",fill:w.value,stroke:$.value,"stroke-width":"2"},null,8,jr),e("circle",{cx:"120",cy:"115",r:"10",fill:_.value},null,8,Br),e("path",{d:"M 105 138 Q 120 130 135 138",fill:_.value},null,8,Gr),U[1]||(U[1]=e("g",{transform:"translate(140, 100)"},[e("path",{d:"M -4 0 L -2 -6 L 0 -2 L 2 -6 L 4 0 Z",fill:"#ffc107"}),e("rect",{x:"-4",y:"0",width:"8",height:"3",fill:"#ffc107"})],-1)),e("path",{d:"M 145 135 L 230 170",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,Kr)]),e("g",Wr,[e("circle",{cx:"480",cy:"120",r:"35",fill:k.value,stroke:$.value,"stroke-width":"2"},null,8,Jr),e("circle",{cx:"480",cy:"115",r:"10",fill:v.value},null,8,Yr),e("path",{d:"M 465 138 Q 480 130 495 138",fill:v.value},null,8,Xr),e("g",Qr,[e("path",{d:"M -3 -3 L 3 3 M 3 3 L 1 5 L -1 3 Z",stroke:T.value,"stroke-width":"1.5",fill:"none","stroke-linecap":"round"},null,8,Zr)]),e("path",{d:"M 455 135 L 370 170",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,ec)]),e("g",tc,[e("circle",{cx:"300",cy:"360",r:"35",fill:r.value,stroke:$.value,"stroke-width":"2"},null,8,ac),e("circle",{cx:"300",cy:"355",r:"10",fill:y.value},null,8,oc),e("path",{d:"M 285 378 Q 300 370 315 378",fill:y.value},null,8,sc),e("g",lc,[e("ellipse",{cx:"0",cy:"0",rx:"5",ry:"3",fill:"none",stroke:M.value,"stroke-width":"1.5"},null,8,nc),e("circle",{cx:"0",cy:"0",r:"2",fill:M.value},null,8,ic)]),e("path",{d:"M 300 325 L 300 320",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,rc)]),e("g",cc,[e("rect",{x:"400",y:"240",width:"100",height:"50",rx:"10",fill:f.value,stroke:$.value,"stroke-width":"1.5"},null,8,dc),e("path",{d:"M 430 290 L 425 300 L 440 290 Z",fill:f.value},null,8,uc),e("text",{x:"450",y:"260","font-size":"9",fill:p.value,"text-anchor":"middle"},"Need Change",8,mc),e("text",{x:"450",y:"273","font-size":"9",fill:p.value,"text-anchor":"middle"},"This part...",8,_c)]),e("g",pc,[e("circle",{cx:"100",cy:"250",r:"28",fill:l.value,stroke:$.value,"stroke-width":"2"},null,8,fc),e("circle",{cx:"100",cy:"250",r:"15",fill:"none",stroke:L.value,"stroke-width":"2"},null,8,vc),e("path",{d:"M 100 240 L 100 250 L 108 250",stroke:L.value,"stroke-width":"2","stroke-linecap":"round"},null,8,hc),e("path",{d:"M 90 235 L 85 240 L 90 245",stroke:L.value,"stroke-width":"2",fill:"none","stroke-linecap":"round"},null,8,gc)]),e("g",yc,[e("circle",{cx:"500",cy:"280",r:"25",fill:l.value,stroke:$.value,"stroke-width":"2"},null,8,wc),e("g",bc,[e("path",{d:"M 505 270 A 10 10 0 1 1 495 280",fill:"none",stroke:P.value,"stroke-width":"2","stroke-linecap":"round"},null,8,$c),e("path",{d:"M 503 268 L 505 270 L 507 268",fill:P.value},null,8,kc),e("path",{d:"M 495 290 A 10 10 0 1 1 505 280",fill:"none",stroke:P.value,"stroke-width":"2","stroke-linecap":"round"},null,8,Cc),e("path",{d:"M 497 292 L 495 290 L 493 292",fill:P.value},null,8,xc)])])]))]))}});const Sc=Y(Ic,[["__scopeId","data-v-804d79a6"]]),Tc={class:"auto-generate-illustration"},Mc={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Lc=["fill"],Vc=["fill"],zc={class:"code-editor",filter:"url(#autoShadow)"},Uc=["fill","stroke"],Pc=["fill"],Ac=["fill"],Dc={"font-family":"monospace","font-size":"9"},Oc=["fill"],Nc=["fill"],Fc=["fill"],qc=["fill"],Rc=["fill"],Hc={class:"transformation-magic"},Ec={class:"tool-icons"},jc=["fill","stroke"],Bc=["fill","stroke"],Gc=["fill","stroke"],Kc=["fill"],Wc={class:"generated-doc",filter:"url(#autoShadow)"},Jc=["fill","stroke"],Yc=["fill"],Xc=["fill"],Qc=["fill"],Zc=["fill"],ed=["fill"],td=["fill","stroke"],ad=["fill"],od=["fill"],sd=["fill","stroke"],ld=["fill"],nd=["fill"],id=["fill"],rd=["fill"],cd={class:"success-icon float-icon",filter:"url(#autoShadow)"},dd=["fill","stroke"],ud=J({__name:"AutoGenerateIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#1e1e1e":"#0d1117"),l=q(()=>a.value?"#2d2d2d":"#161b22"),m=q(()=>a.value?"#2d2d2d":"#ffffff"),f=q(()=>a.value?"#2d2d2d":"#ffffff"),d=q(()=>a.value?"#1e1e1e":"#f8f9fa"),p=q(()=>a.value?"#252525":"#f9f9f9"),h=q(()=>a.value?"#e0e0e0":"#343a40"),$=q(()=>a.value?"#8b949e":"#6c757d"),g=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),n=q(()=>(a.value,"rgba(255, 193, 7, 0.1)"));return(w,k)=>(C(),V("div",Tc,[(C(),V("svg",Mc,[k[19]||(k[19]=Ee('<defs data-v-9a3a589d><linearGradient id="autoGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-9a3a589d><stop offset="0%" style="stop-color:#ffc107;" data-v-9a3a589d></stop><stop offset="100%" style="stop-color:#ff8c2e;" data-v-9a3a589d></stop></linearGradient><filter id="autoShadow" data-v-9a3a589d><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-9a3a589d></feGaussianBlur><feOffset dx="0" dy="3" data-v-9a3a589d></feOffset><feComponentTransfer data-v-9a3a589d><feFuncA type="linear" slope="0.15" data-v-9a3a589d></feFuncA></feComponentTransfer><feMerge data-v-9a3a589d><feMergeNode data-v-9a3a589d></feMergeNode><feMergeNode in="SourceGraphic" data-v-9a3a589d></feMergeNode></feMerge></filter><filter id="glow" data-v-9a3a589d><feGaussianBlur stdDeviation="4" result="coloredBlur" data-v-9a3a589d></feGaussianBlur><feMerge data-v-9a3a589d><feMergeNode in="coloredBlur" data-v-9a3a589d></feMergeNode><feMergeNode in="SourceGraphic" data-v-9a3a589d></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"480",cy:"100",r:"90",fill:n.value,opacity:"0.3"},null,8,Lc),e("circle",{cx:"100",cy:"330",r:"70",fill:n.value,opacity:"0.2"},null,8,Vc),e("g",zc,[e("rect",{x:"50",y:"100",width:"200",height:"220",rx:"12",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,Uc),e("rect",{x:"50",y:"100",width:"200",height:"30",rx:"12",fill:l.value},null,8,Pc),k[7]||(k[7]=e("circle",{cx:"65",cy:"115",r:"4",fill:"#ff5f57"},null,-1)),k[8]||(k[8]=e("circle",{cx:"80",cy:"115",r:"4",fill:"#febc2e"},null,-1)),k[9]||(k[9]=e("circle",{cx:"95",cy:"115",r:"4",fill:"#28c840"},null,-1)),e("text",{x:"150",y:"120","font-size":"10",fill:$.value,"text-anchor":"middle"},"main.js",8,Ac),e("g",Dc,[k[0]||(k[0]=Ee('<text x="60" y="150" fill="#8b949e" data-v-9a3a589d>1</text><text x="75" y="150" fill="#ff7b72" data-v-9a3a589d>/**</text><text x="60" y="164" fill="#8b949e" data-v-9a3a589d>2</text><text x="75" y="164" fill="#7ee787" data-v-9a3a589d> * @api {POST} /api/login</text><text x="60" y="178" fill="#8b949e" data-v-9a3a589d>3</text><text x="75" y="178" fill="#7ee787" data-v-9a3a589d> * @param {string} username</text><text x="60" y="192" fill="#8b949e" data-v-9a3a589d>4</text><text x="75" y="192" fill="#7ee787" data-v-9a3a589d> * @param {string} password</text><text x="60" y="206" fill="#8b949e" data-v-9a3a589d>5</text><text x="75" y="206" fill="#ff7b72" data-v-9a3a589d> */</text><text x="60" y="220" fill="#8b949e" data-v-9a3a589d>6</text><text x="75" y="220" fill="#d2a8ff" data-v-9a3a589d>function</text><text x="118" y="220" fill="#ffa657" data-v-9a3a589d> login</text>',13)),e("text",{x:"143",y:"220",fill:h.value},"(username, pwd)",8,Oc),k[1]||(k[1]=e("text",{x:"60",y:"234",fill:"#8b949e"},"7",-1)),e("text",{x:"75",y:"234",fill:h.value},"{",8,Nc),k[2]||(k[2]=e("text",{x:"60",y:"248",fill:"#8b949e"},"8",-1)),k[3]||(k[3]=e("text",{x:"85",y:"248",fill:"#ff7b72"},"return",-1)),k[4]||(k[4]=e("text",{x:"120",y:"248",fill:"#79c0ff"}," api",-1)),e("text",{x:"138",y:"248",fill:h.value},".",8,Fc),k[5]||(k[5]=e("text",{x:"143",y:"248",fill:"#d2a8ff"},"post",-1)),e("text",{x:"168",y:"248",fill:h.value},"(...)",8,qc),k[6]||(k[6]=e("text",{x:"60",y:"262",fill:"#8b949e"},"9",-1)),e("text",{x:"75",y:"262",fill:h.value},"}",8,Rc)])]),e("g",Hc,[k[12]||(k[12]=Ee('<g class="magic-circle" data-v-9a3a589d><circle cx="300" cy="210" r="50" fill="url(#autoGradient)" opacity="0.1" filter="url(#glow)" class="magic-pulse" data-v-9a3a589d></circle><circle cx="300" cy="210" r="40" fill="none" stroke="url(#autoGradient)" stroke-width="2" opacity="0.5" class="magic-rotate" data-v-9a3a589d></circle><circle cx="300" cy="210" r="30" fill="none" stroke="url(#autoGradient)" stroke-width="2" opacity="0.3" class="magic-rotate-reverse" data-v-9a3a589d></circle></g><g transform="translate(300, 210)" class="magic-icon" data-v-9a3a589d><path d="M -8 -15 L 0 -5 L -5 -5 L 5 10 L -2 0 L 3 0 Z" fill="url(#autoGradient)" filter="url(#glow)" data-v-9a3a589d></path></g>',2)),e("g",Ec,[e("circle",{cx:"280",cy:"140",r:"18",fill:f.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-1"},null,8,jc),k[10]||(k[10]=e("text",{x:"280",y:"146","font-size":"8",fill:"#85ea2d","text-anchor":"middle","font-weight":"bold"},"Swagger",-1)),e("circle",{cx:"340",cy:"150",r:"18",fill:f.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-2"},null,8,Bc),k[11]||(k[11]=e("text",{x:"340",y:"156","font-size":"8",fill:"#ff6c37","text-anchor":"middle","font-weight":"bold"},"Postman",-1)),e("circle",{cx:"320",cy:"290",r:"18",fill:f.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-3"},null,8,Gc),e("text",{x:"320",y:"296","font-size":"9",fill:h.value,"text-anchor":"middle","font-weight":"bold"},"MD",8,Kc)]),k[13]||(k[13]=Ee('<g class="particles" data-v-9a3a589d><circle r="3" fill="#ffc107" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle><circle r="3" fill="#ff8c2e" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" begin="0.5s" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle><circle r="3" fill="#ffc107" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" begin="1s" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle></g><defs data-v-9a3a589d><marker id="arrowGold" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" data-v-9a3a589d><polygon points="0 0, 10 3, 0 6" fill="#ffc107" data-v-9a3a589d></polygon></marker></defs><path d="M 250 210 L 280 210" stroke="#ffc107" stroke-width="2" marker-end="url(#arrowGold)" opacity="0.6" data-v-9a3a589d></path><path d="M 320 210 L 350 210" stroke="#ffc107" stroke-width="2" marker-end="url(#arrowGold)" opacity="0.6" data-v-9a3a589d></path>',4))]),e("g",Wc,[e("rect",{x:"370",y:"100",width:"200",height:"220",rx:"12",fill:m.value,stroke:g.value,"stroke-width":"2"},null,8,Jc),k[16]||(k[16]=e("rect",{x:"380",y:"110",width:"180",height:"30",rx:"8",fill:"url(#autoGradient)",opacity:"0.15"},null,-1)),e("text",{x:"470",y:"130","font-size":"12",fill:h.value,"text-anchor":"middle","font-weight":"600"},"API Docs",8,Yc),e("g",null,[e("text",{x:"390",y:"160","font-size":"11",fill:h.value,"font-weight":"600"},"POST /api/login",8,Xc),e("text",{x:"390",y:"180","font-size":"9",fill:$.value},"User Login API",8,Qc),e("rect",{x:"390",y:"195",width:"160",height:"20",rx:"4",fill:d.value},null,8,Zc),e("text",{x:"400",y:"209","font-size":"9",fill:h.value,"font-weight":"600"},"Request Parameters",8,ed),e("rect",{x:"390",y:"215",width:"160",height:"18",fill:p.value,stroke:g.value,"stroke-width":"0.5"},null,8,td),e("text",{x:"400",y:"227","font-size":"8",fill:$.value},"username",8,ad),e("text",{x:"490",y:"227","font-size":"8",fill:$.value},"string",8,od),e("rect",{x:"390",y:"233",width:"160",height:"18",fill:m.value,stroke:g.value,"stroke-width":"0.5"},null,8,sd),e("text",{x:"400",y:"245","font-size":"8",fill:$.value},"password",8,ld),e("text",{x:"490",y:"245","font-size":"8",fill:$.value},"string",8,nd),e("text",{x:"390",y:"270","font-size":"9",fill:h.value,"font-weight":"600"},"Response Example",8,id),e("rect",{x:"390",y:"275",width:"160",height:"30",rx:"4",fill:o.value},null,8,rd),k[14]||(k[14]=e("text",{x:"400",y:"290","font-size":"8",fill:"#28a745","font-family":"monospace"},'{ "code": 200,',-1)),k[15]||(k[15]=e("text",{x:"400",y:"300","font-size":"8",fill:"#007bff","font-family":"monospace"},' "token": "..." }',-1))])]),e("g",cd,[e("circle",{cx:"540",cy:"340",r:"22",fill:f.value,stroke:g.value,"stroke-width":"2"},null,8,dd),k[17]||(k[17]=e("circle",{cx:"540",cy:"340",r:"14",fill:"none",stroke:"#28a745","stroke-width":"2"},null,-1)),k[18]||(k[18]=e("path",{d:"M 534 340 L 538 344 L 547 333",stroke:"#28a745","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1))])]))]))}});const md=Y(ud,[["__scopeId","data-v-9a3a589d"]]),_d={class:"integration-illustration"},pd={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},fd=["fill"],vd=["fill"],hd={class:"runapi-panel",filter:"url(#intShadow)"},gd=["fill","stroke"],yd=["fill"],wd={class:"debug-panel"},bd=["fill","stroke"],$d=["fill"],kd=["fill"],Cd=["fill"],xd={class:"showdoc-panel",filter:"url(#intShadow)"},Id=["fill","stroke"],Sd=["fill"],Td={class:"doc-panel"},Md=["fill"],Ld=["fill"],Vd=["fill"],zd=["fill"],Ud=["fill","stroke"],Pd=["fill"],Ad=["fill"],Dd=["fill"],Od=["fill","stroke"],Nd=["fill"],Fd=["fill"],qd=["fill"],Rd=["fill"],Hd=["fill"],Ed={class:"integration-connection"},jd=["fill"],Bd={class:"feature-badges"},Gd=["fill","stroke"],Kd=["fill"],Wd=["fill","stroke"],Jd=["fill"],Yd=["fill","stroke"],Xd=["fill"],Qd={class:"deco-icons"},Zd=["fill","stroke"],eu=["fill","stroke"],tu=J({__name:"IntegrationIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),m=q(()=>a.value?"#1e1e1e":"#f8f9fa"),f=q(()=>a.value?"#1e1e1e":"#0d1117"),d=q(()=>a.value?"#1e1e1e":"#f0f7ff"),p=q(()=>a.value?"#252525":"#f9f9f9"),h=q(()=>a.value?"#2d2d2d":"#ffffff"),$=q(()=>a.value?"#2d2d2d":"#f8f9fa"),g=q(()=>a.value?"#e0e0e0":"#343a40"),n=q(()=>a.value?"#8b949e":"#6c757d"),w=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),k=q(()=>"rgba(111, 66, 193, 0.15)"),r=q(()=>"rgba(0, 123, 255, 0.15)");return(_,v)=>(C(),V("div",_d,[(C(),V("svg",pd,[v[9]||(v[9]=Ee('<defs data-v-ffdb77b9><linearGradient id="runApiGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#5a32a3;" data-v-ffdb77b9></stop></linearGradient><linearGradient id="showDocGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#007bff;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-ffdb77b9></stop></linearGradient><linearGradient id="integrationGradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop><stop offset="50%" style="stop-color:#007bff;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop></linearGradient><filter id="intShadow" data-v-ffdb77b9><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-ffdb77b9></feGaussianBlur><feOffset dx="0" dy="3" data-v-ffdb77b9></feOffset><feComponentTransfer data-v-ffdb77b9><feFuncA type="linear" slope="0.15" data-v-ffdb77b9></feFuncA></feComponentTransfer><feMerge data-v-ffdb77b9><feMergeNode data-v-ffdb77b9></feMergeNode><feMergeNode in="SourceGraphic" data-v-ffdb77b9></feMergeNode></feMerge></filter><filter id="glow" data-v-ffdb77b9><feGaussianBlur stdDeviation="4" result="coloredBlur" data-v-ffdb77b9></feGaussianBlur><feMerge data-v-ffdb77b9><feMergeNode in="coloredBlur" data-v-ffdb77b9></feMergeNode><feMergeNode in="SourceGraphic" data-v-ffdb77b9></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"90",cy:"90",r:"80",fill:k.value,opacity:"0.3"},null,8,fd),e("circle",{cx:"510",cy:"320",r:"70",fill:r.value,opacity:"0.3"},null,8,vd),e("g",hd,[e("rect",{x:"50",y:"90",width:"220",height:"240",rx:"16",fill:o.value,stroke:w.value,"stroke-width":"2"},null,8,gd),v[3]||(v[3]=e("rect",{x:"60",y:"100",width:"200",height:"35",rx:"8",fill:"url(#runApiGradient)",opacity:"0.15"},null,-1)),e("text",{x:"160",y:"123","font-size":"14",fill:g.value,"text-anchor":"middle","font-weight":"700"},"RunAPI",8,yd),e("g",wd,[v[0]||(v[0]=e("rect",{x:"70",y:"150",width:"50",height:"24",rx:"6",fill:"#6f42c1"},null,-1)),v[1]||(v[1]=e("text",{x:"95",y:"166","font-size":"11",fill:"white","text-anchor":"middle","font-weight":"bold"},"POST",-1)),e("rect",{x:"130",y:"150",width:"120",height:"24",rx:"6",fill:m.value,stroke:w.value,"stroke-width":"1"},null,8,bd),e("text",{x:"140",y:"166","font-size":"9",fill:n.value,"font-family":"monospace"},"/api/users",8,$d),e("text",{x:"70",y:"195","font-size":"10",fill:g.value,"font-weight":"600"},"Request Body",8,kd),e("rect",{x:"70",y:"200",width:"180",height:"50",rx:"6",fill:f.value},null,8,Cd),v[2]||(v[2]=Ee('<text x="80" y="218" font-size="8" fill="#c792ea" font-family="monospace" data-v-ffdb77b9>{</text><text x="90" y="230" font-size="8" fill="#82aaff" font-family="monospace" data-v-ffdb77b9>&quot;name&quot;: &quot;test&quot;,</text><text x="90" y="240" font-size="8" fill="#c3e88d" font-family="monospace" data-v-ffdb77b9>&quot;age&quot;: 25</text><text x="80" y="248" font-size="8" fill="#c792ea" font-family="monospace" data-v-ffdb77b9>}</text><rect x="70" y="265" width="180" height="32" rx="8" fill="url(#runApiGradient)" class="debug-button" data-v-ffdb77b9></rect><text x="160" y="285" font-size="12" fill="white" text-anchor="middle" font-weight="600" data-v-ffdb77b9>Send Request</text><rect x="70" y="305" width="55" height="20" rx="4" fill="#28a745" opacity="0.2" data-v-ffdb77b9></rect><text x="97" y="318" font-size="9" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-ffdb77b9>200 OK</text>',8))])]),e("g",xd,[e("rect",{x:"330",y:"90",width:"220",height:"240",rx:"16",fill:o.value,stroke:w.value,"stroke-width":"2"},null,8,Id),v[5]||(v[5]=e("rect",{x:"340",y:"100",width:"200",height:"35",rx:"8",fill:"url(#showDocGradient)",opacity:"0.15"},null,-1)),e("text",{x:"440",y:"123","font-size":"14",fill:g.value,"text-anchor":"middle","font-weight":"700"},"ShowDoc",8,Sd),e("g",Td,[e("text",{x:"350",y:"160","font-size":"12",fill:g.value,"font-weight":"600"},"POST /api/users",8,Md),e("text",{x:"350",y:"178","font-size":"9",fill:n.value},"Create User API",8,Ld),e("rect",{x:"350",y:"190",width:"180",height:"20",rx:"4",fill:d.value},null,8,Vd),e("text",{x:"360",y:"204","font-size":"9",fill:g.value,"font-weight":"600"},"Parameters",8,zd),e("rect",{x:"350",y:"210",width:"180",height:"18",fill:p.value,stroke:w.value,"stroke-width":"0.5"},null,8,Ud),e("text",{x:"360",y:"222","font-size":"8",fill:n.value},"name",8,Pd),e("text",{x:"420",y:"222","font-size":"8",fill:n.value},"string",8,Ad),e("text",{x:"475",y:"222","font-size":"8",fill:n.value},"Username",8,Dd),e("rect",{x:"350",y:"228",width:"180",height:"18",fill:o.value,stroke:w.value,"stroke-width":"0.5"},null,8,Od),e("text",{x:"360",y:"240","font-size":"8",fill:n.value},"age",8,Nd),e("text",{x:"420",y:"240","font-size":"8",fill:n.value},"number",8,Fd),e("text",{x:"475",y:"240","font-size":"8",fill:n.value},"Age",8,qd),e("text",{x:"350",y:"265","font-size":"9",fill:g.value,"font-weight":"600"},"Example Code",8,Rd),e("rect",{x:"350",y:"270",width:"180",height:"40",rx:"6",fill:f.value},null,8,Hd),v[4]||(v[4]=Ee('<text x="360" y="286" font-size="8" fill="#82aaff" font-family="monospace" data-v-ffdb77b9>POST /api/users</text><text x="360" y="297" font-size="8" fill="#c3e88d" font-family="monospace" data-v-ffdb77b9>{&quot;name&quot;:&quot;test&quot;}</text><g class="sync-badge" data-v-ffdb77b9><rect x="480" y="148" width="45" height="18" rx="4" fill="#28a745" opacity="0.2" data-v-ffdb77b9></rect><circle cx="488" cy="157" r="3" fill="#28a745" class="sync-dot" data-v-ffdb77b9></circle><text x="510" y="160" font-size="8" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-ffdb77b9>Sync</text></g>',3))])]),e("g",Ed,[e("rect",{x:"260",y:"195",width:"80",height:"40",rx:"20",fill:h.value,opacity:"0.9",filter:"url(#intShadow)"},null,8,jd),v[6]||(v[6]=Ee('<path d="M 280 215 L 295 215 M 282 210 L 280 215 L 282 220" stroke="url(#integrationGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" class="arrow-flow-1" data-v-ffdb77b9></path><path d="M 305 215 L 320 215 M 318 210 L 320 215 L 318 220" stroke="url(#integrationGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" class="arrow-flow-2" data-v-ffdb77b9></path><g transform="translate(300, 215)" class="sync-icon-center" data-v-ffdb77b9><circle r="8" fill="url(#integrationGradient)" opacity="0.2" data-v-ffdb77b9></circle><path d="M 3 -5 A 5 5 0 1 1 -3 0" fill="none" stroke="url(#integrationGradient)" stroke-width="1.5" stroke-linecap="round" data-v-ffdb77b9></path><path d="M 2 -6 L 3 -5 L 4 -6" stroke="url(#integrationGradient)" stroke-width="1.5" fill="none" stroke-linecap="round" data-v-ffdb77b9></path><path d="M -3 5 A 5 5 0 1 1 3 0" fill="none" stroke="url(#integrationGradient)" stroke-width="1.5" stroke-linecap="round" data-v-ffdb77b9></path><path d="M -2 6 L -3 5 L -4 6" stroke="url(#integrationGradient)" stroke-width="1.5" fill="none" stroke-linecap="round" data-v-ffdb77b9></path></g><g class="data-particles" data-v-ffdb77b9><circle r="2.5" fill="#6f42c1" opacity="0.8" filter="url(#glow)" data-v-ffdb77b9><animateMotion dur="2s" repeatCount="indefinite" path="M 270 215 L 330 215" data-v-ffdb77b9></animateMotion></circle><circle r="2.5" fill="#007bff" opacity="0.8" filter="url(#glow)" data-v-ffdb77b9><animateMotion dur="2s" repeatCount="indefinite" begin="1s" path="M 330 215 L 270 215" data-v-ffdb77b9></animateMotion></circle></g>',4))]),e("g",Bd,[e("rect",{x:"150",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:w.value,"stroke-width":"1"},null,8,Gd),e("text",{x:"190",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Real-time Sync",8,Kd),e("rect",{x:"260",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:w.value,"stroke-width":"1"},null,8,Wd),e("text",{x:"300",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Seamless",8,Jd),e("rect",{x:"370",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:w.value,"stroke-width":"1"},null,8,Yd),e("text",{x:"410",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Efficient",8,Xd)]),e("g",Qd,[e("circle",{cx:"120",cy:"50",r:"20",fill:l.value,stroke:w.value,"stroke-width":"1.5",class:"float-icon-1"},null,8,Zd),v[7]||(v[7]=e("text",{x:"120",y:"57","font-size":"12",fill:"#007bff","text-anchor":"middle","font-weight":"bold"},"Client",-1)),e("circle",{cx:"480",cy:"50",r:"20",fill:l.value,stroke:w.value,"stroke-width":"1.5",class:"float-icon-2"},null,8,eu),v[8]||(v[8]=e("text",{x:"480",y:"57","font-size":"12",fill:"#6f42c1","text-anchor":"middle","font-weight":"bold"},"Web",-1))])]))]))}});const au=Y(tu,[["__scopeId","data-v-ffdb77b9"]]),ou={class:"landing-page"},su={class:"hero"},lu={class:"hero-content"},nu={class:"hero-text"},iu={class:"subtitle"},ru={class:"highlight"},cu={class:"hero-description"},du={class:"cta-buttons"},uu=["href"],mu=["href"],_u={class:"feature-tags"},pu={class:"tag"},fu={class:"tag"},vu={class:"hero-image"},hu={class:"features-section"},gu={class:"section-header"},yu={class:"features-grid"},wu={class:"feature-card"},bu={class:"feature-icon"},$u={class:"feature-card"},ku={class:"feature-icon"},Cu={class:"feature-card"},xu={class:"feature-icon"},Iu={class:"feature-card"},Su={class:"feature-icon"},Tu={class:"feature-card"},Mu={class:"feature-icon"},Lu={class:"feature-card"},Vu={class:"feature-icon"},zu={class:"feature-detail"},Uu={class:"detail-row"},Pu={class:"detail-content"},Au={class:"detail-desc"},Du={class:"detail-list"},Ou={class:"detail-image"},Nu={class:"detail-row reverse"},Fu={class:"detail-image"},qu={class:"detail-content"},Ru={class:"detail-desc"},Hu={class:"detail-list"},Eu={class:"detail-row"},ju={class:"detail-content"},Bu={class:"detail-desc"},Gu={class:"detail-list"},Ku={class:"detail-image"},Wu={class:"detail-row reverse"},Ju={class:"detail-image"},Yu={class:"detail-content"},Xu={class:"detail-desc"},Qu={class:"detail-list"},Zu={class:"detail-row"},em={class:"detail-content"},tm={class:"detail-desc"},am={class:"detail-list"},om={class:"detail-image"},sm={class:"trust-section"},lm={class:"trust-content"},nm={class:"trust-subtitle"},im={class:"comparison-section"},rm={class:"comparison-table"},cm={class:"comparison-traditional"},dm={class:"comparison-showdoc"},um={class:"comparison-stats"},mm={class:"comparison-stat-item"},_m={class:"stat-desc"},pm={class:"comparison-stat-item"},fm={class:"stat-desc"},vm={class:"comparison-stat-item"},hm={class:"stat-desc"},gm={class:"comparison-stat-item"},ym={class:"stat-desc"},wm={class:"cta-section"},bm={class:"cta-buttons"},$m=["href"],km=["href"],Cm={class:"feature-tags"},xm={class:"tag"},Im={class:"tag"},Sm=J({__name:"Index",setup(c){const t=Qe(),a=xe(),{locale:o}=te(),l=q(()=>o.value==="en-US"?"https://www.showdoc.com.cn/demo-en":"https://www.showdoc.com.cn/demo"),m=q(()=>o.value==="en-US"?"https://www.showdoc.com.cn/help-en":"https://www.showdoc.com.cn/help"),f=async()=>{try{const d=await X("/api/common/homePageSetting",{},"post",!1);d.error_code===0&&d.data&&(d.data.home_page==2?a.replace({path:"/user/login"}):d.data.home_page==3&&d.data.home_item&&a.replace({path:"/"+d.data.home_item}))}catch(d){console.error("获取首页设置失败:",d)}};return ae(()=>{t.fetchUserInfo().catch(()=>{}),f()}),(d,p)=>{const h=H("router-link");return C(),V("div",ou,[s(Us),e("section",su,[e("div",lu,[e("div",nu,[e("h1",null,[e("span",iu,i(d.$t("index.hero_subtitle")||"专为IT团队打造的"),1),p[0]||(p[0]=e("br",{class:"title-break"},null,-1)),e("span",ru,i(d.$t("index.hero_title")||"技术文档协作平台"),1)]),e("p",cu,[e("span",null,i(d.$t("index.api_docs")||"API文档"),1),e("span",null,i(d.$t("index.data_dict")||"数据字典"),1),e("span",null,i(d.$t("index.tech_spec")||"技术规范"),1),e("span",null,i(d.$t("index.team_kb")||"团队知识库"),1)]),e("div",du,[e("a",{href:l.value,target:"_blank",class:"btn btn-landing-primary"},i(d.$t("index.view_example")||"查看示例"),9,uu),e("a",{href:m.value,target:"_blank",class:"btn btn-landing-outline"},i(d.$t("index.learn_more")||"了解更多"),9,mu)]),e("div",_u,[e("span",pu,[s(z(ca)),O(" "+i(d.$t("index.quick_start")||"5分钟上手"),1)]),e("span",fu,[s(z(Dt)),O(" "+i(d.$t("index.team_collab")||"团队协作"),1)])])]),e("div",vu,[s(Zn)])])]),e("section",hu,[e("div",gu,[e("h2",null,i(d.$t("index.why_choose")||"为什么选择 ShowDoc？"),1),e("p",null,i(d.$t("index.why_choose_desc")||"让API文档管理简单高效，团队协作如丝般顺滑"),1)]),e("div",yu,[e("div",wu,[e("div",bu,[s(z(Qa))]),e("h3",null,i(d.$t("index.section_title2")||"API文档"),1),e("p",null,i(d.$t("index.api_card_desc")||"简单快速编写美观的API文档"),1)]),e("div",$u,[e("div",ku,[s(z(Za))]),e("h3",null,i(d.$t("index.section_title3")||"数据字典"),1),e("p",null,i(d.$t("index.data_dict_desc")||"清晰展示数据库结构"),1)]),e("div",Cu,[e("div",xu,[s(z(eo))]),e("h3",null,i(d.$t("index.section_title4")||"说明文档"),1),e("p",null,i(d.$t("index.manual_desc")||"工具说明书和技术规范文档"),1)]),e("div",Iu,[e("div",Su,[s(z(Dt))]),e("h3",null,i(d.$t("index.section_title5")||"团队协作"),1),e("p",null,i(d.$t("index.team_card_desc")||"权限管理机制，团队协同编写文档"),1)]),e("div",Tu,[e("div",Mu,[s(z(to))]),e("h3",null,i(d.$t("index.auto_doc_title")||"文档自动化"),1),e("p",null,i(d.$t("index.auto_card_desc")||"代码注释自动生成文档"),1)]),e("div",Lu,[e("div",Vu,[s(z(ao))]),e("h3",null,i(d.$t("index.section_title6")||"免费开源"),1),e("p",null,i(d.$t("index.open_source_desc")||"可私有部署，数据自主可控"),1)])])]),e("section",zu,[e("div",Uu,[e("div",Pu,[e("h2",null,i(d.$t("index.api_doc_title")||"强大的API文档管理"),1),e("p",Au,i(d.$t("index.api_doc_subtitle")||"APP、web前端与服务器常用API交互，方便快速编写美观的API文档"),1),e("ul",Du,[e("li",null,i(d.$t("index.api_feature_1")||"支持HTTP方法标识（GET/POST/PUT/DELETE）"),1),e("li",null,i(d.$t("index.api_feature_2")||"代码示例一键复制"),1),e("li",null,i(d.$t("index.api_feature_3")||"参数表格清晰展示"),1),e("li",null,i(d.$t("index.api_feature_4")||"支持Markdown格式化"),1)])]),e("div",Ou,[s(Di)])]),e("div",Nu,[e("div",Fu,[s(Tr)]),e("div",qu,[e("h2",null,i(d.$t("index.data_dict_title")||"清晰展示数据库结构"),1),e("p",Ru,i(d.$t("index.data_dict_detail_desc")||"好的数据字典可以方便描述数据库结构，用ShowDoc编辑出美观的数据字典"),1),e("ul",Hu,[e("li",null,i(d.$t("index.data_feature_1")||"表结构可视化展示"),1),e("li",null,i(d.$t("index.data_feature_2")||"字段类型和说明清晰"),1),e("li",null,i(d.$t("index.data_feature_3")||"支持多数据库格式"),1),e("li",null,i(d.$t("index.data_feature_4")||"一键导出共享"),1)])])]),e("div",Eu,[e("div",ju,[e("h2",null,i(d.$t("index.team_collab_title")||"高效的团队协作"),1),e("p",Bu,i(d.$t("index.team_collab_subtitle")||"团队权限管理机制让团队良好协同编写文档"),1),e("ul",Gu,[e("li",null,i(d.$t("index.team_feature_1")||"多种权限级别控制"),1),e("li",null,i(d.$t("index.team_feature_2")||"变更历史追溯"),1),e("li",null,i(d.$t("index.team_feature_3")||"评论反馈机制"),1)])]),e("div",Ku,[s(Sc)])]),e("div",Wu,[e("div",Ju,[s(md)]),e("div",Yu,[e("h2",null,i(d.$t("index.auto_gen_title")||"多种方式自动生成文档"),1),e("p",Xu,i(d.$t("index.auto_gen_subtitle")||"支持从代码注释、Swagger、Postman等多种方式自动生成API文档"),1),e("ul",Qu,[e("li",null,i(d.$t("index.auto_gen_feature_1")||"代码注释自动生成"),1),e("li",null,i(d.$t("index.auto_gen_feature_2")||"Swagger/OpenAPI导入"),1),e("li",null,i(d.$t("index.auto_gen_feature_3")||"Postman一键导入"),1),e("li",null,i(d.$t("index.auto_gen_feature_4")||"Markdown压缩包导入"),1)])])]),e("div",Zu,[e("div",em,[e("h2",null,i(d.$t("index.runapi_title")||"搭配RunAPI，提升接口开发效率"),1),e("p",tm,i(d.$t("index.runapi_subtitle")||"ShowDoc与RunAPI完美集成，接口调试与文档编写无缝衔接，让API开发更高效"),1),e("ul",am,[e("li",null,i(d.$t("index.runapi_feature_1")||"实时同步接口信息到文档"),1),e("li",null,i(d.$t("index.runapi_feature_2")||"在RunAPI调试，自动生成文档"),1),e("li",null,i(d.$t("index.runapi_feature_3")||"Mock服务与文档联动"),1),e("li",null,i(d.$t("index.runapi_feature_4")||"前后端协作更顺畅"),1)])]),e("div",om,[s(au)])])]),e("section",sm,[e("div",lm,[e("h2",null,[O(i(d.$t("index.over_prefix")||"超过")+" ",1),p[1]||(p[1]=e("span",{class:"stat-highlight"},[e("span",{class:"num-digit"},"100000+")],-1)),O(" "+i(d.$t("index.trust_desc")||"互联网团队正在使用 ShowDoc"),1)]),e("p",nm,i(d.$t("index.company_list")||"包括且不仅以下公司团队："),1),p[2]||(p[2]=Ee('<div class="company-logos" data-v-7376b30d><img src="'+bs+'" alt="腾讯" data-v-7376b30d><img src="'+$s+'" alt="华为" data-v-7376b30d><img src="'+ks+'" alt="百度" data-v-7376b30d><img src="'+Cs+'" alt="京东" data-v-7376b30d><img src="'+xs+'" alt="字节跳动" data-v-7376b30d><img src="'+Is+'" alt="顺丰" data-v-7376b30d></div>',1)),s(h,{to:"/user/register",class:"btn btn-primary btn-large"},{default:u(()=>[O(i(d.$t("index.try_now")||"立即体验"),1)]),_:1})])]),e("section",im,[e("h2",null,i(d.$t("index.comparison_title")||"告别传统方式，拥抱现代化文档管理"),1),e("div",rm,[e("div",cm,[e("h3",null,i(d.$t("index.traditional_doc")||"传统文档管理方式"),1),e("ul",null,[e("li",null,i(d.$t("index.comparison_1_no")||"通过IM或邮件沟通，信息零散，沟通成本高"),1),e("li",null,i(d.$t("index.comparison_2_no")||"Word等离线文档，更新后需重新发送，无法实时同步"),1),e("li",null,i(d.$t("index.comparison_3_no")||"文件多次修改后版本混乱，难以找到最新版"),1),e("li",null,i(d.$t("index.comparison_4_no")||"无法搜索历史文档，查找信息困难"),1),e("li",null,i(d.$t("index.comparison_5_no")||"多人文档协作时容易冲突，权限管理弱"),1)])]),e("div",dm,[p[3]||(p[3]=e("h3",null,"ShowDoc",-1)),e("ul",null,[e("li",null,i(d.$t("index.comparison_1_yes")||"集中管理API文档，信息一目了然"),1),e("li",null,i(d.$t("index.comparison_2_yes")||"在线实时更新，团队成员随时访问最新内容"),1),e("li",null,i(d.$t("index.comparison_3_yes")||"自动保存历史版本，可随时追溯和回滚"),1),e("li",null,i(d.$t("index.comparison_4_yes")||"强大的全文搜索，快速找到所需内容"),1),e("li",null,i(d.$t("index.comparison_5_yes")||"多人协作无缝衔接，精细权限控制"),1)])])]),e("div",um,[e("div",mm,[p[4]||(p[4]=e("div",{class:"stat-value"},"70%",-1)),e("div",_m,i(d.$t("index.comparison_communication_save")||"沟通时间节省"),1)]),e("div",pm,[p[5]||(p[5]=e("div",{class:"stat-value"},"5倍",-1)),e("div",fm,i(d.$t("index.comparison_search_speed")||"文档查找速度提升"),1)]),e("div",vm,[p[6]||(p[6]=e("div",{class:"stat-value"},"90%",-1)),e("div",hm,i(d.$t("index.comparison_update_efficiency")||"文档更新效率提升"),1)]),e("div",gm,[p[7]||(p[7]=e("div",{class:"stat-value"},"100%",-1)),e("div",ym,i(d.$t("index.comparison_version_conflict")||"版本冲突减少"),1)])])]),e("section",wm,[e("h2",null,i(d.$t("index.start_now_title")||"立即开始使用 ShowDoc"),1),e("p",null,[O(i(d.$t("index.join_teams")||"加入")+" ",1),p[8]||(p[8]=e("span",{class:"stat-highlight"},[e("span",{class:"num-digit"},"100000+")],-1)),O(" "+i(d.$t("index.join_teams_suffix")||"团队，让文档协作更高效"),1)]),e("div",bm,[e("a",{href:l.value,target:"_blank",class:"btn btn-landing-white"},i(d.$t("index.view_example")||"查看示例"),9,$m),e("a",{href:m.value,target:"_blank",class:"btn btn-landing-transparent"},i(d.$t("index.learn_more")||"了解更多"),9,km)]),e("div",Cm,[e("span",xm,[s(z(ca)),O(" "+i(d.$t("index.quick_start")||"5分钟上手"),1)]),e("span",Im,[s(z(Dt)),O(" "+i(d.$t("index.team_collab")||"团队协作"),1)])])]),s(Hs),s(ta,{visibilityHeight:400})])}}});const Tm=Y(Sm,[["__scopeId","data-v-7376b30d"]]),hS=Object.freeze(Object.defineProperty({__proto__:null,default:Tm},Symbol.toStringTag,{value:"Module"})),Mm={class:"login-page"},Lm={class:"toggle-wrapper"},Vm={class:"toggle-group"},zm={class:"login-card"},Um={class:"card-header"},Pm={class:"title"},Am={class:"form-inputs"},Dm={class:"captcha-input"},Om=["src"],Nm={class:"footer-links"},Fm=J({__name:"Login",setup(c){const{t}=te(),a=Ge(),o=xe(),l=Qe(),m=b({username:"",password:"",captcha:""}),f=b(!1),d=b(0),p=b(""),h=b(!1),$=b({enabled:!1,entrance_tips:""}),g=b(!0),n=async()=>{try{const x=await X("/api/common/createCaptcha",{},"post",!1);if(x.error_code===0){d.value=x.data.captcha_id;let T=`${ot()}/api/common/showCaptcha`;T=dt(T,{captcha_id:d.value,t:Date.now()}),p.value=T}}catch(x){console.error("获取验证码失败:",x)}},w=async()=>{try{const x=await X("/api/user/oauthInfo",{},"get",!1);x.error_code===0&&x.data&&($.value.enabled=x.data.oauth2_open>0||x.data.oauth2_open===!0,$.value.entrance_tips=x.data.oauth2_entrance_tips||"")}catch(x){console.error("获取OAuth2配置失败:",x)}},k=async()=>{try{const x=await X("/api/common/homePageSetting",{},"post",!1);x.error_code===0&&x.data&&(g.value=x.data.register_open>0||x.data.register_open===!0)}catch(x){console.error("获取注册配置失败:",x)}},r=async()=>{try{await X("/api/ScriptCron/run",{},"get",!1)}catch(x){console.error("脚本定时任务失败:",x)}},_=x=>{try{const I=decodeURIComponent(x);return!(I.search(/[^A-Za-z0-9/:\?\._\*\+\-]+.*/i)>-1||I.indexOf(".")>-1||I.indexOf("//")>-1)}catch{return!1}},v=async()=>{if(!h.value){if(a.query.redirect&&!_(a.query.redirect)){G(t("user.illegal_redirect"));return}f.value=!0;try{const x=await X("/api/user/loginByVerify",{username:m.value.username,password:m.value.password,captcha:m.value.captcha,captcha_id:d.value,redirect_login:!1},"post",!1);x.error_code===0?await y(x.data):(n(),h.value=!0,G(x.error_message||t("common.error"),{callback:()=>{setTimeout(()=>{h.value=!1},500)}}))}catch(x){n(),console.error("登录失败:",x)}finally{f.value=!1}}},y=async x=>{if(x.same_email_accounts&&x.same_email_accounts.length>0){const M=x.same_email_accounts.join("、");if(await Se(t("user.multi_account_binding_tip",{email:x.email,accounts:M,username:x.username}),t("user.multi_account_binding_title"),{confirmText:t("user.continue_login"),cancelText:t("user.switch_account")})){localStorage.setItem("userinfo",JSON.stringify(x)),l.setUserInfo(x);const P=a.query.redirect?String(a.query.redirect):"/item/index";o.replace({path:P})}else{var I=document.cookie.match(/[^ =;]+(?=\=)/g);if(I)for(var T=I.length;T--;)document.cookie=I[T]+"=0;expires="+new Date(0).toUTCString()+";path=/";localStorage.clear(),x.same_email_accounts.length>0&&(m.value.username=x.same_email_accounts[0],m.value.password="",m.value.captcha="",n())}}else{localStorage.setItem("userinfo",JSON.stringify(x)),l.setUserInfo(x);let M=decodeURIComponent(a.query.redirect||"/item/index");o.replace({path:M})}},S=()=>{const x=ot();window.location.href=`${x}/api/ExtLogin/oauth2`};return ae(async()=>{if(a.query.redirect&&!_(a.query.redirect)){G(t("user.illegal_redirect"));return}try{const I=await X("/api/user/info",{redirect_login:!1},"post",!1),T=await X("/api/user/info",{redirect_login:!1},"post",!1);if(I.error_code===0&&T.error_code===0){let M=decodeURIComponent(a.query.redirect||"/item/index");o.replace({path:M})}}catch{}const x=document.getElementsByClassName("v-modal-leave");for(let I=0;I<x.length;I++)x[I].remove();await n(),await w(),await k(),await r()}),(x,I)=>{const T=H("router-link");return C(),V("div",Mm,[e("div",Lm,[e("div",Vm,[s(ea),s(ht)])]),e("div",zm,[e("div",Um,[e("h2",Pm,i(x.$t("user.login")),1)]),e("div",Am,[s(ne,{modelValue:m.value.username,"onUpdate:modelValue":I[0]||(I[0]=M=>m.value.username=M),placeholder:x.$t("user.username_description"),onKeyup:Fe(v,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:m.value.password,"onUpdate:modelValue":I[1]||(I[1]=M=>m.value.password=M),type:"password",placeholder:x.$t("user.password"),onKeyup:Fe(v,["enter"])},null,8,["modelValue","placeholder"]),e("div",Dm,[s(ne,{modelValue:m.value.captcha,"onUpdate:modelValue":I[2]||(I[2]=M=>m.value.captcha=M),placeholder:x.$t("user.verification_code"),onKeyup:Fe(v,["enter"])},null,8,["modelValue","placeholder"]),p.value?(C(),V("img",{key:0,src:p.value,alt:"验证码",class:"captcha-img",onClick:n},null,8,Om)):F("",!0)])]),s(K,{text:x.$t("user.login"),theme:"dark",loading:f.value,"full-width":!0,onClick:v},null,8,["text","loading"]),e("div",Nm,[g.value?(C(),B(T,{key:0,to:"/user/register"},{default:u(()=>[O(i(x.$t("user.register_new_account")),1)]),_:1})):F("",!0),$.value.enabled?(C(),V("a",{key:1,class:"oauth2-link",onClick:S},i($.value.entrance_tips||x.$t("user.oauth2_login")),1)):F("",!0)])])])}}});const qm=Y(Fm,[["__scopeId","data-v-9459121e"]]),gS=Object.freeze(Object.defineProperty({__proto__:null,default:qm},Symbol.toStringTag,{value:"Module"})),Rm={class:"register-page"},Hm={class:"toggle-wrapper"},Em={class:"toggle-group"},jm={class:"register-card"},Bm={class:"card-header"},Gm={class:"title"},Km={class:"form-inputs"},Wm={class:"captcha-input"},Jm=["src"],Ym={class:"footer-links"},Xm=J({__name:"Register",setup(c){const{t}=te();Ge();const a=xe(),o=Qe(),l=b({username:"",password:"",confirmPassword:"",captcha:""}),m=b(!1),f=b(0),d=b(""),p=async()=>{try{const $=await X("/api/common/createCaptcha",{},"post",!1);if($.error_code===0){f.value=$.data.captcha_id;let n=`${ot()}/api/common/showCaptcha`;n=dt(n,{captcha_id:f.value,t:Date.now()}),d.value=n}}catch($){console.error("获取验证码失败:",$)}},h=async()=>{m.value=!0;const $=setTimeout(()=>{m.value=!1},3e3);try{const g=await X("/api/user/registerByVerify",{username:l.value.username,password:l.value.password,confirm_password:l.value.confirmPassword,captcha:l.value.captcha,captcha_id:f.value},"post",!1);clearTimeout($),g.error_code===0?(localStorage.setItem("userinfo",JSON.stringify(g.data)),o.setUserInfo(g.data),ie.success(t("user.register_success")),a.push({path:"/item/index"})):(p(),G(g.error_message||t("common.error")))}catch(g){clearTimeout($),p(),console.error("注册失败:",g)}finally{m.value=!1}};return ae(async()=>{await p();try{(await X("/api/user/info",{redirect_login:!1},"post",!1)).error_code===0&&a.push({path:"/item/index"})}catch{}const $=document.getElementsByClassName("v-modal-leave");for(let g=0;g<$.length;g++)$[g].remove()}),($,g)=>{const n=H("router-link");return C(),V("div",Rm,[e("div",Hm,[e("div",Em,[s(ea),s(ht)])]),e("div",jm,[e("div",Bm,[e("h2",Gm,i($.$t("user.register")),1)]),e("div",Km,[s(ne,{modelValue:l.value.username,"onUpdate:modelValue":g[0]||(g[0]=w=>l.value.username=w),placeholder:$.$t("user.username_description"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:l.value.password,"onUpdate:modelValue":g[1]||(g[1]=w=>l.value.password=w),type:"password",placeholder:$.$t("user.password"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":g[2]||(g[2]=w=>l.value.confirmPassword=w),type:"password",placeholder:$.$t("user.password_again"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),e("div",Wm,[s(ne,{modelValue:l.value.captcha,"onUpdate:modelValue":g[3]||(g[3]=w=>l.value.captcha=w),placeholder:$.$t("user.verification_code"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),d.value?(C(),V("img",{key:0,src:d.value,alt:"验证码",class:"captcha-img",onClick:p},null,8,Jm)):F("",!0)])]),s(K,{text:m.value?$.$t("user.register_loading"):$.$t("user.register"),theme:"dark",loading:m.value,"full-width":!0,onClick:h},null,8,["text","loading"]),e("div",Ym,[s(n,{to:"/user/login"},{default:u(()=>[O(i($.$t("user.login")),1)]),_:1})])])])}}});const Qm=Y(Xm,[["__scopeId","data-v-453f3347"]]),yS=Object.freeze(Object.defineProperty({__proto__:null,default:Qm},Symbol.toStringTag,{value:"Module"})),Zm={class:"reset-password-page"},e_={class:"reset-password-card"},t_={class:"card-header"},a_={class:"title"},o_={class:"form-inputs"},s_={class:"captcha-input"},l_=["src"],n_={class:"footer-links"},i_=J({__name:"ResetPassword",setup(c){const{t}=te(),a=b({email:"",captcha:""}),o=b(!1),l=b(0),m=b(""),f=async()=>{try{const p=await X("/api/common/createCaptcha",{},"post",!1);if(p.error_code===0){l.value=p.data.captcha_id;let $=`${ot()}/api/common/showCaptcha`;$=dt($,{captcha_id:l.value,t:Date.now()}),m.value=$}}catch(p){console.error("获取验证码失败:",p)}},d=async()=>{if(!a.value.email){G(t("user.email_required"));return}if(!a.value.captcha){G(t("user.captcha_required"));return}o.value=!0;try{const p=await X("/api/user/resetPasswordEmail",{email:a.value.email,captcha:a.value.captcha,captcha_id:l.value},"post",!1);p.error_code===0?(G(t("user.reset_password_email_sent")),f()):(f(),G(p.error_message||t("common.error")))}catch(p){f(),console.error("重置密码失败:",p)}finally{o.value=!1}};return ae(()=>{f();const p=document.getElementsByClassName("v-modal-leave");for(let h=0;h<p.length;h++)p[h].remove()}),(p,h)=>{const $=H("router-link");return C(),V("div",Zm,[e("div",e_,[e("div",t_,[e("h2",a_,i(p.$t("user.reset_password")),1)]),e("div",o_,[s(ne,{modelValue:a.value.email,"onUpdate:modelValue":h[0]||(h[0]=g=>a.value.email=g),type:"email",placeholder:p.$t("user.email"),onKeyup:Fe(d,["enter"])},null,8,["modelValue","placeholder"]),e("div",s_,[s(ne,{modelValue:a.value.captcha,"onUpdate:modelValue":h[1]||(h[1]=g=>a.value.captcha=g),placeholder:p.$t("user.verification_code"),onKeyup:Fe(d,["enter"])},null,8,["modelValue","placeholder"]),m.value?(C(),V("img",{key:0,src:m.value,alt:"验证码",class:"captcha-img",onClick:f},null,8,l_)):F("",!0)])]),s(K,{text:o.value?p.$t("common.submitting"):p.$t("common.submit"),theme:"dark",loading:o.value,"full-width":!0,onClick:d},null,8,["text","loading"]),e("div",n_,[s($,{to:"/user/login"},{default:u(()=>[O(i(p.$t("user.remember_password_login")),1)]),_:1})])])])}}});const r_=Y(i_,[["__scopeId","data-v-40ae47c4"]]),wS=Object.freeze(Object.defineProperty({__proto__:null,default:r_},Symbol.toStringTag,{value:"Module"})),c_={class:"reset-password-by-url-page"},d_={class:"reset-password-card"},u_={class:"card-header"},m_={class:"title"},__={class:"form-inputs"},p_={class:"footer-links"},f_=J({__name:"ResetPasswordByUrl",setup(c){const{t}=te(),a=Ge(),o=xe(),l=b({password:""}),m=b(!1),f=async()=>{if(!l.value.password){G(t("user.password_required"));return}m.value=!0;try{const d=await X("/api/user/resetPasswordByUrlToken",{new_password:l.value.password,token:a.params.token},"post",!1);d.error_code===0?G(t("user.reset_password_success"),{callback:()=>{o.replace({path:"/user/login"})}}):G(d.error_message||t("common.error"))}catch(d){console.error("重置密码失败:",d)}finally{m.value=!1}};return ae(()=>{const d=document.getElementsByClassName("v-modal-leave");for(let p=0;p<d.length;p++)d[p].remove()}),(d,p)=>{const h=H("router-link");return C(),V("div",c_,[e("div",d_,[e("div",u_,[e("h2",m_,i(d.$t("user.reset_password")),1)]),e("div",__,[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=$=>l.value.password=$),type:"password",placeholder:d.$t("user.new_password"),onKeyup:Fe(f,["enter"])},null,8,["modelValue","placeholder"])]),s(K,{text:m.value?d.$t("common.submitting"):d.$t("common.submit"),theme:"dark",loading:m.value,"full-width":!0,onClick:f},null,8,["text","loading"]),e("div",p_,[s(h,{to:"/user/login"},{default:u(()=>[O(i(d.$t("user.remember_password_login")),1)]),_:1})])])])}}});const v_=Y(f_,[["__scopeId","data-v-5fc93290"]]),bS=Object.freeze(Object.defineProperty({__proto__:null,default:v_},Symbol.toStringTag,{value:"Module"})),h_={class:"verify-email-by-url-page"},g_=J({__name:"VerifyEmailByUrl",setup(c){const t=xe(),a=Ge(),{t:o}=te();return ae(async()=>{const l=a.params.token;if(!l){await G(o("user.invalid_token")),t.replace("/user/login");return}try{await X("/api/user/verifyEmailByUrlToken",{token:l}),await Se({msg:o("user.verify_email_success"),confirmText:o("common.confirm")}),t.replace("/user/login")}catch(m){console.error("验证邮箱失败:",m),await G(o("common.error")),t.replace("/user/login")}}),(l,m)=>(C(),V("div",h_))}});const y_=Y(g_,[["__scopeId","data-v-e32ac40e"]]),$S=Object.freeze(Object.defineProperty({__proto__:null,default:y_},Symbol.toStringTag,{value:"Module"})),w_={class:"password-modal"},b_={class:"modal-content"},$_={class:"form-item"},k_={class:"form-label"},C_={class:"form-item"},x_={class:"form-label"},I_={class:"form-item"},S_={class:"form-label"},T_={class:"modal-footer"},M_=J({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(0),m=b(!1),f=b({password:"",new_password:"",confirm_password:""}),d=async()=>{if(!f.value.password){await G(t("user.old_password_required"));return}if(!f.value.new_password){await G(t("user.new_password_required"));return}if(f.value.new_password!==f.value.confirm_password){await G(t("user.password_mismatch"));return}m.value=!0;try{await X("/api/user/resetPassword",{new_password:f.value.new_password,password:f.value.password}),G(t("user.modify_success"),{callback:()=>{a.onClose(!0)}})}catch(h){console.error("修改密码失败:",h)}finally{m.value=!1}},p=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{l.value++,setTimeout(()=>{o.value=!0})}),(h,$)=>(C(),V("div",w_,[s(de,{class:re({show:o.value}),title:h.$t("user.modify_password"),onClose:p},{default:u(()=>[e("div",b_,[e("div",$_,[e("label",k_,i(h.$t("user.old_password")),1),s(ne,{modelValue:f.value.password,"onUpdate:modelValue":$[0]||($[0]=g=>f.value.password=g),type:"password",placeholder:h.$t("user.old_password")},null,8,["modelValue","placeholder"])]),e("div",C_,[e("label",x_,i(h.$t("user.new_password")),1),s(ne,{modelValue:f.value.new_password,"onUpdate:modelValue":$[1]||($[1]=g=>f.value.new_password=g),type:"password",placeholder:h.$t("user.new_password")},null,8,["modelValue","placeholder"])]),e("div",I_,[e("label",S_,i(h.$t("user.confirm_password")),1),s(ne,{modelValue:f.value.confirm_password,"onUpdate:modelValue":$[2]||($[2]=g=>f.value.confirm_password=g),type:"password",placeholder:h.$t("user.confirm_password")},null,8,["modelValue","placeholder"])])]),e("div",T_,[s(K,{onClick:p},{default:u(()=>[O(i(h.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:d,loading:m.value},{default:u(()=>[O(i(h.$t("common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["class","title"])]))}});const L_=Y(M_,[["__scopeId","data-v-fb58e031"]]);function V_(){return new Promise(c=>{const{app:t,mountNode:a}=ve(L_,{onClose:()=>{c(),me(t,a)}});t.mount(a)})}const z_={class:"push-url-modal"},U_={class:"modal-content"},P_={class:"description"},A_={class:"steps"},D_={class:"form-item"},O_={class:"form-label"},N_={class:"modal-footer"},F_=J({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(0),m=b(!1),f=b({push_url:""}),d=async()=>{try{const $=await X("/api/user/getPushUrl",{});$&&$.data&&(f.value.push_url=$.data.push_url||$.data)}catch($){console.error("获取推送地址失败:",$)}},p=async()=>{if(!f.value.push_url){ie.warning(t("user.push_url_required"));return}m.value=!0;try{await X("/api/user/savePushUrl",{push_url:f.value.push_url}),ie.success(t("user.save_success")),a.onClose(!0)}catch($){console.error("保存推送地址失败:",$)}finally{m.value=!1}},h=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{l.value++,setTimeout(()=>{o.value=!0,d()})}),($,g)=>(C(),V("div",z_,[s(de,{class:re({show:o.value}),title:$.$t("user.wechat_push_url"),onClose:h},{default:u(()=>[e("div",U_,[e("div",P_,[e("p",null,i($.$t("user.push_url_desc_title")),1),e("ol",A_,[e("li",null,i($.$t("user.push_url_step1")),1),e("li",null,i($.$t("user.push_url_step2")),1),e("li",null,i($.$t("user.push_url_step3")),1),e("li",null,i($.$t("user.push_url_step4")),1)]),e("p",null,i($.$t("user.push_url_desc_footer")),1)]),e("div",D_,[e("label",O_,i($.$t("user.wechat_push_url")),1),s(ne,{modelValue:f.value.push_url,"onUpdate:modelValue":g[0]||(g[0]=n=>f.value.push_url=n),placeholder:$.$t("user.push_url_placeholder")},null,8,["modelValue","placeholder"])])]),e("div",N_,[s(K,{onClick:h},{default:u(()=>[O(i($.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:p,loading:m.value},{default:u(()=>[O(i($.$t("common.save")),1)]),_:1},8,["loading"])])]),_:1},8,["class","title"])]))}});const q_=Y(F_,[["__scopeId","data-v-258f557b"]]);let Nt=!1;function R_(){return new Promise(c=>{if(Nt){console.warn("[PushUrlModal] 已经有弹窗在显示，忽略新的调用"),c(!1);return}Nt=!0;const{app:t,mountNode:a}=ve(q_,{onClose:o=>{Nt=!1,c(o),me(t,a)}});t.mount(a)})}const H_={class:"user-center-modal"},E_={class:"modal-content"},j_={key:0,class:"user-info"},B_={class:"name"},G_={class:"username"},K_={class:"menu-list"},W_={class:"menu-item-content"},J_={class:"menu-item-label"},Y_={class:"menu-item-content"},X_={class:"menu-item-label"},Q_={class:"bottom-actions"},Z_=J({__name:"index",props:{onClose:{type:Function}},setup(c){const{t,locale:a}=te(),o=xe(),l=Qe(),m=c,f=b(!1),d=b({username:"",name:""}),p=b({url:""}),h=q(()=>a.value.toLowerCase()==="zh-cn"),$=async()=>{try{const v=await X("/api/user/info",{});v&&v.data&&(d.value=v.data,w())}catch(v){console.error("获取用户信息失败:",v)}},g=async()=>{const v=await it(t("user.edit_name"),d.value.name,t("user.name_tips"));if(v&&v!==d.value.name)try{await X("/api/user/updateInfo",{name:v}),ie.success(t("user.modify_success")),$()}catch(y){console.error("修改姓名失败:",y)}},n=async()=>{await V_()},w=async()=>{try{const v=await X("/api/user/getPushUrl",{});v&&v.data&&(p.value.url=v.data)}catch(v){console.error("获取推送地址失败:",v)}},k=async()=>{await R_()&&await w()},r=async()=>{if(await Se({title:t("common.confirm"),msg:t("user.confirm_logout"),confirmText:t("common.confirm"),cancelText:t("common.cancel")})){await X("/api/user/logout",{confirm:"1"});const y=document.cookie.match(/[^ =;]+(?==)/g);y&&y.forEach(S=>{document.cookie=`${S}=0;expires=${new Date(0).toUTCString()}`}),localStorage.clear(),l.logout(),o.push({path:"/"}),_()}},_=()=>{f.value=!1,setTimeout(()=>{m.onClose(!0)},300)};return ae(()=>{$(),setTimeout(()=>{f.value=!0})}),(v,y)=>(C(),V("div",H_,[s(de,{class:re({show:f.value}),title:v.$t("user.user_center"),icon:["fas","user"],width:"600px",onClose:_},{default:u(()=>[e("div",E_,[d.value.username?(C(),V("div",j_,[e("div",{onClick:g,class:"user-name"},[e("span",B_,i(d.value.name||v.$t("user.unnamed_user")),1),y[0]||(y[0]=e("i",{class:"fas fa-pencil edit-icon"},null,-1))]),e("div",G_,i(d.value.username),1)])):F("",!0),e("div",K_,[h.value?(C(),V("div",{key:0,class:"menu-item",onClick:k},[e("div",W_,[y[1]||(y[1]=e("div",{class:"menu-item-icon push-icon"},[e("i",{class:"fas fa-bell"})],-1)),e("span",J_,i(v.$t("user.wechat_push_url")),1)]),y[2]||(y[2]=e("i",{class:"fas fa-chevron-right arrow-icon"},null,-1))])):F("",!0),e("div",{class:"menu-item",onClick:n},[e("div",Y_,[y[3]||(y[3]=e("div",{class:"menu-item-icon password-icon"},[e("i",{class:"fas fa-key"})],-1)),e("span",X_,i(v.$t("user.modify_password")),1)]),y[4]||(y[4]=e("i",{class:"fas fa-chevron-right arrow-icon"},null,-1))])]),e("div",Q_,[e("div",{class:"action-btn logout-btn",onClick:r},i(v.$t("user.logout")),1)])])]),_:1},8,["class","title"])]))}});const ep=Y(Z_,[["__scopeId","data-v-d94d25b0"]]);function oa(){return new Promise(c=>{const{app:t,mountNode:a}=ve(ep,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const tp={class:"user-setting-page"},ap=J({__name:"Setting",setup(c){const t=xe(),a=()=>{t.push("/item/index")};return ae(async()=>{await oa(),a()}),(o,l)=>(C(),V("div",tp))}});const op=Y(ap,[["__scopeId","data-v-5993ba92"]]),kS=Object.freeze(Object.defineProperty({__proto__:null,default:op},Symbol.toStringTag,{value:"Module"})),sp={class:"login-by-token-page"},lp={class:"loading-container"},np={class:"loading-text"},ip=J({__name:"LoginByUserToken",setup(c){const t=xe(),a=Ge(),{t:o}=te(),l=He(),m=b(o("user.token_login_loading"));return ae(async()=>{try{const f=a.query.user_token;if(!f){m.value=o("user.token_login_parameter_error"),setTimeout(()=>{t.replace("/user/login")},2e3);return}const d=await X("/api/user/info",{user_token:f,redirect_login:!1},"post",!1);if(d.error_code===0&&d.data){const p=d.data;p.user_token=f,ro(p);const h=new Date;h.setTime(h.getTime()+180*24*60*60*1e3);const $=`expires=${h.toGMTString()}`;document.cookie=`cookie_token=${f}; samesite=strict; path=/; ${$}`,l.setNewMsg(d.data.new_msg||0),m.value=o("user.token_login_success")}else m.value=o("user.token_login_failed")}catch(f){console.error("Token 登录失败:",f),m.value=o("user.token_login_failed")}setTimeout(()=>{const f=decodeURIComponent(a.query.redirect_uri||"/item/index");t.replace({path:f})},1e3)}),(f,d)=>(C(),V("div",sp,[e("div",lp,[d[0]||(d[0]=e("div",{class:"loading-spinner"},null,-1)),e("p",np,i(m.value),1)])]))}});const rp=Y(ip,[["__scopeId","data-v-fe023571"]]),CS=Object.freeze(Object.defineProperty({__proto__:null,default:rp},Symbol.toStringTag,{value:"Module"})),cp={class:"feedback-modal"},dp={class:"modal-content"},up={class:"feedback-info"},mp={class:"info-text"},_p={class:"link-box"},pp={class:"link-text"},fp={class:"star-tip"},vp={class:"modal-footer"},hp="https://github.com/star7th/showdoc/issues",gp=J({__name:"index",props:{onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=()=>{window.open(hp,"_blank")},l=()=>{a.value=!1,setTimeout(()=>{t.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{a.value=!0})}),(m,f)=>(C(),V("div",cp,[a.value?(C(),B(de,{key:0,class:re({show:a.value}),title:m.$t("feedback.feedback"),icon:["fas","circle-info"],maxWidth:"500px",onClose:l},{default:u(()=>[e("div",dp,[e("div",up,[e("div",mp,[e("span",null,i(m.$t("feedback.feedbackDescription")),1)]),e("div",_p,[e("div",{class:"github-link",onClick:o},[e("span",pp,i(m.$t("feedback.githubLinkText")),1)]),e("div",fp,[f[0]||(f[0]=e("i",{class:"fas fa-star"},null,-1)),e("span",null,i(m.$t("feedback.starTip")),1)])])])]),e("div",vp,[e("div",{class:"secondary-button",onClick:l},i(m.$t("common.cancel")),1),e("div",{class:"primary-button",onClick:o},i(m.$t("feedback.goToGithub")),1)])]),_:1},8,["class","title"])):F("",!0)]))}});const yp=Y(gp,[["__scopeId","data-v-a3a5d7b9"]]);function Ra(){return new Promise(c=>{const{app:t,mountNode:a}=ve(yp,{onClose:(o=!1)=>{c(o),me(t,a)}});t.mount(a)})}const wp={class:"message-modal"},bp={class:"modal-content"},$p={class:"message-content"},kp={key:0},Cp={class:"message-line"},xp={key:0,class:"message-remark"},Ip={key:1},Sp={class:"message-line"},Tp={key:2},Mp=["innerHTML"],Lp=["innerHTML"],Vp={class:"modal-footer"},zp={class:"center-button"},Up=J({__name:"index",props:{onClose:{type:Function},initialTab:{}},setup(c){const{t,locale:a}=te(),o=xe(),l=c,m=b(!1),f=b(l.initialTab||"remindList"),d=b([]),p=b([]),h=b(!1),$=b(!1),g=q(()=>[{text:t("feedback.feedback"),icon:["fas","headphones"],onClick:()=>{Ra()}}]),n=q(()=>[{title:"",key:"status",width:70},{title:t("message.send_time"),key:"addtime",width:180},{title:t("message.content"),key:"message_content"}]),w=q(()=>[{title:"",key:"status",width:70},{title:t("message.send_time"),key:"addtime",width:180},{title:t("message.content"),key:"message_content"}]),k=b({current:1,pageSize:6,total:0}),r=q(()=>a.value==="zh-CN"?'你在showdoc购买的付费版资格很快过期了，你可以<a href="/user/setting" target="_blank">点此进入用户中心</a>进行续费 (如已续费请忽略该通知)':'Your paid ShowDoc subscription will expire soon. <a href="/user/setting" target="_blank">Click here to go to User Center</a> to renew (ignore if already renewed)'),_=async()=>{$.value=!0;try{const P=(await co()).data||[];p.value=P.filter(N=>{const U=N.message_type||"announce";return U==="announce"||U==="announce_web"||U==="announce_all"});for(const N of p.value)y(N.from_uid,N.message_content_id)}catch(L){console.error("获取公告列表失败:",L)}finally{$.value=!1}},v=async()=>{h.value=!0;try{const L=await uo({page:k.value.current,count:k.value.pageSize});d.value=L.data.list||[],k.value.total=L.data.total||0;for(const P of d.value)y(P.from_uid,P.message_content_id)}catch(L){console.error("获取提醒列表失败:",L)}finally{h.value=!1}},y=async(L,P)=>{if(P)try{await mo({from_uid:L,message_content_id:P})}catch(N){console.error("设置已读失败:",N)}},S=(L,P)=>{const N=o.resolve({path:`/${L}/${P}`});window.open(N.href,"_blank")},x=(L,P)=>{const N=o.resolve({path:`/${L}/${P}`});window.open(N.href+"#comment-area","_blank")},I=L=>{k.value.current=L,v()},T=L=>{L==="remindList"?v():L==="announcementList"&&_()},M=()=>{m.value=!1,setTimeout(()=>{l.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{m.value=!0}),v(),_()}),(L,P)=>{const N=H("a-badge"),U=H("a-button"),A=H("a-tab-pane"),D=H("a-tabs");return C(),V("div",wp,[s(de,{class:re({show:m.value}),title:L.$t("message.my_notice"),icon:["fas","message"],headerButtons:g.value,width:"800px",onClose:M},{default:u(()=>[e("div",bp,[s(D,{activeKey:f.value,"onUpdate:activeKey":P[0]||(P[0]=E=>f.value=E),onChange:T},{default:u(()=>[s(A,{key:"remindList",tab:L.$t("message.system_reminder")},{default:u(()=>[s(Le,{tableHeader:n.value,tableData:d.value,pagination:k.value,loading:h.value,rowKey:E=>E.id,onPageChange:I},{"cell-status":u(({row:E})=>[E.status===0?(C(),B(N,{key:0,value:"new"})):F("",!0)]),"cell-message_content":u(({row:E})=>[e("div",$p,[(E.action_type==="create"||E.action_type==="update")&&E.object_type==="page"&&E.page_data?(C(),V("div",kp,[e("div",Cp,[O(i(E.from_name)+" "+i(L.$t("message.update_the_page"))+" ",1),s(U,{type:"link",onClick:oe=>S(E.page_data.item_id,E.page_data.page_id)},{default:u(()=>[O(i(E.page_data.page_title),1)]),_:2},1032,["onClick"])]),E.message_content?(C(),V("div",xp,i(L.$t("message.update_remark"))+": "+i(E.message_content),1)):F("",!0)])):F("",!0),(E.action_type==="comment"||E.action_type==="comment_reply")&&E.object_type==="page"&&E.page_data?(C(),V("div",Ip,[e("div",Sp,[O(i(E.message_content)+" ",1),s(U,{type:"link",onClick:oe=>x(E.page_data.item_id,E.page_data.page_id)},{default:u(()=>[O(i(E.page_data.page_title),1)]),_:2},1032,["onClick"])])])):F("",!0),E.object_type==="vip"?(C(),V("div",Tp,[e("span",{innerHTML:r.value},null,8,Mp)])):F("",!0)])]),_:1},8,["tableHeader","tableData","pagination","loading","rowKey"])]),_:1},8,["tab"]),s(A,{key:"announcementList",tab:L.$t("message.system_announcement")},{default:u(()=>[s(Le,{tableHeader:w.value,tableData:p.value,loading:$.value,rowKey:E=>E.id,"max-height":"500px"},{"cell-status":u(({row:E})=>[E.status===0?(C(),B(N,{key:0,value:"new"})):F("",!0)]),"cell-message_content":u(({row:E})=>[e("div",{class:"message-content",innerHTML:E.message_content},null,8,Lp)]),_:1},8,["tableHeader","tableData","loading","rowKey"])]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),e("div",Vp,[e("div",zp,[s(K,{onClick:M},{default:u(()=>[O(i(L.$t("common.close")),1)]),_:1})])])]),_:1},8,["class","title","headerButtons"])])}}});const Pp=Y(Up,[["__scopeId","data-v-d5889703"]]);function sa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Pp,{initialTab:c,onClose:(l=!1)=>{t(l),me(a,o)}});a.mount(o)})}const Ap={class:"upload-modal"},Dp={class:"upload-container"},Op=["innerHTML"],Np={class:"ant-upload-hint"},Fp={key:0,class:"upload-queue"},qp={class:"queue-title"},Rp={class:"queue-list"},Hp={class:"file-info"},Ep={class:"file-name"},jp={class:"file-size"},Bp={class:"status-info"},Gp={key:0,class:"status waiting"},Kp={key:1,class:"status uploading"},Wp={key:2,class:"status success"},Jp=["href"],Yp={key:1},Xp={key:3,class:"status error"},Qp={key:0,class:"upload-actions"},Zp={key:1,class:"upload-progress"},ef={class:"progress-text"},tf=J({__name:"index",props:{onClose:{type:Function},callback:{type:Function}},setup(c){const{t}=te(),a=Qe(),o=c,l=b(!1),m=b([]),f=b(!1),d=b(0),p=b(0),h=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=(y,S)=>(m.value.find(I=>I.file.name===y.name&&I.file.size===y.size)||(m.value.push({file:y,status:"waiting",error:""}),f.value||setTimeout(()=>{n()},100)),!1),n=async()=>{if(m.value.length!==0){if(f.value){p.value=m.value.filter(y=>y.status==="waiting"||y.status==="uploading"||y.status==="success").length;return}f.value=!0,d.value=0,p.value=m.value.filter(y=>y.status==="waiting").length,h.value=0,w()}},w=()=>{for(;h.value<m.value.length;){const x=m.value[h.value];if(x.status==="waiting"){x.status="uploading",k(x.file);return}h.value++}f.value=!1;const y=m.value.filter(x=>x.status==="success").length,S=m.value.filter(x=>x.status==="error").length;S===0?(j.success(t("attachment.batch_upload_complete_success",{count:y})),setTimeout(()=>{v(!0)},1500)):j.warning(t("attachment.batch_upload_complete_partial",{success:y,error:S}))},k=async y=>{const S=new FormData;S.append("file",y),S.append("user_token",a.userToken);try{const x=await X("/api/page/upload",S,"post",!1);r(x)}catch(x){console.error("上传文件失败:",x),uploadError(null,y)}},r=y=>{const S=m.value[h.value];S&&(y.success===1?(S.status="success",S.url=y.url):(S.status="error",S.error=y.error_message||t("attachment.upload_failed_error")),d.value++,w())},_=y=>{if(y===0)return"0 B";const S=1024,x=["B","KB","MB","GB"],I=Math.floor(Math.log(y)/Math.log(S));return parseFloat((y/Math.pow(S,I)).toFixed(2))+" "+x[I]},v=y=>{l.value=!1,setTimeout(()=>{o.onClose(y)},300)};return ae(()=>{setTimeout(()=>{l.value=!0})}),(y,S)=>{const x=H("a-upload-dragger"),I=H("a-progress");return C(),V("div",Ap,[s(de,{class:re({show:l.value}),title:y.$t("common.upload"),maxWidth:"700px",onClose:S[0]||(S[0]=T=>v(!1))},{default:u(()=>[e("div",Dp,[s(x,{name:"file",multiple:!0,"show-upload-list":!1,"before-upload":g,"custom-request":()=>{}},{default:u(()=>[S[1]||(S[1]=e("p",{class:"ant-upload-drag-icon"},[e("i",{class:"fas fa-cloud-upload-alt"})],-1)),e("p",{class:"ant-upload-text",innerHTML:y.$t("attachment.import_file_tips2")},null,8,Op),e("p",Np,i(y.$t("attachment.batch_upload_support")),1)]),_:1}),m.value.length>0?(C(),V("div",Fp,[e("div",qp,i(y.$t("attachment.upload_queue_files",{count:m.value.length}))+": ",1),e("div",Rp,[(C(!0),V(Ce,null,Pe(m.value,(T,M)=>(C(),V("div",{key:M,class:re(["queue-item",{uploading:T.status==="uploading",success:T.status==="success",error:T.status==="error"}])},[e("div",Hp,[S[2]||(S[2]=e("i",{class:"fas fa-file"},null,-1)),e("span",Ep,i(T.file.name),1),e("span",jp,"("+i(_(T.file.size))+")",1)]),e("div",Bp,[T.status==="waiting"?(C(),V("span",Gp,i(y.$t("attachment.file_waiting")),1)):T.status==="uploading"?(C(),V("span",Kp,[S[3]||(S[3]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(y.$t("attachment.file_uploading")),1)])):T.status==="success"?(C(),V("span",Wp,[S[4]||(S[4]=e("i",{class:"fas fa-check"},null,-1)),T.url?(C(),V("a",{key:0,href:T.url,target:"_blank",class:"success-link"},i(y.$t("attachment.file_upload_success")),9,Jp)):(C(),V("span",Yp,i(y.$t("attachment.file_upload_success")),1))])):T.status==="error"?(C(),V("span",Xp,[S[5]||(S[5]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(y.$t("attachment.file_upload_failed"))+": "+i(T.error),1)])):F("",!0)])],2))),128))]),m.value.length>0&&!f.value?(C(),V("div",Qp,[s(K,{onClick:y.clearQueue},{default:u(()=>[O(i(y.$t("attachment.clear_queue")),1)]),_:1},8,["onClick"])])):F("",!0),f.value?(C(),V("div",Zp,[e("div",ef,i(y.$t("attachment.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(I,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const af=Y(tf,[["__scopeId","data-v-fadd0a36"]]);function of(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(af,{...c,onClose:l=>{c!=null&&c.callback&&c.callback(),t(l),me(a,o)}});a.mount(o)})}const sf={class:"attachment-modal"},lf={class:"search-bar"},nf={class:"search-item"},rf={class:"search-item"},cf={class:"search-item"},df={class:"search-item"},uf={class:"info-bar"},mf={class:"tools"},_f=["onClick"],pf=["onClick"],ff=["onClick"],vf=J({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b(""),f=b("-1"),d=q(()=>[{label:t("attachment.all_attachment_type"),value:"-1"},{label:t("attachment.image"),value:"1"},{label:t("attachment.general_attachment"),value:"2"}]),p=b(0),h=b(0),$=b(!1),g=b([]),n=b({current:1,pageSize:10,total:0}),w=q(()=>[{title:t("attachment.file_id"),key:"file_id",width:60},{title:t("attachment.display_name"),key:"display_name",width:180},{title:t("attachment.file_type"),key:"file_type",width:80},{title:t("attachment.file_size_m"),key:"file_size_m",width:70},{title:t("attachment.visit_times"),key:"visit_times",width:70},{title:t("attachment.add_time"),key:"addtime",width:120},{title:t("common.operation"),key:"tools",width:180,tools:!0}]),k=async()=>{l.value=!0;try{const I=await _o({page:n.value.current,count:n.value.pageSize,attachment_type:f.value,display_name:m.value});I.data&&(g.value=I.data.list||[],n.value.total=I.data.total||0,p.value=I.data.used_m||0,h.value=I.data.used_flow_m||0)}catch(I){console.error("Failed to fetch attachment list:",I)}finally{l.value=!1}},r=()=>{n.value.current=1,k()},_=I=>{n.value.current=I,k()},v=I=>{I.url&&window.open(I.url,"_blank")},y=I=>{I.url&&navigator.clipboard.writeText(I.url).then(()=>{j.success(t("common.copy_success"))}).catch(()=>{j.error(t("common.copy_failed"))})},S=async I=>{try{await new Promise((T,M)=>{po(()=>import("./components-dd440e25.js").then(L=>L.t),["./components-dd440e25.js","./vendor-vue-f1f9849c.js","./vendor-8fa27e24.js","./vendor-49dc2278.css","./vendor-vue-e0182f4b.css","./core-a975e3c3.js","./components-c7cd670e.css"],import.meta.url).then(({default:L})=>{L({msg:t("attachment.confirm_delete"),title:t("common.tips")}).then(T).catch(M)})}),await fo({file_id:I.file_id}),j.success(t("common.op_success")),k()}catch{}},x=I=>{o.value=!1,setTimeout(()=>{a.onClose(I)},300)};return ae(()=>{setTimeout(()=>{o.value=!0}),k()}),(I,T)=>(C(),V("div",sf,[s(de,{class:re({show:o.value}),title:I.$t("attachment.my_attachment"),width:"1100px",onClose:T[3]||(T[3]=M=>x(!1))},{default:u(()=>[e("div",lf,[e("div",nf,[s(ne,{modelValue:m.value,"onUpdate:modelValue":T[0]||(T[0]=M=>m.value=M),placeholder:I.$t("attachment.display_name"),onKeyup:Fe(r,["enter"])},null,8,["modelValue","placeholder"])]),e("div",rf,[s(Re,{value:f.value,"onUpdate:value":T[1]||(T[1]=M=>f.value=M),options:d.value,style:{width:"150px"},onChange:r},null,8,["value","options"])]),e("div",cf,[s(K,{onClick:r},{default:u(()=>[O(i(I.$t("common.search")),1)]),_:1})]),e("div",df,[s(K,{type:"primary",onClick:T[2]||(T[2]=M=>$.value=!0)},{default:u(()=>[O(i(I.$t("common.upload")),1)]),_:1})])]),e("div",uf,[e("span",null,i(I.$t("attachment.accumulated_used_space"))+" "+i(p.value)+"M , "+i(I.$t("attachment.month_flow"))+" "+i(h.value)+"M ",1)]),s(Le,{tableHeader:w.value,tableData:g.value,pagination:n.value,loading:l.value,maxHeight:"400px",onPageChange:_},{"cell-tools":u(({row:M})=>[e("div",mf,[e("span",{class:"tools-item clickable",onClick:L=>v(M)},i(I.$t("attachment.visit")),9,_f),e("span",{class:"tools-item clickable",onClick:L=>y(M)},i(I.$t("attachment.copy_link")),9,pf),e("span",{class:"tools-item clickable",onClick:L=>S(M)},i(I.$t("common.delete")),9,ff)])]),_:1},8,["tableHeader","tableData","pagination","loading"])]),_:1},8,["class","title"]),$.value?(C(),B(z(of),{key:0,callback:()=>{$.value=!1,k()}},null,8,["callback"])):F("",!0)]))}});const hf=Y(vf,[["__scopeId","data-v-1ef80ed5"]]);function gf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(hf,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const yf={class:"add-team-member-modal"},wf={class:"form-content"},bf={class:"form-item"},$f={class:"form-label"},kf={class:"select-wrapper"},Cf={class:"user-option"},xf={class:"username"},If={key:0,class:"name"},Sf={class:"form-item"},Tf={class:"form-label"},Mf={class:"radio-group-wrapper"},Lf={class:"modal-footer"},Vf=J({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=b({member_username:"",team_member_group_id:"1"}),d=async()=>{l.value=!0;try{const g=await jt({username:""});g.error_code===0&&g.data&&(m.value=g.data.map(n=>({username:n.username,name:n.name,value:n.username,label:n.name?`${n.username}(${n.name})`:n.username})))}catch(g){console.error("获取全站用户列表失败:",g)}finally{l.value=!1}},p=(g,n)=>{var r,_;const w=((r=n.label)==null?void 0:r.toLowerCase())||"",k=((_=n.value)==null?void 0:_.toLowerCase())||"";return w.includes(g.toLowerCase())||k.includes(g.toLowerCase())},h=async()=>{if(!f.value.member_username.trim()){await G(t("item.member_username")+t("common.required"));return}try{const g=await wa({team_id:a.team_id,member_username:f.value.member_username,team_member_group_id:f.value.team_member_group_id});g.error_code===0?(ie.success(t("common.op_success")),$(),a.onClose(!0)):g.error_code===10310?await G(t("item.member_limit_exceeded_with_link"),{dangerouslyUseHTMLString:!0}):await G(g.error_message||t("common.op_failed"))}catch(g){console.error("添加成员失败:",g),await G(t("common.op_failed"))}},$=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{d(),setTimeout(()=>{o.value=!0})}),(g,n)=>{const w=H("a-select-option"),k=H("a-select"),r=H("a-radio"),_=H("a-radio-group");return C(),V("div",yf,[s(de,{class:re({show:o.value}),title:z(t)("item.add_member"),icon:["fas","user-plus"],width:"500px",onClose:$},{default:u(()=>[e("div",wf,[e("div",bf,[e("div",$f,i(z(t)("item.member_username")),1),e("div",kf,[s(k,{value:f.value.member_username,"onUpdate:value":n[0]||(n[0]=v=>f.value.member_username=v),"show-search":"","filter-option":p,placeholder:z(t)("item.search_member_placeholder"),loading:l.value,style:{width:"100%"}},{default:u(()=>[(C(!0),V(Ce,null,Pe(m.value,v=>(C(),B(w,{key:v.username,value:v.username,label:v.username},{default:u(()=>[e("div",Cf,[e("span",xf,i(v.username),1),v.name&&v.name!==v.username?(C(),V("span",If," ("+i(v.name)+") ",1)):F("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","loading"])])]),e("div",Sf,[e("div",Tf,i(z(t)("item.member_authority")),1),e("div",Mf,[s(_,{value:f.value.team_member_group_id,"onUpdate:value":n[1]||(n[1]=v=>f.value.team_member_group_id=v)},{default:u(()=>[s(r,{value:"1",class:"radio-option"},{default:u(()=>[O(i(z(t)("item.ordinary_member")),1)]),_:1}),s(r,{value:"2",class:"radio-option"},{default:u(()=>[O(i(z(t)("item.team_admin")),1)]),_:1})]),_:1},8,["value"])])])]),e("div",Lf,[e("div",{class:"secondary-button",onClick:n[2]||(n[2]=v=>$())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:n[3]||(n[3]=v=>h())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const zf=Y(Vf,[["__scopeId","data-v-86bbe5b4"]]);function Uf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(zf,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Pf={class:"team-member-modal"},Af={class:"modal-content"},Df={class:"member-info"},Of=["onClick"],Nf=J({__name:"index",props:{team_id:{},team_manage:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=q(()=>[{title:t("item.member_username"),key:"member_username",width:200},{title:t("item.member_authority"),key:"team_member_group_id",width:150},{title:t("team.name"),key:"name",width:150},{title:t("item.addtime"),key:"addtime",width:180},{title:t("common.operation"),key:"operation",width:100}]),d=q(()=>a.team_manage>0?[{text:t("item.add_member"),icon:["fas","plus"],onClick:h}]:[]),p=async()=>{l.value=!0;try{const n=await Bt(a.team_id);n.error_code===0&&(m.value=n.data||[])}catch(n){console.error("获取团队成员列表失败:",n)}finally{l.value=!1}},h=async()=>{await Uf(a.team_id)&&p()},$=async n=>{if(await Se({msg:t("item.confirm_delete_member"),title:t("item.confirm_delete")}))try{await ba(n),ie.success(t("common.op_success")),p()}catch(k){console.error("删除成员失败:",k)}},g=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{o.value=!0,p()})}),(n,w)=>{const k=H("a-tag");return C(),V("div",Pf,[s(de,{class:re({show:o.value}),title:z(t)("item.manage_members"),icon:["fas","user-group"],width:"1000px",headerButtons:d.value,onClose:g},{default:u(()=>[e("div",Af,[s(Le,{tableHeader:f.value,tableData:m.value,loading:l.value},{"cell-member_username":u(({row:r})=>[e("div",Df,[e("span",null,i(r.member_username),1)])]),"cell-team_member_group_id":u(({row:r})=>[s(k,{color:r.team_member_group_id==2?"blue":"default"},{default:u(()=>[O(i(r.team_member_group_id==2?z(t)("team.team_admin"):z(t)("item.ordinary_member")),1)]),_:2},1032,["color"])]),"cell-name":u(({row:r})=>[e("span",null,i(r.name),1)]),"cell-addtime":u(({row:r})=>[e("span",null,i(r.addtime),1)]),"cell-operation":u(({row:r})=>[c.team_manage>0?(C(),V("span",{key:0,class:"operation-btn danger",onClick:_=>$(r.id)},i(z(t)("common.delete")),9,Of)):F("",!0)]),_:1},8,["tableHeader","tableData","loading"])])]),_:1},8,["class","title","headerButtons"])])}}});const Ff=Y(Nf,[["__scopeId","data-v-f9953c68"]]);function qf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ff,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Rf={class:"bind-item-modal"},Hf={class:"form-content"},Ef={class:"form-item"},jf={class:"form-label"},Bf={class:"form-item"},Gf=["href"],Kf={class:"modal-footer"},Wf=J({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),m=b([]),f=b({item_id:[]}),d=q(()=>m.value.map(w=>({label:w.item_name,value:w.item_id}))),p=q(()=>a.resolve({path:"/item/index"}).href),h=(w,k)=>k.label.toLowerCase().includes(w.toLowerCase()),$=async()=>{try{const w=await kt(0);w.error_code===0&&(m.value=(w.data||[]).filter(k=>k.manage))}catch(w){console.error("获取项目列表失败:",w)}},g=async()=>{if(!f.value.item_id||f.value.item_id.length===0){await G(t("item.item")+t("common.required"));return}try{for(const w of f.value.item_id)await Gt(String(w),String(o.team_id));ie.success(t("common.op_success")),n(),o.onClose(!0)}catch(w){console.error("绑定项目失败:",w),await G(t("common.op_failed"))}},n=()=>{l.value=!1,setTimeout(()=>{o.onClose(!1)},300)};return ae(()=>{$(),setTimeout(()=>{l.value=!0})}),(w,k)=>{const r=H("a-select");return C(),V("div",Rf,[s(de,{class:re({show:l.value}),title:z(t)("item.item"),icon:["fas","folder-plus"],width:"500px",onClose:n},{default:u(()=>[e("div",Hf,[e("div",Ef,[e("div",jf,i(z(t)("item.please_choose")),1),s(r,{value:f.value.item_id,"onUpdate:value":k[0]||(k[0]=_=>f.value.item_id=_),mode:"multiple",placeholder:z(t)("item.please_choose"),options:d.value,"filter-option":h,"show-search":"",style:{width:"100%"}},null,8,["value","placeholder","options"])]),e("div",Bf,[e("a",{href:p.value,target:"_blank",class:"link-text"},i(z(t)("item.go_to_new_an_item")),9,Gf)])]),e("div",Kf,[e("div",{class:"secondary-button",onClick:k[1]||(k[1]=_=>n())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:k[2]||(k[2]=_=>g())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const Jf=Y(Wf,[["__scopeId","data-v-e68d3227"]]);function Yf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Jf,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Xf={class:"team-item-member-modal"},Qf={class:"modal-content"},Zf={class:"action-bar"},ev={key:1,class:"all-cats-text"},tv=J({__name:"index",props:{item_id:{},team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=b([]),d=q(()=>[{label:t("item.readonly_member"),value:0},{label:t("item.edit_member"),value:1},{label:t("item.item_admin"),value:2}]),p=q(()=>[{title:t("item.username"),key:"member_username",width:150},{title:t("team.name"),key:"name",width:150},{title:t("item.member_authority"),key:"member_group_id",width:150},{title:t("item.catalog"),key:"cat_ids",width:220},{title:t("item.addtime"),key:"addtime",width:180}]),h=async()=>{l.value=!0;try{const r=await Kt(a.item_id,a.team_id);r.error_code===0&&(m.value=(r.data||[]).map(_=>({..._,member_group_id:Number(_.member_group_id),cat_ids:Array.isArray(_.cat_ids)?_.cat_ids.map(v=>Number(v)):typeof _.cat_ids=="string"?_.cat_ids.split(",").map(v=>Number(v.trim())):[]})))}catch(r){console.error("获取成员列表失败:",r)}finally{l.value=!1}},$=async()=>{try{const r=await xt(a.item_id);if(r.error_code===0){let _=r.data||[];Array.isArray(_)||(Array.isArray(_.items)?_=_.items:Array.isArray(_.list)&&(_=_.list)),_.unshift({cat_id:0,cat_name:t("item.all_cat")}),f.value=_.map(v=>({...v,cat_id:Number(v.cat_id)}))}}catch(r){console.error("获取目录列表失败:",r)}},g=async()=>{for(const r of m.value)try{await nt({id:r.id,member_group_id:0}),r.member_group_id=0}catch(_){console.error("设置成员为只读失败:",_)}ie.success(t("item.auth_success"))},n=async r=>{try{await nt({id:r.id,member_group_id:r.member_group_id}),ie.success(t("item.auth_success"))}catch(_){console.error("修改权限失败:",_)}},w=async r=>{try{await nt({id:r.id,cat_ids:(r.cat_ids||[]).map(_=>Number(_)).join(",")}),ie.success(t("item.cat_success"))}catch(_){console.error("修改目录失败:",_)}},k=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{h(),$(),setTimeout(()=>{o.value=!0})}),(r,_)=>{const v=H("a-select"),y=H("a-select-option");return C(),V("div",Xf,[s(de,{class:re({show:o.value}),title:z(t)("item.adjust_member_authority"),icon:["fas","user-shield"],width:"1000px",onClose:k},{default:u(()=>[e("div",Qf,[e("div",Zf,[e("a",{onClick:g,class:"set-all-read"},i(z(t)("item.all_member_read")),1)]),s(Le,{tableHeader:p.value,tableData:m.value,loading:l.value,emptyText:z(t)("item.team_member_empty_tips")},{"cell-member_group_id":u(({row:S})=>[s(v,{value:S.member_group_id,"onUpdate:value":x=>S.member_group_id=x,size:"small",style:{width:"120px"},onChange:x=>n(S),options:d.value,fieldNames:{label:"label",value:"value"}},null,8,["value","onUpdate:value","onChange","options"])]),"cell-cat_ids":u(({row:S})=>[S.member_group_id<=1?(C(),B(v,{key:0,value:S.cat_ids,"onUpdate:value":x=>S.cat_ids=x,mode:"multiple",size:"small",style:{width:"200px"},onChange:x=>w(S)},{default:u(()=>[(C(!0),V(Ce,null,Pe(f.value,x=>(C(),B(y,{key:x.cat_id,value:x.cat_id},{default:u(()=>[O(i(x.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(C(),V("span",ev,i(z(t)("item.all_cat")),1))]),_:1},8,["tableHeader","tableData","loading","emptyText"])])]),_:1},8,["class","title"])])}}});const av=Y(tv,[["__scopeId","data-v-43d70e02"]]);function ov(c,t){return new Promise(a=>{const{app:o,mountNode:l}=ve(av,{item_id:c,team_id:t,onClose:m=>{a(m),me(o,l)}});o.mount(l)})}const sv={class:"team-item-modal"},lv={class:"modal-content"},nv={class:"item-info"},iv={class:"operation-buttons"},rv=["onClick"],cv=["onClick"],dv=["onClick"],uv=J({__name:"index",props:{team_id:{},team_manage:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),m=b(!1),f=b([]),d=q(()=>o.team_manage>0?[{text:t("item.binding_item"),icon:["fas","plus"],onClick:$}]:[]),p=q(()=>[{title:t("item.item_name"),key:"item_name",width:300},{title:t("team.join_time"),key:"addtime",width:200},{title:t("common.operation"),key:"operation",width:300}]),h=async()=>{m.value=!0;try{const r=await $a(o.team_id);r.error_code===0&&(f.value=r.data||[])}catch(r){console.error("获取团队项目列表失败:",r)}finally{m.value=!1}},$=async()=>{await Yf(o.team_id)&&h()},g=r=>{window.open(a.resolve({path:`/${r}`}).href,"_blank")},n=async r=>{if(await Se(t("item.confirm_unassign_item")))try{await Wt(r),ie.success(t("common.op_success")),h()}catch(v){console.error("解绑项目失败:",v)}},w=async r=>{await ov(r,o.team_id)},k=()=>{l.value=!1,setTimeout(()=>{o.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{l.value=!0,h()})}),(r,_)=>(C(),V("div",sv,[s(de,{class:re({show:l.value}),title:z(t)("team.item_manage"),icon:["fas","folder"],width:"900px",headerButtons:d.value,onClose:k},{default:u(()=>[e("div",lv,[s(Le,{tableHeader:p.value,tableData:f.value,loading:m.value},{"cell-item_name":u(({row:v})=>[e("div",nv,[e("span",null,i(v.item_name),1)])]),"cell-operation":u(({row:v})=>[e("div",iv,[e("span",{class:"operation-btn",onClick:y=>g(v.item_id)},i(z(t)("item.check_item")),9,rv),c.team_manage>0?(C(),V(Ce,{key:0},[_[0]||(_[0]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:y=>w(v.item_id)},i(z(t)("item.member_authority")),9,cv),_[1]||(_[1]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:y=>n(v.id)},i(z(t)("item.unassign")),9,dv)],64)):F("",!0)])]),_:1},8,["tableHeader","tableData","loading"])])]),_:1},8,["class","title","headerButtons"])]))}});const mv=Y(uv,[["__scopeId","data-v-ad8ae728"]]);function _v(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(mv,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const pv={class:"attorn-team-modal"},fv={class:"form-content"},vv={class:"form-item"},hv={class:"form-label"},gv={class:"form-item"},yv={class:"form-label"},wv={class:"tips-text"},bv={class:"modal-footer"},$v=J({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({username:"",password:""}),m=async()=>{if(!l.value.username.trim()){await G(t("item.attorn_username")+t("common.required"));return}if(!l.value.password.trim()){await G(t("item.input_login_password")+t("common.required"));return}try{(await ka(a.team_id,l.value.username,l.value.password)).error_code===0&&(ie.success(t("common.op_success")),f(),a.onClose(!0))}catch(d){console.error("转让团队失败:",d)}},f=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>(C(),V("div",pv,[s(de,{class:re({show:o.value}),title:z(t)("item.attorn_team"),icon:["fas","user-group"],width:"500px",onClose:f},{default:u(()=>[e("div",fv,[e("div",vv,[e("div",hv,i(z(t)("item.attorn_username")),1),s(ne,{modelValue:l.value.username,"onUpdate:modelValue":p[0]||(p[0]=h=>l.value.username=h),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),e("div",gv,[e("div",yv,i(z(t)("item.input_login_password")),1),s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[1]||(p[1]=h=>l.value.password=h),type:"password",placeholder:z(t)("item.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),e("div",wv,i(z(t)("item.attornTeamTips")),1)]),e("div",bv,[e("div",{class:"secondary-button",onClick:p[2]||(p[2]=h=>f())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:p[3]||(p[3]=h=>m())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])]))}});const kv=Y($v,[["__scopeId","data-v-830eb7a4"]]);function Cv(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(kv,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const xv={class:"team-modal"},Iv={class:"modal-content"},Sv={class:"table-wrapper"},Tv=["onClick"],Mv=["onClick"],Lv={class:"operation-buttons"},Vv=["onClick"],zv=["onClick"],Uv=["onClick"],Pv=["onClick"],Av=["onClick"],Dv=["onClick"],Ov={class:"footer-buttons"},Nv=J({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=b({id:0,team_manage:0,team_name:""}),d=q(()=>[{text:t("item.add_team"),icon:["fas","plus"],onClick:g}]),p=q(()=>[{title:t("item.team_name"),key:"team_name",width:200},{title:t("team.member_count"),key:"memberCount",width:100},{title:t("team.item_count"),key:"itemCount",width:100},{title:t("common.operation"),key:"operation",width:300}]),h=async()=>{l.value=!0;try{const S=await Jt();S.error_code===0?m.value=S.data||[]:await G(S.error_message||t("common.op_failed"))}catch(S){console.error("获取团队列表失败:",S),await G(t("common.op_failed"))}finally{l.value=!1}},$=()=>{},g=async()=>{const S=await it(t("item.add_team"),"",t("item.team_name"));if(S&&S.trim())try{const x=await Rt({id:"",team_name:S.trim()});x.error_code===0?(ie.success(t("common.op_success")),h()):await G(x.error_message||t("common.op_failed"))}catch(x){console.error("保存团队失败:",x),await G(t("common.op_failed"))}},n=async S=>{const x=await it(t("item.edit_team"),S.team_name,t("item.team_name"));if(x&&x.trim())try{const I=await Rt({id:S.id,team_name:x.trim()});I.error_code===0?(ie.success(t("common.op_success")),h()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("保存团队失败:",I),await G(t("common.op_failed"))}},w=async S=>{if(await Se({msg:t("item.confirm_delete_team"),title:t("item.confirm_delete")}))try{const I=await Ca(S);I.error_code===0?(ie.success(t("common.op_success")),h()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("删除团队失败:",I),await G(t("common.op_failed"))}},k=async S=>{await Cv(S.id)&&h()},r=async S=>{if(await Se({msg:t("item.team_exit_confirm_content"),title:t("item.team_exit_confirm")}))try{const I=await xa(S);I.error_code===0?(ie.success(t("common.op_success")),h()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("退出团队失败:",I),await G(t("common.op_failed"))}},_=async S=>{f.value=S,await qf({team_id:S.id,team_manage:S.team_manage}),h()},v=async S=>{f.value=S,await _v({team_id:S.id,team_manage:S.team_manage}),h()},y=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{o.value=!0,h()})}),(S,x)=>(C(),V("div",xv,[s(de,{class:re({show:o.value}),title:z(t)("team.team_manage"),icon:["fas","users"],width:"900px",height:"400px",headerButtons:d.value,onClose:y},{footer:u(()=>[e("div",Ov,[s(K,{onClick:y},{default:u(()=>[O(i(z(t)("common.close")),1)]),_:1})])]),default:u(()=>[e("div",Iv,[e("div",Sv,[s(Le,{tableHeader:p.value,tableData:m.value,loading:l.value,rowClickable:!0,emptyText:z(t)("team.empty_team_tips"),onRowClick:$},{"cell-memberCount":u(({row:I})=>[e("a",{onClick:T=>_(I),class:"clickable-link"},i(I.memberCount),9,Tv)]),"cell-itemCount":u(({row:I})=>[e("a",{onClick:T=>v(I),class:"clickable-link"},i(I.itemCount),9,Mv)]),"cell-operation":u(({row:I})=>[e("div",Lv,[e("span",{class:"operation-btn",onClick:T=>_(I)},i(z(t)("team.member")),9,Vv),x[4]||(x[4]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:T=>v(I)},i(z(t)("team.team_item")),9,zv),I.team_manage>0?(C(),V(Ce,{key:0},[x[0]||(x[0]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:T=>n(I)},i(z(t)("common.edit")),9,Uv),x[1]||(x[1]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:T=>k(I)},i(z(t)("item.attorn_team")),9,Pv),x[2]||(x[2]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:T=>w(I.id)},i(z(t)("common.delete")),9,Av)],64)):(C(),V(Ce,{key:1},[x[3]||(x[3]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:T=>r(I.id)},i(z(t)("team.team_exit")),9,Dv)],64))])]),_:1},8,["tableHeader","tableData","loading","emptyText"])])])]),_:1},8,["class","title","headerButtons"])]))}});const Fv=Y(Nv,[["__scopeId","data-v-1fe3650d"]]);function Ha(){return new Promise(c=>{const{app:t,mountNode:a}=ve(Fv,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const qv={class:"header-right"},Rv={class:"icon-item language-item"},Hv=J({__name:"HeaderRight",props:{isAdmin:{type:Boolean}},setup(c){const{t,locale:a}=te(),o=xe(),l=Qe(),m=He(),f=b([]),d=b(!1),p=v=>{o.push({path:v})},h=v=>{window.open(v)},$=()=>{m.toggleTheme()},g=async()=>{await Ra()},n=async()=>{await gf()},w=async()=>{l.setNewMsg(0),await sa()},k=async()=>{await oa()},r=async()=>{await Ha()},_=async()=>{try{const v=await Yt();d.value=v&&v.data&&v.data.enable===1}catch{d.value=!1}};return ae(()=>{_(),f.value=[{title:t("header.runapi_title"),icon:"fas fa-terminal",desc:t("header.runapi_desc"),method:()=>{h("https://www.showdoc.com.cn/runapi")}},{title:t("header.jisuxiang_title"),icon:"fas fa-toolbox",desc:t("header.jisuxiang_desc"),method:()=>{h("https://www.jisuxiang.com")}},{title:t("header.dfyun_title"),icon:"fas fa-cloud",desc:t("header.dfyun_desc"),method:()=>{h("https://www.dfyun.com.cn")}},{title:t("header.push_service_title"),icon:"fas fa-car-side",desc:t("header.push_service_desc"),method:()=>{h("https://push.showdoc.com.cn")}},{title:t("header.back_to_home"),icon:"fas fa-backward",desc:t("header.back_to_home_desc"),method:()=>{p("/")}}]}),(v,y)=>{const S=H("a-tooltip"),x=H("a-badge");return C(),V("div",qv,[e("div",null,[s(S,{title:z(t)("header.switch_language"),placement:"top"},{default:u(()=>[e("div",Rv,[s(ht)])]),_:1},8,["title"]),s(S,{title:z(m).theme==="light"?z(t)("common.dark_mode"):z(t)("common.light_mode"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:$},[...y[2]||(y[2]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),s(S,{title:z(t)("feedback.feedback"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:g},[...y[3]||(y[3]=[e("i",{class:"fas fa-headphones"},null,-1)])])]),_:1},8,["title"]),s(S,{title:z(t)("attachment.my_attachment"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:n},[...y[4]||(y[4]=[e("i",{class:"fas fa-folder-arrow-up"},null,-1)])])]),_:1},8,["title"]),s(S,{title:z(t)("message.my_notice"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:w},[s(x,{count:z(l).newMsg?"New":0},{default:u(()=>[...y[5]||(y[5]=[e("i",{class:"fas fa-message"},null,-1)])]),_:1},8,["count"])])]),_:1},8,["title"]),s(S,{title:z(t)("team.team_manage"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:r},[...y[6]||(y[6]=[e("i",{class:"fas fa-users"},null,-1)])])]),_:1},8,["title"]),d.value?(C(),B(S,{key:0,title:z(t)("item.public_square"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:y[0]||(y[0]=I=>p("/public-square/index"))},[...y[7]||(y[7]=[e("i",{class:"fas fa-landmark"},null,-1)])])]),_:1},8,["title"])):F("",!0),s(S,{title:z(t)("user.user_center"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:k},[...y[8]||(y[8]=[e("i",{class:"fas fa-user"},null,-1)])])]),_:1},8,["title"]),c.isAdmin?(C(),B(S,{key:1,title:z(t)("admin.background"),placement:"top"},{default:u(()=>[e("div",{class:"icon-item",onClick:y[1]||(y[1]=I=>p("/admin/index"))},[...y[9]||(y[9]=[e("i",{class:"fas fa-gear"},null,-1)])])]),_:1},8,["title"])):F("",!0),z(a)==="zh-CN"?(C(),B(Oa,{key:2,title:z(t)("header.more_products"),titleIcon:"fas fa-ellipsis",menuList:f.value,width:"270px"},{default:u(()=>[...y[10]||(y[10]=[e("div",{class:"icon-item"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["title","menuList"])):F("",!0)])])}}});const Ev=Y(Hv,[["__scopeId","data-v-b5f13bec"]]),jv={class:"share-modal"},Bv={class:"modal-content"},Gv={class:"label"},Kv={class:"link-container"},Wv={class:"link"},Jv={key:0,class:"single-page-section"},Yv={class:"label"},Xv={class:"link-container single-link"},Qv={class:"link"},Zv={class:"label"},eh={key:1,class:"tips-text"},th={class:"modal-footer"},ah=J({__name:"index",props:{item_domain:{},item_id:{},page_id:{},page_unique_key:{},page_title:{},item_info:{},onClose:{type:Function}},setup(c){const{t}=te();xe();const a=c,o=q(()=>a.page_id),l=q(()=>a.item_info),m=b(!1),f=b(!1),d=b(0),p=b(a.page_unique_key||""),h=q(()=>{var T,M;const S=a.item_id||((T=l.value)==null?void 0:T.item_id);if(!S)return"";const x=a.item_domain||((M=l.value)==null?void 0:M.item_domain)||S,I=window.location.origin+window.location.pathname;return o.value&&o.value>0?`${I}#/${x}/${o.value}`:`${I}#/${x}`}),$=q(()=>p.value?`${window.location.origin+window.location.pathname}#/p/${p.value}`:""),g=async()=>{await Ht(h.value)?ie.success(t("common.copy_success")):G(t("common.error"))},n=async()=>{await Ht($.value)?ie.success(t("common.copy_success")):G(t("common.error"))},w=async S=>{if(S)await k();else if(await Se({msg:t("item.cancel_single"),confirmText:t("item.cancel_single_yes"),cancelText:t("item.cancel_single_no")})){f.value=!1;const I=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"false",expire_days:0},"post",!1);I.error_code===0?(p.value="",ie.success(t("common.save_success"))):(await G(I.error_message||t("common.op_failed")),f.value=!0)}else f.value=!0},k=async()=>{if(!(!a.page_id||a.page_id<=0))try{const S=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"true",expire_days:d.value},"post",!1);if(S.error_code===0&&S.data){const x=S.data.unique_key;x&&(p.value=x),ie.success(t("common.save_success"))}else await G(S.error_message||t("common.op_failed"))}catch(S){console.error("创建单页失败:",S),await G(t("common.op_failed"))}},r=async()=>{if(f.value&&p.value)try{const S=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"true",expire_days:d.value},"post",!1);if(S.error_code===0&&S.data){const x=S.data.unique_key;x&&(p.value=x),ie.success(t("common.save_success"))}else await G(S.error_message||t("common.op_failed"))}catch(S){console.error("更新单页有效期失败:",S),await G(t("common.op_failed"))}},_=()=>{m.value=!1,setTimeout(()=>{a.onClose(!1)},300)};ae(()=>{a.page_unique_key?(f.value=!0,p.value=a.page_unique_key,v()):a.page_id&&a.page_id>0&&y(),setTimeout(()=>{m.value=!0})});const v=async()=>{if(!a.page_id)return;const S=a.page_unique_key||p.value;try{const x=await X("/api/page/infoByKey",{unique_key:S||""},"post",!1);if(x.error_code===0&&x.data){console.log("[fetchSinglePageInfo] API 返回数据:",x.data),console.log("[fetchSinglePageInfo] expire_time:",x.data.expire_time);const I=Math.floor(Date.now()/1e3),T=x.data.expire_time;if(!T||T<=0)d.value=0,console.log("[fetchSinglePageInfo] 永久有效，设置 expireDays.value: 0");else{const M=Math.round((T-I)/86400);console.log("[fetchSinglePageInfo] 当前时间:",I,"diffDays:",M),M<=1?d.value=1:M<=7?d.value=7:M<=30?d.value=30:M<=180?d.value=180:d.value=0,console.log("[fetchSinglePageInfo] 设置 expireDays.value:",d.value)}}else p.value="",f.value=!1}catch(x){console.error("获取单页信息失败:",x),p.value="",f.value=!1}},y=async()=>{if(!(!a.page_id||a.page_id<=0))try{const S=await X("/api/page/info",{page_id:a.page_id},"post",!1);S.error_code===0&&S.data&&(S.data.unique_key?(p.value=S.data.unique_key,f.value=!0,v()):(p.value="",f.value=!1))}catch(S){console.error("检查单页失败:",S)}};return(S,x)=>{const I=H("a-radio"),T=H("a-radio-group");return C(),V("div",jv,[s(de,{class:re({show:m.value}),title:S.$t("item.share"),onClose:_},{default:u(()=>{var M;return[e("div",Bv,[e("p",Gv,i(o.value?S.$t("item.item_page_address"):S.$t("item.item_address"))+":",1),e("div",Kv,[e("code",Wv,i(h.value),1),e("i",{class:"fas fa-copy copy-icon",onClick:g})]),o.value&&((M=a.item_info)!=null&&M.item_edit)?(C(),V("div",Jv,[e("p",Yv,[s(We,{modelValue:f.value,"onUpdate:modelValue":x[0]||(x[0]=L=>f.value=L),label:S.$t("item.create_single_page"),onChange:w},null,8,["modelValue","label"])]),f.value?(C(),V(Ce,{key:0},[e("div",Xv,[e("code",Qv,i($.value),1),e("i",{class:"fas fa-copy copy-icon",onClick:n})]),e("p",Zv,i(S.$t("item.expire_time"))+":",1),s(T,{value:d.value,"onUpdate:value":x[1]||(x[1]=L=>d.value=L),onChange:r},{default:u(()=>[s(I,{value:0},{default:u(()=>[O(i(S.$t("item.permanent")),1)]),_:1}),s(I,{value:1},{default:u(()=>[O(i(S.$t("item.one_day")),1)]),_:1}),s(I,{value:7},{default:u(()=>[O(i(S.$t("item.seven_days")),1)]),_:1}),s(I,{value:30},{default:u(()=>[O(i(S.$t("item.one_month")),1)]),_:1}),s(I,{value:180},{default:u(()=>[O(i(S.$t("item.half_year")),1)]),_:1})]),_:1},8,["value"])],64)):F("",!0)])):F("",!0),o.value&&(f.value||p.value)?(C(),V("div",eh,i(S.$t("item.create_single_page_tips")),1)):F("",!0)]),e("div",th,[e("div",{class:"secondary-button",onClick:_},i(S.$t("common.close")),1)])]}),_:1},8,["class","title"])])}}});const oh=Y(ah,[["__scopeId","data-v-1a51dbb5"]]);function gt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(oh,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const sh={class:"create-item-modal"},lh={class:"modal-content"},nh={class:"switch-item"},ih={class:"form-item-desc"},rh={class:"switch-item"},ch={class:"form-item-desc"},dh={class:"modal-footer"},uh=J({__name:"index",props:{item_id:{},item_type:{},item_group_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=q(()=>!a.item_id),l=b(!1),m=b(!1),f=b(!0),d=b([]),p=b([]),h=b({item_name:"",item_description:"",password:"",item_type:"1",allow_comment:!1,allow_feedback:!1}),$=v=>{const y=(v||[]).map(S=>Number(S)).filter(S=>!isNaN(S));y.includes(0)?d.value=[0]:d.value=y},g=()=>{f.value&&(h.value.password="")},n=async()=>{try{const v=await vo(String(a.item_id));if(v&&v.data){const y=v.data;y.password?f.value=!1:f.value=!0,h.value.item_name=y.item_name||"",h.value.item_description=y.item_description||"",h.value.password=y.password||"",h.value.item_type=y.item_type||"1",h.value.allow_comment=y.allow_comment===1||y.allow_comment===!0||y.allow_comment==="1",h.value.allow_feedback=y.allow_feedback===1||y.allow_feedback===!0||y.allow_feedback==="1",d.value=Array.isArray(y.group_ids)?y.group_ids.map(S=>Number(S)).filter(S=>!isNaN(S)):[]}}catch(v){console.error("Load item detail failed:",v)}},w=()=>{a.item_type&&(h.value.item_type=String(a.item_type)),a.item_group_id&&a.item_group_id>0&&(d.value=[a.item_group_id]),f.value=!0},k=async()=>{try{const v=await Xt();v&&v.data&&(p.value=v.data||[])}catch(v){console.error("Load group list failed:",v)}},r=async()=>{if(!h.value.item_name||h.value.item_name.trim()===""){await G(t("item.item_name")+" "+t("common.required"));return}if(!f.value&&!h.value.password){await G(t("item.private_item_password"));return}const v={item_name:h.value.item_name,item_description:h.value.item_description,password:f.value?"":h.value.password,item_group_ids:(d.value||[]).map(y=>Number(y)).filter(y=>!isNaN(y))};(h.value.item_type=="1"||Number(h.value.item_type)===1)&&(v.allow_comment=h.value.allow_comment?1:0,v.allow_feedback=h.value.allow_feedback?1:0);try{if(m.value=!0,o.value){v.item_type=Number(h.value.item_type);const y=await Ia(v,!1);if(y.error_code===0)ie.success(t("common.op_success")),_(!0);else if(y.error_code===10309){const S=t("item.item_limit_exceeded_with_link");await G(S,{dangerouslyUseHTMLString:!0})}else if(y.error_code===10313){const S=t("item.realname_auth_required_for_public_item");await G(S,{dangerouslyUseHTMLString:!0})}else await G(y.error_message||t("common.op_failed"))}else{const y=await ho(String(a.item_id),v,!1);y.error_code===0?(ie.success(t("common.modify_success")),_(!0)):await G(y.error_message||t("common.op_failed"))}}catch(y){console.error("Submit item failed:",y),await G(t("common.op_failed"))}finally{m.value=!1}},_=(v=!1)=>{l.value=!1,setTimeout(()=>{a.onClose(v)},300)};return ae(async()=>{setTimeout(()=>{l.value=!0}),await k(),o.value?w():await n()}),(v,y)=>{const S=H("a-select-option"),x=H("a-select"),I=H("a-form-item"),T=H("a-form");return C(),V("div",sh,[s(de,{class:re({show:l.value}),title:o.value?v.$t("item.create_new_item"):v.$t("item.update_base_info"),icon:o.value?["fa","fa-plus"]:["fas","edit"],onClose:_},{default:u(()=>[e("div",lh,[s(T,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:u(()=>[s(I,{label:v.$t("item.item_type")},{default:u(()=>[s(x,{value:h.value.item_type,"onUpdate:value":y[0]||(y[0]=M=>h.value.item_type=M),disabled:!o.value},{default:u(()=>[s(S,{value:"1"},{default:u(()=>[O(i(v.$t("item.regular_item")),1)]),_:1}),s(S,{value:"2"},{default:u(()=>[O(i(v.$t("item.single_item")),1)]),_:1}),s(S,{value:"4"},{default:u(()=>[O(i(v.$t("item.table_item")),1)]),_:1}),s(S,{value:"5"},{default:u(()=>[O(i(v.$t("item.whiteboard_item")),1)]),_:1})]),_:1},8,["value","disabled"])]),_:1},8,["label"]),s(I,{label:v.$t("item.item_name")},{default:u(()=>[s(ne,{modelValue:h.value.item_name,"onUpdate:modelValue":y[1]||(y[1]=M=>h.value.item_name=M),placeholder:v.$t("item.item_name"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p.value&&p.value.length>0?(C(),B(I,{key:0,label:v.$t("item.group")},{default:u(()=>[s(x,{value:d.value,"onUpdate:value":y[2]||(y[2]=M=>d.value=M),mode:"multiple",placeholder:v.$t("item.item_group_desc"),onChange:$},{default:u(()=>[s(S,{value:0},{default:u(()=>[O(i(v.$t("item.all_items")),1)]),_:1}),(C(!0),V(Ce,null,Pe(p.value,M=>(C(),B(S,{key:M.id,value:Number(M.id)},{default:u(()=>[O(i(M.group_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"])):F("",!0),s(I,{label:v.$t("item.item_description")},{default:u(()=>[s(ne,{modelValue:h.value.item_description,"onUpdate:modelValue":y[3]||(y[3]=M=>h.value.item_description=M),placeholder:v.$t("item.item_description"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(I,{label:v.$t("item.accessibility")},{default:u(()=>[s(x,{value:f.value,"onUpdate:value":y[4]||(y[4]=M=>f.value=M),onChange:g},{default:u(()=>[s(S,{value:!0},{default:u(()=>[O(i(v.$t("item.public_item")),1)]),_:1}),s(S,{value:!1},{default:u(()=>[O(i(v.$t("item.private_item")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),f.value?F("",!0):(C(),B(I,{key:1,label:v.$t("item.visit_password")},{default:u(()=>[s(ne,{modelValue:h.value.password,"onUpdate:modelValue":y[5]||(y[5]=M=>h.value.password=M),type:"password",placeholder:v.$t("item.visit_password")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),h.value.item_type=="1"||Number(h.value.item_type)===1?(C(),B(I,{key:2,label:v.$t("itemSetting.interactionTitle")},{default:u(()=>[e("div",nh,[s(We,{modelValue:h.value.allow_comment,"onUpdate:modelValue":y[6]||(y[6]=M=>h.value.allow_comment=M),label:v.$t("itemSetting.allowComment")},null,8,["modelValue","label"]),e("div",ih,i(v.$t("itemSetting.allowCommentDesc")),1)]),e("div",rh,[s(We,{modelValue:h.value.allow_feedback,"onUpdate:modelValue":y[7]||(y[7]=M=>h.value.allow_feedback=M),label:v.$t("itemSetting.allowFeedback")},null,8,["modelValue","label"]),e("div",ch,i(v.$t("itemSetting.allowFeedbackDesc")),1)])]),_:1},8,["label"])):F("",!0)]),_:1})]),e("div",dh,[e("div",{class:"secondary-button",onClick:y[8]||(y[8]=lt(M=>_(!1),["stop"]))},i(v.$t("common.cancel")),1),e("div",{class:re(["primary-button",{disabled:m.value}]),onClick:lt(r,["stop"])},i(m.value?v.$t("common.submiting"):v.$t("common.confirm")),3)])]),_:1},8,["class","title","icon"])])}}});const mh=Y(uh,[["__scopeId","data-v-f06f9198"]]);function at(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(mh,{item_id:c==null?void 0:c.item_id,item_type:c==null?void 0:c.item_type,item_group_id:c==null?void 0:c.item_group_id,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const _h={class:"add-member-modal"},ph={class:"modal-content"},fh={class:"tips-text"},vh={class:"footer-buttons"},hh=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=b([]),f=b([]),d=b({username:[],cat_ids:[],member_group_id:"1"}),p=q(()=>f.value.map(r=>({label:r.cat_name,value:r.cat_id}))),h=q(()=>m.value.map(r=>({label:r.name?`${r.username}(${r.name})`:r.username,value:r.username}))),$=async()=>{try{const r=await jt({username:""});r.error_code===0&&r.data&&(m.value=r.data||[])}catch(r){console.error("获取全站用户列表失败:",r)}},g=async()=>{try{const r=await go();r.error_code===0&&(l.value=r.data||[])}catch(r){console.error("获取成员历史记录失败:",r)}},n=async()=>{try{const r=await xt(String(a.item_id));if(r.error_code===0){const _=r.data||[];_.unshift({cat_id:0,cat_name:t("item.all_cat")}),f.value=_.map(v=>({...v,cat_id:Number(v.cat_id)}))}}catch(r){console.error("获取目录列表失败:",r)}},w=async()=>{if(!d.value.username||d.value.username.length===0){await G(t("item.input_target_member")+t("common.required"));return}try{let r=0,_=0;for(const v of d.value.username){const y=await Sa({item_id:a.item_id,username:v,cat_ids:(d.value.cat_ids||[]).join(","),member_group_id:d.value.member_group_id});y.error_code===0?r++:(_++,console.error(`添加成员 ${v} 失败:`,y.error_message))}if(r>0){let v=t("common.op_success");_>0&&(v=`${v} (成功${r}个，失败${_}个)`),j.success(v),k(!0)}else j.error(t("common.op_failed"))}catch(r){console.error("添加成员失败:",r),j.error(t("common.op_failed"))}},k=(r=!1)=>{o.value=!1,setTimeout(()=>{a.onClose(r)},300)};return ae(()=>{o.value=!0,g(),n(),$()}),(r,_)=>{const v=H("a-form-item"),y=H("a-radio"),S=H("a-radio-group"),x=H("a-form");return C(),V("div",_h,[s(de,{class:re({show:o.value}),title:z(t)("item.add_member"),icon:["fas","fa-user-plus"],maxWidth:"500px",onClose:k},{footer:u(()=>[e("div",vh,[s(K,{text:z(t)("common.cancel"),theme:"light",onClick:k},null,8,["text"]),s(K,{text:z(t)("common.confirm"),theme:"dark",onClick:w},null,8,["text"])])]),default:u(()=>[e("div",ph,[s(x,{layout:"vertical"},{default:u(()=>[s(v,{label:z(t)("item.input_target_member")},{default:u(()=>[s(Re,{value:d.value.username,"onUpdate:value":_[0]||(_[0]=I=>d.value.username=I),options:h.value,placeholder:z(t)("item.search_member_placeholder"),multiple:!0,"show-search":!0},null,8,["value","options","placeholder"])]),_:1},8,["label"]),s(v,{label:z(t)("item.authority")},{default:u(()=>[s(S,{value:d.value.member_group_id,"onUpdate:value":_[1]||(_[1]=I=>d.value.member_group_id=I)},{default:u(()=>[s(y,{value:"1"},{default:u(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(y,{value:"0"},{default:u(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(y,{value:"2"},{default:u(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),d.value.member_group_id<"2"?(C(),B(v,{key:0,label:z(t)("item.catalog")},{default:u(()=>[s(Re,{value:d.value.cat_ids,"onUpdate:value":_[2]||(_[2]=I=>d.value.cat_ids=I),multiple:!0,placeholder:z(t)("item.all_cat2"),options:p.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])):F("",!0)]),_:1}),e("p",fh,i(z(t)("item.member_authority_tips")),1)])]),_:1},8,["class","title"])])}}});const gh=Y(hh,[["__scopeId","data-v-072cc251"]]);function yh(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(gh,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const wh={class:"add-team-modal"},bh={class:"modal-content"},$h={class:"create-team-section"},kh={class:"create-tip"},Ch={class:"footer-buttons"},xh=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=b({team_id:""}),d=q(()=>m.value.map(n=>({label:n.team_name,value:n.id}))),p=async()=>{try{const n=await Jt();n.error_code===0&&(m.value=n.data||[])}catch(n){console.error("获取团队列表失败:",n)}},h=async()=>{await Ha(),await p()},$=async()=>{if(!f.value.team_id){j.warning(t("item.please_choose"));return}try{const n=await Gt(String(a.item_id),f.value.team_id);n.error_code===0?(j.success(t("common.op_success")),g(!0)):j.error(n.error_message||t("common.op_failed"))}catch(n){console.error("添加团队失败:",n),j.error(t("common.op_failed"))}},g=(n=!1)=>{o.value=!1,setTimeout(()=>{a.onClose(n)},300)};return ae(()=>{o.value=!0,p()}),(n,w)=>{const k=H("a-select"),r=H("a-form-item"),_=H("a-form"),v=H("TeamModal");return C(),V(Ce,null,[e("div",wh,[s(de,{class:re({show:o.value}),title:z(t)("item.add_team"),icon:["fas","fa-users"],width:"500px",onClose:g},{footer:u(()=>[e("div",Ch,[s(K,{text:z(t)("common.cancel"),theme:"light",onClick:g},null,8,["text"]),s(K,{text:z(t)("common.confirm"),theme:"dark",onClick:$},null,8,["text"])])]),default:u(()=>[e("div",bh,[s(_,{layout:"vertical"},{default:u(()=>[s(r,{label:z(t)("item.c_team")},{default:u(()=>[s(k,{value:f.value.team_id,"onUpdate:value":w[0]||(w[0]=y=>f.value.team_id=y),placeholder:z(t)("item.please_choose"),options:d.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),e("div",$h,[e("span",kh,i(z(t)("item.or_create_team")),1),e("span",{class:"create-link",onClick:h},i(z(t)("item.create_new_team")),1)])])]),_:1},8,["class","title"])]),l.value?(C(),B(v,{key:0})):F("",!0)],64)}}});const Ih=Y(xh,[["__scopeId","data-v-1831ec85"]]);function Sh(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ih,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Th={class:"team-member-authority-modal"},Mh={class:"modal-content"},Lh={key:1,class:"all-cats-text"},Vh={class:"tips-text"},zh={class:"footer-buttons"},Uh=J({__name:"index",props:{item_id:{},team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=b([]),f=[{title:t("item.member_username"),key:"member_username",width:150},{title:t("item.name"),key:"name",width:150},{title:t("item.member_authority"),key:"member_group_id",width:200},{title:t("item.catalog"),key:"cat_ids",width:200},{title:t("item.add_time"),key:"addtime",width:150}],d=async()=>{try{const n=await Kt(String(a.item_id),a.team_id);n.error_code===0&&(l.value=(n.data||[]).map(w=>({...w,cat_ids:Array.isArray(w.cat_ids)?w.cat_ids.map(k=>Number(k)):[]})))}catch(n){console.error("获取团队成员失败:",n)}},p=async()=>{try{const n=await xt(String(a.item_id));if(n.error_code===0){const w=n.data||[];w.unshift({cat_id:0,cat_name:t("item.all_cat")}),m.value=w.map(k=>({...k,cat_id:Number(k.cat_id)}))}}catch(n){console.error("获取目录列表失败:",n)}},h=async(n,w)=>{try{const k=await nt({member_group_id:n,id:w});k.error_code===0?j.success(t("item.auth_success")):j.error(k.error_message||t("common.op_failed"))}catch(k){console.error("修改权限失败:",k),j.error(t("common.op_failed"))}},$=async(n,w)=>{try{const k=await nt({cat_ids:(n||[]).join(","),id:w});k.error_code===0?j.success(t("item.cat_success")):j.error(k.error_message||t("common.op_failed"))}catch(k){console.error("修改目录失败:",k),j.error(t("common.op_failed"))}},g=()=>{a.onClose(!0)};return ae(()=>{o.value=!0,d(),p()}),(n,w)=>{const k=H("a-select-option"),r=H("a-select");return C(),V("div",Th,[s(de,{class:re({show:o.value}),title:z(t)("item.adjust_member_authority"),icon:["fas","fa-user-cog"],maxWidth:"900px",onClose:g},{footer:u(()=>[e("div",zh,[s(K,{text:z(t)("common.close"),theme:"dark",onClick:g},null,8,["text"])])]),default:u(()=>[e("div",Mh,[s(Le,{tableHeader:f,tableData:l.value,pagination:!1,maxHeight:"400px"},{"cell-member_username":u(({row:_})=>[O(i(_.member_username),1)]),"cell-name":u(({row:_})=>[O(i(_.name),1)]),"cell-member_group_id":u(({row:_})=>[s(r,{size:"small",value:_.member_group_id,"onUpdate:value":v=>_.member_group_id=v,style:{width:"100%"},onChange:v=>h(v,_.id)},{default:u(()=>[s(k,{value:"1"},{default:u(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(k,{value:"0"},{default:u(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(k,{value:"2"},{default:u(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value","onUpdate:value","onChange"])]),"cell-cat_ids":u(({row:_})=>[_.member_group_id<="1"?(C(),B(r,{key:0,size:"small",value:_.cat_ids,"onUpdate:value":v=>_.cat_ids=v,mode:"multiple",style:{width:"100%"},onChange:v=>$(v,_.id)},{default:u(()=>[(C(!0),V(Ce,null,Pe(m.value,v=>(C(),B(k,{key:v.cat_id,value:v.cat_id},{default:u(()=>[O(i(v.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(C(),V("span",Lh,i(z(t)("item.all_cat")),1))]),"cell-addtime":u(({row:_})=>[O(i(_.addtime),1)]),_:1},8,["tableData"]),e("p",Vh,i(z(t)("item.team_member_authority_tips")),1)])]),_:1},8,["class","title"])])}}});const Ph=Y(Uh,[["__scopeId","data-v-8460f41a"]]);function Ah(c,t){return new Promise(a=>{const{app:o,mountNode:l}=ve(Ph,{item_id:c,team_id:t,onClose:m=>{a(m),me(o,l)}});o.mount(l)})}const Dh={class:"member-modal"},Oh={class:"modal-content"},Nh={class:"content-wrapper"},Fh={key:0,class:"section"},qh=["onClick"],Rh={key:1,class:"section"},Hh=["onClick"],Eh=["onClick"],jh={key:2,class:"empty-tips"},Bh={class:"footer-buttons"},Gh=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=b([]),f=async()=>{try{const y=await Ta(String(a.item_id));y.error_code===0&&(l.value=y.data||[])}catch(y){console.error("获取成员列表失败:",y)}},d=async()=>{try{const y=await Ma(String(a.item_id));y.error_code===0&&(m.value=y.data||[])}catch(y){console.error("获取团队项目列表失败:",y)}},p=[{title:t("item.member_username"),key:"username",width:150},{title:t("item.name"),key:"name",width:120},{title:t("item.add_time"),key:"addtime",width:160},{title:t("item.authority"),key:"authority",width:140},{title:t("item.operation"),key:"operation",center:!0}],h=[{title:t("item.team_name"),key:"team_name",width:300},{title:t("item.add_time"),key:"addtime",width:180},{title:t("item.operation"),key:"operation",center:!0}],$=async()=>{await yh(a.item_id)&&f()},g=async()=>{await Sh(a.item_id)&&d()},n=async y=>{if(await Se({title:t("common.confirm_delete"),msg:t("item.confirm_delete_member")}))try{const x=await La(String(a.item_id),y);x.error_code===0?(j.success(t("common.op_success")),f()):j.error(x.error_message||t("common.op_failed"))}catch(x){console.error("删除成员失败:",x),j.error(t("common.op_failed"))}},w=async y=>{if(await Se({title:t("common.confirm_delete"),msg:t("item.confirm_delete_team")}))try{const x=await Wt(y);x.error_code===0?(j.success(t("common.op_success")),d()):j.error(x.error_message||t("common.op_failed"))}catch(x){console.error("删除团队失败:",x),j.error(t("common.op_failed"))}},k=async y=>{await Ah(a.item_id,y)},r=(y,S)=>y==="2"?t("item.item_admin"):y==="1"?`${t("item.edit")}/${t("item.catalog")}: ${S}`:`${t("item.readonly")}/${t("item.catalog")}: ${S}`,_=()=>{o.value=!1,setTimeout(()=>{a.onClose(!0)},300)},v=[{text:t("item.add_member"),icon:["fas","fa-plus"],onClick:$},{text:t("item.add_team"),icon:["fas","fa-plus"],onClick:g}];return ae(()=>{o.value=!0,f(),d()}),(y,S)=>{const x=H("a-divider");return C(),V("div",Dh,[s(de,{class:re({show:o.value}),title:z(t)("item.member_manage"),icon:["fas","fa-users"],headerButtons:v,width:"800px",height:"600px",onClose:_},{footer:u(()=>[e("div",Bh,[s(K,{text:z(t)("common.close"),theme:"dark",onClick:_},null,8,["text"])])]),default:u(()=>[e("div",Oh,[e("div",Nh,[l.value.length>0?(C(),V("div",Fh,[s(Le,{tableHeader:p,tableData:l.value,pagination:!1},{"cell-username":u(({row:I})=>[O(i(I.username),1)]),"cell-name":u(({row:I})=>[O(i(I.name),1)]),"cell-addtime":u(({row:I})=>[O(i(I.addtime),1)]),"cell-authority":u(({row:I})=>[O(i(r(I.member_group_id,I.cat_name)),1)]),"cell-operation":u(({row:I})=>[e("a",{class:"delete-action",onClick:T=>n(I.item_member_id)},i(z(t)("common.delete")),9,qh)]),_:1},8,["tableData"])])):F("",!0),m.value.length>0?(C(),V("div",Rh,[s(Le,{tableHeader:h,tableData:m.value,pagination:!1},{"cell-team_name":u(({row:I})=>[O(i(I.team_name),1)]),"cell-addtime":u(({row:I})=>[O(i(I.addtime),1)]),"cell-operation":u(({row:I})=>[e("a",{onClick:T=>k(I.team_id)},i(z(t)("item.member_authority")),9,Hh),s(x,{type:"vertical"}),e("a",{class:"delete-action",onClick:T=>w(I.id)},i(z(t)("common.delete")),9,Eh)]),_:1},8,["tableData"])])):F("",!0),l.value.length===0&&m.value.length===0?(C(),V("p",jh,i(z(t)("item.no_member_tips")),1)):F("",!0)])])]),_:1},8,["class","title"])])}}});const Kh=Y(Gh,[["__scopeId","data-v-c893fca8"]]);function yt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Kh,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Wh={class:"recycle-content"},Jh={class:"tips"},Yh=J({__name:"index",props:{itemId:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b([]),f=q(()=>[{title:t("item.page_title"),key:"page_title",width:180},{title:t("item.deleter"),key:"del_by_username",width:120},{title:t("item.del_time"),key:"del_time",width:150},{title:t("item.operation"),key:"action",width:80}]),d=async()=>{l.value=!0;try{const $=await yo(String(a.itemId));$&&$.data&&(m.value=$.data)}catch($){console.error("获取回收站列表失败:",$)}finally{l.value=!1}},p=async $=>{if(await Se(t("item.recover_tips"),t("common.confirm"))){l.value=!0;try{await wo(String(a.itemId),String($.page_id)),ie.success(t("common.op_success")),await d()}catch(n){console.error("恢复页面失败:",n)}finally{l.value=!1}}},h=()=>{a.onClose()};return ae(()=>{o.value=!0,d()}),($,g)=>{const n=H("a-button"),w=H("a-empty"),k=H("a-spin");return C(),B(de,{width:"900px",show:o.value,title:$.$t("item.recycle"),useClose:!0,onClose:h},{default:u(()=>[s(k,{spinning:l.value},{default:u(()=>[e("div",Wh,[e("p",Jh,i($.$t("item.recycle_tips")),1),m.value.length>0?(C(),B(Le,{key:0,tableData:m.value,tableHeader:f.value,pagination:!1,rowKey:"page_id",maxHeight:"380px"},{"cell-action":u(({row:r})=>[s(n,{type:"link",size:"small",onClick:_=>p(r)},{default:u(()=>[O(i($.$t("item.recover")),1)]),_:1},8,["onClick"])]),_:1},8,["tableData","tableHeader"])):(C(),B(w,{key:1,description:$.$t("item.recycle_empty")},null,8,["description"]))])]),_:1},8,["spinning"])]),_:1},8,["show","title"])}}});const Xh=Y(Yh,[["__scopeId","data-v-b6976406"]]);function Mt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Xh,{itemId:c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const Qh={class:"archive-modal"},Zh={class:"modal-content"},eg={class:"tips-text"},tg={class:"modal-footer"},ag=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({password:""}),m=async()=>{if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await bo(String(a.item_id),l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("归档项目失败:",d),j.error(t("common.op_failed"))}},f=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>{const h=H("a-form-item"),$=H("a-form");return C(),V("div",Qh,[s(de,{class:re({show:o.value}),title:z(t)("item.archive"),onClose:f},{default:u(()=>[e("div",Zh,[s($,{layout:"vertical"},{default:u(()=>[s(h,{label:z(t)("user.input_login_password")},{default:u(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",eg,i(z(t)("item.archive_tips")),1)]),e("div",tg,[e("div",{class:"secondary-button",onClick:f},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:m},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const og=Y(ag,[["__scopeId","data-v-946c3979"]]);function wt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(og,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const sg={class:"attorn-modal"},lg={class:"modal-content"},ng={class:"tips-text"},ig={class:"button-bar"},rg=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({username:"",password:""}),m=async()=>{if(!l.value.username){j.error(t("item.attorn_username")+t("user.required"));return}if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await $o(String(a.item_id),l.value.username,l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("转让项目失败:",d),j.error(t("common.op_failed"))}},f=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{o.value=!0}),(d,p)=>{const h=H("a-form-item"),$=H("a-form");return C(),V("div",sg,[s(de,{show:o.value,title:z(t)("item.attorn"),onClose:f},{default:u(()=>[e("div",lg,[s($,{layout:"vertical"},{default:u(()=>[s(h,{label:z(t)("item.attorn_username")},{default:u(()=>[s(ne,{modelValue:l.value.username,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.username=g),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(h,{label:z(t)("user.input_login_password")},{default:u(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[1]||(p[1]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",ng,i(z(t)("item.attorn_tips")),1),e("div",ig,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:f},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),onClick:m},null,8,["text"])])])]),_:1},8,["show","title"])])}}});const cg=Y(rg,[["__scopeId","data-v-f6bb970c"]]);function bt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(cg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const dg={class:"my-modal"},ug={class:"modal-content"},mg={class:"modal-footer"},_g=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b(void 0),f=b(""),d=b(""),p=b(!0),h=b(""),$=b([]),g=q(()=>$.value.map(_=>({label:_.item_name,value:String(_.item_id)}))),n=async()=>{try{const _=await kt();_.error_code===0?($.value=_.data||[],a.item_id&&(m.value=String(a.item_id),w(a.item_id))):j.error(_.error_message||t("common.op_failed"))}catch(_){console.error("获取项目列表失败:",_),j.error(t("common.op_failed"))}},w=_=>{const v=$.value.find(y=>String(y.item_id)===String(_));v&&(f.value=v.item_name+"--copy",d.value=v.item_description||"")},k=async()=>{if(!m.value){j.warning(t("common.please_choose"));return}if(!f.value.trim()){j.warning(t("item.copy_item_tips2"));return}if(!p.value&&!h.value.trim()){j.warning(t("item.private_item_password"));return}l.value=!0;try{const _=await Ia({copy_item_id:Number(m.value),item_name:f.value,item_description:d.value,password:p.value?"":h.value});_.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(_.error_message||t("common.op_failed"))}catch(_){console.error("复制项目失败:",_),j.error(t("common.op_failed"))}finally{l.value=!1}},r=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{n(),setTimeout(()=>{o.value=!0})}),(_,v)=>{const y=H("a-form-item"),S=H("a-radio"),x=H("a-radio-group"),I=H("a-form");return C(),V("div",dg,[s(de,{class:re({show:o.value}),title:z(t)("item.copy_item"),icon:["fa","fa-copy"],onClose:r},{default:u(()=>[e("div",ug,[s(I,{"label-col":{span:6},"wrapper-col":{span:18}},{default:u(()=>[s(y,{label:z(t)("common.source")},{default:u(()=>[s(Re,{value:m.value,"onUpdate:value":v[0]||(v[0]=T=>m.value=T),placeholder:z(t)("common.please_choose"),options:g.value,"show-search":!0,onChange:w},null,8,["value","placeholder","options"])]),_:1},8,["label"]),s(y,{label:z(t)("item.item_name")},{default:u(()=>[s(ne,{modelValue:f.value,"onUpdate:modelValue":v[1]||(v[1]=T=>f.value=T),placeholder:z(t)("item.copy_item_tips2")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(y,{label:z(t)("item.item_type")},{default:u(()=>[s(x,{value:p.value,"onUpdate:value":v[2]||(v[2]=T=>p.value=T)},{default:u(()=>[s(S,{value:!0},{default:u(()=>[O(i(z(t)("item.public_item")),1)]),_:1}),s(S,{value:!1},{default:u(()=>[O(i(z(t)("item.private_item")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),p.value?F("",!0):(C(),B(y,{key:0,label:z(t)("item.visit_password")},{default:u(()=>[s(ne,{modelValue:h.value,"onUpdate:modelValue":v[3]||(v[3]=T=>h.value=T),type:"password",placeholder:z(t)("item.input_visit_password")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]))]),_:1})]),e("div",mg,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:r},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),spinning:l.value,onClick:k},null,8,["text","spinning"])])]),_:1},8,["class","title"])])}}});const pg=Y(_g,[["__scopeId","data-v-60807128"]]);function Ea(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(pg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const fg={class:"delete-modal"},vg={class:"modal-content"},hg={class:"tips-container"},gg={class:"danger-tag"},yg={class:"modal-footer"},wg=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({password:""}),m=async()=>{if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await ko(String(a.item_id),l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("删除项目失败:",d),j.error(t("common.op_failed"))}},f=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return ae(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>{const h=H("a-form-item"),$=H("a-form");return C(),V("div",fg,[s(de,{class:re({show:o.value}),title:z(t)("item.delete_item"),onClose:f},{default:u(()=>[e("div",vg,[s($,{layout:"vertical"},{default:u(()=>[s(h,{label:z(t)("user.input_login_password")},{default:u(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("div",hg,[e("div",gg,i(z(t)("item.delete_tips")),1)])]),e("div",yg,[e("div",{class:"secondary-button",onClick:f},i(z(t)("common.cancel")),1),e("div",{class:"primary-button danger-button",onClick:m},i(z(t)("item.delete_confirm_text")),1)])]),_:1},8,["class","title"])])}}});const bg=Y(wg,[["__scopeId","data-v-faadb9a0"]]);function $t(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(bg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const $g={class:"ai-knowledge-base-modal"},kg={class:"ai-knowledge-base"},Cg={class:"function-switch-section"},xg={class:"switch-row"},Ig={key:0,class:"switch-desc"},Sg={key:0,class:"system-warning"},Tg={key:1,class:"info-warning"},Mg={key:2,class:"ai-config-section"},Lg={class:"config-form"},Vg={class:"form-row"},zg={class:"form-item"},Ug={class:"form-row"},Pg={class:"form-item full-width"},Ag={class:"form-label"},Dg={class:"form-hint"},Og={class:"form-row action-row"},Ng={key:3,class:"index-management-section"},Fg={class:"index-form"},qg={class:"index-overview"},Rg={class:"overview-item"},Hg={class:"overview-label"},Eg={class:"overview-value"},jg={key:0,class:"status-badge success"},Bg={key:1,class:"status-badge processing"},Gg={key:2,class:"status-badge warning"},Kg={key:3,class:"status-badge neutral"},Wg={key:0,class:"overview-item"},Jg={class:"overview-label"},Yg={class:"overview-value"},Xg={class:"count-number"},Qg={class:"count-unit"},Zg={key:0,class:"count-increase"},e1={key:1,class:"overview-item"},t1={class:"overview-label"},a1={class:"overview-value"},o1={key:0,class:"indexing-alert"},s1={class:"indexing-detail"},l1={key:0,class:"progress-info"},n1={key:0,class:"progress-badge"},i1={key:1,class:"index-complete-alert"},r1={class:"success-content"},c1={class:"action-row"},d1=120,u1=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b(!1),f=b(!1),d=b({enabled:!1,dialog_expanded:!1,welcome_message:""}),p=b(""),h=b({status:"unknown",document_count:0,last_update_time:null}),$=b(!1),g=b(null),n=b(0),w=b(!1),k=b(0),r=b(!1),_=async()=>{try{const A=await X("/api/item/info",{item_id:a.item_id});A.error_code===0&&A.data&&(p.value=String(A.data.item_id),A.data.ai_config?(d.value={enabled:A.data.ai_config.enabled>0,dialog_expanded:A.data.ai_config.dialog_collapsed===0,welcome_message:A.data.ai_config.welcome_message||""},m.value=A.data.ai_config.enabled>0):(m.value=A.data.ai_knowledge_base_enabled>0,d.value.enabled=A.data.ai_knowledge_base_enabled>0))}catch(A){console.error("加载项目信息失败:",A)}},v=async()=>{if(p.value||await _(),!p.value){console.error("无法获取项目ID");return}try{const A=await X("/api/ai/getIndexStatus",{item_id:String(p.value)});A.error_code===0&&A.data&&(h.value=A.data,A.data.status==="not_configured"&&A.data.message&&A.data.message.indexOf("AI 服务未配置")>-1?f.value=!1:f.value=!0)}catch(A){console.error("加载索引状态失败:",A),f.value=!1}},y=async()=>{if(p.value||await _(),!!p.value)try{const A=await X("/api/item/getAiKnowledgeBaseConfig",{item_id:String(p.value)});A.error_code===0&&A.data&&(d.value={enabled:A.data.enabled>0,dialog_expanded:A.data.dialog_collapsed===0,welcome_message:A.data.welcome_message||""},m.value=A.data.enabled>0)}catch(A){console.error("加载AI配置失败:",A)}},S=async()=>{if(!p.value){await AlertModal("无法获取项目ID");return}l.value=!0;try{const A=await X("/api/item/setAiKnowledgeBaseConfig",{item_id:String(p.value),enabled:d.value.enabled?1:0,dialog_collapsed:d.value.dialog_expanded?0:1,welcome_message:d.value.welcome_message});if(A.error_code===0){ie.success(d.value.enabled?t("ai.ai_project_enabled_success"):t("ai.ai_project_disabled_success"));const D=m.value;m.value=d.value.enabled,await y(),!D&&d.value.enabled&&(w.value=!0),d.value.enabled&&(await v(),(!D||h.value.status==="not_configured")&&setTimeout(()=>{I()},500))}else await AlertModal(A.error_message||t("ai.ai_update_failed")),await y()}catch(A){console.error("保存配置失败:",A),await AlertModal(t("ai.ai_update_failed")),await y()}finally{l.value=!1}},x=async()=>{await Se({msg:t("ai.ai_rebuild_confirm"),title:t("common.tips"),confirmText:t("common.confirm"),cancelText:t("common.cancel")})&&await I()},I=async()=>{if(!p.value){await AlertModal("无法获取项目ID");return}$.value=!0,M();try{(await X("/api/ai/rebuildIndex",{item_id:String(p.value)})).error_code===0?(ie.info(t("ai.ai_rebuild_started")),h.value.status="indexing",n.value=0,k.value=0,r.value=!1,T()):$.value=!1}catch(A){console.error("索引构建失败:",A),$.value=!1}},T=()=>{g.value&&clearInterval(g.value),L(),g.value=setInterval(()=>{L()},5e3)},M=()=>{g.value&&(clearInterval(g.value),g.value=null),n.value=0,r.value=!1},L=async()=>{if(n.value++,n.value>d1){M(),$.value=!1,ie.info("索引构建超时，请手动刷新状态");return}try{const A=await X("/api/ai/getIndexStatus",{item_id:String(p.value)});if(A.error_code===0&&A.data){const D=A.data;if(D.status==="error"){h.value=D,M(),$.value=!1;return}if(D.status==="indexed"){h.value=D,k.value=D.document_count||0,r.value=!1,M(),$.value=!1,ie.success(t("ai.ai_index_completed"));return}else if(D.status==="indexing"){const E=D.document_count||0,oe=h.value.document_count||0;E>oe?(r.value=!0,k.value=oe,setTimeout(()=>{r.value=!1},1e3)):r.value=!1,h.value=D}else h.value={...D,status:"indexing"},r.value=!1}}catch(A){console.error("轮询索引状态失败:",A)}},P=()=>{v(),ie.success(t("common.refreshed"))},N=A=>A?new Date(A*1e3).toLocaleString():"",U=()=>{o.value=!1,setTimeout(()=>{a.onClose(w.value)},300)};return ae(()=>{setTimeout(()=>{o.value=!0}),p.value=String(a.item_id),_().then(()=>{y(),v()})}),Xe(()=>{M()}),(A,D)=>{const E=H("a-tooltip"),oe=H("a-alert"),ge=H("a-divider"),fe=H("a-textarea");return C(),V("div",$g,[s(de,{class:re({show:o.value}),title:A.$t("ai.ai_knowledge_base"),width:"800",onClose:U},{footer:u(()=>[s(K,{onClick:U,size:"large"},{default:u(()=>[D[12]||(D[12]=e("i",{class:"fas fa-times"},null,-1)),e("span",null,i(A.$t("common.close")),1)]),_:1})]),default:u(()=>[e("div",kg,[e("div",Cg,[e("div",xg,[s(We,{modelValue:d.value.enabled,"onUpdate:modelValue":D[0]||(D[0]=ee=>d.value.enabled=ee),label:A.$t("ai.ai_enable_for_project"),disabled:!f.value},null,8,["modelValue","label","disabled"]),s(E,{title:A.$t("ai.ai_enable_for_project_tips")},{default:u(()=>[...D[3]||(D[3]=[e("i",{class:"fas fa-question-circle help-icon"},null,-1)])]),_:1},8,["title"])]),f.value?(C(),V("div",Ig,i(A.$t("ai.ai_enable_for_project_tips")),1)):F("",!0)]),f.value?d.value.enabled?F("",!0):(C(),V("div",Tg,[s(oe,{type:"info","show-icon":!0,message:A.$t("ai.ai_project_not_enabled")},null,8,["message"])])):(C(),V("div",Sg,[s(oe,{type:"warning","show-icon":!0,message:A.$t("ai.ai_system_not_configured")},null,8,["message"])])),f.value?(C(),V("div",Mg,[s(ge,{orientation:"left"},{default:u(()=>[O(i(A.$t("ai.ai_config")),1)]),_:1}),e("div",Lg,[e("div",Vg,[e("div",zg,[s(We,{modelValue:d.value.dialog_expanded,"onUpdate:modelValue":D[1]||(D[1]=ee=>d.value.dialog_expanded=ee),label:A.$t("ai.ai_dialog_expanded_tips")},null,8,["modelValue","label"])])]),e("div",Ug,[e("div",Pg,[e("div",Ag,i(A.$t("ai.ai_welcome_message")),1),s(fe,{value:d.value.welcome_message,"onUpdate:value":D[2]||(D[2]=ee=>d.value.welcome_message=ee),rows:4,placeholder:A.$t("ai.ai_welcome_message_placeholder")},null,8,["value","placeholder"]),e("div",Dg,i(A.$t("ai.ai_welcome_message_tips")),1)])]),e("div",Og,[s(K,{type:"primary",onClick:S,loading:l.value,size:"large"},{default:u(()=>[D[4]||(D[4]=e("i",{class:"fas fa-save"},null,-1)),e("span",null,i(A.$t("common.save")),1)]),_:1},8,["loading"])])])])):F("",!0),f.value&&m.value?(C(),V("div",Ng,[s(ge,{orientation:"left"},{default:u(()=>[O(i(A.$t("ai.ai_index_management")),1)]),_:1}),e("div",Fg,[e("div",qg,[e("div",Rg,[e("div",Hg,i(A.$t("ai.ai_index_status")),1),e("div",Eg,[h.value.status==="indexed"?(C(),V("div",jg,[D[5]||(D[5]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",null,i(A.$t("ai.ai_indexed")),1)])):h.value.status==="indexing"?(C(),V("div",Bg,[D[6]||(D[6]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(A.$t("ai.ai_indexing")),1)])):h.value.status==="not_configured"?(C(),V("div",Gg,[D[7]||(D[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,i(A.$t("ai.ai_not_configured")),1)])):(C(),V("div",Kg,[D[8]||(D[8]=e("i",{class:"fas fa-info-circle"},null,-1)),e("span",null,i(A.$t("ai.ai_unknown_status")),1)]))])]),h.value.document_count!==void 0?(C(),V("div",Wg,[e("div",Jg,i(A.$t("ai.ai_chunk_count")),1),e("div",Yg,[e("span",Xg,i(h.value.document_count),1),e("span",Qg,i(A.$t("ai.ai_chunks")),1),r.value&&h.value.document_count>k.value?(C(),V("span",Zg," +"+i(h.value.document_count-k.value),1)):F("",!0)])])):F("",!0),h.value.last_update_time?(C(),V("div",e1,[e("div",t1,i(A.$t("ai.ai_last_update")),1),e("div",a1,i(N(h.value.last_update_time)),1)])):F("",!0)]),h.value.status==="indexing"?(C(),V("div",o1,[s(oe,{type:"info","show-icon":!0,message:A.$t("ai.ai_indexing_alert_title")},null,8,["message"]),e("div",s1,[e("p",null,i(A.$t("ai.ai_indexing_alert_message")),1),h.value.document_count!==void 0?(C(),V("div",l1,[D[9]||(D[9]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(A.$t("ai.ai_indexing_progress_info",{count:h.value.document_count})),1),r.value&&h.value.document_count>k.value?(C(),V("span",n1," +"+i(h.value.document_count-k.value),1)):F("",!0)])):F("",!0)])])):F("",!0),h.value.status==="indexed"&&h.value.document_count>0?(C(),V("div",i1,[s(oe,{type:"success","show-icon":!0,message:A.$t("ai.ai_indexed_ready_title")},null,8,["message"]),e("div",r1,i(A.$t("ai.ai_indexed_ready_message")),1)])):F("",!0),e("div",c1,[s(K,{type:"primary",onClick:x,loading:$.value,disabled:h.value.status==="not_configured",size:"large"},{default:u(()=>[D[10]||(D[10]=e("i",{class:"fas fa-sync-alt"},null,-1)),e("span",null,i(A.$t("ai.ai_rebuild_index")),1)]),_:1},8,["loading","disabled"]),s(K,{onClick:P,size:"large"},{default:u(()=>[D[11]||(D[11]=e("i",{class:"fas fa-redo"},null,-1)),e("span",null,i(A.$t("common.refresh")),1)]),_:1})])])])):F("",!0)])]),_:1},8,["class","title"])])}}});const m1=Y(u1,[["__scopeId","data-v-8bbc07ea"]]);function la(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(m1,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const _1={class:"my-modal"},p1={class:"open-api-container"},f1={class:"tips-section"},v1=["innerHTML"],h1=["innerHTML"],g1=["innerHTML"],y1=["innerHTML"],w1=["innerHTML"],b1=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(""),m=b(""),f=async()=>{try{const h=await Co(String(a.item_id));h.error_code===0?(l.value=h.data.api_key||"",m.value=h.data.api_token||""):j.error(h.error_message||t("common.op_failed"))}catch(h){console.error("获取 API 密钥失败:",h),j.error(t("common.op_failed"))}},d=async()=>{if(await Se(t("item.confirm_reset_token")))try{const $=await xo(String(a.item_id));$.error_code===0?(j.success(t("common.op_success")),await f()):j.error($.error_message||t("common.op_failed"))}catch($){console.error("重置 API Token 失败:",$),j.error(t("common.op_failed"))}},p=()=>{o.value=!1,setTimeout(()=>{a.onClose(!0)},300)};return ae(()=>{f(),setTimeout(()=>{o.value=!0})}),(h,$)=>{const g=H("a-input"),n=H("a-form-item"),w=H("a-form");return C(),V("div",_1,[s(de,{class:re({show:o.value}),title:z(t)("item.open_api"),icon:["fa","fa-plug"],onClose:p},{default:u(()=>[e("div",p1,[s(w,{"label-col":{span:6},"wrapper-col":{span:18}},{default:u(()=>[s(n,{label:z(t)("item.api_key_label")},{default:u(()=>[s(g,{value:l.value,"onUpdate:value":$[0]||($[0]=k=>l.value=k),readonly:!0},null,8,["value"])]),_:1},8,["label"]),s(n,{label:z(t)("item.api_token_label")},{default:u(()=>[s(g,{value:m.value,"onUpdate:value":$[1]||($[1]=k=>m.value=k),readonly:!0},null,8,["value"])]),_:1},8,["label"]),s(n,{"wrapper-col":{span:18,offset:6}},{default:u(()=>[s(K,{text:z(t)("item.reset_token"),theme:"dark",onClick:d},null,8,["text"])]),_:1})]),_:1}),e("div",f1,[e("p",{innerHTML:z(t)("item.open_api_tips1")},null,8,v1),e("p",{innerHTML:z(t)("item.open_api_tips2")},null,8,h1),e("p",{innerHTML:z(t)("item.open_api_tips3")},null,8,g1),e("p",{innerHTML:z(t)("item.open_api_tips4")},null,8,y1),e("p",{innerHTML:z(t)("item.open_api_tips5")},null,8,w1)])])]),_:1},8,["class","title"])])}}});const $1=Y(b1,[["__scopeId","data-v-551d32ec"]]);function na(c){return new Promise(t=>{const{app:a,mountNode:o}=ve($1,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const k1={class:"item-list"},C1={class:"item-list-container"},x1=["data-key","onClick"],I1={class:"left float-left"},S1={key:0,class:"item-icon fas fa-file"},T1={key:1,class:"item-icon fas fa-table"},M1={key:2,class:"item-icon fas fa-terminal"},L1={key:3,class:"item-icon fas fa-notes"},V1={key:4,class:"star-flag fas fa-star v3-color-yellow"},z1=J({__name:"ItemList",props:{itemList:{},getItemList:{type:Function},itemGroupId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),m=b({item_domain:"",item_id:0}),f=M=>{const L=[{icon:["fas","fa-right-to-bracket"],text:t("item.open_item"),value:"open"},{icon:["fas","fa-share-nodes"],text:t("item.share_project"),value:"share"},M.is_star>0?{icon:["fas","fa-star"],text:t("item.unstar_item"),value:"unstar"}:{icon:["far","fa-star"],text:t("item.star_item"),value:"star"}];return M.manage!=1&&L.push({icon:["fas","fa-trash"],text:t("item.item_exit"),value:"exit"}),M.manage==1&&(L.push({icon:["fas","fa-edit"],text:t("item.update_base_info"),value:"update"},{icon:["far","fa-users"],text:t("item.member_manage"),value:"member"},{icon:["fas","fa-plug"],text:t("item.open_api"),value:"open_api"}),(M.item_type=="1"||M.item_type==1)&&L.push({icon:["fas","fa-brain"],text:t("ai.ai_knowledge_base"),value:"ai_knowledge_base"}),L.push({icon:["fas","fa-trash"],text:t("item.recycle"),value:"recycle"},{icon:["fas","fa-recycle"],text:t("item.attorn"),value:"attorn"},{icon:["fas","fa-copy"],text:t("item.copy_item"),value:"copy"},{icon:["fas","fa-box-archive"],text:t("item.archive"),value:"archive"},{icon:["fas","fa-trash-can"],text:t("item.delete_item"),value:"delete"})),L},d=async(M,L)=>{switch(L){case"open":p(M);break;case"share":$(M);break;case"star":case"unstar":h(M);break;case"exit":x(M.item_id);break;case"update":g(M);break;case"member":n(M);break;case"open_api":w(M);break;case"ai_knowledge_base":k(M);break;case"recycle":r(M);break;case"attorn":v(M);break;case"copy":y(M);break;case"archive":_(M);break;case"delete":S(M);break}},p=M=>{const L="/"+(M.item_domain?M.item_domain:M.item_id);a.push({path:L})},h=async M=>{const L=M.is_star,P=M.item_id;L>0?(await za(P),M.is_star=0,ie.success(t("common.op_success"))):(await Ua(P),M.is_star=1,ie.success(t("common.op_success")))},$=async M=>{await gt({item_domain:M.item_domain,item_id:M.item_id})},g=async M=>{await at({item_id:M.item_id})&&await o.getItemList()},n=async M=>{m.value=M,await yt(M.item_id),await o.getItemList()},w=async M=>{await na(M.item_id)},k=async M=>{await la(M.item_id),window.location.reload()},r=async M=>{await Mt(M.item_id)},_=async M=>{await wt(M.item_id)&&await o.getItemList()},v=async M=>{await bt(M.item_id)&&await o.getItemList()},y=async M=>{await Ea(M.item_id)&&await o.getItemList()},S=async M=>{await $t(M.item_id)&&await o.getItemList()},x=async M=>{await Pa(String(M)),ie.success(t("common.op_success"))},I=async({oldIndex:M,newIndex:L})=>{if(M===L)return;const P=document.querySelector(".item-list-container"),N=P==null?void 0:P.children;if(!N)return;const U={};for(let A=0;A<N.length;A++){const E=N[A].dataset.key;E&&(U[E]=A+1)}try{await Va(U,o.itemGroupId),ie.success(t("common.op_success")),await o.getItemList()}catch(A){console.error("Sort item failed:",A),await G(t("common.op_failed")),await o.getItemList()}};let T=null;return ae(()=>{const M=document.querySelector(".item-list-container");M&&(T=Fa.create(M,{animation:200,ghostClass:"sortable-ghost",dragClass:"sortable-drag",chosenClass:"sortable-chosen",onEnd:L=>{const{newIndex:P,oldIndex:N}=L;N!==P&&P!==null&&I({oldIndex:N,newIndex:P})}}))}),Xe(()=>{T&&T.destroy()}),(M,L)=>{const P=H("a-spin");return C(),V("div",k1,[s(P,{spinning:l.value,style:{width:"100%"}},{default:u(()=>[e("div",C1,[(C(!0),V(Ce,null,Pe(c.itemList,N=>(C(),V("div",{key:N.item_id,"data-key":N.item_id,onClick:U=>p(N),class:re(["item-list-one",N.item_type=="1"||N.item_type=="3"?"shadow-hover":""])},[e("div",{class:re(["item-list-one-block",N.item_type=="1"||N.item_type=="3"?"":"shadow-hover"])},[e("div",I1,[N.item_type=="2"?(C(),V("i",S1)):N.item_type=="4"?(C(),V("i",T1)):N.item_type=="3"?(C(),V("i",M1)):(C(),V("i",L1)),N.is_star>0?(C(),V("i",V1)):F("",!0),O(" "+i(N.item_name),1)]),e("div",{class:"right show-more float-right",onClick:lt(()=>{},["stop"])},[s(ut,{list:f(N),trigger:"hover",placement:"right",offsetX:20,onSelect:U=>d(N,U.value)},{default:u(()=>[...L[0]||(L[0]=[e("span",{class:"el-dropdown-link"},[e("i",{class:"item-icon-more fas fa-ellipsis"})],-1)])]),_:1},8,["list","onSelect"])])],2),e("div",{class:re(["item-list-one-block-bg",N.item_type=="1"||N.item_type=="3"?"":"item-list-one-block-bg-none"])},null,2)],10,x1))),128))])]),_:1},8,["spinning"])])}}});const U1=Y(z1,[["__scopeId","data-v-ec5be99b"]]),P1={class:"item-card-list"},A1={class:"card-container"},D1=["onClick"],O1={class:"item-card-header"},N1={class:"item-icon-wrapper"},F1={key:0,class:"item-icon fas fa-file"},q1={key:1,class:"item-icon fas fa-table"},R1={key:2,class:"item-icon fas fa-terminal"},H1={key:3,class:"item-icon fas fa-chalkboard"},E1={key:4,class:"item-icon fas fa-book"},j1={class:"item-card-title"},B1={class:"item-card-footer"},G1={class:"item-meta"},K1={key:0,class:"meta-item"},W1=J({__name:"ItemCardList",props:{itemList:{},getItemList:{type:Function},itemGroupId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b({}),m=P=>{const N=[{icon:["fas","fa-right-to-bracket"],text:t("item.open_item"),value:"open"},{icon:["fas","fa-share-nodes"],text:t("item.share_project"),value:"share"},P.is_star>0?{icon:["fas","fa-star"],text:t("item.unstar_item"),value:"unstar"}:{icon:["far","fa-star"],text:t("item.star_item"),value:"star"}];return P.manage!=1&&N.push({icon:["fas","fa-trash"],text:t("item.item_exit"),value:"exit"}),P.manage==1&&(N.push({icon:["fas","fa-edit"],text:t("item.update_base_info"),value:"update"},{icon:["far","fa-users"],text:t("item.member_manage"),value:"member"},{icon:["fas","fa-plug"],text:t("item.open_api"),value:"open_api"}),(P.item_type=="1"||P.item_type==1)&&N.push({icon:["fas","fa-brain"],text:t("ai.ai_knowledge_base"),value:"ai_knowledge_base"}),N.push({icon:["fas","fa-trash"],text:t("item.recycle"),value:"recycle"},{icon:["fas","fa-recycle"],text:t("item.attorn"),value:"attorn"},{icon:["fas","fa-copy"],text:t("item.copy_item"),value:"copy"},{icon:["fas","fa-box-archive"],text:t("item.archive"),value:"archive"},{icon:["fas","fa-trash-can"],text:t("item.delete_item"),value:"delete"})),N},f=async(P,N)=>{switch(N){case"open":d(P);break;case"share":h(P);break;case"star":case"unstar":p(P);break;case"exit":S(P.item_id);break;case"update":$(P);break;case"member":g(P);break;case"open_api":n(P);break;case"ai_knowledge_base":w(P);break;case"recycle":k(P);break;case"attorn":_(P);break;case"copy":v(P);break;case"archive":r(P);break;case"delete":y(P);break}},d=P=>{const N="/"+(P.item_domain?P.item_domain:P.item_id);a.push({path:N})},p=async P=>{const N=P.is_star,U=P.item_id;N>0?(await za(U),P.is_star=0,ie.success(t("common.op_success"))):(await Ua(U),P.is_star=1,ie.success(t("common.op_success")))},h=async P=>{await gt({item_domain:P.item_domain,item_id:P.item_id})},$=async P=>{await at({item_id:P.item_id})&&await o.getItemList()},g=async P=>{l.value=P,await yt(P.item_id),await o.getItemList()},n=async P=>{await na(P.item_id)},w=async P=>{await la(P.item_id),window.location.reload()},k=async P=>{await Mt(P.item_id)},r=async P=>{await wt(P.item_id)&&await o.getItemList()},_=async P=>{await bt(P.item_id)&&await o.getItemList()},v=async P=>{await Ea(P.item_id)&&await o.getItemList()},y=async P=>{await $t(P.item_id)&&await o.getItemList()},S=async P=>{await Pa(String(P)),ie.success(t("common.op_success"))},x=(P,N)=>{const U=P?Number(P):0,A=N?Number(N):0;return!U&&!A?0:U?A?Math.max(U,A):U:A},I=P=>{if(P===0||!P)return"";const U=Date.now()/1e3-P;if(U<3600){const fe=Math.floor(U/60);return fe<=1?t("time.just_now"):t("time.minutes_ago",{n:fe})}if(U<86400){const fe=Math.floor(U/3600);return t("time.hours_ago",{n:fe})}if(U<604800){const fe=Math.floor(U/86400);return t("time.days_ago",{n:fe})}const A=new Date(P*1e3),D=A.getFullYear(),E=String(A.getMonth()+1).padStart(2,"0"),oe=String(A.getDate()).padStart(2,"0"),ge=new Date().getFullYear();return D===ge?`${E}-${oe}`:`${D}-${E}-${oe}`},T=P=>({1:t("item.type_regular"),2:t("item.type_single"),3:t("item.type_runapi"),4:t("item.type_table"),5:t("item.type_whiteboard")})[String(P)]||t("item.type_regular"),M=async({oldIndex:P,newIndex:N})=>{if(P===N)return;const U=document.querySelector(".draggable-container"),A=U==null?void 0:U.children;if(!A)return;const D={};for(let E=0;E<A.length;E++){const ge=A[E].dataset.key;ge&&(D[ge]=E+1)}try{await Va(D,o.itemGroupId),ie.success(t("common.op_success")),await o.getItemList()}catch(E){console.error("Sort item failed:",E),await G(t("common.op_failed")),await o.getItemList()}};let L=null;return ae(()=>{const P=document.querySelector(".draggable-container");P&&(L=Fa.create(P,{animation:200,ghostClass:"sortable-ghost",dragClass:"sortable-drag",chosenClass:"sortable-chosen",onEnd:N=>{const{newIndex:U,oldIndex:A}=N;A!==U&&U!==null&&M({oldIndex:A,newIndex:U})}}))}),Xe(()=>{L&&L.destroy()}),(P,N)=>{const U=H("a-col"),A=H("a-row");return C(),V("div",P1,[e("div",A1,[s(A,{gutter:[24,24],class:"draggable-container"},{default:u(()=>[(C(!0),V(Ce,null,Pe(c.itemList,D=>(C(),B(U,{xs:24,sm:12,md:12,lg:8,xl:8,key:D.item_id,"data-key":D.item_id},{default:u(()=>[e("div",{class:re(["item-card",{"is-starred":D.is_star>0}]),onClick:E=>d(D)},[D.is_star>0?(C(),V("div",{key:0,class:"star-corner",onClick:N[0]||(N[0]=lt(()=>{},["stop"]))},[...N[2]||(N[2]=[e("i",{class:"fas fa-star"},null,-1)])])):F("",!0),e("div",O1,[e("div",N1,[D.item_type=="2"?(C(),V("i",F1)):D.item_type=="4"?(C(),V("i",q1)):D.item_type=="3"?(C(),V("i",R1)):D.item_type=="5"?(C(),V("i",H1)):(C(),V("i",E1))]),e("div",j1,i(D.item_name),1),e("div",{class:"item-card-actions",onClick:N[1]||(N[1]=lt(()=>{},["stop"]))},[s(ut,{list:m(D),trigger:"hover",placement:"right",offsetX:20,onSelect:E=>f(D,E.value)},{default:u(()=>[...N[3]||(N[3]=[e("span",{class:"action-trigger"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["list","onSelect"])])]),e("div",B1,[e("div",G1,[x(D.last_update_time,D.addtime)?(C(),V("span",K1,[N[4]||(N[4]=e("i",{class:"far fa-clock"},null,-1)),O(" "+i(I(x(D.last_update_time,D.addtime))),1)])):F("",!0)]),e("div",{class:re(["item-type-badge",`type-${D.item_type}`])},i(T(D.item_type)),3)])],10,D1)]),_:2},1032,["data-key"]))),128))]),_:1})])])}}});const J1=Y(W1,[["__scopeId","data-v-072031e7"]]),Y1={class:"page"},X1={class:"item-list"},Q1=["onClick"],Z1={class:"left float-left"},e0={class:"item-page-content"},t0=["onClick"],a0={class:"search-content break-all"},o0={key:0,class:"loading-indicator"},s0=J({__name:"Search",props:{keyword:{},itemList:{}},setup(c){const t=xe(),a=c,o=b(!1),l=b([]),m=b([]);qe(()=>a.keyword,h=>{l.value=[],l.value.push(h),m.value=[],f()});const f=async()=>{o.value=!0;for(let h=0;h<a.itemList.length;h++){const $=a.itemList[h];let g=0,n=0,w=[];$&&$.item_name&&$.item_name.indexOf(a.keyword)>-1&&(g=1);try{const r=(await Io(a.keyword,$.item_id)).data;r&&r.pages&&r.pages.length>0&&(n=1,w=r.pages)}catch(k){console.error("Search item failed:",k)}(g||n)&&m.value.push({...$,pages:w})}o.value=!1},d=h=>{const $="/"+(h.item_domain?h.item_domain:h.item_id),g=t.resolve({path:$});window.open(g.href,"_blank")},p=h=>{const $="/"+h.item_id+"/"+h.page_id,g=t.resolve({path:$});window.open(g.href,"_blank")};return ae(()=>{l.value=[],l.value.push(a.keyword),f()}),(h,$)=>{const g=H("a-spin"),n=H("a-empty");return C(),V("div",Y1,[e("div",X1,[(C(!0),V(Ce,null,Pe(m.value,w=>(C(),V("div",{class:"item-list-one",key:w.item_id},[e("div",{class:"item-title",onClick:k=>d(w)},[e("div",Z1,[$[0]||($[0]=e("i",{class:"item-icon fas fa-file"},null,-1)),s(Ot,{queries:l.value},{default:u(()=>[O(i(w.item_name),1)]),_:2},1032,["queries"])])],8,Q1),e("div",e0,[(C(!0),V(Ce,null,Pe(w.pages,k=>(C(),V("div",{key:k.page_id},[e("div",{onClick:r=>p(k),class:"page-title"},[$[1]||($[1]=e("i",{class:"item-icon fas fa-file"},null,-1)),s(Ot,{queries:l.value},{default:u(()=>[O(i(k.page_title),1)]),_:2},1032,["queries"])],8,t0),e("div",a0,[s(Ot,{queries:l.value},{default:u(()=>[O(i(k.search_content),1)]),_:2},1032,["queries"])])]))),128))])]))),128)),o.value?(C(),V("div",o0,[s(g),e("span",null,i(h.$t("common.searching")),1)])):F("",!0)]),m.value.length===0&&!o.value?(C(),B(n,{key:0,description:h.$t("item.search_no_results")},null,8,["description"])):F("",!0)])}}});const l0=Y(s0,[["__scopeId","data-v-d4041ad6"]]),n0={class:"import-openapi-modal"},i0={class:"modal-content"},r0={class:"tips-container"},c0={class:"tips"},d0=["innerHTML"],u0={class:"tips"},m0=["innerHTML"],_0={class:"tips"},p0=["innerHTML"],f0={class:"tips"},v0=["innerHTML"],h0={class:"tips"},g0=["innerHTML"],y0={class:"modal-footer"},w0=J({__name:"index",props:{onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=()=>{a.value=!1,setTimeout(()=>{t.onClose(!1)},300)};return ae(async()=>{setTimeout(()=>{a.value=!0})}),(l,m)=>(C(),V("div",n0,[s(de,{class:re({show:a.value}),title:l.$t("item.open_api"),icon:["fas","fa-terminal"],onClose:o},{default:u(()=>[e("div",i0,[e("div",r0,[e("p",c0,[e("span",{innerHTML:l.$t("item.open_api_tips1")},null,8,d0)]),e("p",u0,[e("span",{innerHTML:l.$t("item.open_api_tips2")},null,8,m0)]),e("p",_0,[e("span",{innerHTML:l.$t("item.open_api_tips3")},null,8,p0)]),e("p",f0,[e("span",{innerHTML:l.$t("item.open_api_tips4")},null,8,v0)]),e("p",h0,[e("span",{innerHTML:l.$t("item.open_api_tips5")},null,8,g0)])])]),e("div",y0,[e("div",{class:"secondary-button",onClick:o},i(l.$t("common.cancel")),1)])]),_:1},8,["class","title"])]))}});const b0=Y(w0,[["__scopeId","data-v-fbba83f6"]]);function $0(){return new Promise(c=>{const{app:t,mountNode:a}=ve(b0,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const k0={class:"import-file-modal"},C0={class:"modal-content"},x0={class:"tips"},I0=["innerHTML"],S0={class:"upload-area"},T0={class:"upload-text"},M0=["innerHTML"],L0={key:0,class:"loading-overlay"},V0={class:"modal-footer"},z0=J({__name:"index",props:{onClose:{type:Function},itemId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),m=b(!1),f=Qt(),d=b({user_token:(f==null?void 0:f.user_token)||"",item_id:o.itemId||""}),p=q(()=>ot()+"/api/import/auto"),h=n=>(m.value=!0,!0),$=n=>{if(n.file.status==="done"){const w=n.file.response;w&&w.error_code===0?(ie.success(t("common.op_success")),m.value=!1,g(!0)):(m.value=!1,G((w==null?void 0:w.error_message)||t("common.op_failed")))}else n.file.status==="error"?(m.value=!1,G(t("common.op_failed"))):n.file.status==="uploading"&&(m.value=!0)},g=(n=!1)=>{l.value=!1,setTimeout(()=>{o.onClose(n),n&&(o.itemId&&o.itemId>0?window.location.reload():a.push({path:"/item/index"}))},300)};return ae(async()=>{setTimeout(()=>{l.value=!0})}),(n,w)=>{const k=H("a-upload");return C(),V("div",k0,[s(de,{class:re({show:l.value}),title:n.$t("item.import_file"),icon:["fa","fa-upload"],onClose:g},{default:u(()=>[e("div",C0,[e("p",x0,[e("span",{class:"tips-text",innerHTML:n.$t("item.import_file_tips1")},null,8,I0)]),e("div",S0,[s(k,{data:d.value,class:"upload-demo",action:p.value,"before-upload":h,"show-upload-list":!1,onChange:$,disabled:m.value,drag:""},{default:u(()=>[e("div",{class:re(["upload-content",{"is-loading":m.value}])},[w[2]||(w[2]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",T0,[e("span",{innerHTML:n.$t("item.import_file_tips2")},null,8,M0)]),m.value?(C(),V("div",L0,[w[1]||(w[1]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(n.$t("common.uploading")||"文件上传和导入中，请稍候..."),1)])):F("",!0)],2)]),_:1},8,["data","action","disabled"])])]),e("div",V0,[e("div",{class:"secondary-button",onClick:w[0]||(w[0]=()=>g(!1))},i(n.$t("common.cancel")),1)])]),_:1},8,["class","title"])])}}});const U0=Y(z0,[["__scopeId","data-v-5a4b06c9"]]);function ja(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(U0,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const P0={class:"create-item-btn-div"},A0={class:"left"},D0={class:"right"},O0=J({__name:"ItemAdd",props:{itemGroupId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=async()=>{await at({item_type:"1",item_group_id:a.itemGroupId})&&a.callback()},m=async()=>{await at({item_type:"2",item_group_id:a.itemGroupId})&&a.callback()},f=async()=>{await at({item_type:"4",item_group_id:a.itemGroupId})&&a.callback()},d=async()=>{await at({item_type:"5",item_group_id:a.itemGroupId})&&a.callback()},p=async()=>{await ja()&&a.callback()},h=async()=>{await $0()&&a.callback()};return o.value=[{group_name:t("item.create"),listMenu:[{title:t("item.regular_item"),icon:"fas fa-notes",desc:t("item.regular_item_desc"),method:l},{title:t("item.single_item"),icon:"fas fa-file",desc:t("item.single_item_desc"),method:m},{title:t("item.table_item"),icon:"fas fa-table",desc:t("item.table_item_desc"),method:f},{title:t("item.whiteboard_item"),icon:"fas fa-pen",desc:t("item.whiteboard_item_desc"),method:d}]},{group_name:t("item.import"),listMenu:[{title:t("item.import_file"),icon:"fas fa-upload",desc:t("item.import_file_desc"),method:p},{title:t("item.auto_create"),icon:"fas fa-terminal",desc:t("item.auto_create_desc"),method:h}]}],($,g)=>(C(),V("div",P0,[e("div",A0,[e("div",{onClick:l,class:"create-item-left-btn"},[g[0]||(g[0]=e("i",{class:"mr-3 fas fa-plus"},null,-1)),e("span",null,i(z(t)("item.create_new_item")),1)])]),e("div",D0,[s(Oa,{title:z(t)("item.create_new_item"),titleIcon:"fas fa-plus",menuListGroup:o.value,placement:"top"},{default:u(()=>[...g[1]||(g[1]=[e("div",{class:"create-item-right-btn"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["title","menuListGroup"])])]))}});const N0=Y(O0,[["__scopeId","data-v-4281ad9d"]]),F0={class:"item-group-modal"},q0={class:"modal-content"},R0={key:0,class:"tips"},H0={class:"group-info"},E0={class:"group-name"},j0={class:"group-actions"},B0={class:"modal-footer"},G0={class:"edit-modal-content"},K0={class:"form-group"},W0={class:"form-label"},J0={class:"item-selection"},Y0={class:"selection-title"},X0={class:"modal-footer"},Q0=J({__name:"ItemGroup",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({id:"",group_name:""}),m=b([]),f=b(!1),d=b([]),p=b([]),h=q(()=>[{title:t("item.item_name"),key:"item_name",width:300}]),$=q(()=>({selectedRowKeys:p.value,onChange:I=>{p.value=I}})),g=(I,T)=>{p.value=I},n=()=>{l.value={id:"",group_name:""},p.value=[],f.value=!0},w=q(()=>[{text:t("item.add_group"),icon:"fas fa-plus",type:"default",size:"small",onClick:n}]),k=async()=>{try{const I=await Xt();I&&I.data&&(m.value=I.data)}catch(I){console.error("Get group list failed:",I)}},r=async()=>{try{const I=await kt(0);I&&I.data&&(d.value=I.data)}catch(I){console.error("Get item list failed:",I)}},_=async()=>{const I=l.value.group_name||"default",T=l.value.id,M=p.value.join(",");try{await So({group_name:I,id:T,item_ids:M}),await k(),f.value=!1,p.value=[],l.value={id:"",group_name:""},ie.success(t("common.op_success"))}catch(L){console.error("Save group failed:",L),await G(t("common.error"))}},v=I=>{l.value.id=I.id,l.value.group_name=I.group_name,p.value=[],(I.item_ids?I.item_ids.split(","):[]).forEach(M=>{const L=d.value.find(P=>String(P.item_id)===M);L&&p.value.push(L.item_id)}),f.value=!0},y=async I=>{if(await Se({title:t("common.confirm"),msg:t("common.confirm_delete"),confirmText:t("common.confirm"),cancelText:t("common.cancel")}))try{await To({id:I}),await k(),ie.success(t("common.op_success"))}catch(M){console.error("Delete group failed:",M),await G(t("common.error"))}},S=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)},x=async({oldIndex:I,newIndex:T})=>{const M=m.value[I];m.value.splice(I,1),m.value.splice(T,0,M);const L=m.value.map((P,N)=>({id:P.id,s_number:N+1}));try{await Mo({groups:JSON.stringify(L)}),a.callback()}catch(P){console.error("Save group sort failed:",P)}};return ae(async()=>{setTimeout(()=>{o.value=!0}),await r(),await k()}),(I,T)=>{const M=H("a-empty"),L=H("a-button");return C(),V("div",F0,[s(de,{class:re({show:o.value}),title:I.$t("item.manage_item_group"),headerButtons:w.value,onClose:S},{default:u(()=>[e("div",q0,[m.value&&m.value.length>1?(C(),V("p",R0,i(z(t)("item.draggable_tips")),1)):F("",!0),s(vs,{handle:".group-item",listClass:"group-list",animate:200,onDrop:x},{default:u(()=>[!m.value||m.value.length===0?(C(),B(M,{key:0,description:z(t)("item.item_group_empty_tips")},null,8,["description"])):F("",!0),(C(!0),V(Ce,null,Pe(m.value,P=>(C(),V("div",{key:P.id,class:"group-item"},[e("div",H0,[T[3]||(T[3]=e("i",{class:"fas fa-bars handle-icon"},null,-1)),e("span",E0,i(P.group_name),1)]),e("div",j0,[s(L,{type:"link",size:"small",onClick:N=>v(P)},{default:u(()=>[O(i(z(t)("common.edit")),1)]),_:1},8,["onClick"]),s(L,{type:"link",size:"small",danger:"",onClick:N=>y(P.id)},{default:u(()=>[O(i(z(t)("common.delete")),1)]),_:1},8,["onClick"])])]))),128))]),_:1})]),e("div",B0,[e("div",{class:"secondary-button",onClick:S},i(z(t)("common.close")),1)])]),_:1},8,["class","title","headerButtons"]),f.value?(C(),B(de,{key:0,class:re({show:f.value}),title:l.value.id?z(t)("item.edit_group"):z(t)("item.add_group"),onClose:T[2]||(T[2]=P=>f.value=!1)},{default:u(()=>[e("div",G0,[e("div",K0,[e("label",W0,i(z(t)("item.group_name"))+":",1),s(ne,{modelValue:l.value.group_name,"onUpdate:modelValue":T[0]||(T[0]=P=>l.value.group_name=P),placeholder:z(t)("item.group_name")},null,8,["modelValue","placeholder"])]),e("div",J0,[e("p",Y0,i(z(t)("item.select_item")),1),s(Le,{"table-header":h.value,"table-data":d.value,"row-selection":$.value,"row-key":"item_id",pagination:!1,"max-height":"400px",onSelectionChange:g},{"cell-item_name":u(({value:P})=>[O(i(P),1)]),_:1},8,["table-header","table-data","row-selection"])])]),e("div",X0,[e("div",{class:"secondary-button",onClick:T[1]||(T[1]=P=>f.value=!1)},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:_},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])):F("",!0)])}}});const Z0=Y(Q0,[["__scopeId","data-v-d5834eae"]]),ey={class:"item-home"},ty={class:"header"},ay={class:""},oy={class:"v3-color-aux logo-desc"},sy={class:"left-side"},ly={class:"all-star-item-group"},ny={class:"item-one-block-content"},iy={class:"item-one-block-content"},ry={class:"item-one-block-content"},cy={class:"divider-item-block"},dy={class:"divider-text"},uy=["onClick"],my={class:"item-one-block-content"},_y={key:0,class:"left-bottom-bar"},py={class:"content"},fy={class:"right-side"},vy={class:"search-and-view-control"},hy={class:"search-box-div"},gy={class:"search-box"},yy={class:"divider-item-block mt-3 mb-3"},wy={class:"divider-text"},by={class:"view-switcher"},$y={key:2,class:"loading-container"},ky=J({__name:"Index",setup(c){const{t,locale:a}=te(),o=xe(),l=Qe();b(new Date);const m=b([]),f=b(!1),d=b(""),p=b(!1),h=b(0),$=b([]),g=b(!1),n=b("card"),w=b(!1),k=b(!1),r=q(()=>{if(d.value)return a.value==="en-US"?`Search results with "${d.value}"`:`含有"${d.value}"的搜索结果`;if(h.value===0)return t("item.all_items");if(h.value===-1)return t("item.star_items");const L=$.value.find(P=>parseInt(P.id)==h.value);return L?L.group_name:""});qe(d,L=>{if(L)if(L&&L.length===1){var P=new RegExp("[一-龥]+");P.test(L)&&(p.value=!0)}else p.value=!0;else p.value=!1}),qe(n,L=>{localStorage.setItem("defaultViewMode",L)});const _=async()=>{k.value=!0;try{const L=await kt(h.value);L&&L.data&&(m.value=L.data)}finally{k.value=!1}},v=async()=>{const L=await Xt();if(L&&L.data){$.value=L.data;const P=localStorage.getItem("deaultItemGroupId");$.value.forEach(N=>{N.id==P&&(h.value=parseInt(P))}),_()}},y=L=>{h.value=L,localStorage.setItem("deaultItemGroupId",String(L)),p.value=!1,d.value="",_()},S=()=>{window.location.reload()},x=async()=>{try{await I()}catch(L){console.error("Refresh user info failed:",L)}},I=async()=>{try{const L=await X("/api/user/info",{});L&&L.error_code===0&&L.data.groupid==1&&(f.value=!0)}catch(L){console.error("Fetch user info failed:",L)}},T=L=>{window.open(L)},M=()=>{o.push({path:"/public-square/index"})};return ae(async()=>{console.log("[ItemHome] 页面加载"),console.log("[ItemHome] userStore.isLoggedIn:",l.isLoggedIn),console.log("[ItemHome] userStore.userInfo:",l.userInfo),l.loadUserInfo(),console.log("[ItemHome] 加载后 userStore.isLoggedIn:",l.isLoggedIn),console.log("[ItemHome] 加载后 userStore.userInfo:",l.userInfo);const L=localStorage.getItem("deaultItemGroupId");L===null?h.value=0:h.value=parseInt(L);const P=localStorage.getItem("defaultViewMode");P&&(n.value=P),v(),x();try{const N=await Yt();w.value=N&&N.data&&N.data.enable===1}catch{w.value=!1}}),(L,P)=>{const N=H("a-divider"),U=H("a-tooltip"),A=H("a-spin");return C(),V("div",ey,[e("div",ty,[e("div",{class:"logo ml-10",onClick:S},[P[8]||(P[8]=e("div",{class:"logo-img-div"},[e("img",{onerror:"this.style.display='none';",class:"logo-img",src:Tt,alt:"ShowDoc"})],-1)),e("div",ay,[P[7]||(P[7]=e("div",{class:"font-bold logo-title"},"ShowDoc",-1)),e("div",oy,i(z(t)("index.home_logo_title")),1)])]),s(Ev,{isAdmin:f.value},null,8,["isAdmin"])]),ft(s(Na,{popup:!1},null,512),[[ga,z(l).isLoggedIn]]),e("div",{class:re(["container",{"card-view-mode":n.value==="card"}])},[e("div",sy,[e("div",ly,[e("div",{class:re(h.value===0?"item-one-block item-one-block-active":"item-one-block"),onClick:P[0]||(P[0]=D=>y(0))},[e("div",ny,[P[9]||(P[9]=e("i",{class:"mr-1 fas fa-notes"},null,-1)),O(" "+i(z(t)("item.all_items")),1)])],2),e("div",{class:re(h.value===-1?"item-one-block item-one-block-active":"item-one-block"),onClick:P[1]||(P[1]=D=>y(-1))},[e("div",iy,[P[10]||(P[10]=e("i",{class:"mr-1 fas fa-star v3-color-yellow"},null,-1)),O(" "+i(z(t)("item.star_items")),1)])],2),w.value?(C(),V("div",{key:0,class:"item-one-block public-square-link",onClick:M},[e("div",ry,[P[11]||(P[11]=e("i",{class:"mr-1 fas fa-landmark"},null,-1)),O(" "+i(z(t)("item.public_square")),1)])])):F("",!0)]),s(N,{class:"item-group-divider"}),e("div",cy,[e("div",dy,i(z(t)("item.group")),1),e("div",{class:"divider-icon",onClick:P[2]||(P[2]=D=>g.value=!0)},[s(U,{title:z(t)("item.item_group_desc"),placement:"top"},{default:u(()=>[...P[12]||(P[12]=[e("i",{class:"fas fa-plus mr-1"},null,-1)])]),_:1},8,["title"])])]),e("div",null,[(C(!0),V(Ce,null,Pe($.value,D=>(C(),V("div",{key:D.item_id,class:re(h.value==D.id?"item-one-block item-one-block-active":"item-one-block"),onClick:E=>y(D.id)},[e("div",my,[P[13]||(P[13]=e("i",{class:"mr-1 far fa-hashtag v3-font-size-sm"},null,-1)),O(" "+i(D.group_name),1)])],10,uy))),128))]),z(a)==="zh-CN"?(C(),V("div",_y,[e("div",py,[P[14]||(P[14]=e("i",{class:"far fa-fire"},null,-1)),P[15]||(P[15]=O(" 调试API并自动生成文档 ",-1)),e("a",{class:"text-link ml-2",onClick:P[3]||(P[3]=D=>T("https://www.showdoc.com.cn/runapi"))},"试试")])])):F("",!0)]),e("div",fy,[e("div",vy,[e("div",hy,[e("div",gy,[s(ne,{modelValue:d.value,"onUpdate:modelValue":P[4]||(P[4]=D=>d.value=D),placeholder:z(t)("item.search_keyword"),"allow-clear":"",autocomplete:"off",class:"search-input"},{prefix:u(()=>[...P[16]||(P[16]=[e("i",{class:"fas fa-search"},null,-1)])]),_:1},8,["modelValue","placeholder"])])])]),e("div",yy,[e("div",wy,i(r.value),1),e("div",by,[s(U,{title:z(t)("item.list_view"),placement:"top"},{default:u(()=>[e("div",{class:re(["view-switch-btn",{active:n.value==="list"}]),onClick:P[5]||(P[5]=D=>n.value="list")},[...P[17]||(P[17]=[e("i",{class:"fas fa-list-ul"},null,-1)])],2)]),_:1},8,["title"]),s(U,{title:z(t)("item.card_view"),placement:"top"},{default:u(()=>[e("div",{class:re(["view-switch-btn",{active:n.value==="card"}]),onClick:P[6]||(P[6]=D=>n.value="card")},[...P[18]||(P[18]=[e("i",{class:"fas fa-th-large"},null,-1)])],2)]),_:1},8,["title"])])]),!k.value&&!p.value&&n.value==="list"?(C(),B(U1,{key:0,itemList:m.value,getItemList:_,itemGroupId:h.value},null,8,["itemList","itemGroupId"])):F("",!0),!k.value&&!p.value&&n.value==="card"?(C(),B(J1,{key:1,itemList:m.value,getItemList:_,itemGroupId:h.value},null,8,["itemList","itemGroupId"])):F("",!0),k.value&&!p.value?(C(),V("div",$y,[s(A,{size:"large"})])):F("",!0),p.value?(C(),B(l0,{key:3,keyword:d.value,itemList:m.value},null,8,["keyword","itemList"])):F("",!0),e("div",{class:re(["content-wrapper",{"card-view-mode":n.value==="card"}])},[s(N0,{itemGroupId:h.value,callback:()=>{_()}},null,8,["itemGroupId","callback"])],2)])],2),g.value?(C(),B(Z0,{key:0,callback:()=>{g.value=!1,v()}},null,8,["callback"])):F("",!0)])}}});const Cy=Y(ky,[["__scopeId","data-v-454c8b0a"]]),xS=Object.freeze(Object.defineProperty({__proto__:null,default:Cy},Symbol.toStringTag,{value:"Module"})),xy={class:"item-setting-page"},Iy=J({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),V("div",xy,[e("h2",null,i(t.$t("item.item_setting")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:u(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const Sy=Y(Iy,[["__scopeId","data-v-1704147b"]]),IS=Object.freeze(Object.defineProperty({__proto__:null,default:Sy},Symbol.toStringTag,{value:"Module"})),Ty={class:"item-export-page"},My=J({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),V("div",Ty,[e("h2",null,i(t.$t("item.export")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:u(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const Ly=Y(My,[["__scopeId","data-v-1fa43a5c"]]),SS=Object.freeze(Object.defineProperty({__proto__:null,default:Ly},Symbol.toStringTag,{value:"Module"})),Vy={class:"item-password-page"},zy={class:"password-card"},Uy={class:"title"},Py={class:"form-group"},Ay={class:"form-group captcha-group"},Dy=["src","title"],Oy={class:"footer-links"},Ny=J({__name:"Index",setup(c){const t=Ge(),a=xe(),{t:o}=te(),l=b(""),m=b(""),f=b(0),d=b(""),p=b(!1),h=b("/"),$=async()=>{try{const n=await X("/api/common/createCaptcha",{});if(n.error_code===0){const w=n.data;f.value=w.captcha_id;let r=`${ot()}/api/common/showCaptcha`;r=dt(r,{captcha_id:w.captcha_id,t:Date.now()}),d.value=r}}catch(n){console.error("获取验证码失败:",n),G(o("common.error"))}},g=async()=>{if(!l.value){G(o("item.visit_password_placeholder"));return}if(!m.value){G(o("user.captcha_required"));return}const n=t.params.item_id||0,w=t.query.page_id||0;p.value=!0;try{const k={item_id:n,page_id:w,password:l.value,captcha:m.value,captcha_id:f.value},r=await X("/api/item/pwd",k,"post",!1);if(r.error_code===0){sessionStorage.setItem("_item_pwd",l.value);const _=decodeURIComponent(h.value||`/${n}`);a.replace(_)}else $(),G(r.error_message||o("common.error"))}catch(k){console.error("密码验证失败:",k),$(),G(o("common.error"))}finally{p.value=!1}};return ae(()=>{const n=t.params.item_id||0;h.value=t.query.redirect||`/${n}`,$()}),(n,w)=>{const k=H("router-link");return C(),V("div",Vy,[e("div",zy,[e("h2",Uy,i(n.$t("item.input_visit_password")),1),e("div",Py,[s(ne,{modelValue:l.value,"onUpdate:modelValue":w[0]||(w[0]=r=>l.value=r),type:"password",placeholder:n.$t("item.visit_password_placeholder"),onKeyup:Fe(g,["enter"])},null,8,["modelValue","placeholder"])]),e("div",Ay,[s(ne,{modelValue:m.value,"onUpdate:modelValue":w[1]||(w[1]=r=>m.value=r),placeholder:n.$t("user.verification_code"),onKeyup:Fe(g,["enter"])},null,8,["modelValue","placeholder"]),d.value?(C(),V("img",{key:0,src:d.value,class:"captcha-img",onClick:$,title:n.$t("item.click_to_refresh")},null,8,Dy)):F("",!0)]),s(K,{theme:"dark",loading:p.value,"full-width":!0,onClick:g,class:"submit-btn"},{default:u(()=>[O(i(n.$t("common.submit")),1)]),_:1},8,["loading"]),e("div",Oy,[s(k,{to:`/user/login?redirect=${encodeURIComponent(h.value)}`},{default:u(()=>[O(i(n.$t("user.login")),1)]),_:1},8,["to"])])])])}}});const Fy=Y(Ny,[["__scopeId","data-v-d4d69cd9"]]),TS=Object.freeze(Object.defineProperty({__proto__:null,default:Fy},Symbol.toStringTag,{value:"Module"})),qy={class:"notify-modal"},Ry={class:"form-section"},Hy={class:"notify-info"},Ey={class:"notify-count"},jy={class:"tips-text"},By={class:"footer-buttons"},Gy={class:"member-modal-content"},Ky={class:"member-actions"},Wy={class:"add-member-content"},Jy={class:"form-section"},Yy={class:"select-wrapper"},Xy={class:"tips-text"},Qy={class:"footer-buttons"},Zy=J({__name:"index",props:{itemId:{},pageId:{},onClose:{type:Function},onConfirm:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),m=b(!1),f=b(""),d=b(!1),p=b([]),h=b([]),$=b([]),g=q(()=>h.value.map(M=>({label:`${M.username}${M.name?` (${M.name})`:""}`,value:M.uid}))),n=q(()=>[{title:a("page.username"),key:"username",width:150},{title:a("page.name"),key:"name",width:120},{title:a("page.addtime"),key:"sub_time",width:180},{title:a("common.operation"),key:"action",width:100,center:!0}]),w=q(()=>p.value),k=()=>{var M;o.value=!1,(M=t.onClose)==null||M.call(t)},r=()=>{t.onConfirm(f.value)},_=async()=>{try{d.value=!0;const M=await Lo(t.pageId);p.value=M}catch(M){console.error("加载订阅者列表失败:",M)}finally{d.value=!1}},v=async()=>{try{const M=await Vo(t.itemId);h.value=M}catch(M){console.error("加载成员列表失败:",M)}},y=(M,L)=>L.label.toLowerCase().indexOf(M.toLowerCase())>=0,S=async()=>{if($.value.length===0){ie.info(a("page.select_member_first"));return}try{await ua(t.pageId,$.value),await _(),$.value=[],m.value=!1,ie.success(a("common.op_success"))}catch(M){console.error("添加成员失败:",M),await G(a("common.op_failed"))}},x=async()=>{if(h.value.length===0){ie.info(a("page.no_member_to_add"));return}try{const M=h.value.map(L=>L.uid);await ua(t.pageId,M),await _(),ie.success(a("common.op_success"))}catch(M){console.error("添加全部成员失败:",M),await G(a("common.op_failed"))}},I=async M=>{try{await zo(t.pageId,[M.uid]),await _(),ie.success(a("common.delete_success"))}catch(L){console.error("删除成员失败:",L),await G(a("common.delete_failed"))}},T=M=>M?typeof M=="string"?M:new Date(M*1e3).toLocaleString():"-";return ae(()=>{o.value=!0,_(),v()}),qe(m,M=>{M&&v()}),(M,L)=>{const P=H("a-select"),N=H("a-tooltip");return C(),V(Ce,null,[s(de,{show:o.value,title:M.$t("page.save_and_notify"),icon:["fas","fa-comment-dots"],width:"500px",onClose:k},{footer:u(()=>[e("div",By,[s(K,{text:M.$t("common.cancel"),theme:"light",onClick:k},null,8,["text"]),s(K,{text:M.$t("common.confirm"),theme:"dark",onClick:r},null,8,["text"])])]),default:u(()=>[e("div",qy,[e("div",Ry,[s(tt,{modelValue:f.value,"onUpdate:modelValue":L[0]||(L[0]=U=>f.value=U),label:M.$t("page.notify_content"),placeholder:M.$t("page.notify_content_placeholder"),rows:4},null,8,["modelValue","label","placeholder"])]),e("div",Hy,[s(K,{type:"link",text:M.$t("page.click_to_edit_member"),onClick:L[1]||(L[1]=U=>l.value=!0)},null,8,["text"]),e("span",Ey," ( "+i(M.$t("page.cur_setting_notify"))+" "+i(p.value.length)+" "+i(M.$t("page.people"))+" ) ",1)]),e("p",jy,i(M.$t("page.notify_tips1")),1)])]),_:1},8,["show","title"]),l.value?(C(),B(de,{key:0,show:l.value,title:M.$t("page.edit_notify_member"),icon:["fas","fa-users"],width:"700px",onClose:L[4]||(L[4]=U=>l.value=!1)},{footer:u(()=>[s(K,{text:M.$t("common.close"),theme:"light",onClick:L[3]||(L[3]=U=>l.value=!1)},null,8,["text"])]),default:u(()=>[e("div",Gy,[e("div",Ky,[s(K,{text:M.$t("page.add_single_member"),"left-icon":["fas","fa-user-plus"],theme:"light",onClick:L[2]||(L[2]=U=>m.value=!0)},null,8,["text"]),s(K,{text:M.$t("page.add_all_member"),"left-icon":["fas","fa-users"],theme:"light",onClick:x},null,8,["text"])]),s(Le,{"table-header":n.value,"table-data":w.value,loading:d.value,"row-key":U=>U.uid,"max-height":"400px"},{"cell-username":u(({row:U})=>[O(i(U.username),1)]),"cell-name":u(({row:U})=>[O(i(U.name||"-"),1)]),"cell-sub_time":u(({row:U})=>[O(i(T(U.sub_time)),1)]),"cell-action":u(({row:U})=>[s(K,{type:"link",text:M.$t("common.delete"),theme:"light",onClick:A=>I(U)},null,8,["text","onClick"])]),_:1},8,["table-header","table-data","loading","row-key"])])]),_:1},8,["show","title"])):F("",!0),m.value?(C(),B(de,{key:1,show:m.value,title:M.$t("page.add_single_member"),icon:["fas","fa-user-plus"],width:"500px",onClose:L[7]||(L[7]=U=>m.value=!1)},{footer:u(()=>[e("div",Qy,[s(K,{text:M.$t("common.cancel"),theme:"light",onClick:L[6]||(L[6]=U=>m.value=!1)},null,8,["text"]),s(K,{text:M.$t("common.confirm"),theme:"dark",onClick:S},null,8,["text"])])]),default:u(()=>[e("div",Wy,[e("div",Jy,[e("label",null,i(M.$t("page.username")),1),e("div",Yy,[s(P,{value:$.value,"onUpdate:value":L[5]||(L[5]=U=>$.value=U),mode:"multiple",placeholder:M.$t("page.select_or_search_member"),options:g.value,"show-search":"","filter-option":y,style:{flex:"1"}},null,8,["value","placeholder","options"]),s(N,{title:M.$t("page.refresh_member_list")},{default:u(()=>[e("i",{class:"fas fa-sync-alt refresh-btn",onClick:v})]),_:1},8,["title"])])]),e("p",Xy,i(M.$t("page.notify_add_member_tips1")),1)])]),_:1},8,["show","title"])):F("",!0)],64)}}});const ew=Y(Zy,[["__scopeId","data-v-f6141e88"]]);function tw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(ew,{itemId:c.itemId,pageId:c.pageId,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onConfirm:l=>{var m;(m=c.onConfirm)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const aw={class:"json-to-table"},ow={class:"description"},sw=J({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),m=()=>{t.onClose()},f=()=>{if(!l.value.trim()){G(a("common.required"));return}try{const p=JSON.parse(l.value),h=d(p);t.onInsert(h),t.onClose()}catch(p){console.error("JSON解析失败:",p),G(a("page.invalid_json"))}},d=p=>{let h=[];const $=[],g=(n,w="",k=1)=>{if(!n||typeof n!="object")return;Object.keys(n).forEach(_=>{let v=_;if(k>2||k>1&&w&&!isNaN(Number(w))?isNaN(Number(_))?v=w+"."+_:v=w:k>1&&w&&isNaN(Number(w))&&isNaN(Number(_))&&(v=w+"."+_),!($.indexOf(v)>-1)){if(typeof n[_]=="object"&&n[_]!==null)isNaN(Number(_))&&h.push({name:v,type:Array.isArray(n[_])?"array":"object",require:"1",remark:"",value:""}),n[_]&&g(n[_],v,k+1);else{const y=typeof n[_];h.push({name:v,type:y==="boolean"?"boolean":y==="number"?"number":"string",require:"1",remark:"",value:n[_]})}$.push(v)}})};try{if(g(p),h&&h.length>0){h=(k=>{const r=new Map;return k.filter(_=>{const v=_.name;return r.has(v)?!1:(r.set(v,!0),!0)})})(h);let w=`| 参数 | 类型 | 描述 |
`;return w+=`| :------- | :------- | :------- |
`,h.forEach(k=>{w+=`| ${k.name} | ${k.type} | |
`}),w}else return`| 参数 | 类型 | 描述 |
| :------- | :------- | :------- |
`}catch(n){return console.error("JSON 解析错误:",n),`| 参数 | 类型 | 描述 |
| :------- | :------- | :------- |
`}};return ae(()=>{o.value=!0}),(p,h)=>(C(),B(de,{show:o.value,title:p.$t("page.json_to_table"),width:"700px",onClose:m},{footer:u(()=>[s(K,{onClick:m},{default:u(()=>[O(i(p.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:f},{default:u(()=>[O(i(p.$t("common.confirm")),1)]),_:1})]),default:u(()=>[e("div",aw,[e("div",ow,i(p.$t("page.json_to_table_description")),1),s(tt,{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=$=>l.value=$),placeholder:p.$t("page.json_content_placeholder"),rows:10},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const lw=Y(sw,[["__scopeId","data-v-3809aba7"]]);function nw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(lw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var m;(m=c.onInsert)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const iw={class:"json-beautify"},rw=J({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),m=()=>{t.onClose()},f=()=>{try{const d=JSON.parse(l.value),p=JSON.stringify(d,null,2);t.onInsert(`\`\`\`json
${p}
\`\`\``)}catch{G(a("page.invalid_json"))}};return ae(()=>{o.value=!0}),(d,p)=>(C(),B(de,{show:o.value,title:d.$t("page.beautify_json"),width:"600px",onClose:m},{footer:u(()=>[s(K,{onClick:m},{default:u(()=>[O(i(d.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:f},{default:u(()=>[O(i(d.$t("common.confirm")),1)]),_:1})]),default:u(()=>[e("div",iw,[s(tt,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=h=>l.value=h),label:d.$t("page.json_content"),placeholder:d.$t("page.json_content_placeholder"),rows:8},null,8,["modelValue","label","placeholder"])])]),_:1},8,["show","title"]))}});const cw=Y(rw,[["__scopeId","data-v-a4424b8f"]]);function dw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(cw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var m;(m=c.onInsert)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const uw={class:"paste-table"},mw=J({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c;te();const a=b(!1),o=b(""),l=()=>{t.onClose()},m=()=>{const f=o.value.trim().split(`
`);if(f.length===0)return;const d=f.map($=>$.split("	")),p=Math.max(...d.map($=>$.length));let h="| "+d[0].map($=>$.trim()).join(" | ")+` |
`;h+="| "+Array(p).fill("---").join(" | ")+` |
`,d.slice(1).forEach($=>{const g=Array(p).fill("").map((n,w)=>($[w]||"").trim());h+="| "+g.join(" | ")+` |
`}),t.onInsert(h)};return ae(()=>{a.value=!0}),(f,d)=>(C(),B(de,{show:a.value,title:f.$t("page.paste_insert_table"),width:"600px",onClose:l},{footer:u(()=>[s(K,{onClick:l},{default:u(()=>[O(i(f.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:m},{default:u(()=>[O(i(f.$t("common.confirm")),1)]),_:1})]),default:u(()=>[e("div",uw,[s(tt,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=p=>o.value=p),label:f.$t("page.table_content"),placeholder:f.$t("page.table_content_placeholder"),rows:8},null,8,["modelValue","label","placeholder"])])]),_:1},8,["show","title"]))}});const _w=Y(mw,[["__scopeId","data-v-a519bf5b"]]);function pw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(_w,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var m;(m=c.onInsert)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const fw={class:"sql-to-markdown"},vw={class:"description"},hw=J({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),m=b(!1),f=()=>{t.onClose()},d=async()=>{if(!l.value.trim()){await G(a("common.required"));return}m.value=!0;try{const p=await X("/api/page/sqlToMarkdownTable",{sql:l.value},"post",!1);p.error_code===0&&p.data&&p.data.markdown?(t.onInsert(p.data.markdown),t.onClose(),ie.success(a("common.op_success"))):await G(p.error_message||a("common.op_failed"))}catch(p){console.error("SQL 转换失败:",p),await G(a("common.op_failed"))}finally{m.value=!1}};return ae(()=>{o.value=!0}),(p,h)=>(C(),B(de,{show:o.value,title:p.$t("page.sql_to_markdown_table"),width:"700px",onClose:f},{footer:u(()=>[s(K,{onClick:f},{default:u(()=>[O(i(p.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",loading:m.value,onClick:d},{default:u(()=>[O(i(p.$t("common.confirm")),1)]),_:1},8,["loading"])]),default:u(()=>[e("div",fw,[e("div",vw,i(p.$t("page.sql_to_markdown_table_description")),1),s(tt,{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=$=>l.value=$),placeholder:p.$t("page.sql_content_placeholder"),rows:10},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const gw=Y(hw,[["__scopeId","data-v-9d196cec"]]);function yw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(gw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var m;(m=c.onInsert)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const ww={class:"mock-config"},bw={class:"mock-response-section"},$w={class:"section-label"},kw={class:"section-tips"},Cw={class:"mock-url-section"},xw={class:"section-label"},Iw={class:"url-container"},Sw={class:"mock-url-prefix"},Tw=["title"],Mw={key:0,class:"full-mock-url"},Lw={class:"action-buttons"},Vw={href:"https://www.showdoc.com.cn/p/d952ed6b7b5fb454df13dce74d1b41f8",target:"_blank",class:"help-link"},zw=J({__name:"index",props:{pageId:{},itemId:{},onClose:{type:Function}},setup(c){const t=c,{t:a}=te();Ge();const o=b(!1),l=b({content:"",path:"/"}),m=b(""),f=q(()=>l.value.path?m.value+l.value.path:""),d=()=>{t.onClose()},p=async()=>{try{const w=await X("/api/mock/add",{page_id:t.pageId,template:l.value.content,path:l.value.path},"post",!1);w.error_code===0?(ie.success(a("page.save_success")),t.onClose()):await G(w.error_message||a("page.save_failed"))}catch(w){console.error("保存 Mock 配置失败:",w),await G(a("page.save_failed"))}},h=async()=>{f.value&&await Ht(f.value)&&ie.success(a("common.copy_success"))},$=()=>{try{const w=l.value.content.trim();if(!w){ie.warning(a("page.please_input_content"));return}const k=JSON.parse(w);l.value.content=JSON.stringify(k,null,2),ie.success(a("page.beautify_success"))}catch{G(a("page.json_format_error"))}},g=async()=>{if(t.pageId<=0){ie.warning(a("page.please_save_page_first")),t.onClose();return}try{const w=await X("/api/mock/infoByPageId",{page_id:t.pageId},"post",!1);w.error_code===0&&w.data&&w.data.unique_key&&w.data.template&&(l.value.content=n(w.data.template),l.value.path=w.data.path||"/")}catch(w){console.error("获取 Mock 配置失败:",w)}},n=w=>w?w.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'"):"";return ae(()=>{o.value=!0;const w=window.location.protocol+"//"+window.location.host;m.value=`${w}${ot()}mock-path/${t.itemId}?path=`,g()}),(w,k)=>(C(),B(de,{show:o.value,title:w.$t("page.mock_config"),width:"900px",onClose:d},{footer:u(()=>[s(K,{onClick:d},{default:u(()=>[O(i(w.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:p},{default:u(()=>[O(i(w.$t("common.save")),1)]),_:1})]),default:u(()=>[e("div",ww,[e("div",bw,[e("label",$w,i(w.$t("page.mock_response")),1),e("p",kw,i(w.$t("page.mock_response_tips")),1),s(tt,{modelValue:l.value.content,"onUpdate:modelValue":k[0]||(k[0]=r=>l.value.content=r),placeholder:w.$t("page.mock_response_placeholder"),rows:15,class:"mock-textarea"},null,8,["modelValue","placeholder"])]),e("div",Cw,[e("label",xw,i(w.$t("page.mock_url_and_path")),1),e("div",Iw,[e("code",Sw,i(m.value),1),s(ne,{modelValue:l.value.path,"onUpdate:modelValue":k[1]||(k[1]=r=>l.value.path=r),class:"path-input",placeholder:"/path"},null,8,["modelValue"]),e("i",{class:"fas fa-copy copy-icon",onClick:h,title:w.$t("common.copy")},null,8,Tw)]),f.value?(C(),V("code",Mw,i(f.value),1)):F("",!0)]),e("div",Lw,[s(K,{text:w.$t("page.beautify_json"),"left-icon":["fas","fa-th"],onClick:$},null,8,["text"]),e("a",Vw,[k[2]||(k[2]=e("i",{class:"fas fa-question-circle"},null,-1)),O(" "+i(w.$t("page.help_document")),1)])])])]),_:1},8,["show","title"]))}});const Uw=Y(zw,[["__scopeId","data-v-09d8a72e"]]);function Pw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Uw,{pageId:c.pageId||0,itemId:c.itemId||0,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(!1)}});a.mount(o)})}const Aw={class:"history-modal"},Dw=J({__name:"index",props:{pageId:{},onRestore:{},onClose:{},allowRecover:{type:Boolean,default:!0},allowEdit:{type:Boolean,default:!0}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!0),m=b(!1),f=b([]),d=b({current:1,pageSize:20,total:0}),p=q(()=>[{title:t("page.update_time"),key:"addtime",width:170},{title:t("page.update_by_who"),key:"author_username",width:120},{title:t("page.remark"),key:"page_comments",width:300},{title:t("page.operation"),key:"actions",width:200}]),h=async()=>{m.value=!0;try{const r=await X("/api/page/history",{page_id:o.pageId},"post",!1);r.error_code===0&&r.data?(f.value=r.data,d.value.total=r.data.length):await G(r.error_message||t("common.fetch_failed"))}catch(r){console.error("获取历史版本失败:",r),await G(t("common.fetch_failed"))}finally{m.value=!1}},$=r=>{d.value.current=r},g=r=>{const _=r.page_history_id,v=a.resolve({path:`/page/diff/${o.pageId}/${_}`});window.open(v.href,"_blank")},n=async r=>{if(await Se({title:t("page.recover_to_this_version"),msg:t("page.confirm_recover_version")}))try{const v=Zt(r.page_content);if(o.onRestore){o.onRestore(v),ie.success(t("common.op_success")),k();return}const y=await X("/api/page/save",{page_id:o.pageId,page_content:r.page_content,is_urlencode:1},"post",!1);y.error_code===0?(ie.success(t("common.op_success")),k()):await G(y.error_message||t("common.op_failed"))}catch(v){console.error("恢复版本失败:",v),await G(t("common.op_failed"))}},w=async r=>{const _=await it(t("page.edit_remark"),r.page_comments||"",t("page.remark"));if(!(_===null||_===r.page_comments))try{const v=await X("/api/page/updateHistoryComments",{page_id:o.pageId,page_history_id:r.page_history_id,page_comments:_},"post",!1);v.error_code===0?(ie.success(t("common.save_success")),h()):await G(v.error_message||t("common.save_failed"))}catch(v){console.error("更新备注失败:",v),await G(t("common.save_failed"))}},k=()=>{l.value=!1,setTimeout(()=>{o.onClose()},300)};return ae(()=>{h()}),(r,_)=>{const v=H("a-button");return C(),B(de,{show:l.value,title:r.$t("page.page_history_version"),onClose:k,width:"900px"},{default:u(()=>[e("div",Aw,[s(Le,{tableHeader:p.value,tableData:f.value,loading:m.value,pagination:d.value,onPageChange:$,rowKey:"page_history_id"},{"cell-page_comments":u(({row:y})=>[e("span",null,i(y.page_comments||"-"),1),c.allowEdit?(C(),B(v,{key:0,type:"link",size:"small",onClick:S=>w(y)},{default:u(()=>[O(i(r.$t("page.edit")),1)]),_:1},8,["onClick"])):F("",!0)]),"cell-actions":u(({row:y})=>[s(v,{type:"link",size:"small",onClick:S=>g(y)},{default:u(()=>[O(i(r.$t("page.overview")),1)]),_:1},8,["onClick"]),c.allowRecover?(C(),B(v,{key:0,type:"link",size:"small",danger:"",onClick:S=>n(y)},{default:u(()=>[O(i(r.$t("page.recover_to_this_version")),1)]),_:1},8,["onClick"])):F("",!0)]),_:1},8,["tableHeader","tableData","loading","pagination"])])]),_:1},8,["show","title"])}}});const Ow=Y(Dw,[["__scopeId","data-v-f1e3fe2b"]]);function Lt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ow,{pageId:c.pageId,allowRecover:c.allowRecover??!0,allowEdit:c.allowEdit??!0,onRestore:l=>{var m;(m=c.onRestore)==null||m.call(c,l),me(a,o),t(!0)},onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(!1)}});a.mount(o)})}const Nw={class:"filehub-upload-modal"},Fw={style:{"text-align":"center"}},qw={class:"upload-content"},Rw={class:"upload-text"},Hw=["innerHTML"],Ew={class:"batch-upload-support"},jw={key:0,style:{"margin-top":"15px"}},Bw={style:{"margin-bottom":"10px","font-weight":"bold"}},Gw={class:"upload-queue"},Kw={class:"file-info"},Ww={class:"file-name"},Jw={class:"file-size"},Yw={class:"status-info"},Xw={key:0,class:"status waiting"},Qw={key:1,class:"status uploading"},Zw={key:2,class:"status success"},eb={key:3,class:"status error"},tb={key:0,style:{"margin-top":"15px","text-align":"center"}},ab={key:1,style:{"margin-top":"15px"}},ob={style:{"margin-bottom":"8px","font-size":"14px"}},sb=J({__name:"index",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=b([]),f=b(!1),d=b(0),p=b(0),h=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=x=>(m.value.find(T=>T.file.name===x.name&&T.file.size===x.size)||(m.value.push({file:x,status:"waiting",error:""}),f.value||setTimeout(()=>{w()},100)),!1),n=()=>{},w=()=>{if(m.value.length!==0){if(f.value){p.value=m.value.filter(x=>x.status==="waiting"||x.status==="uploading"||x.status==="success").length;return}f.value=!0,d.value=0,p.value=m.value.filter(x=>x.status==="waiting").length,h.value=0,k()}},k=()=>{for(;h.value<m.value.length;){const T=m.value[h.value];if(T.status==="waiting"){T.status="uploading",r(T.file);return}h.value++}f.value=!1;const x=m.value.filter(T=>T.status==="success").length,I=m.value.filter(T=>T.status==="error").length;I===0?(j.success(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}`),setTimeout(()=>{S(),v()},1500)):j.warning(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}，${t("page.upload_failed_count",{count:I})}`)},r=async x=>{const I=new FormData;I.append("file",x);try{const T=await X("/api/page/upload",I,"post",!0),M=m.value[h.value];M&&(T.success===1?M.status="success":(M.status="error",M.error=T.error_message||t("page.upload_failed")),d.value++),k()}catch(T){console.error("上传文件失败:",T);const M=m.value[h.value];M&&(M.status="error",M.error=t("page.upload_failed"),d.value++),k()}},_=()=>{m.value=[],l.value=[]},v=()=>{_(),f.value=!1,d.value=0,p.value=0,h.value=0},y=x=>{if(x===0)return"0 B";const I=1024,T=["B","KB","MB","GB"],M=Math.floor(Math.log(x)/Math.log(I));return parseFloat((x/Math.pow(I,M)).toFixed(2))+" "+T[M]},S=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return setTimeout(()=>{o.value=!0},0),(x,I)=>{const T=H("a-upload"),M=H("a-progress");return C(),V("div",Nw,[s(de,{class:re({show:o.value}),title:x.$t("common.upload"),width:"600px",showOk:!1,showCancel:!1,onClose:S},{default:u(()=>[e("div",Fw,[s(T,{"file-list":l.value,"before-upload":g,multiple:!0,"show-upload-list":!1,"custom-request":n,class:"upload-area"},{default:u(()=>[e("div",qw,[I[0]||(I[0]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",Rw,[e("span",{class:"tips-text",innerHTML:x.$t("page.import_file_tips2")},null,8,Hw),e("div",Ew,i(x.$t("page.batch_upload_support")),1)])])]),_:1},8,["file-list"]),m.value.length>0?(C(),V("div",jw,[e("div",Bw,i(x.$t("page.upload_queue_files",{count:m.value.length}))+": ",1),e("div",Gw,[(C(!0),V(Ce,null,Pe(m.value,(L,P)=>(C(),V("div",{key:P,class:re(["queue-item",{uploading:L.status==="uploading",success:L.status==="success",error:L.status==="error"}])},[e("div",Kw,[I[1]||(I[1]=e("i",{class:"fas fa-file"},null,-1)),e("span",Ww,i(L.file.name),1),e("span",Jw,"("+i(y(L.file.size))+")",1)]),e("div",Yw,[L.status==="waiting"?(C(),V("span",Xw,i(x.$t("page.file_waiting")),1)):L.status==="uploading"?(C(),V("span",Qw,[I[2]||(I[2]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(x.$t("page.file_uploading")),1)])):L.status==="success"?(C(),V("span",Zw,[I[3]||(I[3]=e("i",{class:"fas fa-check"},null,-1)),e("span",null,i(x.$t("page.file_upload_success")),1)])):L.status==="error"?(C(),V("span",eb,[I[4]||(I[4]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(x.$t("page.file_upload_failed"))+": "+i(L.error),1)])):F("",!0)])],2))),128))]),m.value.length>0&&!f.value?(C(),V("div",tb,[s(K,{onClick:_},{default:u(()=>[O(i(x.$t("page.clear_queue")),1)]),_:1})])):F("",!0),f.value?(C(),V("div",ab,[e("div",ob,i(x.$t("page.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(M,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const lb=Y(sb,[["__scopeId","data-v-6cdb8a17"]]);function nb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(lb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const ib={class:"filehub-modal"},rb={class:"search-bar"},cb={class:"search-item"},db={class:"search-item"},ub={class:"search-item"},mb={class:"search-item"},_b={class:"info-bar"},pb={class:"tools"},fb=["onClick"],vb=["onClick"],hb=["onClick"],gb=J({__name:"index",props:{itemId:{},pageId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b(""),f=b("-1"),d=q(()=>[{label:t("attachment.all_attachment_type"),value:"-1"},{label:t("attachment.image"),value:"1"},{label:t("attachment.general_attachment"),value:"2"}]),p=b(0),h=b(0),$=b(!1),g=b([]),n=b({current:1,pageSize:5,total:0}),w=q(()=>[{title:t("attachment.file_id"),key:"file_id",width:60},{title:t("attachment.display_name"),key:"display_name",width:180},{title:t("attachment.file_type"),key:"file_type",width:120},{title:t("attachment.file_size_m"),key:"file_size_m",width:80},{title:t("attachment.visit_times"),key:"visit_times",width:70},{title:t("attachment.add_time"),key:"addtime",width:120},{title:t("common.operation"),key:"tools",width:150,tools:!0}]),k=async()=>{l.value=!0;try{const T=await X("/api/attachment/getMyList",{page:n.value.current,count:n.value.pageSize,attachment_type:f.value,display_name:m.value},"post",!1);T.error_code===0&&T.data&&(g.value=T.data.list||[],n.value.total=T.data.total||0,p.value=T.data.used_m||0,h.value=T.data.used_flow_m||0)}catch(T){console.error("获取文件库列表失败:",T),j.error(t("attachment.fetch_list_failed"))}finally{l.value=!1}},r=()=>{n.value.current=1,k()},_=T=>{n.value.current=T,k()},v=async T=>{try{const M=await X("/api/attachment/bindingPage",{file_id:T.file_id,page_id:a.pageId},"post",!1);M.error_code===0?(j.success(t("page.bind_success")),I()):j.error(M.error_message||t("page.bind_failed"))}catch(M){console.error("绑定文件失败:",M),j.error(t("page.bind_failed"))}},y=T=>{T.url&&window.open(T.url,"_blank")},S=async T=>{try{await Se({msg:t("attachment.confirm_delete"),title:t("common.tips")});const M=await X("/api/attachment/deleteMyAttachment",{file_id:T.file_id},"post",!1);M.error_code===0?(j.success(t("common.op_success")),k()):j.error(M.error_message||t("common.op_failed"))}catch{}},x=()=>{$.value=!1,k()},I=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return ae(()=>{setTimeout(()=>{o.value=!0}),k()}),(T,M)=>(C(),V("div",ib,[s(de,{class:re({show:o.value}),title:T.$t("page.filehub"),width:"900px",onClose:I},{default:u(()=>[e("div",rb,[e("div",cb,[s(ne,{modelValue:m.value,"onUpdate:modelValue":M[0]||(M[0]=L=>m.value=L),placeholder:T.$t("attachment.display_name"),onKeyup:Fe(r,["enter"])},null,8,["modelValue","placeholder"])]),e("div",db,[s(Re,{value:f.value,"onUpdate:value":M[1]||(M[1]=L=>f.value=L),options:d.value,style:{width:"120px"},onChange:r},null,8,["value","options"])]),e("div",ub,[s(K,{onClick:r},{default:u(()=>[O(i(T.$t("common.search")),1)]),_:1})]),e("div",mb,[s(K,{type:"primary",onClick:M[2]||(M[2]=L=>$.value=!0)},{default:u(()=>[O(i(T.$t("common.upload")),1)]),_:1})])]),e("div",_b,[e("span",null,i(T.$t("attachment.accumulated_used_space"))+" "+i(p.value)+"M , "+i(T.$t("attachment.month_flow"))+" "+i(h.value)+"M ",1)]),s(Le,{tableHeader:w.value,tableData:g.value,pagination:n.value,loading:l.value,maxHeight:"400px",onPageChange:_},{"cell-tools":u(({row:L})=>[e("div",pb,[e("span",{class:"tools-item clickable",onClick:P=>v(L)},i(T.$t("page.select")),9,fb),e("span",{class:"tools-item clickable",onClick:P=>y(L)},i(T.$t("attachment.visit")),9,vb),e("span",{class:"tools-item clickable",onClick:P=>S(L)},i(T.$t("common.delete")),9,hb)])]),_:1},8,["tableHeader","tableData","pagination","loading"])]),_:1},8,["class","title"]),$.value?(C(),B(z(nb),{key:0,callback:x})):F("",!0)]))}});const yb=Y(gb,[["__scopeId","data-v-accacfb4"]]);function wb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(yb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const bb={class:"page-upload-modal"},$b={style:{"text-align":"center"}},kb={class:"upload-content"},Cb={class:"upload-text"},xb=["innerHTML"],Ib={class:"batch-upload-support"},Sb={key:0,style:{"margin-top":"15px"}},Tb={style:{"margin-bottom":"10px","font-weight":"bold"}},Mb={class:"upload-queue"},Lb={class:"file-info"},Vb={class:"file-name"},zb={class:"file-size"},Ub={class:"status-info"},Pb={key:0,class:"status waiting"},Ab={key:1,class:"status uploading"},Db={key:2,class:"status success"},Ob=["href"],Nb={key:1},Fb={key:3,class:"status error"},qb={key:0,style:{"margin-top":"15px","text-align":"center"}},Rb={key:1,style:{"margin-top":"15px"}},Hb={style:{"margin-bottom":"8px","font-size":"14px"}},Eb=J({__name:"index",props:{itemId:{},pageId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=b([]),f=b(!1),d=b(0),p=b(0),h=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=x=>(m.value.find(T=>T.file.name===x.name&&T.file.size===x.size)||(m.value.push({file:x,status:"waiting",error:""}),f.value||setTimeout(()=>{w()},100)),!1),n=()=>{},w=()=>{if(m.value.length!==0){if(f.value){p.value=m.value.filter(x=>x.status==="waiting"||x.status==="uploading"||x.status==="success").length;return}f.value=!0,d.value=0,p.value=m.value.filter(x=>x.status==="waiting").length,h.value=0,k()}},k=()=>{for(;h.value<m.value.length;){const T=m.value[h.value];if(T.status==="waiting"){T.status="uploading",r(T.file);return}h.value++}f.value=!1;const x=m.value.filter(T=>T.status==="success").length,I=m.value.filter(T=>T.status==="error").length;I===0?(j.success(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}`),setTimeout(()=>{S(),v()},1500)):j.warning(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}，${t("page.upload_failed_count",{count:I})}`)},r=async x=>{const I=new FormData;I.append("file",x),I.append("page_id",String(a.pageId)),I.append("item_id",String(a.itemId));try{const T=await X("/api/page/upload",I,"post",!1),M=m.value[h.value];M&&(T.success===1?(M.status="success",M.url=T.url):(M.status="error",M.error=T.message||T.error_message||t("page.upload_failed")),d.value++),k()}catch(T){console.error("上传文件失败:",T);const M=m.value[h.value];M&&(M.status="error",M.error=t("page.upload_failed"),d.value++),k()}},_=()=>{m.value=[],l.value=[]},v=()=>{_(),f.value=!1,d.value=0,p.value=0,h.value=0},y=x=>{if(x===0)return"0 B";const I=1024,T=["B","KB","MB","GB"],M=Math.floor(Math.log(x)/Math.log(I));return parseFloat((x/Math.pow(I,M)).toFixed(2))+" "+T[M]},S=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return setTimeout(()=>{o.value=!0},0),(x,I)=>{const T=H("a-upload"),M=H("a-progress");return C(),V("div",bb,[s(de,{class:re({show:o.value}),title:x.$t("common.upload"),width:"600px",showOk:!1,showCancel:!1,onClose:S},{default:u(()=>[e("div",$b,[s(T,{"file-list":l.value,"before-upload":g,multiple:!0,"show-upload-list":!1,"custom-request":n,class:"upload-area"},{default:u(()=>[e("div",kb,[I[0]||(I[0]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",Cb,[e("span",{class:"tips-text",innerHTML:x.$t("page.import_file_tips2")},null,8,xb),e("div",Ib,i(x.$t("page.batch_upload_support")),1)])])]),_:1},8,["file-list"]),m.value.length>0?(C(),V("div",Sb,[e("div",Tb,i(x.$t("page.upload_queue_files",{count:m.value.length}))+": ",1),e("div",Mb,[(C(!0),V(Ce,null,Pe(m.value,(L,P)=>(C(),V("div",{key:P,class:re(["queue-item",{uploading:L.status==="uploading",success:L.status==="success",error:L.status==="error"}])},[e("div",Lb,[I[1]||(I[1]=e("i",{class:"fas fa-file"},null,-1)),e("span",Vb,i(L.file.name),1),e("span",zb,"("+i(y(L.file.size))+")",1)]),e("div",Ub,[L.status==="waiting"?(C(),V("span",Pb,i(x.$t("page.file_waiting")),1)):L.status==="uploading"?(C(),V("span",Ab,[I[2]||(I[2]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(x.$t("page.file_uploading")),1)])):L.status==="success"?(C(),V("span",Db,[I[3]||(I[3]=e("i",{class:"fas fa-check"},null,-1)),L.url?(C(),V("a",{key:0,href:L.url,target:"_blank",class:"upload-success-link"},i(x.$t("page.file_upload_success")),9,Ob)):(C(),V("span",Nb,i(x.$t("page.file_upload_success")),1))])):L.status==="error"?(C(),V("span",Fb,[I[4]||(I[4]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(x.$t("page.file_upload_failed"))+": "+i(L.error),1)])):F("",!0)])],2))),128))]),m.value.length>0&&!f.value?(C(),V("div",qb,[s(K,{onClick:_},{default:u(()=>[O(i(x.$t("page.clear_queue")),1)]),_:1})])):F("",!0),f.value?(C(),V("div",Rb,[e("div",Hb,i(x.$t("page.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(M,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const jb=Y(Eb,[["__scopeId","data-v-4f4afca7"]]);function Bb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(jb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const Gb={class:"page-attachment-modal"},Kb={key:0,class:"action-bar"},Wb={class:"tips"},Jb={class:"tools"},Yb=["onClick"],Xb=["onClick"],Qb=["onClick"],Zb={key:1,class:"empty-state"},e$=J({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean},onClose:{type:Function},onInsert:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),m=b(!1),f=b(!1),d=b([]),p=q(()=>[{title:t("page.add_time"),key:"addtime",width:170},{title:t("page.file_name"),key:"display_name",minWidth:200},{title:t("common.operation"),key:"tools",width:180,tools:!0}]),h=async()=>{if(a.pageId){l.value=!0;try{const _=await X("/api/page/uploadList",{page_id:a.pageId},"post",!1);_.error_code===0&&_.data&&(d.value=_.data||[])}catch(_){console.error("获取页面附件列表失败:",_),j.error(t("page.fetch_attachments_failed"))}finally{l.value=!1}}},$=_=>{_.url&&window.open(_.url,"_blank")},g=_=>{const v=`[${_.display_name}](${_.url} "${_.display_name}")`;a.onInsert&&(a.onInsert(v),j.success(t("page.insert_success")))},n=async _=>{try{await Se({msg:t("common.confirm_delete"),title:t("common.tips")});const v=await X("/api/page/deleteUploadFile",{file_id:_.file_id,page_id:a.pageId},"post",!1);v.error_code===0?(j.success(t("common.delete_success")),h()):j.error(v.error_message||t("common.delete_failed"))}catch{}},w=()=>{m.value=!1,h()},k=()=>{f.value=!1,h()},r=_=>{o.value=!1,setTimeout(()=>{a.onClose()},300)};return ae(()=>{setTimeout(()=>{o.value=!0}),h()}),(_,v)=>(C(),V("div",Gb,[s(de,{class:re({show:o.value}),title:_.$t("page.attachments"),width:"900px",onClose:v[2]||(v[2]=y=>r())},{default:u(()=>[c.manage?(C(),V("div",Kb,[s(K,{onClick:v[0]||(v[0]=y=>m.value=!0)},{default:u(()=>[v[3]||(v[3]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(_.$t("page.from_filehub")),1)]),_:1}),s(K,{type:"primary",onClick:v[1]||(v[1]=y=>f.value=!0)},{default:u(()=>[v[4]||(v[4]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),O(" "+i(_.$t("common.upload")),1)]),_:1}),e("small",Wb,i(_.$t("page.file_size_tips")),1)])):F("",!0),s(Le,{tableHeader:p.value,tableData:d.value,loading:l.value,maxHeight:"400px",pagination:null},{"cell-tools":u(({row:y})=>[e("div",Jb,[e("span",{class:"tools-item clickable",onClick:S=>$(y)},i(_.$t("common.download")),9,Yb),c.manage?(C(),V("span",{key:0,class:"tools-item clickable",onClick:S=>g(y)},i(_.$t("page.insert")),9,Xb)):F("",!0),c.manage?(C(),V("span",{key:1,class:"tools-item clickable",onClick:S=>n(y)},i(_.$t("common.delete")),9,Qb)):F("",!0)])]),_:1},8,["tableHeader","tableData","loading"]),!l.value&&d.value.length===0?(C(),V("div",Zb,[v[5]||(v[5]=e("i",{class:"fas fa-paperclip"},null,-1)),e("p",null,i(_.$t("page.no_attachments")),1)])):F("",!0)]),_:1},8,["class","title"]),m.value?(C(),B(z(wb),{key:0,itemId:c.itemId,pageId:c.pageId,callback:w},null,8,["itemId","pageId"])):F("",!0),f.value?(C(),B(z(Bb),{key:1,itemId:c.itemId,pageId:c.pageId,callback:k},null,8,["itemId","pageId"])):F("",!0)]))}});const t$=Y(e$,[["__scopeId","data-v-1bc9518f"]]);function Ba(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(t$,{...c,onClose:()=>{c.onClose(),me(a,o),t()}});a.mount(o)})}const a$={class:"template-select"},o$={class:"share-form"},s$={class:"form-label"},l$={class:"tips-text"},n$=J({__name:"index",props:{itemId:{},onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),m=b(!1),f=b(!1),d=b("my"),p=b([]),h=b([]),$=b(!1),g=b(!1),n=b([]),w=b(null),k=b([]),r=q(()=>[{text:a("page.my_template"),value:"my"},{text:a("page.item_template"),value:"item"}]),_=q(()=>[{title:a("page.save_time"),key:"addtime",width:170},{title:a("page.template_title"),key:"template_title"},{title:a("common.operation"),key:"action",width:300}]),v=q(()=>[{title:a("page.save_time"),key:"created_at",width:170},{title:a("page.sharer"),key:"username",width:120},{title:a("page.template_title"),key:"template_title"},{title:a("common.operation"),key:"action",width:150}]),y=D=>qa(D).format("YYYY-MM-DD HH:mm:ss"),S=(D,E)=>E.label.toLowerCase().includes(D.toLowerCase()),x=async()=>{m.value=!0;try{const D=await X("/api/template/getMyList",{},"post",!1);D.error_code===0&&D.data&&(p.value=D.data)}catch(D){console.error("获取我的模板失败:",D),await G(a("common.fetch_failed"))}finally{m.value=!1}},I=async()=>{f.value=!0;try{const D=await X("/api/template/getItemList",{item_id:t.itemId},"post",!1);D.error_code===0&&D.data&&(h.value=D.data)}catch(D){console.error("获取项目模板失败:",D),await G(a("common.fetch_failed"))}finally{f.value=!1}},T=async()=>{try{const D=await X("/api/item/myList",{},"post",!1);D.error_code===0&&D.data&&(k.value=D.data.map(E=>({label:E.item_name,value:E.item_id})))}catch(D){console.error("获取项目列表失败:",D)}},M=D=>{d.value=D},L=D=>{t.onInsert(D.template_content),A()},P=async D=>{if(await Se({msg:`${a("common.confirm_delete")}「${D.template_title}」?`,title:a("common.tips"),confirmText:a("common.confirm"),cancelText:a("common.cancel")}))try{const oe=await X("/api/template/delete",{id:D.id},"post",!1);oe.error_code===0?(ie.success(a("common.delete_success")),x(),I()):await G(oe.error_message||a("common.delete_failed"))}catch(oe){console.error("删除模板失败:",oe),await G(a("common.delete_failed"))}},N=D=>{w.value=D,n.value=[],D.share_item_count>0&&D.share_item&&(n.value=D.share_item.map(E=>E.item_id)),T(),$.value=!0},U=async()=>{if(w.value){g.value=!0;try{const D=await X("/api/template/shareToItem",{template_id:w.value.id,item_id:n.value.join(",")},"post",!1);D.error_code===0?(ie.success(a("common.save_success")),$.value=!1,x(),I()):await G(D.error_message||a("common.save_failed"))}catch(D){console.error("共享模板失败:",D),await G(a("common.save_failed"))}finally{g.value=!1}}},A=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return ae(()=>{o.value=!0,x(),I()}),(D,E)=>{const oe=H("a-spin"),ge=H("a-select");return C(),V(Ce,null,[s(de,{show:o.value,title:D.$t("page.template_list"),width:"900px",onClose:A},{footer:u(()=>[s(K,{text:D.$t("common.close"),onClick:A},null,8,["text"])]),default:u(()=>[e("div",a$,[s(oe,{spinning:l.value},{default:u(()=>[s(vt,{items:r.value,value:d.value,type:"card",onUpdateValue:M},{my:u(()=>[s(Le,{tableHeader:_.value,tableData:p.value,loading:m.value,maxHeight:"400px",emptyText:()=>D.$t("page.no_my_template_text")},{"cell-addtime":u(({row:fe})=>[O(i(y(fe.addtime)),1)]),"cell-action":u(({row:fe})=>[s(K,{text:D.$t("page.insert_template"),type:"link",bold:!1,onClick:ee=>L(fe)},null,8,["text","onClick"]),s(K,{text:`${D.$t("page.share_to_items")} (${fe.share_item_count||0})`,type:"link",bold:!1,onClick:ee=>N(fe)},null,8,["text","onClick"]),s(K,{text:D.$t("common.delete"),type:"link",danger:"",bold:!1,onClick:ee=>P(fe)},null,8,["text","onClick"])]),_:1},8,["tableHeader","tableData","loading","emptyText"])]),item:u(()=>[s(Le,{tableHeader:v.value,tableData:h.value,loading:f.value,maxHeight:"400px",emptyText:()=>D.$t("page.no_item_template_text")},{"cell-created_at":u(({row:fe})=>[O(i(y(fe.created_at)),1)]),"cell-action":u(({row:fe})=>[s(K,{text:D.$t("page.insert_template"),type:"link",bold:!1,onClick:ee=>L(fe)},null,8,["text","onClick"])]),_:1},8,["tableHeader","tableData","loading","emptyText"])]),_:1},8,["items","value"])]),_:1},8,["spinning"])])]),_:1},8,["show","title"]),$.value?(C(),B(de,{key:0,title:D.$t("page.share_template_to_items"),width:"500px",onClose:E[2]||(E[2]=fe=>$.value=!1)},{footer:u(()=>[s(K,{text:D.$t("common.cancel"),onClick:E[1]||(E[1]=fe=>$.value=!1)},null,8,["text"]),s(K,{text:D.$t("common.confirm"),theme:"dark",spinning:g.value,onClick:U},null,8,["text","spinning"])]),default:u(()=>[e("div",o$,[e("label",s$,i(D.$t("page.select_items_to_share")),1),s(ge,{value:n.value,"onUpdate:value":E[0]||(E[0]=fe=>n.value=fe),mode:"multiple",placeholder:D.$t("common.please_choose"),options:k.value,"filter-option":S,"show-search":"",style:{width:"100%"}},null,8,["value","placeholder","options"]),e("div",l$,i(D.$t("page.share_items_tips")),1)])]),_:1},8,["title"])):F("",!0)],64)}}});const i$=Y(n$,[["__scopeId","data-v-64be65c6"]]);function pa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(i$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const r$={class:"save-template-modal"},c$={class:"form-item"},d$={class:"form-label"},u$={class:"label-text"},m$={class:"input-counter"},_$={class:"form-item"},p$={class:"form-label"},f$={class:"label-text"},v$={class:"content-preview"},h$=["value"],g$={class:"input-counter"},y$={class:"form-item"},w$={class:"form-label"},b$={class:"label-text"},$$={class:"share-option"},k$={class:"tips-text"},C$={key:0,class:"form-item"},x$={class:"form-label"},I$={class:"label-text"},S$={class:"item-selector"},T$=["onClick"],M$={class:"item-label"},L$={key:0,class:"empty-tip"},V$=J({__name:"index",props:{content:{},onSuccess:{type:Function},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),m=b({title:"",shareToItem:"0",shareItemIds:[]}),f=b([]),d=n=>m.value.shareItemIds.includes(n),p=async()=>{try{const n=await X("/api/item/myList",{},"post",!1);n.error_code===0&&n.data&&(f.value=n.data.map(w=>({label:w.item_name,value:w.item_id})))}catch(n){console.error("获取项目列表失败:",n)}},h=n=>{const w=m.value.shareItemIds.indexOf(n);w>-1?m.value.shareItemIds.splice(w,1):m.value.shareItemIds.push(n)},$=async()=>{var n;if(!m.value.title.trim()){await G(a("page.template_title_required"));return}l.value=!0;try{const w=await X("/api/template/save",{template_title:m.value.title,template_content:t.content},"post",!1);w.error_code===0?(ie.success(a("page.save_template_success")),m.value.shareToItem==="1"&&m.value.shareItemIds.length>0&&((n=w.data)!=null&&n.id)&&await X("/api/template/shareToItem",{template_id:w.data.id,item_id:m.value.shareItemIds.join(",")},"post",!1),t.onSuccess&&t.onSuccess(),g()):await G(w.error_message||a("common.save_failed"))}catch(w){console.error("保存模板失败:",w),await G(a("common.save_failed"))}finally{l.value=!1}},g=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return ae(()=>{o.value=!0,p()}),(n,w)=>(C(),B(de,{show:o.value,title:n.$t("page.save_to_template"),height:"600px",onClose:g},{footer:u(()=>[s(K,{onClick:g},{default:u(()=>[O(i(n.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:$,loading:l.value},{default:u(()=>[O(i(n.$t("common.save")),1)]),_:1},8,["loading"])]),default:u(()=>[e("div",r$,[e("div",c$,[e("div",d$,[e("span",u$,i(n.$t("page.template_title")),1),w[2]||(w[2]=e("span",{class:"label-required"},"*",-1))]),s(ne,{modelValue:m.value.title,"onUpdate:modelValue":w[0]||(w[0]=k=>m.value.title=k),placeholder:n.$t("page.input_template_title"),maxlength:100},null,8,["modelValue","placeholder"]),e("div",m$,i(m.value.title.length)+"/100",1)]),e("div",_$,[e("div",p$,[e("span",f$,i(n.$t("page.template_content_preview")),1)]),e("div",v$,[e("textarea",{value:c.content,rows:10,readonly:"",class:"readonly-textarea"},null,8,h$)]),e("div",g$,i(c.content.length),1)]),e("div",y$,[e("div",w$,[e("span",b$,i(n.$t("page.share_template")),1)]),e("div",$$,[s(We,{modelValue:m.value.shareToItem,"onUpdate:modelValue":w[1]||(w[1]=k=>m.value.shareToItem=k)},null,8,["modelValue"]),e("div",k$,i(n.$t("page.share_template_tips")),1)])]),m.value.shareToItem==="1"?(C(),V("div",C$,[e("div",x$,[e("span",I$,i(n.$t("page.share_to_items")),1)]),e("div",S$,[(C(!0),V(Ce,null,Pe(f.value,k=>(C(),V("div",{key:k.value,class:"item-checkbox",onClick:r=>h(k.value)},[e("i",{class:re([d(k.value)?"fas fa-check-square":"fas fa-square","checkbox-icon"])},null,2),e("span",M$,i(k.label),1)],8,T$))),128)),f.value.length===0?(C(),V("div",L$,i(n.$t("page.no_items_to_share")),1)):F("",!0)])])):F("",!0)])]),_:1},8,["show","title"]))}});const z$=Y(V$,[["__scopeId","data-v-9543405c"]]);function U$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(z$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const P$={class:"ai-modal"},A$={class:"section-header"},D$={class:"action-bar"},O$={class:"section-header"},N$=J({__name:"index",props:{pageId:{},itemId:{},itemName:{},onInsert:{type:Function},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),m=b(""),f=b(!1),d=q(()=>[{icon:["fas","fa-copy"],text:a("common.copy"),size:"small",onClick:h,disabled:!m.value||!m.value.trim()}]),p=async()=>{var w;if(!(!l.value.trim()||f.value)){m.value="",f.value=!0;try{const k={content:l.value},r=Qt();r&&r.user_token&&(k.user_token=r.user_token);const _=ot()+"/api/ai/create",v=await fetch(_,{method:"POST",body:new URLSearchParams(k),headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!v.ok)throw new Error("AI 生成失败");const y=(w=v.body)==null?void 0:w.getReader(),S=new TextDecoder("utf-8");let x="";if(y){const I=async()=>{const{value:T,done:M}=await y.read();if(M)f.value=!1;else{const P=S.decode(T).trim().split("data: ");for(const N of P)if(N.trim()!=="")try{const U=JSON.parse(N.replace("data: ",""));if(U.choices&&U.choices[0]&&U.choices[0].delta&&U.choices[0].delta.content){const A=U.choices[0].delta.content;x+=A,m.value=x}if(U.choices&&U.choices[0]&&U.choices[0].finish_reason==="length")await I();else if(U.choices&&U.choices[0]&&U.choices[0].finish_reason==="stop"){m.value=x,f.value=!1;return}}catch{if(N.trim()==="[DONE]"){m.value=x,f.value=!1;return}if(N.trim().indexOf("usage")>-1)continue;try{const A=JSON.parse(N.trim());if(A.error_code!==0){await G(A.error_message),f.value=!1;return}}catch{}}await I()}};await I()}}catch(k){console.error("AI 生成失败:",k),await G(a("page.ai_generate_failed")),f.value=!1}}},h=()=>{navigator.clipboard.writeText(m.value).then(()=>{ie.success(a("common.copy_success"))}).catch(()=>{G(a("common.copy_failed"))})},$=()=>{const w=a("page.ai_help_url");window.open(w,"_blank")},g=()=>{t.onInsert&&m.value.trim()&&(t.onInsert(m.value),n())},n=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return ae(()=>{o.value=!0}),(w,k)=>{const r=H("a-col"),_=H("a-row");return C(),B(de,{show:o.value,title:w.$t("page.ai_assistant"),onClose:n,maxWidth:"1400px",minWidth:"1000px","use-line":!0,"header-buttons":d.value},{footer:u(()=>[s(K,{onClick:n},{default:u(()=>[O(i(w.$t("common.close")),1)]),_:1}),s(K,{theme:"dark",onClick:g,disabled:!m.value.trim(),"left-icon":["fas","fa-plus"]},{default:u(()=>[O(i(w.$t("page.ai_insert_to_editor")),1)]),_:1},8,["disabled"])]),default:u(()=>[e("div",P$,[s(_,{gutter:24},{default:u(()=>[s(r,{span:12,class:"input-section"},{default:u(()=>[e("div",A$,[e("h3",null,i(w.$t("page.ai_input_area")),1)]),s(tt,{modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=v=>l.value=v),placeholder:w.$t("page.ai_input_placeholder"),class:"ai-textarea",style:{"min-height":"400px"}},null,8,["modelValue","placeholder"]),e("div",D$,[s(K,{theme:"dark",onClick:p,spinning:f.value,disabled:!l.value.trim()||f.value,"left-icon":["fas","fa-magic"]},{default:u(()=>[O(i(w.$t("page.ai_generate")),1)]),_:1},8,["spinning","disabled"]),s(K,{theme:"light",onClick:$,type:"link","left-icon":["fas","fa-question-circle"]},{default:u(()=>[O(i(w.$t("page.ai_help_text")),1)]),_:1})])]),_:1}),s(r,{span:12,class:"output-section"},{default:u(()=>[e("div",O$,[e("h3",null,i(w.$t("page.ai_output_area")),1)]),s(tt,{modelValue:m.value,"onUpdate:modelValue":k[1]||(k[1]=v=>m.value=v),placeholder:w.$t("page.ai_output_placeholder"),class:"ai-textarea ai-textarea-readonly",style:{"min-height":"400px"},readonly:""},null,8,["modelValue","placeholder"])]),_:1})]),_:1})])]),_:1},8,["show","title","header-buttons"])}}});const F$=Y(N$,[["__scopeId","data-v-d296fa83"]]);function q$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(F$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const R$={class:"create-catalog-container"},H$={class:"form-item"},E$={class:"form-label"},j$={class:"form-item"},B$={class:"form-label"},G$=J({__name:"index",props:{itemId:{},parentCatId:{},onClose:{type:Function},onSuccess:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!0),l=Je({catName:"",parentCatId:Number(a.parentCatId||0)}),m=b([]),f=q(()=>{const g=[{label:t("catalog.root_catalog"),value:0}];return m.value.forEach(n=>{g.push({label:n.cat_name,value:Number(n.cat_id||0)})}),g}),d=(g,n)=>n.label.toLowerCase().includes(g.toLowerCase()),p=()=>{var g;o.value=!1,(g=a.onClose)==null||g.call(a)},h=async()=>{try{const g=await X("/api/catalog/catListName",{item_id:a.itemId},"post",!1);g.error_code===0&&(m.value=(g.data||[]).map(n=>({...n,cat_id:Number(n.cat_id||0)})))}catch(g){console.error("获取目录列表失败:",g)}},$=async()=>{var g;if(!l.catName.trim()){j.error(t("catalog.cat_name_required"));return}try{const n=await X("/api/catalog/save",{item_id:a.itemId,cat_id:0,parent_cat_id:l.parentCatId,cat_name:l.catName.trim()},"post",!1);if(n.error_code===0){j.success(t("common.save_success")),o.value=!1;let w=0;typeof n.data=="number"?w=n.data:n.data&&n.data.cat_id&&(w=Number(n.data.cat_id)),w=Number(w||0),console.log("创建目录成功，新目录 ID:",w,"返回数据:",n),(g=a.onSuccess)==null||g.call(a,w,l.catName.trim())}else j.error(n.error_message||t("common.op_failed"))}catch(n){console.error("创建目录失败:",n),j.error(t("common.op_failed"))}};return ae(()=>{h()}),(g,n)=>{const w=H("a-select");return C(),B(de,{show:o.value,title:g.$t("catalog.new_catalog"),width:"500px",onClose:p},{footer:u(()=>[s(K,{onClick:p},{default:u(()=>[O(i(g.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:$},{default:u(()=>[O(i(g.$t("common.confirm")),1)]),_:1})]),default:u(()=>[e("div",R$,[e("div",H$,[e("label",E$,[O(i(g.$t("catalog.cat_name"))+" ",1),n[2]||(n[2]=e("span",{class:"required"},"*",-1))]),s(ne,{modelValue:l.catName,"onUpdate:modelValue":n[0]||(n[0]=k=>l.catName=k),placeholder:g.$t("catalog.cat_name_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),e("div",j$,[e("label",B$,i(g.$t("catalog.parent_catalog")),1),s(w,{value:l.parentCatId,"onUpdate:value":n[1]||(n[1]=k=>l.parentCatId=k),options:f.value,placeholder:g.$t("catalog.select_parent_catalog"),"show-search":"","filter-option":d,"allow-clear":"",style:{width:"100%"}},null,8,["value","options","placeholder"])])])]),_:1},8,["show","title"])}}});const K$=Y(G$,[["__scopeId","data-v-3320e1ed"]]);function W$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(K$,{itemId:c.itemId,parentCatId:c.parentCatId||0,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t({catId:0,catName:""})},onSuccess:(l,m)=>{var f;(f=c.onSuccess)==null||f.call(c,l,m),me(a,o),t({catId:l,catName:m})}});a.mount(o)})}const J$={class:"catalog-select-container"},Y$={class:"form-item"},X$={class:"form-label"},Q$=J({__name:"index",props:{itemId:{},catId:{},onClose:{type:Function},onSelect:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b([]),m=b(0),f=q(()=>l.value.map(g=>({label:g.cat_name,value:g.cat_id}))),d=()=>{t.onClose()},p=()=>{t.onSelect(Number(m.value))},h=async()=>{console.log("handleNewCatalog 开始执行");const g=await W$({itemId:t.itemId,parentCatId:Number(m.value)});console.log("CreateCatalogModal 返回结果:",g),g.catId>0?(console.log("开始刷新目录列表，新目录 ID:",g.catId),await $(g.catId),console.log("目录列表刷新完成"),t.onSelect(g.catId),console.log("onSelect 调用完成")):console.log("result.catId <= 0，不执行刷新")},$=async g=>{console.log("loadCatalogs 开始执行，selectedCatalogId:",g);try{const n=await X("/api/catalog/catListName",{item_id:t.itemId},"post",!1);if(console.log("API 返回数据:",n),n.error_code===0&&n.data){const w={cat_id:"0",cat_name:"/"};l.value=[w,...(n.data||[]).map(r=>({...r,cat_id:String(Number(r.cat_id||0))}))],console.log("目录列表更新完成:",l.value);const k=String(g!==void 0?g:t.catId);m.value=k,console.log("设置选中目录 ID:",k,"当前值:",m.value)}}catch(n){console.error("获取目录列表失败:",n),await AlertModal(a("common.operation_failed"))}};return ae(()=>{o.value=!0,$()}),(g,n)=>(C(),B(de,{show:o.value,title:g.$t("page.select_catalog"),width:"500px",onClose:d},{footer:u(()=>[s(K,{onClick:h},{default:u(()=>[n[1]||(n[1]=e("i",{class:"fas fa-plus"},null,-1)),O(" "+i(g.$t("catalog.new_catalog")),1)]),_:1}),n[2]||(n[2]=e("div",{style:{flex:"1"}},null,-1)),s(K,{onClick:d},{default:u(()=>[O(i(g.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:p},{default:u(()=>[O(i(g.$t("common.confirm")),1)]),_:1})]),default:u(()=>[e("div",J$,[e("div",Y$,[e("label",X$,i(g.$t("page.select_catalog")),1),s(Re,{value:m.value,"onUpdate:value":n[0]||(n[0]=w=>m.value=w),options:f.value,placeholder:g.$t("page.select_catalog"),"show-search":!0},null,8,["value","options","placeholder"])])])]),_:1},8,["show","title"]))}});const Z$=Y(Q$,[["__scopeId","data-v-a485fae7"]]);function ek(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Z$,{itemId:c.itemId,catId:c.catId,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(0)},onSelect:l=>{var m;(m=c.onSelect)==null||m.call(c,l),me(a,o),t(l)}});a.mount(o)})}const tk={class:"page-edit-container"},ak={class:"edit-header"},ok={class:"header-left"},sk={class:"header-right"},lk={class:"fun-btn-group"},nk={class:"edit-content"},ik=J({__name:"index",props:{itemId:{},editPageId:{default:""},copyPageId:{default:""},catId:{default:""},onClose:{}},setup(c){const t=c,a=xe(),{t:o,locale:l}=te(),m=He(),f=b({title:"",content:"",catId:0}),d=b(!1),p=b(!1),h=b([]),$=b(null),g=b(null),n=b(!1),w=b(0),k=b(!1),r=b({title:"",content:"",catId:0}),_=b(!1);let v=null,y=null,S=null,x=null;const I=q(()=>({handler:async R=>{const Z=[];for(const pe of R)try{const $e=await we(pe);Z.push({url:$e})}catch($e){throw console.error("上传文件失败:",$e),$e}return Z},maxFileSize:10*1024*1024,accept:"image/*",multiple:!0})),T=q(()=>[{icon:["fas","fa-comment-dots"],text:o("page.save_and_notify"),value:"notify",onclick:je},{icon:["fas","fa-file-export"],text:o("page.save_as_template"),value:"template",onclick:Ze},{icon:n.value?["fas","fa-unlock"]:["fas","fa-lock"],text:n.value?o("page.unlock"):o("page.lock_edit"),value:"lock",onclick:x}]),M=q(()=>[{icon:["fas","fa-plug"],text:o("page.insert_api_template"),value:"apidoc",onclick:()=>ze("apidoc")},{icon:["fas","fa-database"],text:o("page.insert_database_template"),value:"database",onclick:()=>ze("database")},{icon:["fas","fa-folder-open"],text:o("page.template_list"),value:"more",onclick:Ye}]),L=q(()=>[{icon:["fas","fa-table"],text:o("page.json_to_table"),value:"toTable",onclick:()=>Ve("toTable")},{icon:["fas","fa-th"],text:o("page.beautify_json"),value:"beautify",onclick:()=>Ve("beautify")},{icon:["fas","fa-table"],text:o("page.paste_insert_table"),value:"pasteTable",onclick:()=>Ve("pasteTable")},{icon:["fas","fa-database"],text:o("page.sql_to_markdown_table"),value:"sqlToTable",onclick:()=>Ve("sqlToTable")}]),P=q(()=>{const R=[{icon:["fas","fa-history"],text:o("page.page_history_version"),value:"history",onclick:()=>De("history")}];return k.value&&R.push({icon:["fas","fa-robot"],text:o("page.ai_assistant"),value:"ai",onclick:()=>De("ai")}),R.push({icon:["fas","fa-vial"],text:o("page.mock_config"),value:"mock",onclick:()=>De("mock")},{icon:["fas","fa-link"],text:o("page.http_test_api"),value:"runapi",onclick:()=>De("runapi")}),R}),N=b(!0),U=q(()=>t.itemId),A=b(t.editPageId||""),D=q(()=>{const R=h.value.find(Z=>Z.catId===f.value.catId);return R?R.title:o("catalog.root_catalog")}),E=()=>{m.toggleTheme()},oe=()=>{t.onClose(!1),A.value&&(a.replace(`/${U.value}/${A.value}`),setTimeout(()=>{window.location.reload()},100))},ge=async R=>{if(R)try{const Z=await X("/api/page/info",{page_id:String(R)},"post",!1);Z.error_code===0&&Z.data&&(f.value.title=Z.data.page_title||"",f.value.catId=Number(Z.data.cat_id||0),f.value.content=It(Z.data.page_content||""),w.value=Z.data.attachment_count>0?Z.data.attachment_count:0,r.value={title:f.value.title,content:f.value.content,catId:f.value.catId})}catch(Z){console.error("获取页面内容失败:",Z),await G(o("page.fetch_content_failed"))}},fe=async()=>{if(A.value)try{const R=await X("/api/page/info",{page_id:String(A.value)},"post",!1);R.error_code===0&&R.data&&(w.value=R.data.attachment_count>0?R.data.attachment_count:0)}catch(R){console.error("获取附件数量失败:",R)}},ee=async()=>{if(U.value)try{const R=await X("/api/catalog/catListName",{item_id:String(U.value)},"post",!1);R.error_code===0&&R.data&&(h.value=[{catId:0,title:o("catalog.root_catalog")},...(R.data||[]).map(Z=>({catId:Number(Z.cat_id),title:Z.cat_name}))])}catch(R){console.error("获取目录列表失败:",R)}},W=async(R=!1,Z="")=>{var pe;if(!U.value){await G(o("page.item_id_required"));return}g.value&&g.value.getValue?f.value.content=g.value.getValue():$.value&&$.value.getMarkdown&&(f.value.content=$.value.getMarkdown()),f.value.title.trim()||(d.value=!1,f.value.title=o("page.untitled")),p.value=!0;try{const $e=await X("/api/page/save",{page_id:A.value||"",item_id:String(U.value),cat_id:f.value.catId,page_title:f.value.title,is_urlencode:1,page_content:encodeURIComponent(f.value.content),is_notify:R?1:0,notify_content:Z},"post",!1);if($e.error_code===0)ie.success(o("page.save_success")),!A.value&&((pe=$e.data)!=null&&pe.page_id)&&(A.value=$e.data.page_id),Ie(),r.value={title:f.value.title,content:f.value.content,catId:f.value.catId};else if($e.error_code===10401){const Ae=o("page.page_limit_exceeded_with_link");await G(Ae,{dangerouslyUseHTMLString:!0});return}else await G($e.error_message||o("page.save_failed"))}catch($e){console.error("保存失败:",$e),await G(o("page.save_failed"))}finally{p.value=!1}},ce=async()=>{const R=await ek({itemId:U.value,catId:f.value.catId});R>0&&(f.value.catId=R,await ye(),await W())},ye=async()=>{await ee()},ze=async R=>{if(R==="more")await pa({itemId:U.value,onInsert:Z=>{ue(Z)}});else if(R==="apidoc"){const Z=l.value==="en-US"?Uo:Po;ue(Z)}else if(R==="database"){const Z=l.value==="en-US"?Ao:Do;ue(Z)}},Ve=async R=>{R==="toTable"?await nw({onInsert:Z=>{ue(Z)}}):R==="beautify"?await dw({onInsert:Z=>{ue(Z)}}):R==="pasteTable"?await pw({onInsert:Z=>{ue(Z)}}):R==="sqlToTable"&&await yw({onInsert:Z=>{ue(Z)}})},De=async R=>{if(R==="history"){if(!A.value){await G(o("page.please_save_page_first"));return}await Lt({pageId:A.value,onRestore:async Z=>{f.value.content=Z,ie.success(o("page.restore_success"))}})}else if(R==="ai")await Ue();else if(R==="mock"){if(!A.value){await G(o("page.please_save_page_first"));return}await Pw({pageId:A.value,itemId:U.value})}else R==="runapi"&&window.open("http://runapi.showdoc.cc/")},Ze=async()=>{await U$({content:f.value.content,onSuccess:()=>{ie.success(o("page.save_template_success"))}})},je=async()=>{await tw({itemId:U.value,pageId:A.value,onConfirm:async R=>{await W(!0,R)}})},Ye=async()=>{await pa({itemId:U.value,onInsert:R=>{ue(R)}})},Ke=async()=>{if(!A.value){await G(o("page.page_id_required"));return}try{const R={page_id:String(A.value),item_id:String(U.value)};n.value&&(R.lock_to=1e3);const Z=await X("/api/page/setLock",R,"post",!1);Z.error_code===0?(n.value=!n.value,ie.success(n.value?o("page.lock_success"):o("page.unlock_success"))):await G(Z.error_message||o("page.operation_failed"))}catch(R){console.error("锁定操作失败:",R),await G(o("page.operation_failed"))}},Ue=async()=>{await q$({pageId:A.value,itemId:U.value,onInsert:R=>{ue(R)}})},Q=R=>{(R.ctrlKey||R.metaKey)&&R.key==="s"&&(R.preventDefault(),W())},se=()=>{if(!$.value)return!1;let R=null;if($.value.cm&&typeof $.value.cm.getWrapperElement=="function"&&(R=$.value.cm.getWrapperElement()),!R&&$.value.id&&(R=document.querySelector(`#${$.value.id} .CodeMirror-wrap`)),!R&&g.value&&g.value.getInstance){const Z=g.value.getInstance();Z!=null&&Z.cm&&(R=Z.cm.getWrapperElement())}return R?R.contains(document.activeElement):!1},be=async R=>{if(!se()||!$.value)return;const Z=R.clipboardData;if(Z)for(let pe=0;pe<Z.items.length;pe++){const $e=Z.items[pe];if($e.type.indexOf("image")>-1){R.preventDefault();const Ae=$e.getAsFile();if(Ae&&g.value)try{const Ne=await we(Ae);g.value.insertValue(`![${Ae.name}](${Ne})`),g.value.focus()}catch(Ne){console.error("粘贴上传图片失败:",Ne)}return}if($e.type==="text/html"){R.preventDefault();const Ae=await new Promise(et=>{$e.getAsString(et)}),Ne=document.querySelector("#pastebin");if(Ne){Ne.innerHTML=Ae;const et=Ne.innerText||Ne.textContent||"";if(Ne.innerHTML="",et.length<200)ue(et);else if(await Se({msg:o("page.paste_html_tips"),confirmText:o("page.past_html_markdown"),cancelText:o("page.past_html_text")})){const At=Te(Ae);ue(At)}else ue(et)}else{const et=Ae.replace(/<[^>]+>/g,"");if(et.length<200)ue(et);else if(await Se({msg:o("page.paste_html_tips"),confirmText:o("page.past_html_markdown"),cancelText:o("page.past_html_text")})){const At=Te(Ae);ue(At)}else ue(et)}return}}},Te=R=>R.replace(/<strong[^>]*>(.*?)<\/strong>/gi,"**$1**").replace(/<b[^>]*>(.*?)<\/b>/gi,"**$1**").replace(/<em[^>]*>(.*?)<\/em>/gi,"*$1*").replace(/<i[^>]*>(.*?)<\/i>/gi,"*$1*").replace(/<h1[^>]*>(.*?)<\/h1>/gi,`# $1
`).replace(/<h2[^>]*>(.*?)<\/h2>/gi,`## $1
`).replace(/<h3[^>]*>(.*?)<\/h3>/gi,`### $1
`).replace(/<code[^>]*>(.*?)<\/code>/gi,"`$1`").replace(/<pre[^>]*><code[^>]*>(.*?)<\/code><\/pre>/gis,"```\n$1\n```").replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]+>/g,""),we=async R=>{const Z=new FormData;Z.append("file",R),Z.append("item_id",String(U.value)),Z.append("page_id",String(A.value||0));try{const pe=await X("/api/attachment/attachmentUpload",Z,"post",!1);if(pe&&pe.success===1&&pe.url)return pe.url;{const $e=(pe==null?void 0:pe.message)||(pe==null?void 0:pe.error_message)||"上传失败",Ae=new Error($e);throw Ae.apiError=pe,Ae}}catch(pe){throw console.error("上传文件失败:",pe),pe}},le=R=>{var pe,$e;console.error("上传失败:",R);const Z=((pe=R.apiError)==null?void 0:pe.message)||(($e=R.apiError)==null?void 0:$e.error_message)||R.message||o("page.upload_failed");G(Z)},_e=async()=>{try{const R=await X("/api/common/homePageSetting",{},"post",!1);R.data&&R.data.is_show_ai&&(k.value=!0)}catch(R){console.error("获取AI配置失败:",R)}},ke=()=>{if(A.value){if(!(f.value.title!==r.value.title||f.value.content!==r.value.content||f.value.catId!==r.value.catId))return;const Z=`showdoc_draft_${A.value}`;localStorage.setItem(Z,JSON.stringify({title:f.value.title,content:f.value.content,catId:f.value.catId,timestamp:Date.now()}))}},he=async()=>{if(A.value){const R=`showdoc_draft_${A.value}`,Z=localStorage.getItem(R);if(Z)try{const pe=JSON.parse(Z),$e=new Date(pe.timestamp).toLocaleString();await Se({msg:o("page.recover_draft_confirm",{time:$e}),confirmText:o("common.confirm"),cancelText:o("common.cancel")})&&(f.value.title=pe.title,f.value.content=pe.content,f.value.catId=pe.catId),localStorage.removeItem(R)}catch(pe){console.error("读取草稿失败:",pe),localStorage.removeItem(R)}}},Ie=()=>{if(A.value){const R=`showdoc_draft_${A.value}`;localStorage.removeItem(R)}},Me=async()=>{if(A.value)try{const R=await X("/api/page/info",{page_id:String(A.value)},"post",!1);R.error_code===0&&R.data&&(n.value=R.data.is_locked===1)}catch(R){console.error("检查页面锁定状态失败:",R)}},Oe=async()=>{if(A.value)try{(await X("/api/page/setLock",{page_id:String(A.value),item_id:String(U.value)},"post",!1)).error_code===0&&(n.value=!0)}catch(R){console.error("锁定页面失败:",R)}},mt=async()=>{if(n.value)try{(await X("/api/page/setLock",{page_id:String(A.value),item_id:String(U.value),lock_to:1e3},"post",!1)).error_code===0&&(n.value=!1)}catch(R){console.error("解锁页面失败:",R)}},_t=()=>{S=setInterval(()=>{n.value&&Oe()},20*60*1e3)};x=async()=>{await Ke()};const pt=async()=>{if(A.value)try{const R=await X("/api/page/isLock",{page_id:String(A.value),item_id:String(U.value)},"post",!1);R.error_code===0&&R.data&&(R.data.lock>0?R.data.is_cur_user>0?n.value=!0:(alert(o("page.locking")+R.data.lock_username),t.onClose(!1)):await Oe())}catch(R){console.error("检查远程锁定状态失败:",R)}},Ut=async()=>{await Ba({itemId:U.value,pageId:A.value,manage:!0,onClose:()=>{fe()},onInsert:R=>{ue(R)}})},Pt=R=>{$.value=R},ue=R=>{g.value?(g.value.insertValue(R),g.value.focus&&g.value.focus()):$.value&&($.value.insertValue(R),$.value.focus&&$.value.focus())};return qe(()=>[f.value.title,f.value.content,f.value.catId],()=>{clearTimeout(v),v=setTimeout(()=>{ke()},2e3)},{deep:!0}),ae(async()=>{N.value=!0,await ee(),t.copyPageId>0?(await ge(t.copyPageId),f.value.title=o("page.copy_of",{title:f.value.title})):t.editPageId>0?(await ge(t.editPageId),await Me(),await he(),await pt(),_t()):(f.value.catId=Number(t.catId),f.value.title="",f.value.content="",r.value={title:"",content:"",catId:Number(t.catId)}),_.value=!0,await _e(),window.addEventListener("keydown",Q),document.addEventListener("paste",be)}),Xe(()=>{clearTimeout(v),clearInterval(y),clearInterval(S),Ie(),mt(),window.removeEventListener("keydown",Q),document.removeEventListener("paste",be)}),(R,Z)=>{const pe=H("a-button"),$e=H("a-tooltip"),Ae=H("a-badge");return C(),B(hs,{show:N.value,"mask-closable":!1,onClose:oe},{default:u(()=>[e("div",tk,[e("div",ak,[e("div",ok,[s(pe,{class:"close-btn",onClick:oe},{default:u(()=>[...Z[5]||(Z[5]=[e("i",{class:"fas fa-times"},null,-1)])]),_:1}),d.value?(C(),B(ne,{key:1,modelValue:f.value.title,"onUpdate:modelValue":Z[1]||(Z[1]=Ne=>f.value.title=Ne),class:"page-title-input",placeholder:R.$t("page.input_page_title"),onBlur:Z[2]||(Z[2]=Ne=>d.value=!1),onKeyup:Z[3]||(Z[3]=Fe(Ne=>d.value=!1,["enter"]))},null,8,["modelValue","placeholder"])):(C(),B($e,{key:0,title:R.$t("page.click_to_edit_page_title")},{default:u(()=>[e("span",{class:"page-title",onClick:Z[0]||(Z[0]=Ne=>d.value=!0)},i(f.value.title||R.$t("page.untitled")),1)]),_:1},8,["title"])),s($e,{title:R.$t("page.select_catalog")},{default:u(()=>[e("span",{class:"catalog-selector",onClick:ce},[Z[6]||(Z[6]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(D.value),1)])]),_:1},8,["title"])]),e("div",sk,[s($e,{title:z(m).theme==="light"?R.$t("common.dark_mode"):R.$t("common.light_mode"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:E},[...Z[7]||(Z[7]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),s(Ct,{text:R.$t("common.save"),theme:"dark",list:T.value,spinning:p.value,"left-icon":["fas","fa-save"],"on-click":W},null,8,["text","list","spinning"])])]),e("div",lk,[s(Ct,{text:R.$t("page.insert_template"),theme:"light",list:M.value,"left-icon":["far","fa-files"]},null,8,["text","list"]),s(Ct,{text:R.$t("page.format_tools"),theme:"light",list:L.value,"left-icon":["far","fa-gear"]},null,8,["text","list"]),s(Ct,{text:R.$t("page.document_tools"),theme:"light",list:P.value,"left-icon":["fas","fa-gear"]},null,8,["text","list"]),s(Ae,{count:w.value,offset:[10,10],color:"var(--icon-tag-color)"},{default:u(()=>[s(K,{text:R.$t("page.attachments"),"left-icon":["fas","fa-paperclip"],theme:"light",onClick:Ut},null,8,["text"])]),_:1},8,["count"])]),e("div",nk,[_.value?(C(),B(St,{key:0,ref_key:"editormdEditorRef",ref:g,modelValue:f.value.content,"onUpdate:modelValue":Z[4]||(Z[4]=Ne=>f.value.content=Ne),mode:"editor",height:"70vh",upload:I.value,onLoad:Pt,onUploadError:le},null,8,["modelValue","upload"])):F("",!0)]),Z[8]||(Z[8]=e("div",{id:"pastebin",contenteditable:"true"},null,-1))])]),_:1},8,["show"])}}});const rk=Y(ik,[["__scopeId","data-v-f5c600a1"]]);function rt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(rk,{itemId:c.itemId,editPageId:c.editPageId||0,copyPageId:c.copyPageId||0,catId:c.catId||0,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const ck={class:"page-edit-page"},dk=J({__name:"Index",setup(c){const t=Ge(),a=xe();He();const o=t.params.item_id,l=t.params.page_id,m=t.query.cat_id||"";return ae(async()=>{const f=await rt({itemId:o,editPageId:l,catId:m});f&&l?window.location.reload():a.back()}),(f,d)=>(C(),V("div",ck))}});const uk=Y(dk,[["__scopeId","data-v-592800ea"]]),MS=Object.freeze(Object.defineProperty({__proto__:null,default:uk},Symbol.toStringTag,{value:"Module"})),mk={key:0,class:"pos"},_k={class:"header-wrap"},pk={class:"logo"},fk={class:"logo-content"},vk={class:"font-bold"},hk={class:"doc-container",id:"doc-container"},gk={class:"doc-title-box"},yk={id:"doc-title"},wk={id:"page_md_content",class:"page_content_main"},bk={key:0,class:"error-message"},$k={key:2,class:"toc-side"},kk=J({__name:"Index",setup(c){const t=Ge(),a=xe(),{t:o}=te(),l=b(!1),m=b(""),f=b(""),d=b(0),p=b(0),h=b(0),$=b(!1),g=b(!0),n=b(!0),w=b(""),k=b(!1),r=b(0),_=b(!1),v=b(0),y=()=>{const N=window.innerWidth;l.value=N<=768||N<1e3||k.value},S=()=>{if(!l.value)return;const N=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;N<100||N<v.value?_.value=!1:_.value=!0,v.value=N},x=async()=>{const N=t.params.page_id,U=t.params.unique_key;if(!N&&!U){w.value=o("page.show.page_not_found");return}try{const E=await X(U?"/api/page/infoByKey":"/api/page/info",{page_id:N,unique_key:U},"post",!1);if(E.error_code===0){const oe=E.data.page_content||"";$.value=!1;try{const fe=JSON.parse(Zt(oe));$.value=!!(fe&&fe.info&&fe.info.url)}catch{}m.value=It(oe),f.value=E.data.page_title,d.value=E.data.page_id,p.value=E.data.item_id||0,h.value=E.data.cat_id||0,w.value="",document.title=f.value+"--ShowDoc";const ge=document.querySelector('meta[name="description"]');ge&&ge.setAttribute("content",f.value)}else E.error_code===10104&&!U?a.replace({path:"/captcha/index",query:{page_id:N,unique_key:U,type:"visit_page",redirect:t.fullPath}}):(E.error_code===10307||E.error_code===10303)&&!U?a.replace({path:"/item/password/0",query:{page_id:N,redirect:t.fullPath}}):w.value=E.error_message||o("page.show.load_failed")}catch{w.value=o("page.show.load_failed")}},I=()=>{k.value=!k.value,y(),r.value++},T=()=>{window.location.href="/"},M=()=>{window.location.reload()},L=()=>{if(y(),l.value){g.value=!1,n.value=!1;const N=document.getElementById("doc-container");N&&(N.style.width="95%",N.style.padding="5px")}else P()},P=()=>{const N=document.querySelector(".toc-side"),U=document.querySelector(".toc-list");if(!N||!U)return;const A=window.innerWidth,D=(A-850)/2+850,E=D+40;console.log("屏幕宽度:",A),console.log("内容区右边缘:",D),console.log("TOC left值:",E),N.setAttribute("style",`right: auto; left: ${E}px;`)};return ae(()=>{if(y(),x(),l.value)g.value=!1,n.value=!1;else{const N=U=>{setTimeout(()=>{P()},U)};N(500),N(1e3),N(1500),N(2e3)}window.addEventListener("resize",L),window.addEventListener("scroll",S)}),Xe(()=>{window.removeEventListener("resize",L),window.removeEventListener("scroll",S),document.title="ShowDoc"}),(N,U)=>(C(),V("div",{class:re(["page-show",{"mobile-view":l.value||k.value}])},[l.value?(C(),V("div",mk)):F("",!0),l.value?(C(),V("div",{key:1,class:re(["mobile-header",{"hide-element":_.value}])},[e("div",_k,[e("div",pk,[e("div",fk,[U[1]||(U[1]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",vk,i(f.value||z(o)("page.show.title")),1)])]),k.value?(C(),V("div",{key:1,class:"exit-fullscreen-btn",onClick:M},[U[3]||(U[3]=e("i",{class:"fas fa-compress"},null,-1)),e("span",null,i(z(o)("common.exit_fullscreen")),1)])):(C(),V("div",{key:0,class:"back-btn",onClick:T},[U[2]||(U[2]=e("i",{class:"fas fa-home"},null,-1)),O(" "+i(N.$t("common.home")),1)]))])],2)):F("",!0),e("div",{class:re(["content-wrapper",{"mobile-wrapper":l.value}])},[e("div",hk,[e("div",gk,[e("h2",yk,i(f.value),1),!l.value&&g.value&&!k.value?(C(),V("i",{key:0,class:re(k.value?"fas fa-compress":"fas fa-expand"),id:"full-page",onClick:I},null,2)):F("",!0)]),e("div",wk,[d.value&&m.value?(C(),B(St,{key:r.value,modelValue:m.value,"onUpdate:modelValue":U[0]||(U[0]=A=>m.value=A),mode:"preview"},null,8,["modelValue"])):F("",!0)]),w.value?(C(),V("div",bk,[U[4]||(U[4]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,i(w.value),1)])):F("",!0)])],2),d.value&&m.value&&!l.value&&n.value&&!k.value?(C(),V("div",$k,[s(aa)])):F("",!0)],2))}});const Ck=Y(kk,[["__scopeId","data-v-1a0b1c04"]]),LS=Object.freeze(Object.defineProperty({__proto__:null,default:Ck},Symbol.toStringTag,{value:"Module"})),xk={class:"page-diff-page"},Ik={class:"container-narrow"},Sk={class:"view-type-wrapper"},Tk={id:"diffoutput"},Mk=J({__name:"Index",setup(c){const t=Ge(),{t:a}=te(),o=b(""),l=b(""),m=b(0),f=b(!0),d=g=>{m.value=g,p(g)},p=g=>{if(typeof window.difflib>"u"||typeof window.diffview>"u"){console.error("difflib 或 diffview 未加载");return}const n=y=>document.getElementById(y),w=window.difflib.stringAsLines(n("baseText").value),k=window.difflib.stringAsLines(n("newText").value),_=new window.difflib.SequenceMatcher(w,k).get_opcodes(),v=n("diffoutput");v&&(v.innerHTML="",v.appendChild(window.diffview.buildView({baseTextLines:w,newTextLines:k,opcodes:_,baseTextName:a("page.cur_page_content"),newTextName:a("page.history_version"),viewType:g})))},h=async()=>{const g=t.params.page_id,n=t.params.page_history_id;if(!g||!n){console.error("缺少参数: page_id 或 page_history_id");return}f.value=!0;try{const w=await X("/api/page/diff",{page_id:g,page_history_id:n},"post",!1);w.error_code===0&&w.data?(o.value=w.data.page.page_content||"",l.value=w.data.history_page.page_content||"",await ct(),p(m.value)):console.error("获取对比数据失败:",w.error_message)}catch(w){console.error("获取对比数据失败:",w)}finally{f.value=!1}},$=async()=>{const g=w=>new Promise((k,r)=>{const _=document.createElement("script");_.src=w,_.onload=()=>k(),_.onerror=r,document.head.appendChild(_)}),n=document.createElement("link");n.href="/diff/diffview.css",n.rel="stylesheet",document.head.appendChild(n);try{await g("/diff/difflib.js"),await g("/diff/diffview.js")}catch(w){console.error("加载 diff 脚本失败:",w)}};return document.title=`${a("page.version_comparison")}--ShowDoc`,ae(async()=>{await $(),await h()}),(g,n)=>{const w=oo("loading");return C(),V("div",xk,[e("div",Ik,[ft(e("textarea",{id:"baseText","onUpdate:modelValue":n[0]||(n[0]=k=>o.value=k),style:{display:"none"}},null,512),[[qt,o.value]]),ft(e("textarea",{id:"newText","onUpdate:modelValue":n[1]||(n[1]=k=>l.value=k),style:{display:"none"}},null,512),[[qt,l.value]]),e("div",Sk,[s(K,{theme:m.value===0?"dark":"light",onClick:n[2]||(n[2]=k=>d(0))},{default:u(()=>[O(i(g.$t("page.side_by_side")),1)]),_:1},8,["theme"]),s(K,{theme:m.value===1?"dark":"light",onClick:n[3]||(n[3]=k=>d(1))},{default:u(()=>[O(i(g.$t("page.inline")),1)]),_:1},8,["theme"])]),ft(e("div",Tk,null,512),[[w,f.value]])])])}}});const Lk=Y(Mk,[["__scopeId","data-v-60214042"]]),VS=Object.freeze(Object.defineProperty({__proto__:null,default:Lk},Symbol.toStringTag,{value:"Module"})),Vk=["onClick"],zk=J({__name:"Member",props:{team_id:{},team_manage:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=b([]),m=b(!1),f=b(!1),d=b({member_username:[],team_member_group_id:"1"}),p=async()=>{try{const r=await Bt(a.team_id);r.error_code===0&&(o.value=r.data||[])}catch(r){console.error("获取团队成员列表失败:",r)}},h=async()=>{m.value=!0;try{const r=await jt({username:""});if(r.error_code===0&&r.data){const _=r.data,v=[];for(let y=0;y<_.length;y++)o.value.some(x=>x.member_username===_[y].username)||v.push(_[y]);l.value=v.map(y=>({label:y.name?`${y.username}(${y.name})`:y.username,value:y.username}))}}catch(r){console.error("获取全站用户列表失败:",r)}finally{m.value=!1}},$=()=>{d.value={member_username:[],team_member_group_id:"1"},h(),f.value=!0},g=async()=>{if(!d.value.member_username||d.value.member_username.length===0){await G(t("item.member_username")+t("common.required"));return}try{let r=0,_=0;for(const v of d.value.member_username){const y=await wa({team_id:a.team_id,member_username:v,team_member_group_id:d.value.team_member_group_id});y.error_code===0?r++:(_++,console.error(`添加成员 ${v} 失败:`,y.error_message))}if(r>0){let v=t("common.op_success");_>0&&(v=`${v} (成功${r}个，失败${_}个)`),j.success(v),f.value=!1,p()}else j.error(t("common.op_failed"))}catch(r){console.error("添加成员失败:",r),j.error(t("common.op_failed"))}},n=()=>{f.value=!1},w=async r=>{if(await Se(t("item.confirm_delete"),t("item.confirm_delete_member")))try{const v=await ba(r);v.error_code===0?(j.success(t("common.op_success")),p()):j.error(v.error_message||t("common.op_failed"))}catch(v){console.error("删除成员失败:",v),j.error(t("common.op_failed"))}},k=()=>{a.callback()};return ae(()=>{p()}),(r,_)=>{const v=H("a-table-column"),y=H("a-table"),S=H("a-form-item"),x=H("a-radio"),I=H("a-radio-group"),T=H("a-form");return C(),V(Ce,null,[s(de,{show:!0,title:z(t)("item.manage_members"),showCancel:!1,showOk:!1,onClose:k},{extraButtons:u(()=>[c.team_manage==1||c.team_manage==2?(C(),B(K,{key:0,theme:"dark",onClick:$},{default:u(()=>[_[2]||(_[2]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.add_member")),1)]),_:1})):F("",!0)]),default:u(()=>[s(y,{dataSource:o.value,pagination:!1,emptyText:z(t)("item.empty_team_member_tips")},{default:u(()=>[s(v,{key:"member_username",title:z(t)("item.member_username")},{default:u(({record:M})=>[O(i(M.member_username),1)]),_:1},8,["title"]),s(v,{key:"team_member_group_id",title:z(t)("item.member_authority")},{default:u(({record:M})=>[O(i(M.team_member_group_id==2?z(t)("item.team_admin"):z(t)("item.ordinary_member")),1)]),_:1},8,["title"]),s(v,{key:"name",title:z(t)("item.name")},{default:u(({record:M})=>[O(i(M.name),1)]),_:1},8,["title"]),s(v,{key:"addtime",title:z(t)("item.addtime")},{default:u(({record:M})=>[O(i(M.addtime),1)]),_:1},8,["title"]),s(v,{key:"operation",title:z(t)("item.operation")},{default:u(({record:M})=>[c.team_manage==1||c.team_manage==2?(C(),V("a",{key:0,onClick:L=>w(M.id)},i(z(t)("common.delete")),9,Vk)):F("",!0)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),f.value?(C(),B(de,{key:0,title:z(t)("item.add_member"),showCancel:!0,showOk:!0,width:"500px",onClose:n,onConfirm:g},{default:u(()=>[s(T,{layout:"vertical"},{default:u(()=>[s(S,{label:z(t)("item.member_username")},{default:u(()=>[s(Re,{value:d.value.member_username,"onUpdate:value":_[0]||(_[0]=M=>d.value.member_username=M),options:l.value,placeholder:z(t)("item.search_member_placeholder"),loading:m.value,multiple:!0,"show-search":!0},null,8,["value","options","placeholder","loading"])]),_:1},8,["label"]),s(S,null,{default:u(()=>[s(I,{value:d.value.team_member_group_id,"onUpdate:value":_[1]||(_[1]=M=>d.value.team_member_group_id=M)},{default:u(()=>[s(x,{value:"1"},{default:u(()=>[O(i(z(t)("item.ordinary_member")),1)]),_:1}),s(x,{value:"2"},{default:u(()=>[O(i(z(t)("item.team_admin")),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1},8,["title"])):F("",!0)],64)}}});const Ga=Y(zk,[["__scopeId","data-v-af29322e"]]),zS=Object.freeze(Object.defineProperty({__proto__:null,default:Ga},Symbol.toStringTag,{value:"Module"})),Uk=["onClick"],Pk=["onClick"],Ak=["onClick"],Dk={href:"/item/index",target:"_blank"},Ok={class:"tips-text"},Nk={components:{ConfirmModal:Se}},Fk=J({...Nk,__name:"Item",props:{team_id:{},team_manage:{},callback:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b([]),m=b([]),f=b([]),d=b([]),p=b(!1),h=b(!1),$=b({item_id:[]}),g=b(0);q(()=>m.value.map(N=>({label:N.item_name,value:N.item_id})));const n=async()=>{try{const N=await $a(o.team_id);N.error_code===0&&(l.value=N.data||[])}catch(N){console.error("获取团队项目列表失败:",N)}},w=async()=>{try{const N=await kt(0);N.error_code===0&&(m.value=(N.data||[]).filter(U=>U.original===1))}catch(N){console.error("获取项目列表失败:",N)}},k=()=>{$.value={item_id:[]},p.value=!0},r=()=>{p.value=!1},_=async()=>{try{for(const N of $.value.item_id)await Gt(String(N),String(o.team_id));j.success(t("common.op_success")),p.value=!1,$.value={item_id:[]},n()}catch(N){console.error("绑定项目失败:",N),j.error(t("common.op_failed"))}},v=N=>{const U=a.resolve({path:`/${N}`}).href;window.open(U,"_blank")},y=async N=>{if(await Se.confirm({title:t("item.confirm_unassign"),content:t("item.confirm_unassign_item")}))try{const A=await Wt(N);A.error_code===0?(j.success(t("common.op_success")),n()):j.error(A.error_message||t("common.op_failed"))}catch(A){console.error("解绑项目失败:",A),j.error(t("common.op_failed"))}},S=async N=>{g.value=Number(N);try{await L(N);const U=await Kt(N,o.team_id);U.error_code===0&&(f.value=(U.data||[]).map(A=>({...A,cat_ids:Array.isArray(A.cat_ids)?A.cat_ids.map(D=>Number(D)):[]})),h.value=!0)}catch(U){console.error("获取团队成员失败:",U)}},x=()=>{h.value=!1},I=async(N,U)=>{try{const A=await nt({member_group_id:N,id:U});A.error_code===0?j.success(t("item.auth_success")):j.error(A.error_message||t("common.op_failed"))}catch(A){console.error("修改权限失败:",A),j.error(t("common.op_failed"))}},T=async(N,U)=>{try{const A=await nt({cat_ids:(N||[]).join(","),id:U});A.error_code===0?j.success(t("item.cat_success")):j.error(A.error_message||t("common.op_failed"))}catch(A){console.error("修改目录失败:",A),j.error(t("common.op_failed"))}},M=async()=>{for(const N of f.value)try{await nt({member_group_id:"0",id:N.id}),setTimeout(()=>{S(String(N.item_id))},500)}catch(U){console.error("修改权限失败:",U)}},L=async N=>{try{const U=await xt(N);if(U.error_code===0){const A=U.data||[];A.unshift({cat_id:0,cat_name:t("item.all_cat")}),d.value=A.map(D=>({...D,cat_id:Number(D.cat_id)}))}}catch(U){console.error("获取目录列表失败:",U)}},P=()=>{o.callback()};return ae(()=>{n(),w()}),(N,U)=>{const A=H("a-table-column"),D=H("a-divider"),E=H("a-table"),oe=H("a-form-item"),ge=H("a-form"),fe=H("a-select-option"),ee=H("a-select");return C(),V(Ce,null,[s(de,{show:!0,title:z(t)("item.item_manage"),showCancel:!1,showOk:!1,width:"800px",onClose:P},{extraButtons:u(()=>[c.team_manage>0?(C(),B(K,{key:0,type:"primary",onClick:k},{default:u(()=>[U[1]||(U[1]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.binding_item")),1)]),_:1})):F("",!0)]),default:u(()=>[s(E,{dataSource:l.value,pagination:!1,emptyText:z(t)("item.empty_team_item_tips")},{default:u(()=>[s(A,{key:"item_name",title:z(t)("item.item_name")},{default:u(({record:W})=>[O(i(W.item_name),1)]),_:1},8,["title"]),s(A,{key:"addtime",title:z(t)("item.Join_time")},{default:u(({record:W})=>[O(i(W.addtime),1)]),_:1},8,["title"]),s(A,{key:"operation",title:z(t)("item.operation")},{default:u(({record:W})=>[e("a",{onClick:ce=>v(W.item_id),target:"_blank"},i(z(t)("item.check_item")),9,Uk),c.team_manage>0?(C(),V(Ce,{key:0},[s(D,{type:"vertical"}),e("a",{onClick:ce=>S(W.item_id)},i(z(t)("item.member_authority")),9,Pk),s(D,{type:"vertical"}),e("a",{onClick:ce=>y(W.id)},i(z(t)("item.unassign")),9,Ak)],64)):F("",!0)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),p.value?(C(),B(de,{key:0,title:z(t)("item.item"),showCancel:!0,showOk:!0,width:"400px",onClose:r,onConfirm:_},{default:u(()=>[s(ge,{layout:"vertical"},{default:u(()=>[s(oe,{label:z(t)("item.please_choose")},{default:u(()=>[s(Re,{value:$.value.item_id,"onUpdate:value":U[0]||(U[0]=W=>$.value.item_id=W),multiple:!0,placeholder:z(t)("item.please_choose"),options:m.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),e("p",null,[e("a",Dk,i(z(t)("item.go_to_new_an_item")),1)])]),_:1},8,["title"])):F("",!0),h.value?(C(),B(de,{key:1,title:z(t)("item.adjust_member_authority"),showCancel:!1,showOk:!1,width:"800px",onClose:x},{default:u(()=>[e("p",null,[e("a",{onClick:M},i(z(t)("item.all_member_read")),1)]),s(E,{dataSource:f.value,pagination:!1,emptyText:z(t)("item.team_member_empty_tips")},{default:u(()=>[s(A,{key:"member_username",title:z(t)("item.username")},{default:u(({record:W})=>[O(i(W.member_username),1)]),_:1},8,["title"]),s(A,{key:"name",title:z(t)("item.name")},{default:u(({record:W})=>[O(i(W.name),1)]),_:1},8,["title"]),s(A,{key:"member_group_id",title:z(t)("item.authority"),width:"130"},{default:u(({record:W})=>[s(ee,{size:"small",value:W.member_group_id,"onUpdate:value":ce=>W.member_group_id=ce,style:{width:"100%"},onChange:ce=>I(ce,W.id)},{default:u(()=>[s(fe,{value:"1"},{default:u(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(fe,{value:"0"},{default:u(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(fe,{value:"2"},{default:u(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value","onUpdate:value","onChange"])]),_:1},8,["title"]),s(A,{key:"cat_ids",title:z(t)("item.catalog"),width:"200"},{default:u(({record:W})=>[W.member_group_id<="1"?(C(),B(ee,{key:0,size:"small",value:W.cat_ids,"onUpdate:value":ce=>W.cat_ids=ce,mode:"multiple",style:{width:"100%"},onChange:ce=>T(ce,W.id)},{default:u(()=>[(C(!0),V(Ce,null,Pe(d.value,ce=>(C(),B(fe,{key:ce.cat_id,value:ce.cat_id},{default:u(()=>[O(i(ce.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):F("",!0)]),_:1},8,["title"]),s(A,{key:"addtime",title:z(t)("item.add_time")},{default:u(({record:W})=>[O(i(W.addtime),1)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"]),e("p",Ok,i(z(t)("item.team_member_authority_tips")),1)]),_:1},8,["title"])):F("",!0)],64)}}});const Ka=Y(Fk,[["__scopeId","data-v-2a424623"]]),US=Object.freeze(Object.defineProperty({__proto__:null,default:Ka},Symbol.toStringTag,{value:"Module"})),qk=["onClick"],Rk=["onClick"],Hk=["onClick"],Ek=["onClick"],jk=["onClick"],Bk=["onClick"],Gk=["onClick"],Kk=["onClick"],Wk={class:"tips-text"},Jk=J({__name:"Index",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=b({id:0,team_manage:0,team_name:""}),m=b(""),f=b(!1),d=b(!1),p=b(!1),h=b(!1),$=b({team_name:""}),g=b({team_id:"",username:"",password:""}),n=async()=>{try{const U=await Jt();U.error_code===0&&(o.value=U.data||[])}catch(U){console.error("获取团队列表失败:",U)}},w=()=>{m.value="",$.value={team_name:""},f.value=!0},k=U=>{m.value=U.id,$.value={team_name:U.team_name},f.value=!0},r=()=>{f.value=!1,$.value={team_name:""}},_=async()=>{try{const U=await Rt({id:m.value,team_name:$.value.team_name});U.error_code===0?(j.success(t("common.op_success")),f.value=!1,$.value={team_name:""},m.value="",n()):j.error(U.error_message||t("common.op_failed"))}catch(U){console.error("保存团队失败:",U),j.error(t("common.op_failed"))}},v=async U=>{if(await Se.confirm({title:t("item.confirm_delete"),content:t("item.confirm_delete_team")}))try{const D=await Ca(U);D.error_code===0?(j.success(t("common.op_success")),n()):j.error(D.error_message||t("common.op_failed"))}catch(D){console.error("删除团队失败:",D),j.error(t("common.op_failed"))}},y=U=>{g.value={team_id:U.id,username:"",password:""},d.value=!0},S=()=>{d.value=!1,g.value={team_id:"",username:"",password:""}},x=async()=>{try{const U=await ka(g.value.team_id,g.value.username,g.value.password);U.error_code===0?(j.success(t("common.op_success")),d.value=!1,g.value={team_id:"",username:"",password:""},n()):j.error(U.error_message||t("common.op_failed"))}catch(U){console.error("转让团队失败:",U),j.error(t("common.op_failed"))}},I=async U=>{if(await Se.confirm({title:t("item.team_exit_confirm"),content:t("item.team_exit_confirm_content")}))try{const D=await xa(U);D.error_code===0?(j.success(t("common.op_success")),n()):j.error(D.error_message||t("common.op_failed"))}catch(D){console.error("退出团队失败:",D),j.error(t("common.op_failed"))}},T=U=>{l.value=U,p.value=!0},M=U=>{l.value=U,h.value=!0},L=()=>{p.value=!1,n()},P=()=>{h.value=!1,n()},N=()=>{a.callback&&a.callback()};return ae(()=>{n()}),(U,A)=>{const D=H("a-table-column"),E=H("a-divider"),oe=H("a-table"),ge=H("a-form-item"),fe=H("a-form");return C(),V(Ce,null,[s(de,{show:!0,title:z(t)("item.team_mamage"),showCancel:!1,showOk:!1,width:"800px",onClose:N},{extraButtons:u(()=>[s(K,{type:"primary",onClick:w},{default:u(()=>[A[3]||(A[3]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.add_team")),1)]),_:1})]),default:u(()=>[s(oe,{dataSource:o.value,pagination:!1,emptyText:z(t)("item.empty_team_tips")},{default:u(()=>[s(D,{key:"team_name",title:z(t)("item.team_name")},{default:u(({record:ee})=>[O(i(ee.team_name),1)]),_:1},8,["title"]),s(D,{key:"memberCount",title:z(t)("item.memberCount")},{default:u(({record:ee})=>[e("a",{onClick:W=>T(ee)},i(ee.memberCount),9,qk)]),_:1},8,["title"]),s(D,{key:"itemCount",title:z(t)("item.itemCount")},{default:u(({record:ee})=>[e("a",{onClick:W=>M(ee)},i(ee.itemCount),9,Rk)]),_:1},8,["title"]),s(D,{key:"operation",title:z(t)("item.operation")},{default:u(({record:ee})=>[e("a",{onClick:W=>T(ee)},i(z(t)("item.member")),9,Hk),s(E,{type:"vertical"}),e("a",{onClick:W=>M(ee)},i(z(t)("item.team_item")),9,Ek),ee.team_manage==1||ee.team_manage==2?(C(),V(Ce,{key:0},[s(E,{type:"vertical"}),e("a",{onClick:W=>k(ee)},i(z(t)("item.edit")),9,jk),s(E,{type:"vertical"}),e("a",{onClick:W=>y(ee)},i(z(t)("item.attorn_team")),9,Bk),s(E,{type:"vertical"}),e("a",{onClick:W=>v(ee.id)},i(z(t)("item.delete")),9,Gk)],64)):(C(),V(Ce,{key:1},[s(E,{type:"vertical"}),e("a",{onClick:W=>I(ee.id)},i(z(t)("item.team_exit")),9,Kk)],64))]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),f.value?(C(),B(de,{key:0,title:m.value?z(t)("item.edit_team"):z(t)("item.add_team"),showCancel:!0,showOk:!0,width:"400px",onClose:r,onConfirm:_},{default:u(()=>[s(fe,{layout:"vertical"},{default:u(()=>[s(ge,{label:z(t)("item.team_name")},{default:u(()=>[s(ne,{modelValue:$.value.team_name,"onUpdate:modelValue":A[0]||(A[0]=ee=>$.value.team_name=ee),placeholder:z(t)("item.team_name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["title"])):F("",!0),d.value?(C(),B(de,{key:1,title:z(t)("item.attorn_team"),showCancel:!0,showOk:!0,width:"400px",onClose:S,onConfirm:x},{default:u(()=>[s(fe,{layout:"vertical"},{default:u(()=>[s(ge,{label:z(t)("item.attorn_username")},{default:u(()=>[s(ne,{modelValue:g.value.username,"onUpdate:modelValue":A[1]||(A[1]=ee=>g.value.username=ee),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(ge,{label:z(t)("item.input_login_password")},{default:u(()=>[s(ne,{modelValue:g.value.password,"onUpdate:modelValue":A[2]||(A[2]=ee=>g.value.password=ee),type:"password",placeholder:z(t)("item.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",Wk,i(z(t)("item.attornTeamTips")),1)]),_:1},8,["title"])):F("",!0),p.value?(C(),B(Ga,{key:2,team_id:l.value.id,team_manage:l.value.team_manage,callback:L},null,8,["team_id","team_manage"])):F("",!0),h.value?(C(),B(Ka,{key:3,team_id:l.value.id,team_manage:l.value.team_manage,callback:P},null,8,["team_id","team_manage"])):F("",!0)],64)}}});const Yk=Y(Jk,[["__scopeId","data-v-a0382503"]]),PS=Object.freeze(Object.defineProperty({__proto__:null,default:Yk},Symbol.toStringTag,{value:"Module"})),Xk={class:"message-page"},Qk=J({__name:"Index",setup(c){const t=Ge();return ae(()=>{const a=t.query.dtab;sa(a)}),(a,o)=>(C(),V("div",Xk))}});const Zk=Y(Qk,[["__scopeId","data-v-e34b9a7d"]]),AS=Object.freeze(Object.defineProperty({__proto__:null,default:Zk},Symbol.toStringTag,{value:"Module"})),e2={class:"attachment-page"},t2=J({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),V("div",e2,[e("h2",null,i(t.$t("attachment.my_attachment")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:u(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const a2=Y(t2,[["__scopeId","data-v-5e0198e1"]]),DS=Object.freeze(Object.defineProperty({__proto__:null,default:a2},Symbol.toStringTag,{value:"Module"})),o2={class:"modal-form"},s2={class:"form-group"},l2={class:"form-label"},n2={class:"form-group"},i2={class:"form-label"},r2={class:"form-group"},c2={class:"form-label"},d2=["placeholder"],u2={class:"modal-footer"},m2=J({__name:"index",props:{user:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=Je({username:"",name:"",password:"",uid:""});ae(()=>{o.value=!0,a.user&&(l.username=a.user.username||"",l.name=a.user.name||"",l.uid=a.user.uid)});const m=()=>a.onClose(!1),f=async()=>{try{const d={username:l.username,name:l.name,uid:l.uid};a.user?l.password&&(d.password=l.password):d.password=l.password,await Oo(d),j.success(t("common.save_success")),a.onClose(!0)}catch{j.error(t("common.save_failed"))}};return(d,p)=>(C(),B(de,{show:o.value,title:c.user?z(t)("admin.edit_user"):z(t)("admin.add_user"),width:"400px",onClose:m},{footer:u(()=>[e("div",u2,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:m},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),onClick:f},null,8,["text"])])]),default:u(()=>[e("div",o2,[e("div",s2,[e("label",l2,i(z(t)("admin.username")),1),s(ne,{modelValue:l.username,"onUpdate:modelValue":p[0]||(p[0]=h=>l.username=h),placeholder:z(t)("admin.username_placeholder"),disabled:!!c.user},null,8,["modelValue","placeholder","disabled"])]),e("div",n2,[e("label",i2,i(z(t)("admin.name")),1),s(ne,{modelValue:l.name,"onUpdate:modelValue":p[1]||(p[1]=h=>l.name=h),placeholder:z(t)("admin.name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",r2,[e("label",c2,i(z(t)("user.password")),1),ft(e("input",{"onUpdate:modelValue":p[2]||(p[2]=h=>l.password=h),type:"password",class:"password-input",placeholder:c.user?z(t)("admin.password_tip"):z(t)("user.password")},null,8,d2),[[qt,l.password]])])])]),_:1},8,["show","title"]))}});const _2=Y(m2,[["__scopeId","data-v-06150037"]]);function fa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(_2,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const p2={class:"user-management"},f2={class:"search-section"},v2={class:"search-row"},h2={class:"search-input"},g2={class:"table-section"},y2={class:"table-action-buttons"},w2=["onClick"],b2=["onClick"],$2=J({__name:"UserManagement",setup(c){const{t}=te(),a=b(""),o=b([]),l=b(!1),m=Je({current:1,pageSize:10,total:0}),f=q(()=>[{title:t("admin.username"),key:"username",width:140},{title:t("user.name"),key:"name",width:100},{title:t("admin.user_role"),key:"groupid",width:90,center:!0},{title:t("admin.mobile"),key:"mobile",width:130},{title:t("admin.register_time"),key:"reg_time",width:160},{title:t("admin.last_login_time"),key:"last_login_time",width:170},{title:t("common.operation"),key:"action",width:200,center:!0}]),d=async()=>{l.value=!0;try{const r=await No({username:a.value,page:m.current,count:m.pageSize});o.value=r.data.users||[],m.total=r.data.total||0}catch(r){console.error("获取用户列表失败:",r)}finally{l.value=!1}},p=r=>Number(r.groupid)===1?"admin":Number(r.groupid)===2?"normal":"unknown",h=r=>Number(r.groupid)===1?t("admin.admin"):Number(r.groupid)===2?t("admin.normal_user"):t("admin.unknown"),$=()=>{m.current=1,d()},g=(r,_)=>{m.current=r,m.pageSize=_,d()},n=async()=>{await fa()&&d()},w=async r=>{await fa({user:r})&&d()},k=async r=>{if(await Se(t("common.confirm_delete")))try{await Fo({uid:r.uid}),j.success(t("admin.delete_success")),d()}catch{j.error(t("common.delete_failed"))}};return ae(()=>{d()}),(r,_)=>(C(),V("div",p2,[e("div",f2,[e("div",v2,[e("div",h2,[s(ne,{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=v=>a.value=v),placeholder:r.$t("admin.username_search_placeholder")},null,8,["modelValue","placeholder"])]),s(K,{theme:"dark",text:r.$t("common.search"),leftIcon:["fas","search"],onClick:$},null,8,["text"]),s(K,{theme:"light",text:r.$t("admin.add_user"),leftIcon:["fas","plus"],onClick:n},null,8,["text"])])]),e("div",g2,[s(Le,{"table-header":f.value,"table-data":o.value,pagination:m,loading:l.value,"row-key":"uid","max-height":"calc(100vh - 280px)",onPageChange:g},{"cell-groupid":u(({row:v})=>[e("span",{class:re(["role-badge",p(v)])},i(h(v)),3)]),"cell-action":u(({row:v})=>[e("div",y2,[e("span",{class:"table-action-btn edit",onClick:y=>w(v)},[_[1]||(_[1]=e("i",{class:"fas fa-edit"},null,-1)),O(" "+i(r.$t("common.edit")),1)],8,w2),e("span",{class:"table-action-btn delete",onClick:y=>k(v)},[_[2]||(_[2]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(r.$t("common.delete")),1)],8,b2)])]),_:1},8,["table-header","table-data","pagination","loading"])])]))}});const k2=Y($2,[["__scopeId","data-v-8250dc19"]]),C2=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=b(""),l=()=>t.onClose(!1,null),m=()=>t.onClose(!0,{username:o.value});return ae(()=>{a.value=!0}),(f,d)=>(C(),B(de,{show:a.value,title:f.$t("admin.attorn"),width:"300px",onClose:l},{footer:u(()=>[s(K,{theme:"light",text:f.$t("common.cancel"),onClick:l},null,8,["text"]),s(K,{theme:"dark",text:f.$t("admin.attorn"),onClick:m},null,8,["text"])]),default:u(()=>[s(ne,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=p=>o.value=p),placeholder:f.$t("admin.attorn_username_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["show","title"]))}});function x2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(C2,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const I2={class:"modal-form"},S2={class:"form-label"},T2={class:"modal-footer"},M2=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(""),m=()=>a.onClose(!1),f=async()=>{if(!l.value.trim()){j.warning(t("admin.input_member_username"));return}try{await Sa({item_id:String(a.item_id),username:l.value,member_group_id:1}),j.success(t("admin.add_member_success")),a.onClose(!0,l.value)}catch{j.error(t("common.op_failed"))}};return ae(()=>{o.value=!0}),(d,p)=>(C(),B(de,{show:o.value,title:d.$t("admin.add_member"),width:"400px",top:"10vh",onClose:m},{footer:u(()=>[e("div",T2,[s(K,{theme:"light",text:d.$t("common.cancel"),onClick:m},null,8,["text"]),s(K,{theme:"dark",text:d.$t("common.confirm"),onClick:f},null,8,["text"])])]),default:u(()=>[e("div",I2,[e("label",S2,i(d.$t("admin.member_username")),1),s(ne,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=h=>l.value=h),placeholder:d.$t("admin.input_member_username")},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const L2=Y(M2,[["__scopeId","data-v-03a1d29e"]]);function V2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(L2,{...c,onClose:(l,m)=>{t(l&&m||null),me(a,o)}});a.mount(o)})}const z2={key:1,class:"tip-text"},U2=J({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),m=q(()=>[{title:t("admin.username"),key:"member_username",width:140},{title:t("user.name"),key:"name",width:140},{title:t("admin.join_time"),key:"addtime",width:160}]),f=async()=>{try{const p=await Bt(a.team_id);l.value=p.data||[]}catch(p){console.error("获取团队成员失败:",p)}},d=()=>a.onClose();return ae(()=>{o.value=!0,f()}),(p,h)=>(C(),B(de,{show:o.value,title:p.$t("admin.team_members"),width:"650px","show-footer":!1,onClose:d},{default:u(()=>[l.value.length>0?(C(),B(Le,{key:0,"table-header":m.value,"table-data":l.value,pagination:!1,"row-key":"id","max-height":"400px"},null,8,["table-header","table-data"])):(C(),V("p",z2,i(p.$t("admin.no_team_member")),1))]),_:1},8,["show","title"]))}});const P2=Y(U2,[["__scopeId","data-v-4ec87f4d"]]);function A2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(P2,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const D2={class:"modal-toolbar"},O2={key:0,class:"member-content"},N2={key:0,class:"tip-text"},F2={class:"table-action-buttons"},q2=["onClick"],R2={key:1,class:"member-content"},H2={key:0,class:"tip-text"},E2={key:1,class:"tip-text"},j2={class:"table-action-buttons"},B2=["onClick"],G2=J({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b("members"),m=b([]),f=b([]),d=q(()=>[{text:a("admin.project_members"),value:"members"},{text:a("admin.project_teams"),value:"teams"}]),p=q(()=>[{title:a("admin.member_username"),key:"username",width:120},{title:a("user.name"),key:"name",width:120},{title:a("admin.add_time"),key:"addtime",width:140},{title:a("admin.authority"),key:"member_group",width:100,center:!0},{title:a("common.operation"),key:"action",width:80,center:!0}]),h=q(()=>[{title:a("admin.team_name"),key:"team_name",width:160},{title:a("admin.creator"),key:"username",width:120},{title:a("admin.bind_time"),key:"addtime",width:150},{title:a("common.operation"),key:"action",width:100,center:!0}]),$=v=>{l.value=v,v==="members"&&m.value.length===0?g():v==="teams"&&f.value.length===0&&n()},g=async()=>{try{const v=await Ta(String(t.item_id));m.value=v.data||[]}catch(v){console.error("获取成员列表失败:",v)}},n=async()=>{try{const v=await Ma(String(t.item_id));f.value=v.data||[]}catch(v){console.error("获取团队列表失败:",v)}},w=async()=>{await V2({item_id:t.item_id})&&g()},k=async v=>{if(await Se(a("common.confirm_delete")))try{await La(String(t.item_id),v.item_member_id),g()}catch{j.error(a("common.delete_failed"))}},r=async v=>{await A2({team_id:v.team_id})},_=()=>t.onClose();return ae(()=>{o.value=!0,g(),n()}),(v,y)=>(C(),B(de,{show:o.value,title:v.$t("admin.member_manage"),width:"700px",onClose:_},{default:u(()=>[e("div",D2,[s(K,{theme:"dark",text:v.$t("admin.add_member"),leftIcon:["fas","plus"],onClick:w},null,8,["text"])]),s(vt,{items:d.value,value:l.value,type:"segmented",onUpdateValue:$},null,8,["items","value"]),l.value==="members"?(C(),V("div",O2,[m.value.length>0?(C(),V("p",N2,i(v.$t("admin.member_tip")),1)):F("",!0),m.value.length>0?(C(),B(Le,{key:1,"table-header":p.value,"table-data":m.value,pagination:!1,"row-key":"item_member_id","max-height":"250px"},{"cell-action":u(({row:S})=>[e("div",F2,[e("span",{class:"table-action-btn delete",onClick:x=>k(S)},[y[0]||(y[0]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(v.$t("common.delete")),1)],8,q2)])]),_:1},8,["table-header","table-data"])):F("",!0)])):(C(),V("div",R2,[f.value.length>0?(C(),V("p",H2,i(v.$t("admin.team_tip")),1)):(C(),V("p",E2,i(v.$t("admin.no_team")),1)),f.value.length>0?(C(),B(Le,{key:2,"table-header":h.value,"table-data":f.value,pagination:!1,"row-key":"id","max-height":"250px"},{"cell-action":u(({row:S})=>[e("div",j2,[e("span",{class:"table-action-btn view",onClick:x=>r(S)},[y[1]||(y[1]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(v.$t("admin.view_member")),1)],8,B2)])]),_:1},8,["table-header","table-data"])):F("",!0)]))]),_:1},8,["show","title"]))}});const K2=Y(G2,[["__scopeId","data-v-855f8138"]]);function W2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(K2,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const J2={class:"item-management"},Y2={class:"search-section"},X2={class:"search-row"},Q2={class:"search-input"},Z2={class:"search-selector"},e8={class:"search-input"},t8={class:"search-selector"},a8={class:"table-section"},o8=["onClick"],s8={key:1,class:"deleted-text"},l8=["onClick"],n8={key:0,class:"table-action-buttons"},i8=["onClick"],r8=["onClick"],c8=["onClick"],d8={key:1,class:"table-action-buttons"},u8=["onClick"],m8=["onClick"],_8=J({__name:"ItemManagement",setup(c){const{t}=te(),a=xe(),o=b([]),l=b(!1),m=b("0"),f=q(()=>[{text:t("admin.item_tab_list"),value:"0"},{text:t("admin.item_tab_deleted"),value:"1"}]),d=A=>{m.value=A,x()},p=b(""),h=b(""),$=b("-1"),g=b("1"),n=b(t("admin.all_item_type")),w=b(t("admin.all_privacy_type")),k=Je({current:1,pageSize:10,total:0}),r=q(()=>[{label:t("admin.all_item_type"),value:"-1"},{label:t("admin.normal_item"),value:"1"},{label:t("admin.single_page_item"),value:"2"},{label:t("admin.runapi_item"),value:"3"},{label:t("admin.table_item"),value:"4"}]),_=q(()=>[{label:t("admin.all_privacy_type"),value:"1"},{label:t("admin.public_items"),value:"2"},{label:t("admin.private_items"),value:"3"}]),v=q(()=>[{title:t("admin.item_name"),key:"item_name",width:160},{title:t("admin.item_desc"),key:"item_description",width:180},{title:t("admin.privacy"),key:"password",width:150,center:!0},{title:t("admin.access_link"),key:"item_id",width:130,center:!0},{title:t("admin.owner"),key:"username",width:140},{title:t("admin.member_count"),key:"member_num",width:100,center:!0},{title:t("admin.create_time"),key:"addtime",width:160},...m.value==="1"?[{title:t("admin.delete_time"),key:"del_time",width:160}]:[],{title:t("common.operation"),key:"action",width:220,center:!0}]),y=async()=>{l.value=!0;try{const A=await Aa({item_name:p.value,username:h.value,page:k.current,count:k.pageSize,item_type:$.value,privacy_type:g.value,is_del:m.value});o.value=A.data.items||[],k.total=A.data.total||0}catch(A){console.error("获取项目列表失败:",A)}finally{l.value=!1}},S=A=>A.password?t("admin.password_access"):t("admin.public_access"),x=()=>{k.current=1,y()},I=(A,D)=>{k.current=A,k.pageSize=D,y()},T=A=>{const D=a.resolve({path:`/${A.item_id}`}).href;window.open(D,"_blank")},M=async A=>{const D=await x2({item_id:A.item_id});if(D&&D.username)try{await qo({item_id:A.item_id,username:D.username}),j.success(t("common.save_success")),y()}catch{j.error(t("common.save_failed"))}},L=async A=>{if(await Se(t("common.confirm_delete")))try{await Ro({item_id:A.item_id}),j.success(t("common.delete_success")),y()}catch{j.error(t("common.delete_failed"))}},P=async A=>{if(await Se(t("admin.confirm_recover")))try{await Ho({item_id:A.item_id}),j.success(t("admin.recover_success")),y()}catch{j.error(t("common.op_failed"))}},N=async A=>{if(await Se({title:t("admin.confirm_permanent_delete"),msg:t("admin.permanent_delete_warning")}))try{await Eo({item_id:A.item_id}),j.success(t("admin.permanent_delete_success")),y()}catch{j.error(t("common.op_failed"))}},U=async A=>{await W2({item_id:A.item_id})};return ae(()=>{y()}),(A,D)=>{const E=H("CommonTab");return C(),V("div",J2,[s(E,{items:f.value,value:m.value,type:"segmented",onUpdateValue:d},null,8,["items","value"]),e("div",Y2,[e("div",X2,[e("div",Q2,[s(ne,{modelValue:p.value,"onUpdate:modelValue":D[0]||(D[0]=oe=>p.value=oe),placeholder:A.$t("admin.item_name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",Z2,[s(Re,{"selector-label":n.value,"selector-value":$.value,options:r.value,"onUpdate:selectorLabel":D[1]||(D[1]=oe=>n.value=oe),"onUpdate:selectorValue":D[2]||(D[2]=oe=>$.value=oe)},null,8,["selector-label","selector-value","options"])]),e("div",e8,[s(ne,{modelValue:h.value,"onUpdate:modelValue":D[3]||(D[3]=oe=>h.value=oe),placeholder:A.$t("admin.owner_placeholder")},null,8,["modelValue","placeholder"])]),e("div",t8,[s(Re,{"selector-label":w.value,"selector-value":g.value,options:_.value,"onUpdate:selectorLabel":D[4]||(D[4]=oe=>w.value=oe),"onUpdate:selectorValue":D[5]||(D[5]=oe=>g.value=oe)},null,8,["selector-label","selector-value","options"])]),s(K,{theme:"dark",text:A.$t("common.search"),leftIcon:["fas","search"],onClick:x},null,8,["text"])])]),e("div",a8,[s(Le,{"table-header":v.value,"table-data":o.value,pagination:k,loading:l.value,"row-key":"item_id","max-height":"calc(100vh - 350px)",onPageChange:I},{"cell-password":u(({row:oe})=>[e("span",{class:re(["privacy-badge",oe.password?"private":"public"])},i(S(oe)),3)]),"cell-item_id":u(({row:oe})=>[m.value==="0"?(C(),V("span",{key:0,class:"link-btn",onClick:ge=>T(oe)},i(A.$t("admin.view")),9,o8)):(C(),V("span",s8,i(A.$t("admin.deleted")),1))]),"cell-member_num":u(({row:oe})=>[e("span",{class:"member-btn",onClick:ge=>U(oe)},i(oe.member_num),9,l8)]),"cell-action":u(({row:oe})=>[m.value==="0"?(C(),V("div",n8,[e("span",{class:"table-action-btn attorn",onClick:ge=>M(oe)},[D[6]||(D[6]=e("i",{class:"fas fa-exchange-alt"},null,-1)),O(" "+i(A.$t("admin.attorn")),1)],8,i8),e("span",{class:"table-action-btn member",onClick:ge=>U(oe)},[D[7]||(D[7]=e("i",{class:"fas fa-users"},null,-1)),O(" "+i(A.$t("admin.member_manage")),1)],8,r8),e("span",{class:"table-action-btn delete",onClick:ge=>L(oe)},[D[8]||(D[8]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(A.$t("common.delete")),1)],8,c8)])):(C(),V("div",d8,[e("span",{class:"table-action-btn recover",onClick:ge=>P(oe)},[D[9]||(D[9]=e("i",{class:"fas fa-undo"},null,-1)),O(" "+i(A.$t("admin.recover")),1)],8,u8),e("span",{class:"table-action-btn hard-delete",onClick:ge=>N(oe)},[D[10]||(D[10]=e("i",{class:"fas fa-trash"},null,-1)),O(" "+i(A.$t("admin.permanent_delete")),1)],8,m8)]))]),_:1},8,["table-header","table-data","pagination","loading"])])])}}});const p8=Y(_8,[["__scopeId","data-v-6b6d2513"]]),f8={class:"announcement-management"},v8={class:"publish-section"},h8={class:"section-header"},g8={class:"header-title"},y8={class:"publish-form"},w8={class:"form-row"},b8={class:"form-label"},$8={class:"radio-group"},k8={class:"radio-icon"},C8={key:0,class:"fas fa-circle"},x8={key:1,class:"far fa-circle"},I8={class:"radio-icon"},S8={key:0,class:"fas fa-circle"},T8={key:1,class:"far fa-circle"},M8={class:"radio-icon"},L8={key:0,class:"fas fa-circle"},V8={key:1,class:"far fa-circle"},z8={class:"form-row"},U8={class:"form-label"},P8={class:"form-row"},A8={class:"form-label"},D8={class:"tip-text"},O8={class:"form-actions"},N8={class:"table-section"},F8=["innerHTML"],q8=J({__name:"AnnouncementManagement",setup(c){const{t}=te(),a=b([]),o=b(!1),l=Je({message_type:"announce_web",message_content:"",send_at:null}),m=Je({current:1,pageSize:10,total:0}),f=q(()=>[{title:"ID",key:"id",width:80},{title:t("admin.announcement_type"),key:"message_type",width:140,center:!0},{title:t("admin.send_time"),key:"addtime",width:180},{title:t("admin.content"),key:"message_content",width:0}]),d=w=>{switch(w){case"announce_all":return"all";case"announce_runapi":return"runapi";default:return"web"}},p=w=>{switch(w){case"announce_all":return t("admin.announce_all");case"announce_runapi":return t("admin.announce_runapi_only");default:return t("admin.announce_web_only")}},h=async()=>{o.value=!0;try{const w=await jo({page:m.current,count:m.pageSize});a.value=w.data||[],m.total=m.current*m.pageSize+(a.value.length===m.pageSize?m.pageSize:0)}catch(w){console.error("获取公告列表失败:",w)}finally{o.value=!1}},$=async()=>{if(!l.message_content){j.error(t("admin.announcement_content_required"));return}if(await Se({title:t("admin.confirm_publish"),msg:t("admin.publish_warning")}))try{const k=l.send_at?qa(l.send_at).format("YYYY-MM-DD HH:mm:ss"):"";await Bo({message_type:l.message_type,message_content:l.message_content,send_at:k}),j.success(t("admin.publish_success")),g(),h()}catch{j.error(t("common.op_failed"))}},g=()=>{l.message_type="announce_web",l.message_content="",l.send_at=null},n=(w,k)=>{m.current=w,m.pageSize=k,h()};return ae(()=>{h()}),(w,k)=>{const r=H("a-date-picker");return C(),V("div",f8,[e("div",v8,[e("div",h8,[e("div",g8,[k[5]||(k[5]=e("i",{class:"fas fa-bullhorn"},null,-1)),e("span",null,i(w.$t("admin.publish_announcement")),1)])]),e("div",y8,[e("div",w8,[e("label",b8,i(w.$t("admin.announcement_type")),1),e("div",$8,[e("div",{class:re(["radio-item",{active:l.message_type==="announce_web"}]),onClick:k[0]||(k[0]=_=>l.message_type="announce_web")},[e("div",k8,[l.message_type==="announce_web"?(C(),V("i",C8)):(C(),V("i",x8))]),e("span",null,i(w.$t("admin.announce_web_only")),1)],2),e("div",{class:re(["radio-item",{active:l.message_type==="announce_runapi"}]),onClick:k[1]||(k[1]=_=>l.message_type="announce_runapi")},[e("div",I8,[l.message_type==="announce_runapi"?(C(),V("i",S8)):(C(),V("i",T8))]),e("span",null,i(w.$t("admin.announce_runapi_only")),1)],2),e("div",{class:re(["radio-item",{active:l.message_type==="announce_all"}]),onClick:k[2]||(k[2]=_=>l.message_type="announce_all")},[e("div",M8,[l.message_type==="announce_all"?(C(),V("i",L8)):(C(),V("i",V8))]),e("span",null,i(w.$t("admin.announce_all")),1)],2)])]),e("div",z8,[e("label",U8,i(w.$t("admin.announcement_content")),1),s(tt,{modelValue:l.message_content,"onUpdate:modelValue":k[3]||(k[3]=_=>l.message_content=_),placeholder:w.$t("admin.announcement_content_placeholder"),rows:6},null,8,["modelValue","placeholder"])]),e("div",P8,[e("label",A8,i(w.$t("admin.send_time")),1),s(r,{value:l.send_at,"onUpdate:value":k[4]||(k[4]=_=>l.send_at=_),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:w.$t("admin.send_time_placeholder"),style:{width:"100%",height:"40px"}},null,8,["value","placeholder"]),e("div",D8,i(w.$t("admin.send_time_tip")),1)]),e("div",O8,[s(K,{theme:"dark",text:w.$t("admin.send"),leftIcon:["fas","paper-plane"],onClick:$},null,8,["text"]),s(K,{theme:"light",text:w.$t("admin.reset"),leftIcon:["fas","redo"],onClick:g},null,8,["text"])])])]),e("div",N8,[s(Le,{"table-header":f.value,"table-data":a.value,pagination:m,loading:o.value,"row-key":"id","max-height":"calc(100vh - 450px)",onPageChange:n},{"cell-message_type":u(({row:_})=>[e("span",{class:re(["type-badge",d(_.message_type)])},i(p(_.message_type)),3)]),"cell-message_content":u(({row:_})=>[e("div",{class:"announcement-content",innerHTML:_.message_content},null,8,F8)]),_:1},8,["table-header","table-data","pagination","loading"])])])}}});const R8=Y(q8,[["__scopeId","data-v-3968eae0"]]),H8={class:"attachment-management"},E8={class:"search-section"},j8={class:"search-row"},B8={class:"search-input"},G8={class:"search-selector"},K8={class:"search-input"},W8={class:"cleanup-modal-body"},J8={class:"cleanup-search"},Y8={class:"table-action-buttons"},X8=["onClick"],Q8={class:"modal-footer"},Z8={class:"stats-section"},eC={class:"stats-card"},tC={class:"stats-content"},aC={class:"stats-label"},oC={class:"stats-value"},sC={class:"table-section"},lC={class:"table-action-buttons"},nC=["onClick"],iC=["onClick"],rC=J({__name:"AttachmentManagement",setup(c){const{t}=te(),a=b([]),o=b(!1),l=b([]),m=b(""),f=b(""),d=b("-1"),p=b(0),h=b(!1),$=b([]),g=b(!1),n=b([]),w=Je({displayName:"",username:""}),k=Je({current:1,pageSize:10,total:0}),r=b(t("admin.all_attachment_type")),_=Je({current:1,pageSize:10,total:0}),v=q(()=>[{label:t("admin.all_attachment_type"),value:"-1"},{label:t("admin.image"),value:"1"},{label:t("admin.general_attachment"),value:"2"}]),y=q(()=>[{title:t("admin.file_id"),key:"file_id",width:100},{title:t("admin.display_name"),key:"display_name",width:200},{title:t("admin.file_type"),key:"file_type",width:140},{title:t("admin.file_size"),key:"file_size_m",width:120},{title:t("admin.visit_times"),key:"visit_times",width:100,center:!0},{title:t("admin.uploader"),key:"username",width:140},{title:t("admin.add_time"),key:"addtime",width:160},{title:t("common.operation"),key:"action",width:240,center:!0}]),S=q(()=>[{title:t("admin.file_id"),key:"file_id",width:100},{title:t("admin.display_name"),key:"display_name",width:200},{title:t("admin.file_type"),key:"file_type",width:140},{title:t("admin.file_size"),key:"file_size_m",width:140},{title:t("admin.uploader"),key:"username",width:140},{title:t("admin.add_time"),key:"addtime",width:160},{title:t("common.operation"),key:"action",width:120,center:!0}]),x=q(()=>({selectedRowKeys:l.value,onChange:W=>{l.value=W}})),I=q(()=>({selectedRowKeys:n.value,onChange:W=>{n.value=W}})),T=async()=>{o.value=!0;try{const W=await Go({page:_.current,count:_.pageSize,attachment_type:d.value,display_name:m.value,username:f.value});a.value=W.data.list||[],_.total=parseInt(W.data.total)||0,p.value=W.data.used_m||0}catch(W){console.error("获取附件列表失败:",W)}finally{o.value=!1}},M=()=>{_.current=1,T()},L=(W,ce)=>{_.current=W,_.pageSize=ce,T()},P=(W,ce)=>{l.value=W},N=W=>{window.open(W.url)},U=async W=>{if(await Se(t("common.confirm_delete")))try{await Ko({file_id:W.file_id}),j.success(t("common.op_success")),T()}catch{j.error(t("common.op_failed"))}},A=()=>{h.value=!0,k.current=1,E()},D=()=>{h.value=!1,n.value=[],w.displayName="",w.username=""},E=async()=>{g.value=!0;try{const W=await Wo({page:k.current,count:k.pageSize,display_name:w.displayName,username:w.username});$.value=W.data.list||[],k.total=parseInt(W.data.total)||0}catch(W){console.error("获取未使用附件列表失败:",W)}finally{g.value=!1}},oe=()=>{k.current=1,E()},ge=(W,ce)=>{k.current=W,k.pageSize=ce,E()},fe=(W,ce)=>{n.value=W},ee=async()=>{if(n.value.length===0){j.warning(t("admin.please_select_to_delete"));return}if(await Se({title:t("admin.confirm_delete_selected"),msg:t("admin.confirm_delete_selected_message")}))try{await Jo({file_ids:n.value.join(",")}),j.success(t("common.op_success")),E(),T(),n.value=[]}catch{j.error(t("common.op_failed"))}};return ae(()=>{T()}),(W,ce)=>(C(),V("div",H8,[e("div",E8,[e("div",j8,[e("div",B8,[s(ne,{modelValue:m.value,"onUpdate:modelValue":ce[0]||(ce[0]=ye=>m.value=ye),placeholder:W.$t("admin.display_name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",G8,[s(Re,{"selector-label":r.value,"selector-value":d.value,options:v.value,"onUpdate:selectorLabel":ce[1]||(ce[1]=ye=>r.value=ye),"onUpdate:selectorValue":ce[2]||(ce[2]=ye=>d.value=ye)},null,8,["selector-label","selector-value","options"])]),e("div",K8,[s(ne,{modelValue:f.value,"onUpdate:modelValue":ce[3]||(ce[3]=ye=>f.value=ye),placeholder:W.$t("admin.uploader")},null,8,["modelValue","placeholder"])]),s(K,{theme:"dark",text:W.$t("common.search"),leftIcon:["fas","search"],onClick:M},null,8,["text"]),s(K,{theme:"light",text:W.$t("admin.cleanup_unused_attachments"),leftIcon:["fas","broom"],onClick:A},null,8,["text"])])]),s(de,{show:h.value,title:W.$t("admin.cleanup_dialog_title"),width:"80%",onClose:D},{footer:u(()=>[e("div",Q8,[s(K,{theme:"light",text:W.$t("common.cancel"),onClick:D},null,8,["text"]),s(K,{theme:"dark",text:W.$t("admin.delete_selected"),disabled:n.value.length===0,onClick:ee},null,8,["text","disabled"])])]),default:u(()=>[e("div",W8,[e("div",J8,[s(ne,{modelValue:w.displayName,"onUpdate:modelValue":ce[4]||(ce[4]=ye=>w.displayName=ye),placeholder:W.$t("admin.display_name_placeholder")},null,8,["modelValue","placeholder"]),s(ne,{modelValue:w.username,"onUpdate:modelValue":ce[5]||(ce[5]=ye=>w.username=ye),placeholder:W.$t("admin.uploader")},null,8,["modelValue","placeholder"]),s(K,{theme:"dark",text:W.$t("common.search"),leftIcon:["fas","search"],onClick:oe},null,8,["text"])]),s(Le,{"table-header":S.value,"table-data":$.value,"row-selection":I.value,pagination:k,loading:g.value,"row-key":"file_id","max-height":"500px",onPageChange:ge,onSelectionChange:fe},{"cell-action":u(({row:ye})=>[e("div",Y8,[e("span",{class:"table-action-btn visit",onClick:ze=>N(ye)},[ce[6]||(ce[6]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(W.$t("admin.visit")),1)],8,X8)])]),_:1},8,["table-header","table-data","row-selection","pagination","loading"])])]),_:1},8,["show","title"]),e("div",Z8,[e("div",eC,[ce[7]||(ce[7]=e("div",{class:"stats-icon"},[e("i",{class:"fas fa-hdd"})],-1)),e("div",tC,[e("div",aC,i(W.$t("admin.accumulated_used_space")),1),e("div",oC,i(p.value)+"M",1)])])]),e("div",sC,[s(Le,{"table-header":y.value,"table-data":a.value,"row-selection":x.value,pagination:_,loading:o.value,"row-key":"file_id","max-height":"calc(100vh - 380px)",onPageChange:L,onSelectionChange:P},{"cell-action":u(({row:ye})=>[e("div",lC,[e("span",{class:"table-action-btn visit",onClick:ze=>N(ye)},[ce[8]||(ce[8]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(W.$t("admin.visit")),1)],8,nC),e("span",{class:"table-action-btn delete",onClick:ze=>U(ye)},[ce[9]||(ce[9]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(W.$t("common.delete")),1)],8,iC)])]),_:1},8,["table-header","table-data","row-selection","pagination","loading"])])]))}});const cC=Y(rC,[["__scopeId","data-v-6fb5aec0"]]),dC={class:"ext-login"},uC={class:"settings-container"},mC={class:"tab-content"},_C={class:"form-row"},pC={class:"form-label"},fC={class:"form-row"},vC={class:"form-label"},hC={class:"form-row"},gC={class:"form-label"},yC={class:"form-row"},wC={class:"form-label"},bC={class:"form-row"},$C={class:"form-label"},kC={class:"form-row"},CC={class:"form-label"},xC={class:"form-row"},IC={class:"form-label"},SC={class:"form-row"},TC={class:"form-label"},MC={class:"form-row"},LC={class:"form-label"},VC={class:"form-row"},zC={class:"form-label"},UC={class:"form-row form-actions"},PC={class:"tab-content"},AC={class:"form-row"},DC={class:"form-label"},OC={class:"form-row"},NC={class:"form-label"},FC={class:"form-row"},qC={class:"form-label"},RC={class:"form-row"},HC={class:"form-label"},EC={class:"form-row"},jC={class:"form-label"},BC={class:"form-row"},GC={class:"form-label"},KC={class:"form-row"},WC={class:"form-label"},JC={class:"form-row"},YC={class:"form-label"},XC={class:"form-row"},QC={class:"form-label"},ZC={class:"form-row"},ex={class:"form-label"},tx={class:"form-row"},ax={class:"form-label"},ox={class:"form-row"},sx={class:"form-label"},lx={class:"tab-content"},nx={class:"form-row"},ix={class:"form-label"},rx={class:"form-row form-actions"},cx={class:"save-button-wrapper"},dx=J({__name:"ExtLogin",setup(c){const{t}=te(),a=b("ldap"),o=b(!1),l=b(!1),m=q(()=>[{text:t("admin.ldap_login"),value:"ldap"},{text:t("admin.oauth2_login"),value:"oauth2"},{text:t("admin.general_login"),value:"general"}]),f=r=>{a.value=String(r)},d=Je({ldap_open:"0",ldap_form:{host:"",port:"389",version:"3",base_dn:"",bind_dn:"",bind_password:"",user_field:"",name_field:"",search_filter:"(cn=*)"}}),p=Je({oauth2_open:"0",oauth2_form:{redirectUri:"",entrance_tips:"",client_id:"",client_secret:"",protocol:"https",host:"",authorize_path:"",token_path:"",resource_path:"",userinfo_path:"",logout_redirect_uri:""}}),h=Je({login_secret_key:""}),$=async()=>{try{const r=await Yo();r.data&&(d.ldap_open=st(r.data.ldap_open),r.data.ldap_form&&Object.assign(d.ldap_form,r.data.ldap_form));const _=await Xo();_.data&&(p.oauth2_open=st(_.data.oauth2_open),_.data.oauth2_form&&Object.assign(p.oauth2_form,_.data.oauth2_form));const v=await Qo();v.data&&v.data.login_secret_key&&(h.login_secret_key=v.data.login_secret_key)}catch(r){console.error("加载扩展登录配置失败:",r)}},g=async()=>{try{await Zo({ldap_open:d.ldap_open==="1",ldap_form:d.ldap_form}),await es({oauth2_open:p.oauth2_open==="1",oauth2_form:p.oauth2_form}),j.success(t("common.save_success"))}catch{j.error(t("common.save_failed"))}},n=async()=>{o.value=!0;try{const r=await ts();r.error_code===0?j.success(t("admin.ldap_sync_success")):j.error(r.error_message||t("admin.ldap_sync_failed"))}catch(r){j.error(`${t("admin.ldap_sync_failed")}: ${r.message||t("admin.unknown_error")}`)}finally{o.value=!1}},w=async()=>{try{const r=await as();r.error_code===0?(h.login_secret_key=r.data.login_secret_key,j.success(t("admin.reset_login_secret_key_success"))):j.error(r.error_message||t("admin.reset_login_secret_key_failed"))}catch(r){j.error(`${t("admin.reset_login_secret_key_failed")}: ${r.message||t("admin.unknown_error")}`)}},k=()=>{window.open("https://www.showdoc.com.cn/p/0fb2753c5a48acc7c3fbbb00f9504e6b","_blank")};return ae(()=>{$()}),(r,_)=>{const v=H("a-alert"),y=H("QuestionCircleOutlined"),S=H("a-tooltip"),x=H("a-select-option"),I=H("a-select");return C(),V("div",dC,[e("div",uC,[s(vt,{items:m.value,value:a.value,type:"segmented",onUpdateValue:f},{ldap:u(()=>[e("div",mC,[s(v,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.ldap_login_tips"),class:"info-alert"},null,8,["message"]),e("div",_C,[e("label",pC,i(r.$t("admin.enable_ldap_login")),1),s(We,{modelValue:d.ldap_open,"onUpdate:modelValue":_[0]||(_[0]=T=>d.ldap_open=T)},null,8,["modelValue"])]),e("div",fC,[e("label",vC,[O(i(r.$t("admin.ldap_host"))+" ",1),s(S,{title:r.$t("admin.ldap_host_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.host,"onUpdate:modelValue":_[1]||(_[1]=T=>d.ldap_form.host=T),class:"form-input",placeholder:r.$t("admin.ldap_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",hC,[e("label",gC,[O(i(r.$t("admin.ldap_port"))+" ",1),s(S,{title:r.$t("admin.ldap_port_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.port,"onUpdate:modelValue":_[2]||(_[2]=T=>d.ldap_form.port=T),class:"form-input",placeholder:r.$t("admin.ldap_port_placeholder")},null,8,["modelValue","placeholder"])]),e("div",yC,[e("label",wC,[O(i(r.$t("admin.ldap_version"))+" ",1),s(S,{title:r.$t("admin.ldap_version_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(I,{value:d.ldap_form.version,"onUpdate:value":_[3]||(_[3]=T=>d.ldap_form.version=T),class:"form-select"},{default:u(()=>[s(x,{value:"2"},{default:u(()=>[..._[23]||(_[23]=[O("LDAP v2",-1)])]),_:1}),s(x,{value:"3"},{default:u(()=>[..._[24]||(_[24]=[O("LDAP v3",-1)])]),_:1})]),_:1},8,["value"])]),e("div",bC,[e("label",$C,[O(i(r.$t("admin.ldap_base_dn"))+" ",1),s(S,{title:r.$t("admin.ldap_base_dn_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.base_dn,"onUpdate:modelValue":_[4]||(_[4]=T=>d.ldap_form.base_dn=T),class:"form-input",placeholder:r.$t("admin.ldap_base_dn_placeholder")},null,8,["modelValue","placeholder"])]),e("div",kC,[e("label",CC,[O(i(r.$t("admin.ldap_bind_dn"))+" ",1),s(S,{title:r.$t("admin.ldap_bind_dn_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.bind_dn,"onUpdate:modelValue":_[5]||(_[5]=T=>d.ldap_form.bind_dn=T),class:"form-input",placeholder:r.$t("admin.ldap_bind_dn_placeholder")},null,8,["modelValue","placeholder"])]),e("div",xC,[e("label",IC,[O(i(r.$t("admin.ldap_bind_password"))+" ",1),s(S,{title:r.$t("admin.ldap_bind_password_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.bind_password,"onUpdate:modelValue":_[6]||(_[6]=T=>d.ldap_form.bind_password=T),type:"password",class:"form-input",placeholder:r.$t("admin.ldap_bind_password_placeholder")},null,8,["modelValue","placeholder"])]),e("div",SC,[e("label",TC,i(r.$t("admin.ldap_user_field")),1),s(ne,{modelValue:d.ldap_form.user_field,"onUpdate:modelValue":_[7]||(_[7]=T=>d.ldap_form.user_field=T),class:"form-input",placeholder:r.$t("admin.ldap_user_field_placeholder")},null,8,["modelValue","placeholder"])]),e("div",MC,[e("label",LC,[O(i(r.$t("admin.ldap_name_field"))+" ",1),s(S,{title:r.$t("admin.ldap_name_field_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.name_field,"onUpdate:modelValue":_[8]||(_[8]=T=>d.ldap_form.name_field=T),class:"form-input",placeholder:r.$t("admin.ldap_name_field_placeholder")},null,8,["modelValue","placeholder"])]),e("div",VC,[e("label",zC,[O(i(r.$t("admin.ldap_search_filter"))+" ",1),s(S,{title:r.$t("admin.ldap_search_filter_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.search_filter,"onUpdate:modelValue":_[9]||(_[9]=T=>d.ldap_form.search_filter=T),class:"form-input",placeholder:r.$t("admin.ldap_search_filter_placeholder")},null,8,["modelValue","placeholder"])]),e("div",UC,[s(K,{theme:"dark",text:r.$t("admin.ldap_sync_users"),leftIcon:["fas","sync"],loading:o.value,onClick:n},null,8,["text","loading"])])])]),oauth2:u(()=>[e("div",PC,[s(v,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.oauth2_login_tips"),class:"info-alert"},null,8,["message"]),e("div",AC,[e("label",DC,i(r.$t("admin.enable_oauth2_login")),1),s(We,{modelValue:p.oauth2_open,"onUpdate:modelValue":_[10]||(_[10]=T=>p.oauth2_open=T)},null,8,["modelValue"])]),e("div",OC,[e("label",NC,i(r.$t("admin.oauth2_callback_url")),1),s(ne,{modelValue:p.oauth2_form.redirectUri,"onUpdate:modelValue":_[11]||(_[11]=T=>p.oauth2_form.redirectUri=T),class:"form-input",placeholder:r.$t("admin.oauth2_callback_eg")},null,8,["modelValue","placeholder"])]),e("div",FC,[e("label",qC,[O(i(r.$t("admin.oauth2_entrance_tips"))+" ",1),s(S,{title:r.$t("admin.oauth2_entrance_tips_content"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.entrance_tips,"onUpdate:modelValue":_[12]||(_[12]=T=>p.oauth2_form.entrance_tips=T),class:"form-input",placeholder:r.$t("admin.oauth2_entrance_tips_placeholder")},null,8,["modelValue","placeholder"])]),e("div",RC,[e("label",HC,i(r.$t("admin.oauth2_client_id")),1),s(ne,{modelValue:p.oauth2_form.client_id,"onUpdate:modelValue":_[13]||(_[13]=T=>p.oauth2_form.client_id=T),class:"form-input",placeholder:r.$t("admin.oauth2_client_id_placeholder")},null,8,["modelValue","placeholder"])]),e("div",EC,[e("label",jC,i(r.$t("admin.oauth2_client_secret")),1),s(ne,{modelValue:p.oauth2_form.client_secret,"onUpdate:modelValue":_[14]||(_[14]=T=>p.oauth2_form.client_secret=T),type:"password",class:"form-input",placeholder:r.$t("admin.oauth2_client_secret_placeholder")},null,8,["modelValue","placeholder"])]),e("div",BC,[e("label",GC,i(r.$t("admin.oauth2_protocol")),1),s(I,{value:p.oauth2_form.protocol,"onUpdate:value":_[15]||(_[15]=T=>p.oauth2_form.protocol=T),class:"form-select"},{default:u(()=>[s(x,{value:"http"},{default:u(()=>[..._[25]||(_[25]=[O("HTTP",-1)])]),_:1}),s(x,{value:"https"},{default:u(()=>[..._[26]||(_[26]=[O("HTTPS",-1)])]),_:1})]),_:1},8,["value"])]),e("div",KC,[e("label",WC,[O(i(r.$t("admin.oauth2_host"))+" ",1),s(S,{title:r.$t("admin.oauth2_host_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.host,"onUpdate:modelValue":_[16]||(_[16]=T=>p.oauth2_form.host=T),class:"form-input",placeholder:r.$t("admin.oauth2_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",JC,[e("label",YC,[O(i(r.$t("admin.oauth2_authorize_path"))+" ",1),s(S,{title:r.$t("admin.oauth2_authorize_path_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.authorize_path,"onUpdate:modelValue":_[17]||(_[17]=T=>p.oauth2_form.authorize_path=T),class:"form-input",placeholder:r.$t("admin.oauth2_authorize_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",XC,[e("label",QC,[O(i(r.$t("admin.oauth2_token_path"))+" ",1),s(S,{title:r.$t("admin.oauth2_token_path_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.token_path,"onUpdate:modelValue":_[18]||(_[18]=T=>p.oauth2_form.token_path=T),class:"form-input",placeholder:r.$t("admin.oauth2_token_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",ZC,[e("label",ex,[O(i(r.$t("admin.oauth2_resource_path"))+" ",1),s(S,{title:r.$t("admin.oauth2_resource_path_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.resource_path,"onUpdate:modelValue":_[19]||(_[19]=T=>p.oauth2_form.resource_path=T),class:"form-input",placeholder:r.$t("admin.oauth2_resource_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",tx,[e("label",ax,[O(i(r.$t("admin.oauth2_userinfo_path"))+" ",1),s(S,{title:r.$t("admin.oauth2_userinfo_path_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.userinfo_path,"onUpdate:modelValue":_[20]||(_[20]=T=>p.oauth2_form.userinfo_path=T),class:"form-input",placeholder:r.$t("admin.oauth2_userinfo_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",ox,[e("label",sx,[O(i(r.$t("admin.oauth2_logout_redirect_uri"))+" ",1),s(S,{title:r.$t("admin.oauth2_logout_redirect_uri_tips"),placement:"top"},{default:u(()=>[s(y,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.logout_redirect_uri,"onUpdate:modelValue":_[21]||(_[21]=T=>p.oauth2_form.logout_redirect_uri=T),class:"form-input",placeholder:r.$t("admin.oauth2_logout_redirect_uri_placeholder")},null,8,["modelValue","placeholder"])])])]),general:u(()=>[e("div",lx,[s(v,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.general_login_desc"),class:"info-alert"},null,8,["message"]),e("div",nx,[e("label",ix,i(r.$t("admin.login_secret_key")),1),s(ne,{modelValue:h.login_secret_key,"onUpdate:modelValue":_[22]||(_[22]=T=>h.login_secret_key=T),class:"form-input",disabled:""},null,8,["modelValue"])]),e("div",rx,[s(K,{theme:"dark",text:r.$t("admin.reset_login_secret_key"),leftIcon:["fas","redo"],loading:l.value,onClick:w},null,8,["text","loading"]),s(K,{theme:"light",text:r.$t("admin.general_login_doc_link"),leftIcon:["fas","book"],onClick:k},null,8,["text"])])])]),_:1},8,["items","value"]),e("div",cx,[s(K,{theme:"dark",text:r.$t("common.save"),leftIcon:["fas","save"],onClick:g},null,8,["text"]),s(K,{theme:"light",text:r.$t("common.cancel"),onClick:$},null,8,["text"])])])])}}});const ux=Y(dx,[["__scopeId","data-v-3b1d7607"]]),mx={class:"system-settings"},_x={class:"settings-container"},px={class:"tab-content"},fx={class:"form-row"},vx={class:"form-label"},hx={class:"form-row"},gx={class:"form-label"},yx={class:"section-title"},wx={class:"form-row"},bx={class:"form-label"},$x={class:"form-row"},kx={class:"form-label"},Cx={class:"tab-content"},xx={class:"form-row"},Ix={class:"form-label"},Sx={class:"form-row"},Tx={class:"form-label"},Mx={class:"form-row"},Lx={class:"form-label"},Vx={class:"form-row"},zx={class:"form-label"},Ux={class:"form-row"},Px={class:"form-label"},Ax={class:"form-row"},Dx={class:"form-label"},Ox={class:"tab-content"},Nx={class:"form-row"},Fx={class:"form-label"},qx={class:"form-row"},Rx={class:"form-label"},Hx={class:"form-row"},Ex={class:"form-label"},jx={class:"form-row"},Bx={class:"form-label"},Gx={key:0,class:"form-row"},Kx={class:"form-label"},Wx={class:"form-row"},Jx={class:"form-label"},Yx={class:"form-row"},Xx={class:"form-label"},Qx={class:"form-row"},Zx={class:"form-label"},e3={class:"form-row"},t3={class:"form-label"},a3={class:"form-row"},o3={class:"form-label"},s3={class:"form-row"},l3={class:"form-label"},n3={class:"form-row"},i3={class:"form-label"},r3={class:"form-row"},c3={class:"form-label"},d3={class:"tab-content"},u3={class:"section-title"},m3={class:"form-row"},_3={class:"form-label"},p3={class:"form-row"},f3={class:"form-label"},v3={class:"form-row"},h3={class:"form-label"},g3={class:"section-title"},y3={class:"alert-content"},w3={class:"alert-text"},b3={class:"form-row"},$3={class:"form-label"},k3={class:"form-row"},C3={class:"form-label"},x3={class:"form-row form-actions"},I3={class:"tab-content"},S3={key:0,class:"form-row"},T3={class:"form-label"},M3={class:"save-button-wrapper"},L3=J({__name:"SystemSettings",setup(c){const{t,locale:a}=te(),o=b("basic"),l=b(!1),m=b([]),f=q(()=>{const r=[{text:t("admin.basic_settings"),value:"basic"},{text:t("admin.security_settings"),value:"security"},{text:t("admin.storage_settings"),value:"storage"}];return a.value==="zh-CN"&&r.push({text:t("admin.ai_related_settings"),value:"ai"}),a.value==="zh-CN"&&r.push({text:t("admin.other_settings"),value:"other"}),r}),d=r=>{o.value=String(r)},p=Je({register_open:"1",ldap_open:"0",home_page:"1",home_item:"",site_url:"",open_api_key:"",open_api_host:"",ai_model_name:"",ai_service_url:"",ai_service_token:"",force_login:"0",enable_public_square:"0",strong_password_enabled:"0",session_expire_days:180,history_version_count:0,show_watermark:"0",beian:""}),h=Je({oss_open:"0",oss_setting:{oss_type:"aliyun",key:"",secret:"",endpoint:"",region:"",secretId:"",secretKey:"",bucket:"",subcat:"",protocol:"https",domain:""}}),$=async()=>{try{const r=await os();if(!r.data||r.data.length===0)return;const _=r.data;p.register_open=st(_.register_open),p.ldap_open=st(_.ldap_open),p.home_page=String(_.home_page||"1"),p.home_item=_.home_item||"",p.site_url=_.site_url||"",p.open_api_key=_.open_api_key||"",p.open_api_host=_.open_api_host||"",p.ai_model_name=_.ai_model_name||"",p.ai_service_url=_.ai_service_url||"",p.ai_service_token=_.ai_service_token||"",p.force_login=st(_.force_login),p.enable_public_square=st(_.enable_public_square),p.strong_password_enabled=st(_.strong_password_enabled),p.session_expire_days=_.session_expire_days?parseInt(String(_.session_expire_days)):180,p.history_version_count=_.history_version_count?parseInt(String(_.history_version_count)):0,p.show_watermark=st(_.show_watermark),p.beian=_.beian||"",_.oss_open!==void 0&&(h.oss_open=st(_.oss_open)),_.oss_setting&&Object.assign(h.oss_setting,_.oss_setting)}catch(r){console.error("加载系统配置失败:",r)}},g=async()=>{try{await ss({register_open:p.register_open==="1",site_url:p.site_url,home_page:p.home_page,home_item:p.home_item,open_api_key:p.open_api_key,open_api_host:p.open_api_host,ai_model_name:p.ai_model_name,ai_service_url:p.ai_service_url,ai_service_token:p.ai_service_token,force_login:p.force_login==="1",enable_public_square:p.enable_public_square==="1",strong_password_enabled:p.strong_password_enabled==="1",session_expire_days:p.session_expire_days,history_version_count:p.history_version_count,show_watermark:p.show_watermark==="1",beian:p.beian,oss_open:h.oss_open==="1",oss_setting:h.oss_setting}),j.success(t("common.save_success"))}catch{j.error(t("common.save_failed"))}},n=async()=>{if(!p.ai_service_url){j.warning(t("admin.ai_service_url_required"));return}if(!p.ai_service_token){j.warning(t("admin.ai_service_token_required"));return}l.value=!0;try{const r=await ls({ai_service_url:p.ai_service_url,ai_service_token:p.ai_service_token});r.error_code===0?j.success(t("admin.ai_connection_success")):j.error(r.error_message||t("admin.ai_connection_failed"))}catch(r){j.error(`${t("admin.ai_connection_failed")}: ${r.message||t("admin.unknown_error")}`)}finally{l.value=!1}},w=r=>{window.open(r,"_blank")},k=async()=>{try{const r=await Aa({item_name:"",username:"",page:1,count:100,positive_type:"",item_type:"",privacy_type:"",is_del:""});r.data&&r.data.items&&(m.value=r.data.items)}catch(r){console.error("加载项目列表失败:",r)}};return ae(async()=>{$(),await k()}),(r,_)=>{const v=H("a-tooltip"),y=H("a-select-option"),S=H("a-select"),x=H("a-input-number"),I=H("a-alert");return C(),V("div",mx,[e("div",_x,[s(vt,{items:f.value,value:o.value,type:"segmented",onUpdateValue:d},{basic:u(()=>[e("div",px,[e("div",fx,[e("label",vx,[O(i(r.$t("admin.open_register"))+" ",1),s(v,{title:r.$t("admin.open_register_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(We,{modelValue:p.register_open,"onUpdate:modelValue":_[0]||(_[0]=T=>p.register_open=T)},null,8,["modelValue"])]),e("div",hx,[e("label",gx,[O(i(r.$t("admin.site_url"))+" ",1),s(v,{title:r.$t("admin.site_url_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[1]||(_[1]=T=>w("https://www.showdoc.com.cn/p/30dd0637811cd5c690ffd547f3c46889"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.site_url,"onUpdate:modelValue":_[2]||(_[2]=T=>p.site_url=T),class:"form-input",placeholder:r.$t("admin.site_url_placeholder")},null,8,["modelValue","placeholder"])]),e("div",yx,i(r.$t("admin.home_page")),1),e("div",wx,[e("label",bx,[O(i(r.$t("admin.home_page"))+" ",1),s(v,{title:r.$t("admin.home_page_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(S,{value:p.home_page,"onUpdate:value":_[3]||(_[3]=T=>p.home_page=T),class:"form-select"},{default:u(()=>[s(y,{value:"1"},{default:u(()=>[O(i(r.$t("admin.full_page")),1)]),_:1}),s(y,{value:"2"},{default:u(()=>[O(i(r.$t("admin.login_page")),1)]),_:1}),s(y,{value:"3"},{default:u(()=>[O(i(r.$t("admin.jump_to_item")),1)]),_:1})]),_:1},8,["value"])]),ft(e("div",$x,[e("label",kx,[O(i(r.$t("admin.home_item"))+" ",1),s(v,{title:r.$t("admin.home_item_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(S,{value:p.home_item,"onUpdate:value":_[4]||(_[4]=T=>p.home_item=T),class:"form-select",placeholder:r.$t("admin.home_item_placeholder"),"show-search":!0,"filter-option":(T,M)=>M.label.toLowerCase().includes(T.toLowerCase())},{default:u(()=>[(C(!0),V(Ce,null,Pe(m.value,T=>(C(),B(y,{key:T.item_id,value:T.item_id,label:T.item_name},{default:u(()=>[O(i(T.item_name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","filter-option"])],512),[[ga,p.home_page==="3"]])])]),security:u(()=>[e("div",Cx,[e("div",xx,[e("label",Ix,[O(i(r.$t("admin.force_login"))+" ",1),s(v,{title:r.$t("admin.force_login_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(We,{modelValue:p.force_login,"onUpdate:modelValue":_[5]||(_[5]=T=>p.force_login=T)},null,8,["modelValue"])]),e("div",Sx,[e("label",Tx,[O(i(r.$t("admin.enable_public_square"))+" ",1),s(v,{title:r.$t("admin.enable_public_square_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(We,{modelValue:p.enable_public_square,"onUpdate:modelValue":_[6]||(_[6]=T=>p.enable_public_square=T)},null,8,["modelValue"])]),e("div",Mx,[e("label",Lx,[O(i(r.$t("admin.strong_password_enabled"))+" ",1),s(v,{title:r.$t("admin.strong_password_enabled_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(We,{modelValue:p.strong_password_enabled,"onUpdate:modelValue":_[7]||(_[7]=T=>p.strong_password_enabled=T)},null,8,["modelValue"])]),e("div",Vx,[e("label",zx,[O(i(r.$t("admin.session_expire_days"))+" ",1),s(v,{title:r.$t("admin.session_expire_days_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(x,{value:p.session_expire_days,"onUpdate:value":_[8]||(_[8]=T=>p.session_expire_days=T),min:1,max:3650,class:"form-input-number",placeholder:r.$t("admin.session_expire_days_placeholder")},null,8,["value","placeholder"])]),e("div",Ux,[e("label",Px,[O(i(r.$t("admin.history_version_count"))+" ",1),s(v,{title:r.$t("admin.history_version_count_content"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(x,{value:p.history_version_count,"onUpdate:value":_[9]||(_[9]=T=>p.history_version_count=T),min:0,max:100,class:"form-input-number",placeholder:r.$t("admin.history_version_count_content")},null,8,["value","placeholder"])]),e("div",Ax,[e("label",Dx,[O(i(r.$t("admin.watermark"))+" ",1),s(v,{title:r.$t("admin.watermark_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(We,{modelValue:p.show_watermark,"onUpdate:modelValue":_[10]||(_[10]=T=>p.show_watermark=T)},null,8,["modelValue"])])])]),storage:u(()=>[e("div",Ox,[e("div",Nx,[e("label",Fx,i(r.$t("admin.oss_open")),1),s(We,{modelValue:h.oss_open,"onUpdate:modelValue":_[11]||(_[11]=T=>h.oss_open=T)},null,8,["modelValue"])]),e("div",qx,[e("label",Rx,i(r.$t("admin.oss_server")),1),s(S,{value:h.oss_setting.oss_type,"onUpdate:value":_[12]||(_[12]=T=>h.oss_setting.oss_type=T),class:"form-select"},{default:u(()=>[s(y,{value:"aliyun"},{default:u(()=>[O(i(r.$t("admin.aliyun")),1)]),_:1}),s(y,{value:"qiniu"},{default:u(()=>[O(i(r.$t("admin.qiniu")),1)]),_:1}),s(y,{value:"qcloud"},{default:u(()=>[O(i(r.$t("admin.qcloud")),1)]),_:1}),s(y,{value:"s3_storage"},{default:u(()=>[O(i(r.$t("admin.s3_storage")),1)]),_:1})]),_:1},8,["value"])]),h.oss_setting.oss_type==="aliyun"||h.oss_setting.oss_type==="s3_storage"?(C(),V(Ce,{key:0},[e("div",Hx,[e("label",Ex,i(r.$t("admin.oss_key")),1),s(ne,{modelValue:h.oss_setting.key,"onUpdate:modelValue":_[13]||(_[13]=T=>h.oss_setting.key=T),class:"form-input",placeholder:r.$t("admin.oss_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",jx,[e("label",Bx,i(r.$t("admin.oss_secret")),1),s(ne,{modelValue:h.oss_setting.secret,"onUpdate:modelValue":_[14]||(_[14]=T=>h.oss_setting.secret=T),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secret_placeholder")},null,8,["modelValue","placeholder"])]),h.oss_setting.oss_type==="aliyun"?(C(),V("div",Gx,[e("label",Kx,i(r.$t("admin.oss_endpoint")),1),s(ne,{modelValue:h.oss_setting.endpoint,"onUpdate:modelValue":_[15]||(_[15]=T=>h.oss_setting.endpoint=T),class:"form-input",placeholder:r.$t("admin.oss_endpoint_placeholder")},null,8,["modelValue","placeholder"])])):F("",!0)],64)):F("",!0),h.oss_setting.oss_type==="qiniu"?(C(),V(Ce,{key:1},[e("div",Wx,[e("label",Jx,i(r.$t("admin.oss_key")),1),s(ne,{modelValue:h.oss_setting.key,"onUpdate:modelValue":_[16]||(_[16]=T=>h.oss_setting.key=T),class:"form-input",placeholder:r.$t("admin.oss_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",Yx,[e("label",Xx,i(r.$t("admin.oss_secret")),1),s(ne,{modelValue:h.oss_setting.secret,"onUpdate:modelValue":_[17]||(_[17]=T=>h.oss_setting.secret=T),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secret_placeholder")},null,8,["modelValue","placeholder"])])],64)):F("",!0),h.oss_setting.oss_type==="qcloud"?(C(),V(Ce,{key:2},[e("div",Qx,[e("label",Zx,i(r.$t("admin.oss_secretId")),1),s(ne,{modelValue:h.oss_setting.secretId,"onUpdate:modelValue":_[18]||(_[18]=T=>h.oss_setting.secretId=T),class:"form-input",placeholder:r.$t("admin.oss_secretId_placeholder")},null,8,["modelValue","placeholder"])]),e("div",e3,[e("label",t3,i(r.$t("admin.oss_secretKey")),1),s(ne,{modelValue:h.oss_setting.secretKey,"onUpdate:modelValue":_[19]||(_[19]=T=>h.oss_setting.secretKey=T),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secretKey_placeholder")},null,8,["modelValue","placeholder"])]),e("div",a3,[e("label",o3,i(r.$t("admin.oss_region")),1),s(ne,{modelValue:h.oss_setting.region,"onUpdate:modelValue":_[20]||(_[20]=T=>h.oss_setting.region=T),class:"form-input",placeholder:r.$t("admin.oss_region_placeholder")},null,8,["modelValue","placeholder"])])],64)):F("",!0),e("div",s3,[e("label",l3,i(r.$t("admin.oss_bucket")),1),s(ne,{modelValue:h.oss_setting.bucket,"onUpdate:modelValue":_[21]||(_[21]=T=>h.oss_setting.bucket=T),class:"form-input",placeholder:r.$t("admin.oss_bucket_placeholder")},null,8,["modelValue","placeholder"])]),e("div",n3,[e("label",i3,i(r.$t("admin.oss_subcat")),1),s(ne,{modelValue:h.oss_setting.subcat,"onUpdate:modelValue":_[22]||(_[22]=T=>h.oss_setting.subcat=T),class:"form-input",placeholder:r.$t("admin.oss_subcat_placeholder")},null,8,["modelValue","placeholder"])]),e("div",r3,[e("label",c3,i(r.$t("admin.oss_domain")),1),s(ne,{modelValue:h.oss_setting.domain,"onUpdate:modelValue":_[23]||(_[23]=T=>h.oss_setting.domain=T),class:"form-input",placeholder:r.$t("admin.oss_domain_placeholder")},null,8,["modelValue","placeholder"])])])]),ai:u(()=>[e("div",d3,[e("div",u3,i(r.$t("admin.ai_edit_assistant")),1),s(I,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.ai_edit_assistant_desc"),class:"info-alert"},null,8,["message"]),e("div",m3,[e("label",_3,[O(i(r.$t("admin.ai_edit_assistant_key"))+" ",1),s(v,{title:r.$t("admin.ai_edit_assistant_key_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[24]||(_[24]=T=>w("https://www.showdoc.com.cn/p/30dd0637811cd5c690ffd547f3c46889"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.open_api_key,"onUpdate:modelValue":_[25]||(_[25]=T=>p.open_api_key=T),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",p3,[e("label",f3,[O(i(r.$t("admin.ai_edit_assistant_host"))+" ",1),s(v,{title:r.$t("admin.ai_edit_assistant_host_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[26]||(_[26]=T=>w("https://github.com/star7th/showdoc/issues/1904"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.open_api_host,"onUpdate:modelValue":_[27]||(_[27]=T=>p.open_api_host=T),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",v3,[e("label",h3,i(r.$t("admin.ai_edit_assistant_model")),1),s(ne,{modelValue:p.ai_model_name,"onUpdate:modelValue":_[28]||(_[28]=T=>p.ai_model_name=T),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_model_placeholder")},null,8,["modelValue","placeholder"])]),e("div",g3,i(r.$t("admin.ai_knowledge_base_service")),1),s(I,{type:"warning",closable:!1,"show-icon":"",class:"warning-alert"},{message:u(()=>[e("div",y3,[e("div",w3,i(r.$t("admin.ai_knowledge_base_service_desc")),1),e("a",{class:"alert-link",onClick:_[29]||(_[29]=T=>w("https://github.com/star7th/showdoc-ai-service"))},i(r.$t("admin.ai_knowledge_base_install_link")),1)])]),_:1}),e("div",b3,[e("label",$3,[O(i(r.$t("admin.ai_service_url"))+" ",1),s(v,{title:r.$t("admin.ai_service_url_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.ai_service_url,"onUpdate:modelValue":_[30]||(_[30]=T=>p.ai_service_url=T),class:"form-input",placeholder:r.$t("admin.ai_service_url_placeholder")},null,8,["modelValue","placeholder"])]),e("div",k3,[e("label",C3,[O(i(r.$t("admin.ai_service_token"))+" ",1),s(v,{title:r.$t("admin.ai_service_token_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.ai_service_token,"onUpdate:modelValue":_[31]||(_[31]=T=>p.ai_service_token=T),type:"password",class:"form-input",placeholder:r.$t("admin.ai_service_token_placeholder")},null,8,["modelValue","placeholder"])]),e("div",x3,[s(K,{theme:"dark",text:r.$t("admin.ai_test_connection"),leftIcon:["fas","link"],loading:l.value,onClick:n},null,8,["text","loading"])])])]),other:u(()=>[e("div",I3,[z(a)==="zh-CN"?(C(),V("div",S3,[e("label",T3,[O(i(r.$t("admin.beian"))+" ",1),s(v,{title:r.$t("admin.beian_tips"),placement:"top"},{default:u(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.beian,"onUpdate:modelValue":_[32]||(_[32]=T=>p.beian=T),class:"form-input",placeholder:r.$t("admin.beian_tips")},null,8,["modelValue","placeholder"])])):F("",!0)])]),_:1},8,["items","value"]),e("div",M3,[s(K,{theme:"dark",text:r.$t("common.save"),leftIcon:["fas","save"],onClick:g},null,8,["text"]),s(K,{theme:"light",text:r.$t("common.cancel"),onClick:$},null,8,["text"])])])])}}});const V3=Y(L3,[["__scopeId","data-v-c7ecd797"]]),z3={class:"about-site"},U3={class:"about-content"},P3={class:"info-section"},A3={class:"section-title"},D3={class:"info-text"},O3={class:"info-section"},N3={class:"info-text"},F3={class:"info-section"},q3={class:"section-title"},R3={class:"info-text"},H3={href:"https://www.showdoc.com.cn/",target:"_blank",class:"link"},E3={key:0,class:"update-section"},j3={class:"section-title update-title"},B3={class:"info-text"},G3={href:"https://www.showdoc.com.cn/help/13733",target:"_blank",class:"link"},K3={class:"info-text"},W3={class:"info-text"},J3={href:"https://www.showdoc.com.cn/help?page_id=13732",target:"_blank",class:"link"},Y3=J({__name:"AboutSite",setup(c){const{t}=te(),a=b(""),o=b(""),l=b(!1),m=b(""),f=async()=>{try{const h=await X("/api/common/version",{},"get");h&&h.data&&h.data.version&&(a.value=h.data.version)}catch(h){console.error("Failed to get current version:",h)}},d=async()=>{try{const h=await X("/api/adminUpdate/checkUpdate",{},"get");h&&h.data&&h.data.url&&(m.value=h.data.url,o.value=h.data.new_version,a.value=h.data.version,l.value=!0)}catch(h){console.error("Failed to check update:",h)}},p=async()=>{const h=j.loading(t("admin.downloading_update_package"),0);try{await X("/api/adminUpdate/download",{},"post"),h();const $=j.loading(t("admin.updating_files"),0);await X("/api/adminUpdate/updateFiles",{},"post"),$();const g=j.loading(t("admin.upgrade_success_ready_to_refresh")+t("admin.if_cache_not_auto_update_refresh_manually"),0);await X("/api/update/checkDb",{},"post"),setTimeout(()=>{window.location.reload()},7e3)}catch($){h(),j.error(t("common.update_failed")),console.error("Update failed:",$)}};return ae(()=>{f(),d()}),(h,$)=>(C(),V("div",z3,[e("div",U3,[e("div",P3,[e("h3",A3,i(h.$t("admin.version")),1),e("p",D3,[O(i(h.$t("admin.open_source_based"))+" ",1),e("b",null,i(h.$t("admin.current_version"))+": "+i(a.value),1)])]),e("div",O3,[$[3]||($[3]=e("h3",{class:"section-title"},"GitHub",-1)),e("p",N3,[O(i(h.$t("admin.issue_report"))+"：",1),$[0]||($[0]=e("a",{href:"https://github.com/star7th/showdoc/issues",target:"_blank",class:"link"}," https://github.com/star7th/showdoc/issues ",-1)),$[1]||($[1]=e("br",null,null,-1)),O(" "+i(h.$t("admin.star_tip"))+" ",1),$[2]||($[2]=e("a",{href:"https://github.com/star7th/showdoc",target:"_blank",class:"link"},"GitHub",-1))])]),e("div",F3,[e("h3",q3,i(h.$t("common.copyright")),1),e("p",R3,[e("a",H3,i(h.$t("common.showdoc")),1),O(" "+i(h.$t("admin.copyright_info")),1)])]),l.value?(C(),V("div",E3,[$[4]||($[4]=e("hr",null,null,-1)),e("h3",j3,i(h.$t("admin.update_available"))+"("+i(o.value)+")",1),e("p",B3,[O(i(h.$t("admin.update_content"))+" ",1),e("a",G3,i(h.$t("admin.update_log")),1)]),e("p",K3,i(h.$t("admin.update_tips")),1),s(K,{type:"primary",onClick:p},{default:u(()=>[O(i(h.$t("admin.click_to_update")),1)]),_:1}),$[5]||($[5]=e("br",null,null,-1)),$[6]||($[6]=e("br",null,null,-1)),e("p",W3,[O(i(h.$t("admin.update_failed_tip"))+"， ",1),e("a",J3,i(h.$t("common.click_here")),1)])])):F("",!0)])]))}});const X3=Y(Y3,[["__scopeId","data-v-a3e1bc68"]]),Q3={class:"admin-layout"},Z3={class:"admin-header"},e5={class:"header-left"},t5={class:"header-title"},a5={class:"header-right"},o5={class:"admin-container"},s5={class:"admin-sidebar"},l5={class:"sidebar-menu"},n5=["onClick"],i5={class:"menu-icon"},r5={class:"menu-label"},c5={class:"admin-content"},d5=J({__name:"AdminLayout",setup(c){const t=xe(),{t:a}=te(),o=He(),l=b(["user"]),m=()=>{o.toggleTheme()},f=q(()=>[{key:"user",label:a("admin.user_manage"),icon:"fas fa-users"},{key:"item",label:a("admin.item_manage"),icon:"fas fa-file-alt"},{key:"announcement",label:a("admin.announcement_manage"),icon:"fas fa-bullhorn"},{key:"attachment",label:a("admin.attachment_manage"),icon:"fas fa-paperclip"},{key:"ext-login",label:a("admin.ext_login"),icon:"fas fa-plug"},{key:"setting",label:a("admin.web_setting"),icon:"fas fa-cog"},{key:"about",label:a("admin.about_site"),icon:"fas fa-info-circle"}]),d={user:k2,item:p8,announcement:R8,attachment:cC,"ext-login":ux,setting:V3,about:X3},p=q(()=>d[l.value[0]]),h=g=>{l.value=[g]},$=()=>{t.push("/item/index")};return ae(()=>{l.value=["user"]}),(g,n)=>{const w=H("a-tooltip");return C(),V("div",Q3,[e("div",Z3,[e("div",e5,[s(w,{title:g.$t("item.back_to_item_list"),mouseEnterDelay:.3,destroyTooltipOnHide:!0},{default:u(()=>[e("div",{class:"icon-item",onClick:$},[...n[0]||(n[0]=[e("i",{class:"fas fa-arrow-left"},null,-1)])])]),_:1},8,["title"]),e("div",t5,i(g.$t("admin.admin_panel")),1)]),e("div",a5,[s(w,{title:z(o).theme==="light"?g.$t("common.dark_mode"):g.$t("common.light_mode"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:m},[...n[1]||(n[1]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"])])]),e("div",o5,[e("div",s5,[e("div",l5,[(C(!0),V(Ce,null,Pe(f.value,k=>(C(),V("div",{key:k.key,class:re(["menu-item",{active:l.value[0]===k.key}]),onClick:r=>h(k.key)},[e("div",i5,[e("i",{class:re(k.icon)},null,2)]),e("span",r5,i(k.label),1)],10,n5))),128))])]),e("div",c5,[p.value?(C(),B(so(p.value),{key:0})):F("",!0)])])])}}});const u5=Y(d5,[["__scopeId","data-v-e5e82630"]]),m5=J({__name:"Index",setup(c){return(t,a)=>(C(),B(u5))}}),OS=Object.freeze(Object.defineProperty({__proto__:null,default:m5},Symbol.toStringTag,{value:"Module"})),_5={class:"public-square-page"},p5={class:"page-header"},f5={class:"header-left"},v5={class:"page-title"},h5={class:"header-right"},g5={class:"search-box"},y5={class:"public-square-container"},w5={key:0,class:"project-grid"},b5=["onClick"],$5={class:"project-card-header"},k5={class:"item-icon-wrapper"},C5={key:0,class:"item-icon fas fa-file"},x5={key:1,class:"item-icon fas fa-table"},I5={key:2,class:"item-icon fas fa-terminal"},S5={key:3,class:"item-icon fas fa-chalkboard"},T5={key:4,class:"item-icon fas fa-book"},M5={class:"project-title"},L5={class:"project-desc"},V5={class:"project-card-footer"},z5={class:"meta-item"},U5={key:1,class:"empty-container"},P5={key:2,class:"loading-container"},A5={key:0,class:"pagination-wrapper"},D5=J({__name:"Index",setup(c){const{t}=te(),a=xe(),o=He(),l=b([]),m=b(0),f=b(1),d=b(12),p=b(""),h=b("title"),$=q(()=>[{label:t("item.search_title"),value:"title"},{label:t("item.search_content"),value:"content"}]),g=b(!1),n=b(!1),w=(M,L)=>t("common.pagination_info",{start:L[0],end:L[1],total:M}),k=()=>{a.push("/item/index")},r=()=>{o.toggleTheme()},_=async()=>{try{const M=await Yt();M&&M.data&&M.data.enable===1?(n.value=!0,await v()):(j.error(t("item.enable_public_square_tips")),a.push("/item/index"))}catch{j.error(t("common.op_failed")),a.push("/item/index")}},v=async()=>{if(n.value){g.value=!0;try{const M=await ns({page:f.value,count:d.value,keyword:p.value,search_type:h.value});M&&M.data&&(l.value=M.data.items||[],m.value=M.data.total||0)}catch(M){console.error("获取公开项目列表失败:",M),j.error(t("common.op_failed"))}finally{g.value=!1}}},y=()=>{f.value=1,v()},S=M=>{f.value=M,v()},x=M=>{const L="#/"+(M.item_domain||M.item_id);window.open(L,"_blank")},I=M=>({1:t("item.type_regular"),2:t("item.type_single"),3:t("item.type_runapi"),4:t("item.type_table"),5:t("item.type_whiteboard")})[String(M)]||t("item.type_regular"),T=M=>{if(!M)return"";let L;if(typeof M=="string"){if(L=new Date(M).getTime()/1e3,isNaN(L))return""}else L=M;const N=Date.now()/1e3-L;if(N<3600){const ge=Math.floor(N/60);return ge<=1?t("time.just_now"):t("time.minutes_ago",{n:ge})}if(N<86400){const ge=Math.floor(N/3600);return t("time.hours_ago",{n:ge})}if(N<604800){const ge=Math.floor(N/86400);return t("time.days_ago",{n:ge})}const U=new Date(L*1e3),A=U.getFullYear(),D=String(U.getMonth()+1).padStart(2,"0"),E=String(U.getDate()).padStart(2,"0"),oe=new Date().getFullYear();return A===oe?`${D}-${E}`:`${A}-${D}-${E}`};return ae(()=>{_()}),(M,L)=>{const P=H("a-input"),N=H("a-empty"),U=H("a-spin"),A=H("a-pagination");return C(),V("div",_5,[e("div",p5,[e("div",f5,[e("button",{class:"back-button",onClick:k},[...L[3]||(L[3]=[e("i",{class:"fas fa-arrow-left"},null,-1)])]),e("h2",v5,i(z(t)("item.public_square")),1),e("button",{class:"theme-toggle-button",onClick:r},[...L[4]||(L[4]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),e("div",h5,[e("div",g5,[s(P,{value:p.value,"onUpdate:value":L[1]||(L[1]=D=>p.value=D),placeholder:z(t)("item.search_placeholder"),onPressEnter:y},{prepend:u(()=>[s(Re,{value:h.value,"onUpdate:value":L[0]||(L[0]=D=>h.value=D),options:$.value,style:{width:"120px"}},null,8,["value","options"])]),suffix:u(()=>[e("i",{class:"fas fa-search search-icon",onClick:y})]),_:1},8,["value","placeholder"])])])]),e("div",y5,[!g.value&&l.value.length>0?(C(),V("div",w5,[(C(!0),V(Ce,null,Pe(l.value,D=>(C(),V("div",{class:"project-card",key:D.item_id,onClick:E=>x(D)},[e("div",$5,[e("div",k5,[D.item_type=="2"?(C(),V("i",C5)):D.item_type=="4"?(C(),V("i",x5)):D.item_type=="3"?(C(),V("i",I5)):D.item_type=="5"?(C(),V("i",S5)):(C(),V("i",T5))]),e("h3",M5,i(D.item_name),1)]),e("p",L5,i(D.item_description||z(t)("item.no_description_item")),1),e("div",V5,[e("span",z5,[L[5]||(L[5]=e("i",{class:"far fa-clock"},null,-1)),O(" "+i(T(D.last_update_time)),1)]),e("div",{class:re(["item-type-badge",`type-${D.item_type}`])},i(I(D.item_type)),3)])],8,b5))),128))])):F("",!0),!g.value&&l.value.length===0?(C(),V("div",U5,[s(N,{description:z(t)("item.no_public_items")},null,8,["description"])])):F("",!0),g.value?(C(),V("div",P5,[s(U,{size:"large"})])):F("",!0)]),m.value>0?(C(),V("div",A5,[s(A,{current:f.value,"onUpdate:current":L[2]||(L[2]=D=>f.value=D),"page-size":d.value,total:m.value,"show-size-changer":!1,"show-total":w,onChange:S},null,8,["current","page-size","total"])])):F("",!0)])}}});const O5=Y(D5,[["__scopeId","data-v-1a50b003"]]),NS=Object.freeze(Object.defineProperty({__proto__:null,default:O5},Symbol.toStringTag,{value:"Module"})),N5={class:"item-header"},F5={class:"header-left"},q5={class:"item-name"},R5=J({__name:"ItemHeader",props:{itemInfo:{default:()=>({})},slots:{default:()=>({})}},setup(c){const t=xe();te();const a=()=>{t.push("/item/index")};return(o,l)=>{var f;const m=H("a-tooltip");return C(),V("div",N5,[e("div",F5,[s(m,{title:o.$t("item.back_to_item_list")},{default:u(()=>[e("div",{class:"icon-item",onClick:a},[...l[0]||(l[0]=[e("i",{class:"fas fa-arrow-left"},null,-1)])])]),_:1},8,["title"]),e("div",q5,i(((f=c.itemInfo)==null?void 0:f.item_name)||""),1)]),lo(o.$slots,"right",{},void 0,!0)])}}});const Vt=Y(R5,[["__scopeId","data-v-82bc7211"]]),H5={class:"export-file-modal"},E5={class:"modal-content"},j5={class:"form-section"},B5={class:"form-label"},G5={key:0,class:"form-group"},K5={class:"form-label"},W5={key:1,class:"form-group"},J5={class:"form-label"},Y5={class:"tips"},X5={class:"tips-text"},Q5={class:"tips"},Z5={class:"tips-text"},eI={class:"modal-footer"},tI=J({__name:"index",props:{onClose:{type:Function},itemId:{}},setup(c){const{t}=te(),a=c,o=q(()=>{const L=[{text:t("item.export_format_word"),value:"word"},{text:t("item.export_format_html"),value:"html"}];return g.value&&L.splice(1,0,{text:t("item.export_format_markdown"),value:"markdown"}),L}),l=q(()=>[{text:t("item.export_all"),value:1},{text:t("item.export_cat"),value:2}]),m=b(!1),f=b(!1),d=b("word"),p=b(1),h=b(""),$=b("0"),g=b(!0),n=b([]),w=b([{page_id:"0",page_title:t("item.all_pages")}]),k=Qt(),r=(k==null?void 0:k.user_token)||"",_=q(()=>{const L=n.value.slice(0),P=[];for(let N=0;N<L.length;N++){P.push(L[N]);const U=L[N].sub;if(U&&U.length>0)for(let A=0;A<U.length;A++){P.push({cat_id:U[A].cat_id,cat_name:L[N].cat_name+" / "+U[A].cat_name});const D=U[A].sub;if(D&&D.length>0)for(let E=0;E<D.length;E++)P.push({cat_id:D[E].cat_id,cat_name:L[N].cat_name+" / "+U[A].cat_name+" / "+D[E].cat_name})}}return P.unshift({cat_id:"",cat_name:t("item.none")}),P.map(N=>({label:N.cat_name,value:N.cat_id}))}),v=q(()=>w.value.map(L=>({label:L.page_title,value:L.page_id}))),y=async L=>{try{const P=await X("/api/catalog/catListGroup",{item_id:L});P.error_code===0&&P.data&&(n.value=P.data)}catch(P){console.error("获取目录失败:",P)}},S=async L=>{if(!L){w.value=[{page_id:"0",page_title:t("item.all_pages")}],$.value="0";return}try{const P=await X("/api/catalog/getPagesBycat",{item_id:a.itemId,cat_id:L});P.error_code===0&&P.data&&(w.value=[{page_id:"0",page_title:t("item.all_pages")},...P.data],$.value="0")}catch(P){console.error("获取页面失败:",P)}},x=L=>{S(L)},I=async()=>{try{return(await X("/api/export/checkMarkdownLimit",{export_format:d.value})).error_code===0}catch(L){return console.error("检查Markdown限制失败:",L),!1}},T=async()=>{if(f.value)return;if(!await I()){await G(t("common.op_failed"));return}const P=ot();let N="";if(d.value==="word"){const U=p.value===1?"":h.value;N=dt(`${P}/api/export/word`,{item_id:a.itemId,cat_id:U,page_id:$.value,user_token:r})}else d.value==="markdown"?N=dt(`${P}/api/export/markdown`,{item_id:a.itemId,user_token:r}):d.value==="html"&&(N=dt(`${P}/api/exportHtml/export`,{item_id:a.itemId,user_token:r}));window.location.href=N,ie.success(t("common.export_success")),M(!0)},M=(L=!1)=>{m.value=!1,setTimeout(()=>{a.onClose(L)},300)};return ae(async()=>{await y(a.itemId);try{const L=await X("/api/item/info",{item_id:a.itemId});L.error_code===0&&L.data&&L.data.item_type==="3"&&(g.value=!1)}catch(L){console.error("获取项目信息失败:",L)}setTimeout(()=>{m.value=!0})}),(L,P)=>(C(),V("div",H5,[s(de,{class:re({show:m.value}),title:L.$t("item.export"),icon:["fa","fa-download"],onClose:M},{default:u(()=>[e("div",E5,[s(vt,{items:o.value,value:d.value,type:"segmented",onUpdateValue:P[3]||(P[3]=N=>d.value=N)},{word:u(()=>[e("div",j5,[e("label",B5,i(L.$t("item.export_range")),1),s(vt,{items:l.value,value:p.value,type:"segmented",onUpdateValue:P[0]||(P[0]=N=>p.value=N)},null,8,["items","value"]),p.value===2?(C(),V("div",G5,[e("label",K5,i(L.$t("page.catalog")),1),s(Re,{value:h.value,"onUpdate:value":P[1]||(P[1]=N=>h.value=N),placeholder:L.$t("page.catalog"),"show-search":!0,options:_.value,onChange:x},null,8,["value","placeholder","options"])])):F("",!0),p.value===2&&w.value.length>0?(C(),V("div",W5,[e("label",J5,i(L.$t("page.page_info")),1),s(Re,{value:$.value,"onUpdate:value":P[2]||(P[2]=N=>$.value=N),"show-search":!0,options:v.value},null,8,["value","options"])])):F("",!0)])]),markdown:u(()=>[e("div",Y5,[e("p",X5,i(L.$t("item.export_markdown_tips")),1)])]),html:u(()=>[e("div",Q5,[e("p",Z5,i(L.$t("item.export_html_tips")),1)])]),_:1},8,["items","value"])]),e("div",eI,[s(K,{text:L.$t("common.cancel"),theme:"light",onClick:M},null,8,["text"]),s(K,{text:L.$t("common.confirm"),theme:"dark",spinning:f.value,onClick:T},null,8,["text","spinning"])])]),_:1},8,["class","title"])]))}});const aI=Y(tI,[["__scopeId","data-v-f72135ff"]]);function Wa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(aI,{itemId:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const oI={class:"change-log-modal"},sI={class:"modal-content"},lI=["onClick"],nI={key:1},iI=J({__name:"index",props:{itemId:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=q(()=>[{title:t("item.op_time"),key:"optime",minWidth:150},{title:t("item.oper"),key:"oper",minWidth:80},{title:t("item.op_action_type_desc"),key:"op_action_type_desc",minWidth:80},{title:t("item.op_object_type_desc"),key:"op_object_type_desc",minWidth:80},{title:t("item.op_object_name"),key:"op_object_name",minWidth:150},{title:t("item.remark"),key:"remark",minWidth:150}]),m=b(!1),f=b(!1),d=b([]),p=b([]),h=b(1),$=b(10),g=b(0),n=q(()=>({current:h.value,pageSize:$.value,total:g.value})),w=x=>(x.op_action_type==="create"||x.op_action_type==="update")&&x.op_object_type==="page",k=x=>x?{create:t("item.op_create"),update:t("item.op_update"),delete:t("item.op_delete"),copy:t("item.op_copy"),move:t("item.op_move")}[x]||x:"",r=x=>x?{page:t("item.op_page"),catalog:t("item.catalog"),item:t("item.op_item"),member:t("item.op_member"),attachment:t("item.op_attachment")}[x]||x:"",_=async()=>{f.value=!0;try{const x=await X("/api/item/getChangeLog",{page:h.value,count:$.value,item_id:o.itemId},"post",!1);if(console.log("[fetchChangeLog] result:",x),x.error_code===0){const I=(h.value-1)*$.value,T=I+$.value;p.value=[...p.value.slice(0,I),...x.data.list||[],...p.value.slice(T)],d.value=p.value,g.value=parseInt(x.data.total)||0,console.log("[fetchChangeLog] logList.value:",d.value),console.log("[fetchChangeLog] total.value:",g.value)}}catch(x){console.error("获取变更日志失败:",x)}finally{f.value=!1}},v=x=>{h.value=x,_()},y=x=>{if(!x)return;const I=a.resolve({path:`/${o.itemId}/${x}`});window.open(I.href,"_blank")},S=()=>{o.onClose&&o.onClose()};return ae(()=>{m.value=!0,_()}),(x,I)=>(C(),V("div",oI,[s(de,{class:re({show:m.value}),title:x.$t("item.item_change_log_dialog_title"),icon:["fa","fa-clock-rotate-left"],width:"70%",height:"600px",onClose:S},{default:u(()=>[e("div",sI,[s(Le,{"table-header":l.value,"table-data":d.value,pagination:n.value,loading:f.value,"max-height":"calc(100vh - 350px)",onPageChange:v},{"cell-oper":u(({row:T})=>[O(i(T.oper),1)]),"cell-op_action_type_desc":u(({row:T})=>[O(i(k(T.op_action_type)),1)]),"cell-op_object_type_desc":u(({row:T})=>[O(i(r(T.op_object_type)),1)]),"cell-op_object_name":u(({row:T})=>[w(T)?(C(),V("a",{key:0,class:"page-link",onClick:M=>y(T.op_object_id)},i(T.op_object_name),9,lI)):(C(),V("span",nI,i(T.op_object_name),1))]),"cell-remark":u(({row:T})=>[O(i(T.remark),1)]),_:1},8,["table-header","table-data","pagination","loading"])])]),_:1},8,["class","title"])]))}});const rI=Y(iI,[["__scopeId","data-v-f64ea04e"]]);function zt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(rI,{itemId:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const cI={class:"header-right"},dI={class:"icon-item language-item"},uI=J({__name:"HeaderRight",props:{pageId:{default:0},itemInfo:{default:()=>({})},pageInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}}},emits:["editPage"],setup(c,{emit:t}){const a=c,o=t,l=xe(),{t:m}=te(),f=He(),d=Qe(),p=()=>{f.toggleTheme()},h=q(()=>d.newMsg),$=q(()=>[{icon:["far","fa-upload"],text:m("item.import"),value:"import"},{icon:["far","fa-download"],text:m("item.export"),value:"export"},{icon:["far","fa-users"],text:m("item.member_manage"),value:"member"},{icon:["far","fa-recycle"],text:m("item.recycle"),value:"recycle"},{icon:["far","fa-gear"],text:m("item.update_base_info"),value:"setting"},{icon:["far","fa-brain"],text:m("ai.ai_knowledge_base"),value:"ai"},{icon:["far","fa-terminal"],text:m("item.open_api"),value:"openapi"},{icon:["far","fa-clock-rotate-left"],text:m("item.change_log"),value:"changelog"},{icon:["far","fa-repeat"],text:m("item.attorn"),value:"attorn"},{icon:["far","fa-box-archive"],text:m("item.archive"),value:"archive"},{icon:["far","fa-trash-can"],text:m("item.delete_item"),value:"delete"}]),g=S=>{const x=S.value;y({key:x})},n=async()=>{var S;a.pageId&&((S=a.itemInfo)!=null&&S.item_id)&&await rt({itemId:a.itemInfo.item_id,editPageId:a.pageId,copyPageId:0})&&o("editPage")},w=async()=>{var S,x;a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id,page_id:a.pageId,page_unique_key:(S=a.pageInfo)==null?void 0:S.unique_key,page_title:(x=a.pageInfo)==null?void 0:x.page_title,item_info:a.itemInfo})},k=async()=>{f.setNewMsg(0),await sa()},r=async()=>{await oa()},_=()=>{l.push("/user/login")},v=()=>{window.open("https://www.showdoc.com.cn/help","_blank")},y=async({key:S})=>{switch(S){case"import":a.itemInfo&&await ja({itemId:a.itemInfo.item_id});break;case"export":a.itemInfo&&await Wa(a.itemInfo.item_id);break;case"member":a.itemInfo&&await yt(a.itemInfo.item_id);break;case"recycle":a.itemInfo&&await Mt(a.itemInfo.item_id);break;case"setting":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"ai":a.itemInfo&&(await la(a.itemInfo.item_id),window.location.reload());break;case"openapi":a.itemInfo&&await na(a.itemInfo.item_id);break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id);break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id);break}};return(S,x)=>{var M,L,P,N,U,A,D,E,oe;const I=H("a-tooltip"),T=H("a-badge");return C(),V("div",cI,[((M=c.itemInfo)==null?void 0:M.item_edit)==1&&c.pageId?(C(),B(I,{key:0,title:S.$t("page.edit_page"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:n},[...x[0]||(x[0]=[e("i",{class:"far fa-edit"},null,-1)])])]),_:1},8,["title"])):F("",!0),((L=c.itemInfo)==null?void 0:L.item_type)==3&&((P=c.itemInfo)!=null&&P.is_login)?(C(),B(I,{key:1,title:S.$t("item.runapi_edit_hint"),placement:"bottom"},{default:u(()=>[...x[1]||(x[1]=[e("div",{class:"icon-item disabled"},[e("i",{class:"far fa-edit"})],-1)])]),_:1},8,["title"])):F("",!0),s(I,{title:S.$t("item.share"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:w},[...x[2]||(x[2]=[e("i",{class:"far fa-share-nodes"},null,-1)])])]),_:1},8,["title"]),(N=c.itemInfo)!=null&&N.is_login?(C(),B(I,{key:2,title:S.$t("message.my_notice"),placement:"bottom"},{default:u(()=>[s(T,{count:h.value?"New":0,offset:[-5,5]},{default:u(()=>[e("div",{class:"icon-item",onClick:k},[...x[3]||(x[3]=[e("i",{class:"far fa-message"},null,-1)])])]),_:1},8,["count"])]),_:1},8,["title"])):F("",!0),(U=c.itemInfo)!=null&&U.is_login?(C(),B(I,{key:3,title:S.$t("user.user_center"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:r},[...x[4]||(x[4]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])):F("",!0),(A=c.itemInfo)!=null&&A.is_login?F("",!0):(C(),B(I,{key:4,title:S.$t("user.login"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:_},[...x[5]||(x[5]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])),(D=c.itemInfo)!=null&&D.is_login?F("",!0):(C(),B(I,{key:5,title:S.$t("item.aboutShowdoc"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:v},[...x[6]||(x[6]=[e("i",{class:"far fa-circle-info"},null,-1)])])]),_:1},8,["title"])),(E=c.itemInfo)!=null&&E.is_login?F("",!0):(C(),B(I,{key:6,title:S.$t("header.switch_language"),placement:"bottom"},{default:u(()=>[e("div",dI,[s(ht)])]),_:1},8,["title"])),s(I,{title:z(f).theme==="light"?S.$t("common.dark_mode"):S.$t("common.light_mode"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:p},[...x[7]||(x[7]=[e("i",{class:"far fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),(oe=c.itemInfo)!=null&&oe.item_manage?(C(),B(ut,{key:7,list:$.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:g},{default:u(()=>[...x[8]||(x[8]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const mI=Y(uI,[["__scopeId","data-v-675c91ff"]]),_I={class:"header-wrap"},pI={class:"logo"},fI={class:"logo-content"},vI={class:"font-bold"},hI={class:"cat-btn"},gI=J({__name:"MobileHeader",props:da({itemInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}},getPageContent:{type:Function,default:()=>{}},hideHeader:{type:Boolean,default:!1},isFullPage:{type:Boolean,default:!1}},{drawerVisible:{type:Boolean,default:!1},drawerVisibleModifiers:{}}),emits:da(["exitFullscreen"],["update:drawerVisible"]),setup(c,{emit:t}){const a=no(c,"drawerVisible"),o=()=>{a.value=!0};return(l,m)=>{var f;return C(),V("div",{class:re(["mobile-header",{"hide-element":c.hideHeader}])},[e("div",_I,[e("div",pI,[e("div",fI,[m[1]||(m[1]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",vI,i(((f=c.itemInfo)==null?void 0:f.item_name)||""),1)])]),c.isFullPage?(C(),V("div",{key:1,class:"exit-fullscreen-btn",onClick:m[0]||(m[0]=d=>l.$emit("exit-fullscreen"))},[m[3]||(m[3]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(l.$t("common.exit_fullscreen")),1)])):(C(),V("div",{key:0,class:"cat-btn-div",onClick:o},[e("div",hI,[m[2]||(m[2]=e("i",{class:"fas fa-folder-tree"},null,-1)),O(" "+i(l.$t("item.catalog")),1)])]))])],2)}}});const yI=Y(gI,[["__scopeId","data-v-2e86218e"]]),wI=J({__name:"index",props:{catId:{default:0},itemId:{default:0}},emits:["close"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),m=b(!0),f=b(!1),d=b(!1),p=b(a.itemId),h=b(0),$=b([]),g=b([{cat_id:0,cat_name:"/"}]),n=q(()=>[{label:l("catalog.copy_to"),value:!1},{label:l("catalog.move_to"),value:!0}]),w=q(()=>$.value.map(x=>({label:x.item_name,value:x.item_id}))),k=q(()=>g.value.map(x=>({label:x.cat_name,value:x.cat_id}))),r=async()=>{try{const x=await X("/api/item/myList",{},"post");x.error_code===0&&($.value=x.data||[],p.value=a.itemId)}catch(x){console.error("获取项目列表失败:",x)}},_=async x=>{try{const I=await X("/api/catalog/catListName",{item_id:x},"post");if(I.error_code===0){h.value=0;const T=(I.data||[]).map(M=>({...M,cat_id:Number(M.cat_id||0)}));g.value=[{cat_id:0,cat_name:"/"},...T]}}catch(I){console.error("获取目录列表失败:",I)}},v=x=>{_(x)},y=async()=>{if(h.value===a.catId){await G("不能将目录移动/克隆到自身");return}f.value=!0;try{const x=await X("/api/catalog/copy",{cat_id:a.catId,new_p_cat_id:h.value,to_item_id:p.value,is_del:d.value?1:0},"post");x.error_code===0?(ie.success(l("common.op_success")),S()):await G(x.error_message||l("common.op_failed"))}catch(x){console.error("复制/移动目录失败:",x),await G(l("common.op_failed"))}finally{f.value=!1}},S=()=>{o("close")};return ae(()=>{r(),_(a.itemId)}),(x,I)=>{const T=H("a-form-item"),M=H("a-form"),L=H("a-spin");return C(),B(de,{show:m.value,title:z(l)("catalog.clone_move"),width:"600px",onClose:S},{footer:u(()=>[s(K,{theme:"light",text:z(l)("common.cancel"),disabled:f.value,style:{"margin-right":"12px"},onClick:S},null,8,["text","disabled"]),s(K,{theme:"dark",text:z(l)("common.confirm"),disabled:f.value,onClick:y},null,8,["text","disabled"])]),default:u(()=>[s(L,{spinning:f.value},{default:u(()=>[s(M,{layout:"vertical"},{default:u(()=>[s(T,{label:z(l)("catalog.copy_or_move")},{default:u(()=>[s(Re,{value:d.value,"onUpdate:value":I[0]||(I[0]=P=>d.value=P),options:n.value,onChange:v},null,8,["value","options"])]),_:1},8,["label"]),s(T,{label:z(l)("catalog.target_project")},{default:u(()=>[s(Re,{value:p.value,"onUpdate:value":I[1]||(I[1]=P=>p.value=P),options:w.value,"show-search":!0,onChange:v},null,8,["value","options"])]),_:1},8,["label"]),s(T,{label:z(l)("catalog.target_catalog")},{default:u(()=>[s(Re,{value:h.value,"onUpdate:value":I[2]||(I[2]=P=>h.value=P),options:k.value},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1},8,["spinning"])]),_:1},8,["show","title"])}}});const bI=Y(wI,[["__scopeId","data-v-b280b63c"]]);function $I(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(bI,{...c,onClose:()=>{t(!0),me(a,o)}});a.mount(o)})}const kI={class:"catalog-tree"},CI=["data-selected","id","onClick"],xI={class:"node-icon"},II={key:0,class:"far fa-folder-open"},SI={key:1,class:"far fa-folder-closed"},TI={key:1,class:"far fa-file-lines"},MI=["title"],LI=["onClick"],VI=J({__name:"CatalogTree",props:{itemInfo:{default:()=>({})},keyword:{default:""},getPageContent:{type:Function,default:()=>{}},searchItem:{type:Function,default:()=>{}}},emits:["reloadItem"],setup(c,{expose:t,emit:a}){const o=c,l=a,m=xe(),f=Ge(),{t:d}=te(),p=b(""),h=b([]),$=b([]),g=b([]),n=b({show:!1,x:0,y:0,node:null}),w=b(null),k=q(()=>{var Q;return((Q=o.itemInfo)==null?void 0:Q.item_edit)==1}),r=q(()=>{const Q=n.value.node;return Q?Q.type==="folder"?[{icon:["far","fa-plus"],text:d("page.new_page"),onclick:()=>U(Q)},{icon:["far","fa-folder-tree"],text:d("catalog.add_sub_cat"),onclick:()=>A(Q)},{icon:["far","fa-folder-plus"],text:d("catalog.add_sibling_cat"),onclick:()=>D(Q)},{icon:["far","fa-edit"],text:d("catalog.edit_cat"),onclick:()=>oe(Q)},{icon:["far","fa-clone"],text:d("catalog.clone_move"),onclick:()=>fe(Q)},{icon:["far","fa-trash-can"],text:d("common.delete"),onclick:()=>ee(Q)}]:[{icon:["far","fa-edit"],text:d("page.edit_page"),onclick:()=>ce(Q)},{icon:["far","fa-copy"],text:d("page.copy_page"),onclick:()=>ye(Q)},{icon:["far","fa-circle-info"],text:d("page.page_info"),onclick:()=>ze(Q)},{icon:["far","fa-clock-rotate-left"],text:d("page.history_version"),onclick:()=>Ve(Q)},{icon:["far","fa-trash-can"],text:d("page.delete_page"),onclick:()=>De(Q)}]:[]}),_=()=>{var se;if(!((se=o.itemInfo)!=null&&se.menu))return;g.value=is(o.itemInfo.menu);const Q=o.itemInfo.default_page_id||0;if(Q){const be=ma(g.value,Q);be&&($.value=be,h.value=[`page_${Q}`],ct(()=>{setTimeout(()=>{const Te=document.querySelector(`[data-node-key="page_${Q}"]`);Te&&Te.scrollIntoView({block:"center",behavior:"smooth"}),o.getPageContent(Q)},500)}))}},v=Q=>{$.value=Q},y=(Q,se,be,Te)=>{const we=x(g.value);if(w.value=we.find(le=>le.key===se),be==="folder"){const le=[...$.value],_e=le.indexOf(se);_e>-1?le.splice(_e,1):le.push(se),$.value=le}else{const le=w.value;if(le&&le.page_id){h.value=[se],o.getPageContent(le.page_id);const ke=`/${o.itemInfo.item_domain||o.itemInfo.item_id}/${le.page_id}`;f.path!==ke&&m.replace(ke)}}},S=(Q,se,be)=>{if(!k.value)return;let Te,we,le=null;if(Q&&Q.type==="click"){const _e=x(g.value);if(se?le=_e.find(Ie=>Ie.key===se):le=w.value,!le)return;const he=Q.currentTarget.getBoundingClientRect();Te=he.left,we=he.bottom+5}else Q&&(Q.type==="contextmenu"||Q.type==="mousedown")?(le=w.value,Te=Q.clientX,we=Q.clientY):(le=w.value,Te=n.value.x||0,we=n.value.y||0);le&&(n.value={show:!0,x:Te,y:we,node:le})},x=Q=>{const se=[],be=Te=>{Te.forEach(we=>{se.push(we),we.children&&we.children.length>0&&be(we.children)})};return be(Q),se},I=({event:Q,node:se})=>{k.value&&(Q.preventDefault(),Q.stopPropagation(),w.value=se,S(Q))},T=()=>{n.value.show=!1,n.value.node=null},M=async Q=>{if(p.value)return;const{dragNode:se,node:be,dropPosition:Te,dropToGap:we}=Q;if(!we&&be.type!=="folder")return;const le=(he,Ie,Me)=>{for(let Oe=0;Oe<he.length;Oe++){if(he[Oe].key===Ie)return Me(he[Oe],Oe,he);he[Oe].children&&le(he[Oe].children,Ie,Me)}},_e=[...g.value];let ke;if(le(_e,se.key,(he,Ie,Me)=>{Me.splice(Ie,1),ke=he}),!!ke){if(!we)le(_e,be.key,he=>{he.children=he.children||[],he.children.push(ke)});else if((be.children||[]).length>0&&be.expanded&&Te===1)le(_e,be.key,he=>{he.children=he.children||[],he.children.unshift(ke)});else{let he,Ie;le(_e,be.key,(Me,Oe,mt)=>{he=mt,Ie=Oe}),Ie!==void 0&&he&&(Te===-1?he.splice(Ie,0,ke):he.splice(Ie+1,0,ke))}g.value=_e,await L(_e)}},L=async Q=>{const se=[],be=(we,le,_e,ke)=>{const he=we.type==="folder"&&we.cat_id||0;se.push({cat_id:he,cat_name:we.title||"",page_id:we.page_id||0,parent_cat_id:le||0,page_cat_id:le||0,level:_e,s_number:ke+1}),we.children&&we.children.forEach((Ie,Me)=>{be(Ie,he,_e+1,Me)})};Q.forEach((we,le)=>{be(we,0,2,le)});const Te=await X("/api/catalog/batUpdate",{item_id:o.itemInfo.item_id,cats:JSON.stringify(se)},"post");Te.error_code!==0&&await G(Te.error_message||d("common.op_failed"))},P=()=>{o.searchItem(p.value)},N=()=>{p.value="",o.searchItem("")},U=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:0,copyPageId:0,catId:Q.cat_id})&&l("reloadItem")}catch(se){console.error("添加子页面失败:",se)}},A=async Q=>{const se=await it(d("catalog.add_sub_cat"),"",d("catalog.cat_name"));!se||!se.trim()||await E(Q.cat_id,se.trim())},D=async Q=>{const se=await it(d("catalog.add_sibling_cat"),"",d("catalog.cat_name"));!se||!se.trim()||await E(Q.parent_cat_id,se.trim())},E=async(Q,se)=>{try{const be=await X("/api/catalog/save",{item_id:o.itemInfo.item_id,cat_id:0,parent_cat_id:Q,cat_name:se},"post",!1);be.error_code===0?(ie.success(d("common.save_success")),l("reloadItem")):await G(be.error_message||d("common.op_failed"))}catch(be){console.error("创建目录失败:",be),await G(d("common.op_failed"))}},oe=async Q=>{const se=await it(d("catalog.edit_cat"),Q.title,d("catalog.cat_name"));se===null||se===Q.title||!se.trim()||await ge(Q.cat_id,Q.parent_cat_id,se.trim())},ge=async(Q,se,be)=>{try{const Te=await X("/api/catalog/save",{item_id:o.itemInfo.item_id,cat_id:Q,parent_cat_id:se,cat_name:be},"post",!1);Te.error_code===0?(ie.success(d("common.save_success")),l("reloadItem")):await G(Te.error_message||d("common.op_failed"))}catch(Te){console.error("编辑目录失败:",Te),await G(d("common.op_failed"))}},fe=async Q=>{await $I({catId:Q.cat_id,itemId:o.itemInfo.item_id})&&l("reloadItem")},ee=async Q=>{await Se({msg:d("catalog.confirm_cat_delete"),title:d("common.tips")})&&await W(Q.cat_id)},W=async Q=>{try{const se=await X("/api/catalog/delete",{item_id:o.itemInfo.item_id,cat_id:Q},"post",!1);se.error_code===0?(ie.success(d("common.op_success")),l("reloadItem")):await G(se.error_message||d("common.op_failed"))}catch(se){console.error("删除目录失败:",se),await G(d("common.op_failed"))}},ce=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:Q.page_id,copyPageId:0,catId:Q.page_cat_id})&&l("reloadItem")}catch(se){console.error("编辑页面失败:",se)}},ye=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:0,copyPageId:Q.page_id})&&l("reloadItem")}catch(se){console.error("复制页面失败:",se)}},ze=async Q=>{try{const se=await X("/api/page/info",{page_id:Q.page_id},"post",!1);if(se.error_code===0&&se.data){const be=`本页面由 ${se.data.author_username} 于 ${se.data.addtime} 更新`;await G(be,{dangerouslyUseHTMLString:!0})}}catch(se){console.error("获取页面信息失败:",se)}},Ve=async Q=>{try{await Lt({pageId:Q.page_id})}catch(se){console.error("打开历史版本失败:",se)}},De=async Q=>{await Se({msg:d("common.confirm_delete"),title:d("common.tips")})&&await Ze(Q.page_id)},Ze=async Q=>{try{const se=await X("/api/page/delete",{page_id:Q},"post",!1);se.error_code===0?(ie.success(d("common.op_success")),l("reloadItem")):await G(se.error_message||d("common.op_failed"))}catch(se){console.error("删除页面失败:",se),await G(d("common.op_failed"))}};t({expandAll:()=>{$.value=rs(g.value)},collapseAll:()=>{$.value=[]},scrollToPage:Q=>{if(!Q||!g.value.length)return;const se=`page_${Q}`,be=ma(g.value,Q);be&&($.value=be),h.value=[se],ct(()=>{setTimeout(()=>{const Te=document.querySelector(`#node-${se}`);Te&&Te.scrollIntoView({block:"center",behavior:"smooth"})},500)})}}),qe(()=>o.itemInfo,Q=>{Q&&Q.menu&&_()},{immediate:!0,deep:!0}),qe(()=>o.keyword,Q=>{Q!==void 0&&(p.value=Q)});let Ue=null;return qe(p,Q=>{Ue&&clearTimeout(Ue),Ue=setTimeout(()=>{o.searchItem&&o.searchItem(Q)},500)}),qe(h,Q=>{ct(()=>{document.querySelectorAll(".ant-tree-node-content-wrapper").forEach(be=>{be.classList.remove("node-content-wrapper-selected")}),Q.length>0&&document.querySelectorAll(".ant-tree-treenode").forEach(Te=>{const we=Te.querySelector(".tree-node-content");if(we&&we.getAttribute("data-selected")==="true"){const le=Te.querySelector(".ant-tree-node-content-wrapper");le&&le.classList.add("node-content-wrapper-selected")}})})}),ae(()=>{_()}),(Q,se)=>{const be=H("a-input"),Te=H("a-tree");return C(),V("div",kI,[s(be,{value:p.value,"onUpdate:value":se[0]||(se[0]=we=>p.value=we),placeholder:Q.$t("common.input_keyword"),"allow-clear":"",size:"large",onPressEnter:P,onClear:N,class:"search-input"},{prefix:u(()=>[...se[1]||(se[1]=[e("i",{class:"far fa-search"},null,-1)])]),_:1},8,["value","placeholder"]),g.value.length>0?(C(),B(Te,{key:0,ref:"treeRef",selectedKeys:h.value,expandedKeys:$.value,"tree-data":g.value,draggable:k.value,selectable:!1,"block-node":!0,onExpand:v,onRightClick:I,onDrop:M,class:"tree-container"},{switcherIcon:u(({switcherCls:we})=>[e("div",{class:re(we)},[...se[2]||(se[2]=[e("i",{class:"far fa-angle-down"},null,-1)])],2)]),title:u(({key:we,title:le,type:_e,children:ke})=>[e("div",{class:re(["tree-node-content",{"node-selected":h.value.includes(we)}]),"data-selected":h.value.includes(we),id:`node-${we}`,onClick:he=>y(he,we,_e,ke)},[e("span",xI,[_e==="folder"?(C(),V(Ce,{key:0},[$.value.includes(we)&&(ke!=null&&ke.length)?(C(),V("i",II)):(C(),V("i",SI))],64)):(C(),V("i",TI))]),e("span",{class:re(["node-title",`node-${_e}`]),title:le},i(le),11,MI),k.value?(C(),V("div",{key:0,class:"node-more",onClick:lt(he=>S(he,we,_e),["stop"])},[...se[3]||(se[3]=[e("i",{class:"far fa-ellipsis"},null,-1)])],8,LI)):F("",!0)],10,CI)]),_:1},8,["selectedKeys","expandedKeys","tree-data","draggable"])):F("",!0),n.value.show?(C(),B(z(gs),{key:1,x:n.value.x,y:n.value.y,list:r.value,onClose:T},null,8,["x","y","list"])):F("",!0)])}}});const va=Y(VI,[["__scopeId","data-v-df137f69"]]),zI={class:"interface-list-modal"},UI={class:"search-box"},PI=["onClick"],AI={class:"cat-path"},DI=J({__name:"index",props:{itemId:{},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=xe(),l=b(!0),m=b(!1),f=b([]),d=b(""),p=b({current:1,pageSize:8,total:0}),h=q(()=>[{title:a("item.page_title"),key:"page_title",width:300},{title:a("page.catalog_path"),key:"cat_path",width:250},{title:a("page.update_time"),key:"addtime",width:170},{title:a("item.operation"),key:"actions",width:100}]),$=q(()=>{if(!d.value)return f.value;const v=d.value.toLowerCase();return f.value.filter(y=>{var S,x;return((S=y.page_title)==null?void 0:S.toLowerCase().includes(v))||((x=y.cat_path)==null?void 0:x.toLowerCase().includes(v))})}),g=v=>{if(v===0||!v)return"";const S=Date.now()/1e3-v;if(S<3600){const U=Math.floor(S/60);return U<=1?a("time.just_now"):a("time.minutes_ago",{n:U})}if(S<86400){const U=Math.floor(S/3600);return a("time.hours_ago",{n:U})}if(S<604800){const U=Math.floor(S/86400);return a("time.days_ago",{n:U})}const x=new Date(v*1e3),I=x.getFullYear(),T=String(x.getMonth()+1).padStart(2,"0"),M=String(x.getDate()).padStart(2,"0"),L=String(x.getHours()).padStart(2,"0"),P=String(x.getMinutes()).padStart(2,"0"),N=new Date().getFullYear();return I===N?`${T}-${M} ${L}:${P}`:`${I}-${T}-${M} ${L}:${P}`},n=async()=>{m.value=!0;try{const v=await X("/api/item/info",{item_id:t.itemId},"post",!1);if(v.error_code===0&&v.data){const y=[],S=v.data.menu||{};S.pages&&Array.isArray(S.pages)&&S.pages.forEach(I=>{y.push({...I,cat_path:a("page.root_catalog")})});const x=(I,T="")=>{I.forEach(M=>{const L=T?`${T} / ${M.cat_name}`:M.cat_name;M.pages&&Array.isArray(M.pages)&&M.pages.forEach(P=>{y.push({...P,cat_path:L})}),M.catalogs&&Array.isArray(M.catalogs)&&x(M.catalogs,L)})};S.catalogs&&Array.isArray(S.catalogs)&&x(S.catalogs),f.value=y,p.value.total=y.length}}catch(v){console.error("获取接口列表失败:",v)}finally{m.value=!1}},w=()=>{p.value.current=1},k=v=>{p.value.current=v},r=v=>{_();const y=o.resolve({name:"ItemShowPage",params:{item_id:String(t.itemId),page_id:String(v.page_id)}});window.location.assign(y.href),setTimeout(()=>{window.location.reload()},100)},_=()=>{l.value=!1,setTimeout(()=>{t.onClose()},300)};return ae(()=>{n()}),(v,y)=>{const S=H("a-input"),x=H("a-button");return C(),B(de,{show:l.value,title:v.$t("page.interface_list_view"),onClose:_,width:"900px"},{default:u(()=>[e("div",zI,[e("div",UI,[s(S,{value:d.value,"onUpdate:value":y[0]||(y[0]=I=>d.value=I),placeholder:v.$t("page.search_interface"),allowClear:"",onInput:w},{prefix:u(()=>[...y[1]||(y[1]=[e("i",{class:"far fa-search"},null,-1)])]),_:1},8,["value","placeholder"])]),s(Le,{tableHeader:h.value,tableData:$.value,loading:m.value,pagination:p.value,dataSource:"client",onPageChange:k,rowKey:"page_id"},{"cell-page_title":u(({row:I})=>[e("a",{class:"page-title-link",onClick:T=>r(I)},i(I.page_title),9,PI)]),"cell-cat_path":u(({row:I})=>[e("span",AI,i(I.cat_path||"-"),1)]),"cell-addtime":u(({row:I})=>[e("span",null,i(g(I.addtime)),1)]),"cell-actions":u(({row:I})=>[s(x,{type:"link",size:"small",onClick:T=>r(I)},{default:u(()=>[O(i(v.$t("page.view")),1)]),_:1},8,["onClick"])]),_:1},8,["tableHeader","tableData","loading","pagination"])])]),_:1},8,["show","title"])}}});const OI=Y(DI,[["__scopeId","data-v-ee00c707"]]);function NI(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(OI,{itemId:c.itemId,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(!1)}});a.mount(o)})}const FI={key:0,class:"catalog-actions"},qI={class:"action-item more-action-wrapper"},RI=J({__name:"CatalogActions",props:{itemId:{default:0},pageId:{default:0},pageInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}},expandAll:{type:Function,default:()=>{}},collapseAll:{type:Function,default:()=>{}}},emits:["reloadItem"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),m=q(()=>{const n=[{icon:["far","fa-recycle"],text:l("item.recycle"),value:"recycle"}];return a.pageId&&n.push({icon:["far","fa-clock-rotate-left"],text:l("page.page_history_version"),value:"history"},{icon:["far","fa-circle-info"],text:l("page.page_info"),value:"info"}),n.push({icon:["far","fa-list"],text:l("page.interface_list_view"),value:"interface-list"},{icon:["far","fa-folder-open"],text:l("catalog.expand_all"),value:"expand-all"},{icon:["far","fa-folder-closed"],text:l("catalog.collapse_all"),value:"collapse-all"}),n}),f=async()=>{if(!a.itemId){ie.info(l("common.please_select_item"));return}try{await rt({itemId:a.itemId,editPageId:0,copyPageId:0})&&o("reloadItem")}catch(n){console.error("打开页面编辑器失败:",n)}},d=async()=>{if(!a.pageId){ie.info(l("common.please_select_page"));return}try{await rt({itemId:a.itemId||0,editPageId:0,copyPageId:a.pageId})&&o("reloadItem")}catch(n){console.error("复制页面失败:",n)}},p=async()=>{const n=await it(l("catalog.add_cat"),"",l("catalog.cat_name"));!n||!n.trim()||$(n.trim(),0)},h=async n=>{switch(n.value){case"recycle":a.itemId&&await Mt(a.itemId);break;case"history":a.pageId&&await Lt({pageId:a.pageId,allowRecover:!1,allowEdit:!1});break;case"info":g();break;case"interface-list":a.itemId&&await NI({itemId:a.itemId});break;case"expand-all":a.expandAll();break;case"collapse-all":a.collapseAll();break}},$=async(n,w)=>{try{const k=await X("/api/catalog/save",{item_id:a.itemId,cat_id:0,parent_cat_id:w,cat_name:n},"post",!1);k.error_code===0?(ie.success(l("common.save_success")),o("reloadItem")):await G(k.error_message||l("common.save_failed"))}catch(k){console.error("创建目录失败:",k),await G(l("common.save_failed"))}},g=async()=>{if(!a.pageInfo)return;const n=`本页面由 ${a.pageInfo.author_username} 于 ${a.pageInfo.addtime} 更新`;await G(n,{dangerouslyUseHTMLString:!0})};return(n,w)=>{const k=H("a-tooltip");return c.itemId?(C(),V("div",FI,[s(k,{title:n.$t("page.new_page"),placement:"top"},{default:u(()=>[e("div",{class:"action-item",onClick:f},[...w[0]||(w[0]=[e("i",{class:"far fa-plus"},null,-1)])])]),_:1},8,["title"]),s(k,{title:n.$t("page.copy_page"),placement:"top"},{default:u(()=>[e("div",{class:"action-item",onClick:d},[...w[1]||(w[1]=[e("i",{class:"far fa-clone"},null,-1)])])]),_:1},8,["title"]),s(k,{title:n.$t("catalog.add_cat"),placement:"top"},{default:u(()=>[e("div",{class:"action-item",onClick:p},[...w[2]||(w[2]=[e("i",{class:"far fa-folder-plus"},null,-1)])])]),_:1},8,["title"]),e("div",qI,[s(ut,{list:m.value,trigger:"hover",placement:"top",onSelect:h},{default:u(()=>[...w[3]||(w[3]=[e("div",{class:"more-trigger"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])])])):F("",!0)}}});const ha=Y(RI,[["__scopeId","data-v-8822c890"]]),HI={key:0,class:"page-comments"},EI={class:"comments-header"},jI={class:"comments-title"},BI={key:0,class:"comments-count"},GI={key:0,class:"comments-list"},KI=["id"],WI={class:"comment-main"},JI={class:"comment-header"},YI={class:"username"},XI={class:"time"},QI=["textContent"],ZI={class:"comment-actions"},e4={key:0,class:"comment-replies"},t4={class:"reply-header"},a4={class:"username"},o4={class:"time"},s4=["textContent"],l4={key:1,class:"reply-form"},n4={class:"reply-form-actions"},i4={key:1,class:"comments-empty"},r4={key:2,class:"comments-pagination"},c4={key:3,class:"comment-form"},d4={class:"comment-form-actions"},u4={key:4,class:"comment-login-tip"},Ft=20,m4=J({__name:"PageComment",props:{pageId:{default:0},itemInfo:{default:()=>({})}},setup(c){const t=c,a=xe(),{t:o}=te(),l=Qe(),m=b([]),f=b(0),d=b(1),p=b(!1),h=b(!1),$=b(""),g=b(0),n=b(""),w=b(""),k=b(!1),r=b(!1);let _=null;const v=()=>{k.value=l.isLoggedIn},y=async()=>{if(t.pageId){p.value=!0;try{const U=await cs({page_id:t.pageId,page:d.value,count:Ft});U.error_code===0&&U.data&&(m.value=U.data.comments||[],f.value=U.data.total||0)}catch(U){console.error("加载评论失败:",U)}finally{p.value=!1}}},S=async()=>{if(!$.value.trim()){ie.warning(o("pageComment.placeholder"));return}h.value=!0;try{(await _a({page_id:t.pageId,content:$.value.trim(),parent_id:0})).error_code===0&&($.value="",ie.success(o("pageComment.success")),d.value=1,await y(),setTimeout(()=>{const A=document.querySelector(".page-comments");A&&A.scrollIntoView({behavior:"smooth",block:"start"})},0))}catch(U){console.error("发表评论失败:",U)}finally{h.value=!1}},x=(U,A)=>{g.value=U,n.value=A,w.value=""},I=()=>{g.value=0,n.value="",w.value=""},T=async U=>{if(!w.value.trim()){ie.warning(o("pageComment.replyPlaceholder"));return}h.value=!0;try{(await _a({page_id:t.pageId,content:w.value.trim(),parent_id:U})).error_code===0&&(I(),ie.success(o("pageComment.replySuccess")),await y())}catch(A){console.error("发表回复失败:",A)}finally{h.value=!1}},M=async U=>{try{await Se({title:o("tips"),content:o("pageComment.deleteConfirm"),confirmText:o("common.confirm"),cancelText:o("common.cancel")})&&(await ds(U)).error_code===0&&(ie.success(o("pageComment.delete")+o("common.success")),await y())}catch(A){A!=="cancel"&&console.error("删除评论失败:",A)}},L=U=>{d.value=U,y(),setTimeout(()=>{const A=document.querySelector(".page-comments");A&&A.scrollIntoView({behavior:"smooth",block:"start"})},0)},P=()=>{const U=a.currentRoute.value.fullPath;a.push({path:"/user/login",query:{redirect:U}})},N=()=>{_&&(clearTimeout(_),_=null),t.pageId&&t.itemInfo&&(t.itemInfo.allow_comment==1||t.itemInfo.allow_comment===!0)?(r.value=!0,_=window.setTimeout(()=>{y()},1e3)):r.value=!1};return qe(()=>t.pageId,N,{immediate:!0}),qe(()=>t.itemInfo,N,{deep:!0,immediate:!0}),ae(()=>{v()}),Xe(()=>{_&&(clearTimeout(_),_=null)}),(U,A)=>{const D=H("a-pagination");return r.value?(C(),V("div",HI,[e("div",EI,[e("span",jI,i(U.$t("pageComment.title")),1),f.value>0?(C(),V("span",BI,i(U.$t("pageComment.total",{count:f.value})),1)):F("",!0)]),m.value.length>0?(C(),V("div",GI,[(C(!0),V(Ce,null,Pe(m.value,E=>(C(),V("div",{class:"comment-item",key:E.comment_id,id:"comment-"+E.comment_id},[e("div",WI,[e("div",JI,[e("span",YI,"👤 "+i(E.username),1),e("span",XI,i(E.addtime_text),1)]),e("div",{class:"comment-content",textContent:i(E.content)},null,8,QI),e("div",ZI,[k.value?(C(),B(K,{key:0,type:"text",size:"small",onClick:oe=>x(E.comment_id,E.username)},{default:u(()=>[O(i(U.$t("pageComment.reply")),1)]),_:1},8,["onClick"])):F("",!0),E.can_delete?(C(),B(K,{key:1,type:"text",size:"small",onClick:oe=>M(E.comment_id)},{default:u(()=>[O(i(U.$t("pageComment.delete")),1)]),_:1},8,["onClick"])):F("",!0)])]),E.replies&&E.replies.length>0?(C(),V("div",e4,[(C(!0),V(Ce,null,Pe(E.replies,oe=>(C(),V("div",{class:"reply-item",key:oe.comment_id},[e("div",t4,[e("span",a4,"↪ "+i(oe.username),1),e("span",o4,i(oe.addtime_text),1),oe.can_delete?(C(),B(K,{key:0,type:"text",size:"small",onClick:ge=>M(oe.comment_id)},{default:u(()=>[O(i(U.$t("pageComment.delete")),1)]),_:1},8,["onClick"])):F("",!0)]),e("div",{class:"reply-content",textContent:i(oe.content)},null,8,s4)]))),128))])):F("",!0),g.value===E.comment_id?(C(),V("div",l4,[s(tt,{modelValue:w.value,"onUpdate:modelValue":A[0]||(A[0]=oe=>w.value=oe),rows:2,maxlength:500,placeholder:U.$t("pageComment.replyPlaceholder",{username:"@"+n.value})},null,8,["modelValue","placeholder"]),e("div",n4,[s(K,{size:"small",onClick:I},{default:u(()=>[O(i(U.$t("pageComment.cancel")),1)]),_:1}),s(K,{type:"primary",size:"small",loading:h.value,onClick:oe=>T(E.comment_id)},{default:u(()=>[O(i(U.$t("pageComment.submitReply")),1)]),_:1},8,["loading","onClick"])])])):F("",!0)],8,KI))),128))])):p.value?F("",!0):(C(),V("div",i4,i(U.$t("pageComment.empty")),1)),f.value>Ft?(C(),V("div",r4,[s(D,{current:d.value,"page-size":Ft,total:f.value,onChange:L,small:""},null,8,["current","total"])])):F("",!0),k.value?(C(),V("div",c4,[s(tt,{modelValue:$.value,"onUpdate:modelValue":A[1]||(A[1]=E=>$.value=E),rows:3,maxlength:500,placeholder:U.$t("pageComment.placeholder")},null,8,["modelValue","placeholder"]),e("div",d4,[s(K,{type:"primary",size:"small",loading:h.value,onClick:S},{default:u(()=>[O(i(U.$t("pageComment.submit")),1)]),_:1},8,["loading"])])])):(C(),V("div",u4,[e("span",null,i(U.$t("pageComment.loginTip")),1),s(K,{type:"text",onClick:P},{default:u(()=>[O(i(U.$t("pageComment.loginButton")),1)]),_:1})]))])):F("",!0)}}});const _4=Y(m4,[["__scopeId","data-v-bd377e6f"]]),p4={key:0,class:"page-feedback"},f4={class:"feedback-title"},v4={class:"feedback-buttons"},h4=J({__name:"PageFeedback",props:{pageId:{default:0},itemInfo:{default:()=>({})}},setup(c){const t=c;te();const a=b(0),o=b(0),l=b(0),m=b(!1),f=b(!1);let d=null;const p=async()=>{if(t.pageId)try{const g=await ms(t.pageId);g.error_code===0&&g.data&&(a.value=g.data.helpful_count||0,o.value=g.data.unhelpful_count||0,l.value=g.data.user_feedback||0)}catch(g){console.error("加载反馈统计失败:",g)}},h=async g=>{if(t.pageId){l.value===g&&(g=0),m.value=!0;try{const n=await us({page_id:t.pageId,feedback_type:g});n.error_code===0&&n.data&&(a.value=n.data.helpful_count||0,o.value=n.data.unhelpful_count||0,l.value=n.data.user_feedback||0,n.data.message&&ie.success(n.data.message))}catch(n){console.error("提交反馈失败:",n)}finally{m.value=!1}}},$=()=>{d&&(clearTimeout(d),d=null),t.pageId&&t.itemInfo&&(t.itemInfo.allow_feedback==1||t.itemInfo.allow_feedback===!0)?(f.value=!0,d=window.setTimeout(()=>{p()},1e3)):f.value=!1};return qe(()=>t.pageId,$,{immediate:!0}),qe(()=>t.itemInfo,$,{deep:!0,immediate:!0}),Xe(()=>{d&&(clearTimeout(d),d=null)}),(g,n)=>f.value?(C(),V("div",p4,[e("div",f4,i(g.$t("pageFeedback.title")),1),e("div",v4,[s(K,{type:l.value===1?"primary":"default",size:"small",loading:m.value,onClick:n[0]||(n[0]=w=>h(1))},{default:u(()=>[n[2]||(n[2]=e("i",{class:"fas fa-thumbs-up"},null,-1)),O(" "+i(g.$t("pageFeedback.helpful"))+" ("+i(a.value)+") ",1)]),_:1},8,["type","loading"]),s(K,{type:l.value===2?"primary":"default",size:"small",loading:m.value,onClick:n[1]||(n[1]=w=>h(2))},{default:u(()=>[n[3]||(n[3]=e("i",{class:"fas fa-thumbs-down"},null,-1)),O(" "+i(g.$t("pageFeedback.unhelpful"))+" ("+i(o.value)+") ",1)]),_:1},8,["type","loading"])])])):F("",!0)}});const g4=Y(h4,[["__scopeId","data-v-b7304daa"]]),y4={key:0,class:"pos"},w4={class:"drawer-content"},b4={class:"doc-container",id:"doc-container"},$4={key:0,id:"left-side"},k4={id:"content-side"},C4={id:"p-content"},x4={class:"doc-title-box"},I4={class:"doc-title"},S4={class:"doc-actions"},T4={class:"doc-body"},M4={class:"page-content-main",id:"page-content-main"},L4={key:1,class:"empty-tips"},V4={id:"feedback-area"},z4={key:0,id:"comment-area"},U4={key:1,id:"right-side"},P4=J({__name:"index",props:{itemInfo:{default:()=>({})}},emits:["reloadItem"],setup(c,{emit:t}){const a=c,o=t,l=Ge(),m=xe(),{t:f}=te(),d=_s(),p=b(),h=b(!0),$=b(!0),g=b(!1),n=b(!0),w=b("pc"),k=b(!1),r=b(!1),_=b(0),v=b(0),y=b(""),S=b(""),x=b(null),I=b(0),T=b(0),M=b(0),L=b(""),P=b(!1),N=b(!1),U=b(a.itemInfo||{}),A=b(null),D=b(0),E=b({}),oe=b(!1),ge=b(0),fe=()=>window.innerWidth<768||P.value,ee=q(()=>{var le;return((le=U.value)==null?void 0:le.item_edit)==1}),W=async()=>{var le;if((le=U.value)!=null&&le.item_id)try{const _e=await X("/api/item/getAiKnowledgeBaseConfig",{item_id:U.value.item_id});if(_e.error_code===0&&_e.data){let ke=!1;_e.data.ai_config?ke=_e.data.ai_config.enabled>0:_e.data.enabled!==void 0?ke=_e.data.enabled>0:_e.data.ai_knowledge_base_enabled!==void 0&&(ke=_e.data.ai_knowledge_base_enabled>0),oe.value=ke}else oe.value=!1}catch{oe.value=!1}},ce=(le,_e)=>{if(!_e||!le)return le;const ke=_e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),he=new RegExp(`(${ke})`,"gi");return le.replace(he,"<mark>$1</mark>")},ye=async le=>{if(le<=0)return;fe()&&k.value&&le!==ge.value&&(k.value=!1),ge.value=le;const _e=Date.now(),ke=E.value[le]||0;if(_e-ke<1e3)return;E.value[le]=_e,se();const he=!!L.value,Ie={page_id:le};he&&(Ie.with_path=1);try{const Me=await X("/api/page/info",Ie,"post",!1);if(Me.error_code===0&&Me.data){let Oe=It(Me.data.page_content||"",U.value.global_param);he&&L.value&&(Oe=ce(Oe,L.value)),S.value=Oe,d.setOpenCatId(Me.data.cat_id),y.value=Me.data.page_title,he&&(Me.data.from_search_result=!0),x.value=Me.data,I.value=Me.data.cat_id,T.value=Me.data.item_id,M.value=Me.data.attachment_count||0;const _t=`/${U.value.item_domain||U.value.item_id}/${le}`;l.path!==_t&&m.replace(_t),setTimeout(()=>{var pt;v.value=le,we(),document.title=`${y.value}--ShowDoc`,(pt=p.value)!=null&&pt.scrollToPage&&!L.value&&p.value.scrollToPage(le)},0)}}catch(Me){console.error("获取页面内容失败:",Me),await G(f("fetch_page_content_failed"))}},ze=async()=>{x.value&&await Ba({itemId:x.value.item_id,pageId:x.value.page_id,manage:!1,onClose:()=>{}})},Ve=async le=>{var _e,ke;if(L.value=le,le){const he={page_title:`${f("search_results_for")} "${le}"`,cat_id:0,is_search_result:!0};x.value=he,y.value=he.page_title;try{const Ie=(_e=U.value)==null?void 0:_e.item_id;if(Ie){const Me=await X("/api/item/info",{item_id:Ie,keyword:le},"post",!1);Me.error_code===0&&Me.data&&(U.value=Me.data,S.value="",v.value=0,W())}}catch(Ie){console.error("搜索项目失败:",Ie)}}else{v.value||(x.value=null);try{const he=(ke=U.value)==null?void 0:ke.item_id;if(he){const Ie=await ps(String(he));Ie.error_code===0&&Ie.data&&(U.value=Ie.data,Ie.data.default_page_id&&await ye(Ie.data.default_page_id))}}catch(he){console.error("加载项目失败:",he)}}},De=({index:le,checked:_e})=>{var ke;(ke=U.value)!=null&&ke.item_edit&&(S.value=Da(S.value,le,_e),Ze())},Ze=()=>{A.value&&clearTimeout(A.value),A.value=window.setTimeout(async()=>{if(v.value)try{await X("/api/page/save",{page_id:v.value,item_id:U.value.item_id,cat_id:I.value,page_title:y.value,is_urlencode:1,page_content:encodeURIComponent(S.value)},"post",!1)}catch(le){console.error("保存任务列表失败:",le)}},800)},je=()=>{p.value&&p.value.expandAll()},Ye=()=>{p.value&&p.value.collapseAll()},Ke=()=>{o("reloadItem")},Ue=()=>{$.value=!1,g.value=!0,n.value=!1,w.value="mobile"},Q=()=>{if(!fe())return;const le=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;le<100||le<_.value?r.value=!1:r.value=!0,_.value=le},se=()=>{fe()&&Ue()},be=()=>{P.value=!P.value,P.value?Ue():($.value=!0,g.value=!1,n.value=!0,w.value="pc",r.value=!1)},Te=()=>{window.location.reload()},we=()=>{const le=window.location.hash;le==="#comment-area"||le==="#feedback-area"?setTimeout(()=>{const _e=document.querySelector(le);_e&&_e.scrollIntoView({behavior:"smooth",block:"start"})},1500):document.body.scrollTop=document.documentElement.scrollTop=0};return qe(()=>a.itemInfo,le=>{le&&(U.value=le,le.menu&&le.menu.catalogs&&le.menu.catalogs.length===0&&le.menu.pages&&le.menu.pages.length===0?N.value=!0:N.value=!1,setTimeout(()=>{W()},100))},{immediate:!0}),qe(()=>S.value,(le,_e)=>{le!==_e&&le&&D.value++}),ae(()=>{se(),window.addEventListener("scroll",Q)}),ya(()=>{window.removeEventListener("scroll",Q)}),(le,_e)=>{var he;const ke=H("a-drawer");return h.value?(C(),V("div",{key:0,class:re(["show-regular-item",w.value])},[g.value?(C(),V("div",y4)):F("",!0),$.value?(C(),B(Vt,{key:1,"item-info":U.value},{right:u(()=>[s(mI,{"page-id":v.value,"item-info":U.value,"page-info":x.value,"search-item":Ve},null,8,["page-id","item-info","page-info"])]),_:1},8,["item-info"])):F("",!0),g.value?(C(),B(yI,{key:2,drawerVisible:k.value,"onUpdate:drawerVisible":_e[0]||(_e[0]=Ie=>k.value=Ie),"item-info":U.value,"search-item":Ve,"get-page-content":ye,"hide-header":r.value,"is-full-page":P.value,onExitFullscreen:Te},null,8,["drawerVisible","item-info","hide-header","is-full-page"])):F("",!0),s(ke,{visible:k.value,onClose:_e[1]||(_e[1]=Ie=>k.value=!1),placement:"right",width:"80%",closable:!0,"mask-closable":!0,title:"目录"},{default:u(()=>[e("div",w4,[s(va,{ref_key:"catalogTreeRef",ref:p,keyword:L.value,"item-info":U.value,"get-page-content":ye,"search-item":Ve,onReloadItem:Ke},null,8,["keyword","item-info"]),U.value&&ee.value?(C(),B(ha,{key:0,"item-id":U.value.item_id,"page-id":v.value,"page-info":x.value,"expand-all":je,"collapse-all":Ye,"search-item":Ve,onReloadItem:Ke},null,8,["item-id","page-id","page-info"])):F("",!0)])]),_:1},8,["visible"]),e("div",b4,[n.value?(C(),V("div",$4,[s(va,{ref_key:"catalogTreeRef",ref:p,keyword:L.value,"item-info":U.value,"get-page-content":ye,"search-item":Ve,onReloadItem:Ke},null,8,["keyword","item-info"]),U.value&&ee.value?(C(),B(ha,{key:0,"item-id":U.value.item_id,"page-id":v.value,"page-info":x.value,"expand-all":je,"collapse-all":Ye,"search-item":Ve,onReloadItem:Ke},null,8,["item-id","page-id","page-info"])):F("",!0)])):F("",!0),e("div",k4,[e("div",C4,[L.value&&x.value?(C(),B(ys,{key:0,"page-info":x.value,"item-info":U.value,keyword:L.value},null,8,["page-info","item-info","keyword"])):F("",!0),e("div",x4,[e("span",I4,i(y.value),1),e("span",S4,[M.value?(C(),V("i",{key:0,class:"far fa-paperclip attachment-icon",onClick:ze})):F("",!0),v.value&&!fe()?(C(),V("i",{key:1,class:re([P.value?"far fa-compress":"far fa-expand","full-page-icon"]),onClick:be},null,2)):F("",!0)])]),e("div",T4,[e("div",M4,[v.value?(C(),B(St,{key:`${v.value}-${P.value}`,modelValue:S.value,"onUpdate:modelValue":_e[2]||(_e[2]=Ie=>S.value=Ie),mode:"preview",onTaskToggle:De},null,8,["modelValue"])):N.value?(C(),V("div",L4,[..._e[3]||(_e[3]=[e("div",{class:"icon"},[e("i",{class:"far fa-exclamation-triangle"})],-1),e("div",{class:"text"},[e("p",null,"当前项目是空的，你可以点击左下方的 + 以手动添加页面。")],-1)])])):F("",!0)]),e("div",V4,[v.value&&U.value&&!fe()?(C(),B(g4,{key:0,"page-id":v.value,"item-info":U.value},null,8,["page-id","item-info"])):F("",!0)]),fe()?F("",!0):(C(),V("div",z4,[v.value&&U.value?(C(),B(_4,{key:0,"page-id":v.value,"item-info":U.value},null,8,["page-id","item-info"])):F("",!0)]))])])]),!fe()&&!P.value?(C(),V("div",U4,[(C(),B(aa,{key:D.value}))])):F("",!0)]),s(ta,{visibilityHeight:100}),oe.value&&((he=U.value)!=null&&he.item_id)?(C(),B(ws,{key:3,"item-id":U.value.item_id,"item-name":U.value.item_name},null,8,["item-id","item-name"])):F("",!0)],2)):F("",!0)}}});const A4=Y(P4,[["__scopeId","data-v-6738ac09"]]),D4={class:"header-right"},O4={class:"icon-item language-item"},N4=J({__name:"HeaderRight",props:{itemInfo:{default:()=>({})},pageId:{default:0},pageInfo:{default:()=>({})}},emits:["editPage","reload"],setup(c,{emit:t}){const a=c,o=t,l=xe(),{t:m}=te(),f=He(),d=()=>{f.toggleTheme()},p=q(()=>{const r=[{value:"export",icon:["far","fa-arrow-down-to-bracket"],text:m("item.export")}];return a.pageId&&r.push({value:"history",icon:["far","fa-rectangle-history"],text:m("page.page_history_version")}),r.push({value:"update",icon:["far","fa-edit"],text:m("item.updateBaseInfo")},{value:"attorn",icon:["far","fa-recycle"],text:m("item.attorn")},{value:"changelog",icon:["far","fa-clock-rotate-left"],text:m("item.change_log")},{value:"archive",icon:["far","fa-box-archive"],text:m("item.archive")},{value:"delete",icon:["far","fa-trash-can"],text:m("item.delete_item")}),r}),h=()=>{var r;a.pageId&&l.push(`/page/edit/${(r=a.itemInfo)==null?void 0:r.item_id}/${a.pageId}`),o("editPage")},$=async()=>{var r,_;a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id,page_id:a.pageId,page_unique_key:(r=a.pageInfo)==null?void 0:r.unique_key,page_title:(_=a.pageInfo)==null?void 0:_.page_title,item_info:a.itemInfo})},g=async()=>{a.itemInfo&&await yt(a.itemInfo.item_id)},n=()=>{l.push("/user/login")},w=()=>{ie.info(m("common.coming_soon"))},k=async r=>{switch(r.value){case"export":a.itemInfo&&await Wa(a.itemInfo.item_id);break;case"history":a.pageId&&await Lt({pageId:a.pageId,allowRecover:!1,allowEdit:!1});break;case"update":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id);break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id);break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id);break}};return(r,_)=>{var y,S,x,I,T,M,L;const v=H("a-tooltip");return C(),V("div",D4,[((y=c.itemInfo)==null?void 0:y.item_edit)==1?(C(),V("div",{key:0,class:"icon-item",onClick:h},[s(v,{title:r.$t("page.edit_page"),placement:"bottom"},{default:u(()=>[..._[0]||(_[0]=[e("i",{class:"far fa-edit"},null,-1)])]),_:1},8,["title"])])):F("",!0),e("div",{class:"icon-item",onClick:$},[s(v,{title:r.$t("item.share"),placement:"bottom"},{default:u(()=>[..._[1]||(_[1]=[e("i",{class:"far fa-share-nodes"},null,-1)])]),_:1},8,["title"])]),((S=c.itemInfo)==null?void 0:S.item_manage)==1?(C(),V("div",{key:1,class:"icon-item",onClick:g},[s(v,{title:r.$t("item.member_manage"),placement:"bottom"},{default:u(()=>[..._[2]||(_[2]=[e("i",{class:"fal fa-users"},null,-1)])]),_:1},8,["title"])])):F("",!0),((x=c.itemInfo)==null?void 0:x.is_login)!=1?(C(),V("div",{key:2,class:"icon-item",onClick:n},[s(v,{title:r.$t("user.login"),placement:"bottom"},{default:u(()=>[..._[3]||(_[3]=[e("i",{class:"far fa-user"},null,-1)])]),_:1},8,["title"])])):F("",!0),((I=c.itemInfo)==null?void 0:I.item_edit)==1&&((T=c.itemInfo)==null?void 0:T.item_manage)!=1?(C(),V("div",{key:3,class:"icon-item",onClick:w},[s(v,{title:r.$t("item.export"),placement:"bottom"},{default:u(()=>[..._[4]||(_[4]=[e("i",{class:"far fa-arrow-down-to-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),((M=c.itemInfo)==null?void 0:M.is_login)!=1?(C(),B(v,{key:4,title:r.$t("header.switch_language"),placement:"bottom"},{default:u(()=>[e("div",O4,[s(ht)])]),_:1},8,["title"])):F("",!0),s(v,{title:z(f).theme==="light"?r.$t("common.dark_mode"):r.$t("common.light_mode"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:d},[..._[5]||(_[5]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),((L=c.itemInfo)==null?void 0:L.item_manage)==1?(C(),B(ut,{key:5,list:p.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:k},{default:u(()=>[..._[6]||(_[6]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const F4=Y(N4,[["__scopeId","data-v-37b2ae01"]]),q4={class:"attachment-modal"},R4={key:0,class:"upload-actions"},H4={class:"file-name"},E4=J({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}}},setup(c){const t=io.PRESENTED_IMAGE_SIMPLE,a=c,o=b(!0),l=b([]),m=b(!1),f=q(()=>{var w,k,r;return[{title:((w=a.$t)==null?void 0:w.call(a,"page.add_time"))||"上传时间",key:"addtime",width:170},{title:((k=a.$t)==null?void 0:k.call(a,"page.file_name"))||"文件名",key:"display_name",ellipsis:!0},{title:((r=a.$t)==null?void 0:r.call(a,"common.operation"))||"操作",key:"action",width:150}]}),d=async()=>{if(a.pageId){m.value=!0;try{const w=await X("/api/page/uploadList",{page_id:a.pageId});l.value=w.data||[]}catch(w){console.error("加载附件列表失败:",w)}finally{m.value=!1}}},p=w=>{w.url&&window.open(w.url,"_blank")},h=async w=>{var r,_,v;if(await Se({title:((r=a.$t)==null?void 0:r.call(a,"common.confirm_delete"))||"确认删除",content:((_=a.$t)==null?void 0:_.call(a,"page.confirm_delete_attachment"))||"确定要删除这个附件吗？"}))try{await X("/api/page/deleteUploadFile",{file_id:w.file_id,page_id:a.pageId}),ie.success(((v=a.$t)==null?void 0:v.call(a,"common.delete_success"))||"删除成功"),await d()}catch(y){console.error("删除附件失败:",y)}},$=()=>{var w;ie.info(((w=a.$t)==null?void 0:w.call(a,"common.coming_soon"))||"功能开发中...")},g=()=>{var w;ie.info(((w=a.$t)==null?void 0:w.call(a,"common.coming_soon"))||"功能开发中...")},n=()=>{o.value=!1,a.onClose()};return ae(()=>{d()}),(w,k)=>{const r=H("a-button"),_=H("a-tooltip"),v=H("a-table"),y=H("a-empty");return C(),B(de,{show:o.value,title:w.$t("page.attachment"),width:"700px",onClose:n},{footer:u(()=>[s(K,{onClick:n},{default:u(()=>[O(i(w.$t("common.close")),1)]),_:1})]),default:u(()=>[e("div",q4,[c.manage?(C(),V("div",R4,[s(r,{type:"primary",onClick:$},{default:u(()=>[k[0]||(k[0]=e("i",{class:"fas fa-upload"},null,-1)),O(" "+i(w.$t("page.upload")),1)]),_:1}),s(r,{onClick:g},{default:u(()=>[k[1]||(k[1]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(w.$t("page.from_file_hub")),1)]),_:1})])):F("",!0),s(v,{"data-source":l.value,columns:f.value,pagination:!1,loading:m.value,"row-key":"file_id",size:"small"},{bodyCell:u(({column:S,record:x})=>[S.key==="addtime"?(C(),V(Ce,{key:0},[O(i(x.addtime),1)],64)):S.key==="display_name"?(C(),B(_,{key:1,title:x.display_name},{default:u(()=>[e("span",H4,i(x.display_name),1)]),_:2},1032,["title"])):S.key==="action"?(C(),V(Ce,{key:2},[s(r,{type:"link",size:"small",onClick:I=>p(x)},{default:u(()=>[O(i(w.$t("common.download")),1)]),_:1},8,["onClick"]),c.manage?(C(),B(r,{key:0,type:"link",size:"small",onClick:I=>h(x)},{default:u(()=>[O(i(w.$t("common.delete")),1)]),_:1},8,["onClick"])):F("",!0)],64)):F("",!0)]),_:1},8,["data-source","columns","loading"]),!m.value&&l.value.length===0?(C(),B(y,{key:1,description:w.$t("page.no_attachment"),image:z(t)},null,8,["description","image"])):F("",!0)])]),_:1},8,["show","title"])}}});const j4=Y(E4,[["__scopeId","data-v-845e85a3"]]);function B4(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(j4,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const G4={key:0,class:"pos"},K4={class:"header-wrap"},W4={class:"logo"},J4={class:"logo-content"},Y4={class:"font-bold"},X4={class:"page-wrapper"},Q4={class:"page-title-box"},Z4={id:"doc-title",class:"page-title"},e7={id:"page_md_content",class:"page_content_main"},t7={key:1,class:"loading"},a7={key:1,class:"attachment-icon"},o7={key:3,class:"toc-side"},s7=J({__name:"index",props:{itemInfo:{}},setup(c){const t=c,{t:a}=te(),o=b(""),l=b(0),m=b(""),f=b(0),d=b(0),p=b(null),h=b(!1),$=b(!1);let g=null;const n=q(()=>window.innerWidth<1e3||$.value),w=b(!1),k=b(0),r=()=>{if(!n.value)return;const L=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;L<100||L<k.value?w.value=!1:w.value=!0,k.value=L},_=async L=>{var N,U,A,D,E,oe,ge,fe;if(!L&&!((D=(A=(U=(N=t.itemInfo)==null?void 0:N.menu)==null?void 0:U.pages)==null?void 0:A[0])!=null&&D.page_id))return;const P=L||((fe=(ge=(oe=(E=t.itemInfo)==null?void 0:E.menu)==null?void 0:oe.pages)==null?void 0:ge[0])==null?void 0:fe.page_id);if(P)try{const ee=await X("/api/page/info",{page_id:P});o.value=It(ee.data.page_content),m.value=ee.data.page_title,f.value=ee.data.cat_id,d.value=ee.data.attachment_count||0,p.value=ee.data,l.value=0,await ct(),l.value=P,document.title=m.value+"--ShowDoc"}catch(ee){console.error("获取页面内容失败:",ee),o.value="### "+a("common.load_failed")}},v=async({index:L,checked:P})=>{var N;((N=t.itemInfo)==null?void 0:N.item_edit)==1&&(o.value=Da(o.value,L,P),g&&clearTimeout(g),g=window.setTimeout(async()=>{try{await X("/api/page/save",{page_id:l.value,item_id:t.itemInfo.item_id,cat_id:f.value,page_title:m.value,is_urlencode:1,page_content:encodeURIComponent(o.value)},"post",!1)}catch(U){console.error("保存失败:",U)}},800))},y=async()=>{var L;l.value&&((L=t.itemInfo)!=null&&L.item_id)&&await rt({itemId:t.itemInfo.item_id,editPageId:l.value,copyPageId:0})&&await _(l.value)},S=()=>{window.location.href="/item/index"},x=()=>{window.location.reload()},I=()=>{$.value=!$.value},T=()=>{n.value||M()},M=()=>{const L=document.querySelector(".toc-side"),P=document.querySelector(".toc-list");if(!L||!P)return;const N=window.innerWidth,U=(N-850)/2+850,A=U+40;console.log("屏幕宽度:",N),console.log("内容区右边缘:",U),console.log("TOC left值:",A),L.setAttribute("style",`right: auto; left: ${A}px;`)};return ae(async()=>{if(await _(),T(),!n.value){const L=P=>{setTimeout(()=>{M()},P)};L(500),L(1e3),L(1500),L(2e3)}window.addEventListener("resize",T),window.addEventListener("scroll",r)}),Xe(()=>{g&&clearTimeout(g),window.removeEventListener("resize",T)}),ya(()=>{window.removeEventListener("scroll",r)}),(L,P)=>{var U,A,D;const N=H("a-spin");return C(),V("div",{class:re(["show-single-page-item",{"mobile-view":n.value}])},[n.value?(C(),V("div",G4)):F("",!0),n.value?F("",!0):(C(),B(Vt,{key:1,"item-info":c.itemInfo},{right:u(()=>[s(F4,{"page-id":l.value,"item-info":c.itemInfo,"page-info":p.value,onEditPage:y},null,8,["page-id","item-info","page-info"])]),_:1},8,["item-info"])),n.value?(C(),V("div",{key:2,class:re(["mobile-header",{"hide-element":w.value}])},[e("div",K4,[e("div",W4,[e("div",J4,[P[3]||(P[3]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",Y4,i(((U=c.itemInfo)==null?void 0:U.item_name)||""),1)])]),$.value?(C(),V("div",{key:1,class:"exit-fullscreen-btn",onClick:x},[P[5]||(P[5]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(L.$t("common.exit_fullscreen")),1)])):(C(),V("div",{key:0,class:"back-btn",onClick:S},[P[4]||(P[4]=e("i",{class:"far fa-arrow-left"},null,-1)),O(" "+i(L.$t("common.back")),1)]))])],2)):F("",!0),e("div",{class:re(["content-container",{"mobile-content":n.value}])},[e("div",X4,[e("div",Q4,[e("h2",Z4,i(m.value),1),!n.value&&!$.value?(C(),V("i",{key:0,class:re([$.value?"far fa-compress":"far fa-expand","full-page-icon"]),onClick:I},null,2)):F("",!0)]),$.value?(C(),V("div",{key:0,class:"fullscreen-cancel-btn",onClick:I},[P[6]||(P[6]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(L.$t("common.exit_fullscreen")),1)])):F("",!0),e("div",e7,[o.value?(C(),B(St,{key:`${l.value}-${$.value}`,modelValue:o.value,"onUpdate:modelValue":P[0]||(P[0]=E=>o.value=E),mode:"preview",readonly:((A=c.itemInfo)==null?void 0:A.item_edit)!=1,onTaskToggle:v},null,8,["modelValue","readonly"])):(C(),V("div",t7,[s(N,{size:"large",tip:L.$t("common.loading")},null,8,["tip"])]))]),d.value?(C(),V("div",a7,[e("i",{class:"far fa-paperclip",onClick:P[1]||(P[1]=E=>h.value=!0)})])):F("",!0)])],2),l.value&&!n.value&&!$.value?(C(),V("div",o7,[s(aa)])):F("",!0),s(ta,{right:n.value?20:40,bottom:n.value?20:40},null,8,["right","bottom"]),h.value?(C(),B(z(B4),{key:4,"item-id":(D=p.value)==null?void 0:D.item_id,"page-id":l.value,onClose:P[2]||(P[2]=E=>h.value=!1)},null,8,["item-id","page-id"])):F("",!0)],2)}}});const l7=Y(s7,[["__scopeId","data-v-1c6178ae"]]),n7={class:"header-right float-right"},i7={class:"text-center"},r7=J({__name:"HeaderRight",props:{itemInfo:{}},emits:["save","export","import","reload"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),m=xe(),f=b(!1),d=q(()=>[{value:"update",icon:["fa-regular","fa-edit"],text:l("item.updateBaseInfo")},{value:"attorn",icon:["fa-regular","fa-recycle"],text:l("item.attornItem")},{value:"changelog",icon:["fa-regular","fa-clock-rotate-left"],text:l("item.change_log")},{value:"archive",icon:["fa-regular","fa-box-archive"],text:l("item.archiveItem")},{value:"delete",icon:["fa-regular","fa-trash-can"],text:l("item.deleteItem"),danger:!0}]),p=async()=>{a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id})},h=async()=>{a.itemInfo&&await yt(a.itemInfo.item_id)},$=()=>{m.push("/user/login")},g=()=>{window.open("https://www.showdoc.com.cn/help","_blank")},n=()=>{f.value=!0},w=_=>{const v=_.target;v.files&&v.files[0]&&(o("import",v.files[0]),f.value=!1)},k=async _=>{switch(_.value){case"update":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id)&&r();break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id)&&r();break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id)&&r();break}},r=()=>{m.push("/item/index"),setTimeout(()=>{window.location.reload()},200)};return(_,v)=>{const y=H("a-tooltip");return C(),V("div",n7,[e("div",{class:"icon-item",onClick:p},[s(y,{title:_.$t("item.share"),placement:"bottom"},{default:u(()=>[...v[3]||(v[3]=[e("i",{class:"fa-regular fa-share-nodes"},null,-1)])]),_:1},8,["title"])]),c.itemInfo.item_manage==1?(C(),V("div",{key:0,class:"icon-item",onClick:v[0]||(v[0]=S=>_.$emit("save"))},[s(y,{title:_.$t("common.save"),placement:"bottom"},{default:u(()=>[...v[4]||(v[4]=[e("i",{class:"fa-regular fa-save"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_edit==1?(C(),V("div",{key:1,class:"icon-item",onClick:v[1]||(v[1]=S=>_.$emit("export"))},[s(y,{title:_.$t("item.export"),placement:"bottom"},{default:u(()=>[...v[5]||(v[5]=[e("i",{class:"fa-regular fa-arrow-down-to-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),V("div",{key:2,class:"icon-item",onClick:n},[s(y,{title:_.$t("item.import"),placement:"bottom"},{default:u(()=>[...v[6]||(v[6]=[e("i",{class:"fa-regular fa-arrow-up-from-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),V("div",{key:3,class:"icon-item",onClick:h},[s(y,{title:_.$t("item.memberManage"),placement:"bottom"},{default:u(()=>[...v[7]||(v[7]=[e("i",{class:"fa-regular fa-users"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.is_login!=1?(C(),V("div",{key:4,class:"icon-item",onClick:$},[s(y,{title:_.$t("user.login"),placement:"bottom"},{default:u(()=>[...v[8]||(v[8]=[e("i",{class:"fa-regular fa-user"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.is_login!=1?(C(),V("div",{key:5,class:"icon-item",onClick:g},[s(y,{title:_.$t("item.aboutShowdoc"),placement:"bottom"},{default:u(()=>[...v[9]||(v[9]=[e("i",{class:"fa-regular fa-circle-info"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),B(ut,{key:6,list:d.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:k},{default:u(()=>[...v[10]||(v[10]=[e("div",{class:"icon-item"},[e("i",{class:"fa-regular fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0),f.value?(C(),B(de,{key:7,show:f.value,title:_.$t("item.importExcel"),onClose:v[2]||(v[2]=S=>f.value=!1)},{default:u(()=>[e("div",i7,[e("input",{type:"file",name:"xlfile",id:"xlf",accept:".xlsx,.xls",onChange:w},null,32)])]),_:1},8,["show","title"])):F("",!0)])}}});const c7=Y(r7,[["__scopeId","data-v-64b494b3"]]),d7={class:"table-item-container"},u7=J({__name:"index",props:{itemInfo:{}},emits:["reload"],setup(c,{emit:t}){const a=c,o=t;Ge(),xe();const{t:l,locale:m}=te(),f=He(),d=Qe(),p=b(null),h=b({}),$=b(0),g=b(0),n=b(0),w=b(0),k=b(!1),r=b("light"),_=async ee=>{const W=ee||$.value,ce=await X("/api/page/info",{page_id:W});if(ce.data&&ce.data.page_content){let ye;try{ye=JSON.parse(fs(ce.data.page_content))}catch{ye={}}if(h.value=ye,a.itemInfo.item_edit==1&&S())return;n.value=a.itemInfo.item_edit==1?1:0,await v(),a.itemInfo.item_edit==1&&x()}},v=async()=>{if(!x_spreadsheet)return!1;const ee=n.value?"edit":"read",W=document.getElementById("table-item");W&&(W.innerHTML=""),p.value=null,await ct(),p.value=x_spreadsheet("#table-item",{mode:ee,showToolbar:!0,row:{len:800,height:25},view:{height:()=>document.documentElement.clientHeight-90}}).loadData(h.value),p.value.on("cell-edited",(ce,ye,ze)=>{y()})},y=async()=>{if(p.value)try{await X("/api/page/save",{page_id:$.value,page_title:a.itemInfo.item_name,item_id:a.itemInfo.item_id,is_urlencode:1,page_content:encodeURIComponent(JSON.stringify(p.value.getData()))}),D(),I()}catch(ee){console.error("保存失败:",ee)}},S=()=>{const ee="page_content_"+$.value,W=localStorage.getItem(ee);if(!W)return!1;try{const ce=JSON.parse(W);return JSON.stringify(ce)!==JSON.stringify(h.value)?(confirm(l("page.draftTips"))&&(h.value=ce,v()),localStorage.removeItem(ee),!0):(localStorage.removeItem(ee),!1)}catch(ce){return console.error("解析草稿数据失败:",ce),localStorage.removeItem(ee),!1}},x=()=>{const ee="page_content_"+$.value;setInterval(()=>{if(p.value){const W=JSON.stringify(p.value.getData());localStorage.setItem(ee,W)}},30*1e3)},I=()=>{for(let ee=0;ee<localStorage.length;ee++){const W=localStorage.key(ee);W&&W.indexOf("page_content_")>-1&&localStorage.removeItem(W)}},T=async()=>{$.value>0&&(await X("/api/page/setLock",{page_id:$.value,item_id:a.itemInfo.item_id}),g.value=1)},M=async()=>{g.value&&(await X("/api/page/setLock",{page_id:$.value,item_id:a.itemInfo.item_id,lock_to:1e3}),g.value=0)},L=()=>{w.value=window.setInterval(()=>{g.value&&T()},3*60*1e3)},P=async()=>{const ee=await X("/api/page/isLock",{page_id:$.value});ee.data.lock>0?ee.data.is_cur_user>0?(g.value=1,n.value=1,v(),L()):(j.error(l("item.locking")+ee.data.lock_username),a.itemInfo.item_edit=!1,clearInterval(w.value),I()):(T(),n.value=1,v(),L())},N=()=>{if(!p.value)return;const W=(ce=>{const ye=XLSX.utils.book_new();return ce.forEach(ze=>{const Ve=[[]],De=ze.rows;for(let je=0;je<De.len;++je){const Ye=De[je];Ye&&(Ve[je]=[],Object.keys(Ye.cells).forEach(Ke=>{const Ue=+Ke;isNaN(Ue)||(Ve[je][Ue]=Ye.cells[Ke].text)}))}const Ze=XLSX.utils.aoa_to_sheet(Ve);XLSX.utils.book_append_sheet(ye,Ze,ze.name)}),ye})(p.value.getData());XLSX.writeFile(W,"showdoc.xlsx")},U=ee=>{if(!ee)return;const W=ye=>{const ze=[];return ye.SheetNames.forEach(Ve=>{const De={name:Ve,rows:{}},Ze=ye.Sheets[Ve];XLSX.utils.sheet_to_json(Ze,{raw:!1,header:1}).forEach((Ye,Ke)=>{const Ue={};Ye.forEach((Q,se)=>{Ue[se]={text:Q}}),De.rows[Ke]={cells:Ue}}),ze.push(De)}),ze},ce=new FileReader;ce.onload=ye=>{var De;const ze=(De=ye.target)==null?void 0:De.result;if(!ze)return;const Ve=W(XLSX.read(ze,{type:"array"}));Ve&&p.value&&(p.value.loadData(Ve),setTimeout(()=>{y()},500))},ce.readAsArrayBuffer(ee)},A=()=>{const ee=new URLSearchParams({page_id:$.value.toString(),item_id:a.itemInfo.item_id.toString(),lock_to:"1000",user_token:d.userToken}),W=ot()+"/api/page/setLock";if("sendBeacon"in navigator)navigator.sendBeacon(W,ee);else{const ce=new XMLHttpRequest;ce.open("POST",W,!1),ce.send(ee)}},D=()=>{localStorage.getItem("table_item_auto_save_tips")||(j.info(l("item.tableItemAutoSaveTips")),localStorage.setItem("table_item_auto_save_tips","1"))},E=()=>{o("reload")},oe=ee=>new Promise((W,ce)=>{const ye=document.createElement("script");ye.src=ee,ye.onload=()=>W(),ye.onerror=ce,document.head.appendChild(ye)}),ge=ee=>{const W=document.createElement("link");W.rel="stylesheet",W.href=ee,document.head.appendChild(W)},fe=async()=>{try{const ee=Et();await oe(`${ee}xspreadsheet/xspreadsheet.js`),await Promise.all([oe(`${ee}xspreadsheet/locale/zh-cn.js`),oe(`${ee}xspreadsheet/locale/en.js`)]),await oe(`${ee}xspreadsheet/xlsx.full.min.js`),k.value=!0,x_spreadsheet&&(m.value==="en-US"?x_spreadsheet.locale("en"):x_spreadsheet.locale("zh-cn"),a.itemInfo.menu&&a.itemInfo.menu.pages&&a.itemInfo.menu.pages[0]&&($.value=a.itemInfo.menu.pages[0].page_id,_(),a.itemInfo.item_edit==1&&P()))}catch(ee){console.error("加载依赖失败:",ee)}};return ae(()=>{r.value=f.theme,f.theme==="dark"&&f.setTheme("light");const ee=Et();ge(`${ee}xspreadsheet/xspreadsheet.css`),fe(),window.addEventListener("beforeunload",A)}),Xe(()=>{clearInterval(w.value),M(),window.removeEventListener("beforeunload",A),r.value!==f.theme&&f.setTheme(r.value),setTimeout(()=>{E()},500)}),(ee,W)=>(C(),V("div",d7,[s(Vt,{"item-info":c.itemInfo},{right:u(()=>[s(c7,{"item-info":c.itemInfo,onSave:y,onExport:N,onImport:U,onReload:E},null,8,["item-info"])]),_:1},8,["item-info"]),W[0]||(W[0]=e("div",{id:"table-item"},null,-1))]))}});const m7=Y(u7,[["__scopeId","data-v-be7749fa"]]),_7={class:"header-right"},p7=J({__name:"HeaderRight",props:{itemInfo:{default:()=>({})},pageId:{default:0}},emits:["save","exportImage","clearCanvas"],setup(c){const t=c,a=xe(),{t:o}=te(),l=He(),m=()=>{l.toggleTheme()},f=q(()=>[{value:"update",icon:["far","fa-edit"],text:o("item.base_info")},{value:"archive",icon:["far","fa-box-archive"],text:o("item.archive")},{value:"attorn",icon:["far","fa-recycle"],text:o("item.attorn")},{value:"changelog",icon:["far","fa-clock-rotate-left"],text:o("item.change_log")},{value:"delete",icon:["far","fa-trash-can"],text:o("item.delete_item"),danger:!0}]),d=async()=>{t.itemInfo&&await gt({item_domain:t.itemInfo.item_domain,item_id:t.itemInfo.item_id,page_id:t.pageId})},p=async()=>{t.itemInfo&&await yt(t.itemInfo.item_id)},h=()=>{a.push("/user/login")},$=async g=>{switch(g.value){case"update":t.itemInfo&&await at({item_id:t.itemInfo.item_id});break;case"archive":t.itemInfo&&await wt(t.itemInfo.item_id);break;case"attorn":t.itemInfo&&await bt(t.itemInfo.item_id);break;case"changelog":t.itemInfo&&await zt(t.itemInfo.item_id);break;case"delete":t.itemInfo&&await $t(t.itemInfo.item_id);break}};return(g,n)=>{var k,r,_,v,y;const w=H("a-tooltip");return C(),V("div",_7,[s(w,{title:g.$t("item.share"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:d},[...n[2]||(n[2]=[e("i",{class:"far fa-share-nodes"},null,-1)])])]),_:1},8,["title"]),((k=c.itemInfo)==null?void 0:k.item_manage)==1?(C(),B(w,{key:0,title:g.$t("common.save"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:n[0]||(n[0]=S=>g.$emit("save"))},[...n[3]||(n[3]=[e("i",{class:"far fa-save"},null,-1)])])]),_:1},8,["title"])):F("",!0),((r=c.itemInfo)==null?void 0:r.item_edit)==1?(C(),B(w,{key:1,title:g.$t("item.export"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:n[1]||(n[1]=S=>g.$emit("exportImage"))},[...n[4]||(n[4]=[e("i",{class:"far fa-download"},null,-1)])])]),_:1},8,["title"])):F("",!0),((_=c.itemInfo)==null?void 0:_.item_manage)==1?(C(),B(w,{key:2,title:g.$t("item.member_manage"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:p},[...n[5]||(n[5]=[e("i",{class:"far fa-users"},null,-1)])])]),_:1},8,["title"])):F("",!0),((v=c.itemInfo)==null?void 0:v.is_login)!=1?(C(),B(w,{key:3,title:g.$t("user.login"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item",onClick:h},[...n[6]||(n[6]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])):F("",!0),s(w,{title:z(l).theme==="light"?g.$t("common.dark_mode"):g.$t("common.light_mode"),placement:"bottom"},{default:u(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:m},[...n[7]||(n[7]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),((y=c.itemInfo)==null?void 0:y.item_manage)==1?(C(),B(ut,{key:4,list:f.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:$},{default:u(()=>[...n[8]||(n[8]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const f7=Y(p7,[["__scopeId","data-v-9d42b2dd"]]),v7={class:"whiteboard-toolbar"},h7={class:"tool-left"},g7={class:"width-wrap"},y7={class:"label"},w7={class:"btn-text"},b7={class:"btn-text"},$7={class:"tool-right"},k7={class:"btn-text"},C7={class:"btn-text"},x7={class:"btn-text"},I7={class:"text-style-pop"},S7={class:"row",style:{display:"flex","align-items":"center",gap:"8px","margin-bottom":"8px"}},T7={class:"label",style:{"min-width":"56px"}},M7={class:"row",style:{display:"flex","align-items":"center",gap:"8px"}},L7={class:"label",style:{"min-width":"56px"}},V7={class:"btn-text"},z7={style:{display:"flex",gap:"16px","flex-wrap":"wrap","align-items":"center",padding:"12px"}},U7={class:"btn-text"},P7={class:"btn-text"},A7={class:"btn-text"},D7={class:"btn-text"},O7={class:"btn-text"},N7={class:"btn-text"},F7={class:"btn-text"},q7={class:"btn-text"},R7={class:"btn-text"},H7={class:"btn-text"},E7={class:"btn-text"},j7={class:"btn-text"},B7=J({__name:"Toolbar",props:{isReadOnly:{type:Boolean},brushColor:{},brushWidth:{},isDrawing:{type:Boolean},isErasing:{type:Boolean},isInsertingText:{type:Boolean},pendingShapeType:{},textFontSize:{},textColor:{},fontSizeOptions:{},isFullscreen:{type:Boolean}},emits:["update:brushColor","update:brushWidth","update:textFontSize","update:textColor","toggle-drawing","toggle-eraser","toggle-text-insert","insert-rect","insert-circle","insert-triangle","insert-arrow","undo","redo","clear-canvas","export-image","export-svg","export-json","import-image","import-json","zoom-out","zoom-in","fit-to-viewport","zoom-reset","toggle-fullscreen","apply-brush","apply-text-font-size","apply-text-color"],setup(c,{emit:t}){const a=t,o=b(null),l=b(null),m=g=>{a("update:brushColor",g),a("apply-brush")},f=g=>{a("update:brushWidth",g),a("apply-brush")},d=g=>{a("update:textFontSize",g),a("apply-text-font-size")},p=g=>{a("update:textColor",g),a("apply-text-color")},h=()=>{o.value&&(o.value.value="",o.value.click())},$=()=>{l.value&&(l.value.value="",l.value.click())};return(g,n)=>{const w=H("a-color-picker"),k=H("a-tooltip"),r=H("a-slider"),_=H("a-input-number"),v=H("a-button"),y=H("a-select-option"),S=H("a-select"),x=H("a-popover");return C(),V("div",v7,[e("div",h7,[s(k,{title:g.$t("item.whiteboard_color")||"颜色"},{default:u(()=>[s(w,{value:c.brushColor,size:"small",disabled:c.isReadOnly,onChange:m},null,8,["value","disabled"])]),_:1},8,["title"]),e("div",g7,[e("span",y7,i(g.$t("item.whiteboard_width")||"粗细"),1),s(r,{class:"width-slider",min:1,max:50,step:1,value:c.brushWidth,disabled:c.isReadOnly,onChange:f},null,8,["value","disabled"]),s(_,{value:c.brushWidth,min:1,max:50,size:"small",disabled:c.isReadOnly,style:{width:"60px"},onChange:f},null,8,["value","disabled"])]),n[21]||(n[21]=e("span",{class:"divider"},null,-1)),s(k,{title:c.isDrawing?g.$t("item.whiteboard_drawing_on")||"绘制中":g.$t("item.whiteboard_drawing_off")||"停止绘制"},{default:u(()=>[s(v,{size:"small",type:c.isDrawing?"primary":"default",disabled:c.isReadOnly,onClick:n[0]||(n[0]=I=>g.$emit("toggle-drawing"))},{icon:u(()=>[e("i",{class:re(c.isDrawing?"fa-solid fa-pen":"fa-solid fa-hand-pointer")},null,2)]),default:u(()=>[e("span",w7,i(c.isDrawing?g.$t("item.whiteboard_draw")||"绘制":g.$t("item.whiteboard_select")||"选择"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_eraser")||"橡皮擦"},{default:u(()=>[s(v,{size:"small",type:c.isErasing?"primary":"default",disabled:c.isReadOnly,onClick:n[1]||(n[1]=I=>g.$emit("toggle-eraser"))},{icon:u(()=>[...n[20]||(n[20]=[e("i",{class:"fa-solid fa-eraser"},null,-1)])]),default:u(()=>[e("span",b7,i(g.$t("item.whiteboard_eraser")||"橡皮擦"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"])]),e("div",$7,[s(k,{title:g.$t("common.undo")||"撤销"},{default:u(()=>[s(v,{size:"small",disabled:c.isReadOnly,onClick:n[2]||(n[2]=I=>g.$emit("undo"))},{icon:u(()=>[...n[22]||(n[22]=[e("i",{class:"fa-solid fa-rotate-left"},null,-1)])]),default:u(()=>[e("span",k7,i(g.$t("common.undo")||"撤销"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),s(k,{title:g.$t("common.redo")||"重做"},{default:u(()=>[s(v,{size:"small",disabled:c.isReadOnly,onClick:n[3]||(n[3]=I=>g.$emit("redo"))},{icon:u(()=>[...n[23]||(n[23]=[e("i",{class:"fa-solid fa-rotate-right"},null,-1)])]),default:u(()=>[e("span",C7,i(g.$t("common.redo")||"重做"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),n[41]||(n[41]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_insert_text")||"插入文字"},{default:u(()=>[s(v,{size:"small",type:c.isInsertingText?"primary":"default",disabled:c.isReadOnly,onClick:n[4]||(n[4]=I=>g.$emit("toggle-text-insert"))},{icon:u(()=>[...n[24]||(n[24]=[e("i",{class:"fa-solid fa-i-cursor"},null,-1)])]),default:u(()=>[e("span",x7,i(g.$t("item.whiteboard_insert_text")||"插入文字"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"]),s(x,{placement:"bottom",trigger:"click",overlayStyle:{width:"260px"}},{content:u(()=>[e("div",I7,[e("div",S7,[e("span",T7,i(g.$t("item.whiteboard_font_size")||"字号"),1),s(S,{value:c.textFontSize,size:"small",style:{width:"100px"},disabled:c.isReadOnly,onChange:d},{default:u(()=>[(C(!0),V(Ce,null,Pe(c.fontSizeOptions,I=>(C(),B(y,{key:I,value:I},{default:u(()=>[O(i(I),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])]),e("div",M7,[e("span",L7,i(g.$t("item.whiteboard_font_color")||"字体颜色"),1),s(w,{value:c.textColor,size:"small",disabled:c.isReadOnly,onChange:p},null,8,["value","disabled"])])])]),default:u(()=>[s(v,{size:"small",disabled:c.isReadOnly},{icon:u(()=>[...n[25]||(n[25]=[e("i",{class:"fa-solid fa-font"},null,-1)])]),default:u(()=>[e("span",V7,i(g.$t("item.whiteboard_text_style")||"文本样式"),1)]),_:1},8,["disabled"])]),_:1}),n[42]||(n[42]=e("span",{class:"divider"},null,-1)),s(x,{placement:"bottom",trigger:"click",overlayStyle:{width:"480px"}},{content:u(()=>[e("div",z7,[s(v,{size:"small",type:c.pendingShapeType==="rect"?"primary":"default",disabled:c.isReadOnly,onClick:n[5]||(n[5]=I=>g.$emit("insert-rect")),style:{"min-width":"80px",height:"40px"}},{default:u(()=>[n[26]||(n[26]=e("i",{class:"fa-regular fa-square",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_rect")||"方形"),1)]),_:1},8,["type","disabled"]),s(v,{size:"small",type:c.pendingShapeType==="circle"?"primary":"default",disabled:c.isReadOnly,onClick:n[6]||(n[6]=I=>g.$emit("insert-circle")),style:{"min-width":"80px",height:"40px"}},{default:u(()=>[n[27]||(n[27]=e("i",{class:"fa-regular fa-circle",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_circle")||"圆形"),1)]),_:1},8,["type","disabled"]),s(v,{size:"small",type:c.pendingShapeType==="triangle"?"primary":"default",disabled:c.isReadOnly,onClick:n[7]||(n[7]=I=>g.$emit("insert-triangle")),style:{"min-width":"80px",height:"40px"}},{default:u(()=>[n[28]||(n[28]=e("i",{class:"fa-solid fa-caret-up",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_triangle")||"三角形"),1)]),_:1},8,["type","disabled"]),s(v,{size:"small",type:c.pendingShapeType==="arrow"?"primary":"default",disabled:c.isReadOnly,onClick:n[8]||(n[8]=I=>g.$emit("insert-arrow")),style:{"min-width":"80px",height:"40px"}},{default:u(()=>[n[29]||(n[29]=e("i",{class:"fa-solid fa-arrow-right",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_arrow")||"箭头"),1)]),_:1},8,["type","disabled"])])]),default:u(()=>[s(v,{size:"small",type:c.pendingShapeType?"primary":"default",disabled:c.isReadOnly},{icon:u(()=>[...n[30]||(n[30]=[e("i",{class:"fa-solid fa-draw-polygon"},null,-1)])]),default:u(()=>[e("span",U7,i(g.$t("item.whiteboard_insert_shape")||"插入形状"),1)]),_:1},8,["type","disabled"])]),_:1}),s(k,{title:g.$t("item.whiteboard_insert_image")||"插入图片"},{default:u(()=>[s(v,{size:"small",disabled:c.isReadOnly,onClick:h},{icon:u(()=>[...n[31]||(n[31]=[e("i",{class:"fa-solid fa-image"},null,-1)])]),default:u(()=>[e("span",P7,i(g.$t("item.whiteboard_insert_image")||"插入图片"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),e("input",{ref_key:"imgFile",ref:o,type:"file",accept:"image/*",style:{display:"none"},onChange:n[9]||(n[9]=I=>g.$emit("import-image",I))},null,544),n[43]||(n[43]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_zoom_out")||"缩小"},{default:u(()=>[s(v,{size:"small",onClick:n[10]||(n[10]=I=>g.$emit("zoom-out"))},{icon:u(()=>[...n[32]||(n[32]=[e("i",{class:"fa-solid fa-magnifying-glass-minus"},null,-1)])]),default:u(()=>[e("span",A7,i(g.$t("item.whiteboard_zoom_out")||"缩小"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_zoom_in")||"放大"},{default:u(()=>[s(v,{size:"small",onClick:n[11]||(n[11]=I=>g.$emit("zoom-in"))},{icon:u(()=>[...n[33]||(n[33]=[e("i",{class:"fa-solid fa-magnifying-glass-plus"},null,-1)])]),default:u(()=>[e("span",D7,i(g.$t("item.whiteboard_zoom_in")||"放大"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_fit")||"适屏"},{default:u(()=>[s(v,{size:"small",onClick:n[12]||(n[12]=I=>g.$emit("fit-to-viewport"))},{icon:u(()=>[...n[34]||(n[34]=[e("i",{class:"fa-solid fa-maximize"},null,-1)])]),default:u(()=>[e("span",O7,i(g.$t("item.whiteboard_fit")||"适屏"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_actual_size")||"1:1"},{default:u(()=>[s(v,{size:"small",onClick:n[13]||(n[13]=I=>g.$emit("zoom-reset"))},{icon:u(()=>[...n[35]||(n[35]=[e("i",{class:"fa-solid fa-compress"},null,-1)])]),default:u(()=>[e("span",N7,i(g.$t("item.whiteboard_actual_size")||"1:1"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:c.isFullscreen?g.$t("item.whiteboard_exit_fullscreen")||"退出全屏":g.$t("item.whiteboard_fullscreen")||"全屏编辑"},{default:u(()=>[s(v,{size:"small",type:c.isFullscreen?"primary":"default",onClick:n[14]||(n[14]=I=>g.$emit("toggle-fullscreen"))},{icon:u(()=>[e("i",{class:re(c.isFullscreen?"fa-solid fa-compress":"fa-solid fa-expand")},null,2)]),default:u(()=>[e("span",F7,i(c.isFullscreen?g.$t("item.whiteboard_exit_fullscreen")||"退出全屏":g.$t("item.whiteboard_fullscreen")||"全屏编辑"),1)]),_:1},8,["type"])]),_:1},8,["title"]),n[44]||(n[44]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_export_png")||"导出 PNG"},{default:u(()=>[s(v,{size:"small",onClick:n[15]||(n[15]=I=>g.$emit("export-image"))},{icon:u(()=>[...n[36]||(n[36]=[e("i",{class:"fa-solid fa-image"},null,-1)])]),default:u(()=>[e("span",q7,i(g.$t("item.whiteboard_export_png")||"导出PNG"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_export_svg")||"导出 SVG"},{default:u(()=>[s(v,{size:"small",onClick:n[16]||(n[16]=I=>g.$emit("export-svg"))},{icon:u(()=>[...n[37]||(n[37]=[e("i",{class:"fa-solid fa-file-code"},null,-1)])]),default:u(()=>[e("span",R7,i(g.$t("item.whiteboard_export_svg")||"导出SVG"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_export_json")||"导出 JSON"},{default:u(()=>[s(v,{size:"small",onClick:n[17]||(n[17]=I=>g.$emit("export-json"))},{icon:u(()=>[...n[38]||(n[38]=[e("i",{class:"fa-solid fa-code"},null,-1)])]),default:u(()=>[e("span",H7,i(g.$t("item.whiteboard_export_json")||"导出JSON"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_import_json")||"导入 JSON"},{default:u(()=>[s(v,{size:"small",disabled:c.isReadOnly,onClick:$},{icon:u(()=>[...n[39]||(n[39]=[e("i",{class:"fa-solid fa-file-import"},null,-1)])]),default:u(()=>[e("span",E7,i(g.$t("item.whiteboard_import_json")||"导入JSON"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),e("input",{ref_key:"jsonFile",ref:l,type:"file",accept:"application/json",style:{display:"none"},onChange:n[18]||(n[18]=I=>g.$emit("import-json",I))},null,544),n[45]||(n[45]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_clear")||"清空画布"},{default:u(()=>[s(v,{size:"small",danger:"",disabled:c.isReadOnly,onClick:n[19]||(n[19]=I=>g.$emit("clear-canvas"))},{icon:u(()=>[...n[40]||(n[40]=[e("i",{class:"fa-solid fa-trash-can"},null,-1)])]),default:u(()=>[e("span",j7,i(g.$t("item.whiteboard_clear")||"清空画布"),1)]),_:1},8,["disabled"])]),_:1},8,["title"])])])}}});const G7=Y(B7,[["__scopeId","data-v-3b8c6dc0"]]);function K7(){const c=b(!1),t=b(!1);return{isLoaded:c,isLoading:t,loadFabric:()=>new Promise((o,l)=>{if(window.fabric){c.value=!0,o();return}if(t.value){const f=setInterval(()=>{window.fabric&&(clearInterval(f),c.value=!0,o())},100);return}t.value=!0;const m=document.createElement("script");m.src=`${Et()}whiteboard/fabric.min.js`,m.onload=()=>{c.value=!0,t.value=!1,o()},m.onerror=()=>{t.value=!1,l(new Error("Failed to load Fabric.js"))},document.head.appendChild(m)})}}function W7(c,t){const a=b(null),o=b(null),l=()=>{const $=(window.innerHeight||document.documentElement.clientHeight||0)*.9-120;return Math.max($,480)},m=(h,$)=>{if(!window.fabric)return;const g=document.getElementById("whiteboard-canvas");if(!g)return;const n=document.querySelector("#whiteboard-item .canvas-inner")||g.parentElement;let w=Math.max((n==null?void 0:n.clientWidth)||0,600),k=Math.max((n==null?void 0:n.clientHeight)||0,0);if(k<=0){k=l();try{n&&(n.style.height=k+"px")}catch{}}else k=Math.max(k,480);const _=document.documentElement.getAttribute("data-theme")==="dark"?"#2d2d2d":"#ffffff";a.value=new window.fabric.Canvas("whiteboard-canvas",{isDrawingMode:!h,width:w,height:k,selection:!h,backgroundColor:_}),a.value.on("path:created",()=>{$&&$()}),a.value.on("object:modified",()=>{$&&$()}),a.value.on("object:removed",()=>{$&&$()}),f()},f=()=>{const h=document.querySelector("#whiteboard-item .canvas-wrap"),$=document.querySelector("#whiteboard-item .canvas-inner");if(!h)return;const g=()=>{if(!a.value)return;let n=$&&$.clientWidth||h.clientWidth,w=$&&$.clientHeight||h.clientHeight;if(w<=0||w<480){w=l();try{$?$.style.height=w+"px":h.style.height=w+"px"}catch{}}n<=0&&(n=Math.max(document.documentElement.clientWidth||window.innerWidth||0,600)),n>0&&w>0&&(a.value.setWidth(n),a.value.setHeight(w),a.value.renderAll())};if(window.ResizeObserver)o.value=new window.ResizeObserver(g),o.value.observe(h);else{const n=class{constructor(w){ia(this,"cb");this.cb=w}observe(){window.addEventListener("resize",this.cb)}disconnect(){window.removeEventListener("resize",this.cb)}};o.value=new n(g),o.value.observe(h)}window.addEventListener("resize",g),setTimeout(g,16),setTimeout(g,200),setTimeout(g,800)},d=()=>{try{o.value&&o.value.disconnect&&o.value.disconnect()}catch{}a.value&&a.value.dispose()};return Xe(d),{canvas:a,initCanvas:m,getViewportCanvasHeight:l,setBackgroundColor:h=>{a.value&&a.value.setBackgroundColor(h,a.value.renderAll.bind(a.value))},cleanup:d}}function J7(c,t,a,o={}){const l=b([]),m=b([]),f=b(null),d=b(0),p=()=>{if(!c.value)return"{}";const v=c.value.toJSON(),{backgroundColor:y,...S}=v,x={__canvasSize:{width:c.value.getWidth(),height:c.value.getHeight()},...S};return JSON.stringify(x)},h=async(v=!1)=>{var y,S;if(!(!t.value||!c.value))try{await X("/api/page/save",{page_id:t.value,page_title:(y=a.value)==null?void 0:y.item_name,item_id:(S=a.value)==null?void 0:S.item_id,is_urlencode:1,page_content:encodeURIComponent(p())},"post",!1,"form"),d.value=Date.now(),v||j.success("已保存")}catch{v||j.error("保存失败")}},$=()=>{if(!a.value||!a.value.item_edit)return;f.value&&(clearTimeout(f.value),f.value=null);const y=Date.now()-d.value,S=1e4,x=2e3,I=Math.max(S-y,0),T=Math.max(x,I);f.value=setTimeout(()=>{h(!0)},T)},g=()=>{n(),m.value=[],$()},n=()=>{if(!c.value)return;const v=p(),y=50;l.value.push(v),l.value.length>y&&l.value.shift()},w=()=>{if(l.value.length<=1)return;const v=l.value.pop();m.value.push(v);const y=l.value[l.value.length-1];r(y)},k=()=>{if(m.value.length===0)return;const v=m.value.pop();v&&(l.value.push(v),r(v))},r=v=>{try{const y=JSON.parse(v);if(y&&y.__canvasSize){const{width:S,height:x}=y.__canvasSize;S&&x&&o.applyCustomSize&&o.applyCustomSize(S,x)}c.value.loadFromJSON(y,()=>{var S;c.value.renderAll(),((S=a.value)==null?void 0:S.item_edit)==0&&o.applyReadOnlyMode&&o.applyReadOnlyMode(),o.onContentLoaded&&o.onContentLoaded(),o.onContentLoadedFromJSON&&o.onContentLoadedFromJSON()})}catch{}};return{undoStack:l,redoStack:m,onContentChanged:g,undo:w,redo:k,save:h,loadPageContent:async()=>{var v;try{const y=await X("/api/page/info",{page_id:t.value},"post",!1,"form");if(!c.value)return;let S=(v=y==null?void 0:y.data)==null?void 0:v.page_content;if(S)try{const x=JSON.parse(Zt(S));if(x&&x.__canvasSize){const{width:I,height:T}=x.__canvasSize;I&&T&&o.applyCustomSize&&o.applyCustomSize(I,T)}c.value.loadFromJSON(x,()=>{var I;c.value.renderAll(),((I=a.value)==null?void 0:I.item_edit)==0&&o.applyReadOnlyMode&&o.applyReadOnlyMode(),o.onContentLoaded&&o.onContentLoaded(),n()})}catch{n()}else n()}catch{n()}},serialize:p}}function Y7(c){const t=()=>"cell",a=()=>document.documentElement.getAttribute("data-theme")==="dark"?"#2d2d2d":"#ffffff";return{applyBrush:(f,d,p,h,$,g)=>{if(!c.value)return;const n=f.value!==void 0?f.value:f,w=d.value!==void 0?d.value:d,k=p.value!==void 0?p.value:p,r=h.value!==void 0?h.value:h,_=$.value!==void 0?$.value:$,v=g.value!==void 0?g.value:g;c.value.isDrawingMode=n||r?!1:w,c.value.freeDrawingBrush||(c.value.freeDrawingBrush=new window.fabric.PencilBrush(c.value));const y=k?a():_;c.value.freeDrawingBrush.color=y,c.value.freeDrawingBrush.width=v;try{c.value.freeDrawingCursor=k?t():"crosshair";const S=c.value.isDrawingMode?k?t():"crosshair":"default";c.value.setCursor(S),c.value.requestRenderAll()}catch{}},deleteSelectedObjects:()=>{if(!c.value)return;const f=c.value.getActiveObject();f&&(f.type==="activeSelection"?(f.forEachObject(d=>c.value.remove(d)),c.value.discardActiveObject()):c.value.remove(f),c.value.requestRenderAll())},applyReadOnlyMode:()=>{if(c.value){c.value.isDrawingMode=!1,c.value.selection=!1,c.value.skipTargetFind=!0;try{c.value.forEachObject(f=>{f.selectable=!1,f.evented=!1,f.hasControls&&(f.hasControls=!1)})}catch{}c.value.discardActiveObject&&c.value.discardActiveObject(),c.value.requestRenderAll&&c.value.requestRenderAll()}}}}function X7(){return{insertShapeAtPosition:(t,a,o,l,m,f,d)=>{if(!t)return;let p=null;const h=window.fabric;switch(a){case"rect":{const $=Math.max(60,f*10),g=Math.max(40,f*7);p=new h.Rect({left:o-$/2,top:l-g/2,width:$,height:g,fill:"transparent",stroke:m,strokeWidth:f});break}case"circle":{const $=Math.max(30,f*5);p=new h.Circle({left:o-$,top:l-$,radius:$,fill:"transparent",stroke:m,strokeWidth:f});break}case"triangle":{const $=Math.max(70,f*12),g=Math.max(60,f*10);p=new h.Triangle({left:o-$/2,top:l-g/2,width:$,height:g,fill:"transparent",stroke:m,strokeWidth:f});break}case"arrow":{const $=Math.max(120,f*20),g=Math.max(10,f*3),n=$-g*.9,w=0,k=new h.Line([0,0,n,w],{stroke:m,strokeWidth:f,selectable:!1,evented:!1}),r=new h.Triangle({left:n+g*.05,top:-g*.9,width:g*2,height:g*2,angle:90,fill:m,selectable:!1,evented:!1});p=new h.Group([k,r],{left:o,top:l-f/2});break}}p&&(p.set({cornerStyle:"circle",transparentCorners:!1}),t.add(p),t.setActiveObject(p),t.requestRenderAll(),d&&d())}}}function Q7(c,t,a){const o=b(!1),l=b(!1),m=()=>{c.value&&(window.addEventListener("keydown",f),window.addEventListener("keyup",d),c.value.on("mouse:down",()=>{o.value&&(l.value=!0,c.value.setCursor("grab"),c.value.renderAll())}),c.value.on("mouse:move",n=>{if(l.value){const w=n.e,k=new window.fabric.Point(w.movementX,w.movementY);c.value.relativePan(k)}}),c.value.on("mouse:up",()=>{l.value=!1,c.value.setCursor("default"),c.value.renderAll()}),c.value.on("mouse:wheel",n=>{const w=n.e;if(!w.ctrlKey)return;w.preventDefault(),w.stopPropagation();let k=c.value.getZoom();k*=Math.pow(.999,w.deltaY),k=Math.max(.25,Math.min(k,4));const r=new window.fabric.Point(w.offsetX,w.offsetY);c.value.zoomToPoint(r,k)}))},f=n=>{n.code==="Space"&&(o.value=!0,c.value&&(c.value.isDrawingMode=!1)),n.code==="Delete"||n.code},d=n=>{if(n.code==="Space"&&(o.value=!1,c.value)){c.value.isDrawingMode=t.value;try{const w=c.value.isDrawingMode?a.value?"cell":"crosshair":"default";c.value.setCursor(w),c.value.requestRenderAll()}catch{}}},p=()=>{if(!c.value)return;const n=Math.min(c.value.getZoom()*1.1,4);c.value.setZoom(n),c.value.requestRenderAll()},h=()=>{if(!c.value)return;const n=Math.max(c.value.getZoom()/1.1,.25);c.value.setZoom(n),c.value.requestRenderAll()},$=()=>{c.value&&(c.value.setViewportTransform([1,0,0,1,0,0]),c.value.requestRenderAll())};return{bindPanAndWheel:m,zoomIn:p,zoomOut:h,zoomReset:$,fitToViewport:()=>{const n=document.querySelector("#whiteboard-item .canvas-inner"),w=document.querySelector("#whiteboard-item .canvas-wrap");if(!n||!w||!c.value)return;n.style.width="",n.style.height="";const k=n.clientWidth||w.clientWidth,r=n.clientHeight||w.clientHeight||480;c.value.setWidth(k),c.value.setHeight(Math.max(r,480)),$(),c.value.renderAll()},spacePressed:o,panning:l}}function Z7(c,t,a){const o=b(null),l=b(!1),m=b({x:0,y:0,width:0,height:0}),f=()=>{var v;const r=((v=c.value)==null?void 0:v.item_id)||"0",_=t.value||"0";return`whiteboard:size:${r}:${_}`},d=()=>{try{const r=localStorage.getItem(f());if(!r)return null;const _=JSON.parse(r);if(_&&typeof _.width=="number"&&typeof _.height=="number")return _}catch{}return null},p=(r,_)=>{try{localStorage.setItem(f(),JSON.stringify({width:r,height:_}))}catch{}},h=()=>{try{localStorage.removeItem(f())}catch{}},$=(r,_)=>{const v=document.querySelector("#whiteboard-item .canvas-inner"),y=document.querySelector("#whiteboard-item .canvas-wrap");if(!v||!a.value)return;const S=480,x=1e4,I=Math.max(S,Math.min(r||0,x)),T=Math.max(S,Math.min(_||0,x));v.style.width=I+"px",v.style.height=T+"px",y&&(y.scrollLeft=y.scrollWidth),a.value.setWidth(I),a.value.setHeight(T),a.value.renderAll()},g=r=>{const _=document.querySelector("#whiteboard-item .canvas-inner");_&&(l.value=!0,m.value={x:r.clientX,y:r.clientY,width:_.clientWidth,height:_.clientHeight},document.addEventListener("mousemove",n),document.addEventListener("mouseup",w,{once:!0}))},n=r=>{if(!l.value)return;const _=(r.clientX-m.value.x)*2.5,v=(r.clientY-m.value.y)*2.5,y=Math.round(m.value.width+_),S=Math.round(m.value.height+v);o.value={width:y,height:S},$(y,S)},w=()=>{l.value&&(l.value=!1,document.removeEventListener("mousemove",n),o.value&&p(o.value.width,o.value.height))};return{customCanvasSize:o,resizing:l,loadSavedSize:d,saveCustomSize:p,clearSavedSize:h,applyCustomSize:$,onResizeHandleDown:g,onResizeHandleUp:w,fitToViewport:()=>{const r=document.querySelector("#whiteboard-item .canvas-inner"),_=document.querySelector("#whiteboard-item .canvas-wrap");if(!r||!_||!a.value)return;r.style.width="",r.style.height="",o.value=null,h();const v=r.clientWidth||_.clientWidth,y=Math.max(r.clientHeight||_.clientHeight||window.innerHeight-150,480);a.value.setWidth(v),a.value.setHeight(y),a.value.renderAll()}}}function eS(c,t,a){const o=b(null),l=b(null);return{imgFile:o,jsonFile:l,clearCanvas:()=>{c.value&&(c.value.clear(),c.value.setBackgroundColor("#ffffff",c.value.renderAll.bind(c.value)))},exportImage:()=>{if(!c.value)return;const w=c.value.toDataURL({format:"png",quality:1}),k=document.createElement("a");k.href=w,k.download="showdoc-whiteboard.png",k.click()},exportSVG:()=>{if(c.value)try{const w=c.value.toSVG(),k=new Blob([w],{type:"image/svg+xml"}),r=URL.createObjectURL(k),_=document.createElement("a");_.href=r,_.download="showdoc-whiteboard.svg",_.click(),URL.revokeObjectURL(r)}catch{}},exportJSON:()=>{const w=a(),k=new Blob([w],{type:"application/json"}),r=URL.createObjectURL(k),_=document.createElement("a");_.href=r,_.download="showdoc-whiteboard.json",_.click(),URL.revokeObjectURL(r)},importJSON:w=>{var _;const k=(_=w.target.files)==null?void 0:_[0];if(!k)return;const r=new FileReader;r.onload=()=>{try{const v=String(r.result||"")}catch{}},r.readAsText(k)},importImage:w=>{var _;const k=(_=w.target.files)==null?void 0:_[0];if(!k||!c.value)return;const r=new FileReader;r.onload=()=>{const v=r.result,y=new Image;y.onload=()=>{const S=c.value.getWidth(),x=c.value.getHeight(),I=Math.min(S/y.width,x/y.height,1);window.fabric.Image.fromURL(v,M=>{M.set({left:(S-y.width*I)/2,top:(x-y.height*I)/2,selectable:!0,hasControls:!0,cornerStyle:"circle",transparentCorners:!1}),M.scale(I),c.value.add(M),c.value.setActiveObject(M),c.value.requestRenderAll()},{crossOrigin:"anonymous"})},y.src=v},r.readAsDataURL(k)},triggerImageUpload:()=>{o.value&&(o.value.value="",o.value.click())},triggerImport:()=>{l.value&&(l.value.value="",l.value.click())}}}const tS=["onKeydown"],aS={key:0,class:"item-header"},oS={class:"canvas-wrap"},sS={class:"canvas-inner"},lS=J({__name:"index",props:{itemInfo:{}},setup(c){const t=c;xe();const{t:a}=te(),o=He(),{isLoaded:l,loadFabric:m}=K7(),{canvas:f,initCanvas:d,setBackgroundColor:p}=W7(q(()=>t.itemInfo),b("")),h=b(""),$=q(()=>!(t.itemInfo&&t.itemInfo.item_edit==1)),g=q(()=>!(t.itemInfo&&t.itemInfo.is_login==1)),n=b(!1),w=()=>o.theme==="dark"?"#e0e0e0":"#2c3e50",k=()=>o.theme==="dark"?"#e0e0e0":"#2c3e50",r=b(!0),_=b(!1),v=b(w()),y=b(4),S=b(!1),x=b(24),I=b(k()),T=[12,14,16,18,20,24,28,32,36,48,64,80,96,120];qe(()=>o.theme,ue=>{if(!f.value)return;p(ue==="dark"?"#2d2d2d":"#ffffff");const Z="#2c3e50",pe="#e0e0e0",$e=ue==="dark"?pe:Z,Ae=ue==="dark"?pe:Z,Ne=ue==="dark"?Z:pe,et=ue==="dark"?Z:pe;v.value===Ne&&(v.value=$e),I.value===et&&(I.value=Ae),D($.value,r.value,_.value,S.value,v.value,y.value),f.value.requestRenderAll()});const M=b(null),{customCanvasSize:L,loadSavedSize:P,applyCustomSize:N,onResizeHandleDown:U,fitToViewport:A}=Z7(q(()=>t.itemInfo),h,f),{applyBrush:D,deleteSelectedObjects:E,applyReadOnlyMode:oe}=Y7(f),{insertShapeAtPosition:ge}=X7(),{bindPanAndWheel:fe,zoomIn:ee,zoomOut:W,zoomReset:ce}=Q7(f,r,_),{exportImage:ye,exportSVG:ze,exportJSON:Ve,importJSON:De,importImage:Ze,clearCanvas:je}=eS(f,q(()=>t.itemInfo),()=>""),{undo:Ye,redo:Ke,onContentChanged:Ue,save:Q,loadPageContent:se}=J7(f,h,q(()=>t.itemInfo),{applyCustomSize:(ue,R)=>{L.value={width:ue,height:R},N(ue,R)},applyReadOnlyMode:()=>{oe()},onContentLoaded:()=>{D($.value,r.value,_.value,S.value,v.value,y.value);const ue=o.theme==="dark"?"#2d2d2d":"#ffffff";p(ue)},onContentLoadedFromJSON:()=>{const ue=o.theme==="dark"?"#2d2d2d":"#ffffff";p(ue)}}),be=()=>{$.value||(r.value=!r.value,_.value=!1,S.value=!1,M.value=null,D())},Te=()=>{$.value||(_.value=!_.value,_.value&&(r.value=!0),S.value=!1,M.value=null,D())},we=()=>{$.value||(S.value=!S.value,S.value?(r.value=!1,_.value=!1,M.value=null):(r.value=!0,_.value=!1),D())},le=()=>{n.value=!n.value,n.value?document.documentElement.requestFullscreen():document.exitFullscreen()},_e=async()=>{if($.value){j.warning(a("item.whiteboard_no_edit_permission")||"没有编辑权限");return}await Q()},ke=()=>{var R,Z;if(!f.value)return;const ue=(Z=(R=f.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text")){const pe=Number(ue.fontSize)||24;x.value=Math.max(1,Math.min(pe,300)),ue.fill&&(I.value=ue.fill)}};ae(async()=>{var ue,R,Z,pe;o.initTheme(),h.value=((pe=(Z=(R=(ue=t.itemInfo)==null?void 0:ue.menu)==null?void 0:R.pages)==null?void 0:Z[0])==null?void 0:pe.page_id)||"",await ct(),await m(),l.value&&setTimeout(async()=>{d($.value,Ue),D($.value,r.value,_.value,S.value,v.value,y.value);const $e=P();$e&&(L.value=$e,N($e.width,$e.height)),fe(),f.value&&(f.value.on("selection:created",ke),f.value.on("selection:updated",ke),f.value.on("mouse:down",he)),window.addEventListener("keydown",Ie),window.addEventListener("keyup",Me),await se()},0)});const he=ue=>{if($.value||!f.value)return;const R=ue==null?void 0:ue.e,Z=f.value.getPointer(R);if(M.value){ge(f.value,M.value,Z.x,Z.y,v.value,y.value,Ue);return}if(!S.value)return;const pe=window.fabric,$e=new pe.Textbox("",{left:Z.x,top:Z.y,width:300,fontSize:x.value,fill:I.value,editable:!0,splitByGrapheme:!0,cornerStyle:"circle",transparentCorners:!1});f.value.add($e),f.value.setActiveObject($e),f.value.requestRenderAll();try{$e.enterEditing(),$e.selectionStart=0,$e.selectionEnd=0}catch{}$e.on("editing:exited",()=>{S.value=!1,r.value=!1,_.value=!1,D($.value,r.value,_.value,S.value,v.value,y.value);try{f.value&&(f.value.setCursor("default"),f.value.requestRenderAll())}catch{}Ue()}),Ue()},Ie=ue=>{if(ue.code==="Delete"||ue.code==="Backspace"){if(S.value)return;E()}},Me=ue=>{},Oe=()=>{var R,Z;if(!f.value)return;const ue=(Z=(R=f.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text"))try{ue.set("fontSize",x.value),f.value.requestRenderAll(),Ue()}catch{}},mt=()=>{var R,Z;if(!f.value)return;const ue=(Z=(R=f.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text"))try{ue.set("fill",I.value),f.value.requestRenderAll(),Ue()}catch{}},_t=()=>{M.value="rect",r.value=!1,_.value=!1,S.value=!1,D($.value,r.value,_.value,S.value,v.value,y.value);try{f.value&&f.value.setCursor("crosshair")}catch{}},pt=()=>{M.value="circle",r.value=!1,_.value=!1,S.value=!1,D($.value,r.value,_.value,S.value,v.value,y.value);try{f.value&&f.value.setCursor("crosshair")}catch{}},Ut=()=>{M.value="triangle",r.value=!1,_.value=!1,S.value=!1,D($.value,r.value,_.value,S.value,v.value,y.value);try{f.value&&f.value.setCursor("crosshair")}catch{}},Pt=()=>{M.value="arrow",r.value=!1,_.value=!1,S.value=!1,D($.value,r.value,_.value,S.value,v.value,y.value);try{f.value&&f.value.setCursor("crosshair")}catch{}};return Xe(()=>{if(window.removeEventListener("keydown",Ie),window.removeEventListener("keyup",Me),f.value)try{f.value.off("mouse:down",he),f.value.off("selection:created",ke),f.value.off("selection:updated",ke),f.value.dispose()}catch{}}),(ue,R)=>{const Z=H("a-tooltip");return C(),V("div",{id:"whiteboard-item",class:re({fullscreen:n.value}),onKeydown:[Fe(lt(_e,["ctrl","prevent"]),["83"]),Fe(lt(_e,["meta","prevent"]),["83"])]},[n.value?F("",!0):(C(),V("div",aS,[s(Vt,{itemInfo:c.itemInfo},{right:u(()=>[s(f7,{itemInfo:c.itemInfo,pageId:h.value,onSave:_e,onExportImage:z(ye),onClearCanvas:z(je)},null,8,["itemInfo","pageId","onExportImage","onClearCanvas"])]),_:1},8,["itemInfo"])])),s(G7,{isReadOnly:$.value,isVisitor:g.value,brushColor:v.value,brushWidth:y.value,isDrawing:r.value,isErasing:_.value,isInsertingText:S.value,pendingShapeType:M.value,textFontSize:x.value,textColor:I.value,fontSizeOptions:T,isFullscreen:n.value,"onUpdate:brushColor":R[0]||(R[0]=pe=>v.value=pe),"onUpdate:brushWidth":R[1]||(R[1]=pe=>y.value=pe),"onUpdate:textFontSize":R[2]||(R[2]=pe=>x.value=pe),"onUpdate:textColor":R[3]||(R[3]=pe=>I.value=pe),onToggleDrawing:be,onToggleEraser:Te,onToggleTextInsert:we,onInsertRect:_t,onInsertCircle:pt,onInsertTriangle:Ut,onInsertArrow:Pt,onUndo:z(Ye),onRedo:z(Ke),onClearCanvas:z(je),onExportImage:z(ye),onExportSvg:z(ze),onExportJson:z(Ve),onImportImage:z(Ze),onImportJson:z(De),onZoomOut:z(W),onZoomIn:z(ee),onFitToViewport:z(A),onZoomReset:z(ce),onToggleFullscreen:le,onApplyBrush:z(D),onApplyTextFontSize:Oe,onApplyTextColor:mt},null,8,["isReadOnly","isVisitor","brushColor","brushWidth","isDrawing","isErasing","isInsertingText","pendingShapeType","textFontSize","textColor","isFullscreen","onUndo","onRedo","onClearCanvas","onExportImage","onExportSvg","onExportJson","onImportImage","onImportJson","onZoomOut","onZoomIn","onFitToViewport","onZoomReset","onApplyBrush"]),e("div",oS,[e("div",sS,[R[5]||(R[5]=e("canvas",{id:"whiteboard-canvas"},null,-1)),$.value?F("",!0):(C(),B(Z,{key:0,title:ue.$t("item.whiteboard_drag_resize")||"拖动调整尺寸",placement:"top"},{default:u(()=>[e("div",{class:"resize-handle",onMousedown:R[4]||(R[4]=lt((...pe)=>z(U)&&z(U)(...pe),["prevent"]))},null,32)]),_:1},8,["title"]))])])],42,tS)}}});const nS=Y(lS,[["__scopeId","data-v-8eade7bf"]]),iS={class:"item-show-container"},rS={key:5,class:"loading-container"},cS=J({__name:"Index",setup(c){const t=Ge(),a=xe(),o=Qe(),l=b(!1),m=b(null),f=b(""),d=b(1),p=q(()=>{if(!m.value)return!1;const y=m.value.item_type;return y==1||y==3||y==0||y=="0"}),h=async(y="")=>{l.value=!0;const S=t.params.item_id||0,x=t.params.page_id||t.query.page_id||0;try{const I={item_id:S,keyword:y};y||(I.default_page_id=x);const T=await X("/api/item/info",I,"post",!1);if(l.value=!1,T.error_code===0){const M=T.data;if(M.default_page_id<=0)if(M.item_type==1&&M.menu){const L=$(M.menu);L&&(M.default_page_id=L)}else M.menu&&M.menu.pages&&M.menu.pages[0]&&(M.default_page_id=M.menu.pages[0].page_id);M.item_type==3&&(M.item_manage=!1,M.item_edit=!1),m.value=M,d.value=d.value+1,document.title=M.item_name+"--ShowDoc",M.show_watermark>0&&k()}else T.error_code===10307||T.error_code===10303?a.replace({path:"/item/password/"+S,query:{page_id:x,redirect:a.currentRoute.value.fullPath}}):T.error_code===10312?a.replace({path:"/user/login/",query:{redirect:a.currentRoute.value.fullPath}}):T.error_code===10104?a.replace({path:"/captcha/index",query:{item_id:S,type:"visit_item",redirect:a.currentRoute.value.fullPath}}):G(T.error_message)}catch(I){l.value=!1,console.error("获取项目信息失败:",I)}},$=y=>{if(!y)return null;if(y.pages&&y.pages.length>0&&y.pages[0])return y.pages[0].page_id;if(!y.catalogs||y.catalogs.length===0)return null;const S=x=>{if(!x||x.length===0)return null;for(const I of x){if(I.pages&&I.pages.length>0&&I.pages[0])return I.pages[0].page_id;if(I.catalogs&&I.catalogs.length>0){const T=S(I.catalogs);if(T)return T}}return null};return S(y.catalogs)},g=y=>{f.value=y,m.value=null,h(y)},n=()=>{h(f.value)},w=y=>{const S=y.getFullYear(),x=String(y.getMonth()+1).padStart(2,"0"),I=String(y.getDate()).padStart(2,"0");return`${S}/${x}/${I}`},k=async()=>{if(o.loadUserInfo(),o.userInfo&&o.userInfo.username)r(o.userInfo);else try{await o.fetchUserInfo(),o.userInfo&&o.userInfo.username&&r(o.userInfo)}catch(y){console.error("获取用户信息失败，无法显示水印:",y)}},r=y=>{let S=y.username+"，"+w(new Date);y.name&&(S+="，"+y.name),setTimeout(()=>{_(S)},500)},_=y=>{v();const S=document.createElement("div");S.id="watermark-container",Object.assign(S.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none",zIndex:"9999999",overflow:"hidden"});const x=document.createElement("canvas"),I=x.getContext("2d");if(!I)return;const T=200,M=120;x.width=T,x.height=M,I.save(),I.translate(T/2,M/2),I.rotate(-30*Math.PI/180),I.font="14px Arial",I.fillStyle="rgba(0, 0, 0, 0.05)",I.textAlign="center",I.textBaseline="middle",I.fillText(y,0,0),I.restore();const L=x.toDataURL("image/png");Object.assign(S.style,{backgroundImage:`url(${L})`,backgroundRepeat:"repeat"}),document.body.appendChild(S);const P=new MutationObserver(()=>{document.getElementById("watermark-container")||document.body.appendChild(S)});P.observe(document.body,{childList:!0,subtree:!0}),S.observer=P},v=()=>{const y=document.getElementById("watermark-container");if(y){const S=y.observer;S&&S.disconnect(),y.remove()}};return qe(()=>t.params.item_id,()=>{h()}),ae(()=>{h()}),Xe(()=>{v(),document.title="ShowDoc"}),(y,S)=>{const x=H("a-spin");return C(),V("div",iS,[m.value&&p.value?(C(),B(A4,{key:d.value,"item-info":m.value,"search-keyword":f.value,onSearch:g,onReloadItem:n},null,8,["item-info","search-keyword"])):F("",!0),m.value&&m.value.item_type==2?(C(),B(l7,{key:d.value,"item-info":m.value},null,8,["item-info"])):F("",!0),m.value&&m.value.item_type==4?(C(),B(m7,{key:d.value,"item-info":m.value},null,8,["item-info"])):F("",!0),m.value&&m.value.item_type==5?(C(),B(nS,{key:d.value,"item-info":m.value},null,8,["item-info"])):F("",!0),m.value&&m.value.is_login?(C(),B(Na,{key:4,popup:!0})):F("",!0),l.value?(C(),V("div",rS,[s(x,{spinning:l.value,size:"large"},null,8,["spinning"])])):F("",!0)])}}});const dS=Y(cS,[["__scopeId","data-v-a4c35b2f"]]),FS=Object.freeze(Object.defineProperty({__proto__:null,default:dS},Symbol.toStringTag,{value:"Module"}));export{hS as I,gS as L,zS as M,yS as R,kS as S,$S as V,wS as a,bS as b,CS as c,xS as d,IS as e,SS as f,TS as g,MS as h,LS as i,VS as j,US as k,PS as l,AS as m,DS as n,OS as o,NS as p,FS as q};
