var Ya=Object.defineProperty;var Xa=(c,t,a)=>t in c?Ya(c,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[t]=a;var ia=(c,t,a)=>(Xa(c,typeof t!="symbol"?t+"":t,a),a);import{d as W,r as H,o as C,c as L,a as e,f as s,w as m,z as O,t as i,u as z,k as B,l as b,m as oe,b as F,g as q,j as ra,R as Ee,G as xe,s as te,S as ca,U as Dt,V as Qa,W as Za,X as eo,Y as to,Z as ao,_ as Ge,$ as Fe,n as re,F as Ce,h as Pe,J as j,i as lt,E as Xe,A as qe,q as ft,v as ga,a0 as We,a1 as oo,y as qt,B as ct,a2 as Be,a3 as so,e as lo,a4 as da,a5 as no,p as ya,a6 as io}from"./vendor-vue-f1f9849c.js";import{b as Qe,r as X,u as He,i as ot,j as dt,c as ve,d as me,k as ro,l as co,m as uo,s as mo,n as _o,_ as po,o as fo,p as jt,q as wa,t as Bt,v as ba,w as kt,x as Gt,y as Kt,z as xt,A as nt,B as $a,C as Jt,D as ka,E as Rt,F as Wt,G as Ca,H as xa,I as Yt,J as Ht,K as vo,L as Xt,M as Ia,N as ho,O as go,P as Sa,Q as Ta,R as Ma,S as La,T as yo,U as wo,V as bo,W as $o,X as ko,Y as Co,Z as xo,$ as Va,a0 as za,a1 as Ua,a2 as Pa,a3 as Io,a4 as Qt,a5 as So,a6 as To,a7 as Mo,a8 as Lo,a9 as Vo,aa as ua,ab as zo,ac as Zt,ad as Uo,ae as Po,af as Ao,ag as Do,ah as It,ai as Oo,aj as No,ak as Fo,al as Aa,am as qo,an as Ro,ao as Ho,ap as Eo,aq as jo,ar as Bo,as as Go,at as Ko,au as Jo,av as Wo,aw as Yo,ax as st,ay as Xo,az as Qo,aA as Zo,aB as es,aC as ts,aD as as,aE as os,aF as ss,aG as ls,aH as ns,aI as is,aJ as ma,aK as rs,aL as _a,aM as cs,aN as ds,aO as us,aP as ms,aQ as _s,aR as ps,aS as Da,h as Et,aT as fs}from"./core-31cf74c4.js";import{L as ht,T as ea,_ as Y,C as ta,A as G,a as ne,b as K,c as Se,M as ie,d as de,P as it,e as Le,f as Re,S as Oa,g as Je,h as ut,i as Ot,j as vs,k as Na,l as tt,m as vt,n as Ct,E as St,o as hs,p as aa,q as gs,r as ys,s as ws}from"./components-bd088a2a.js";import{_ as Tt}from"./assets-123e6eb8.js";import{S as Fa,ax as qa}from"./vendor-8fa27e24.js";const bs=""+new URL("../imgs/case-logo/tencent.png",import.meta.url).href,$s=""+new URL("../imgs/case-logo/huawei_logo.png",import.meta.url).href,ks=""+new URL("../imgs/case-logo/baidu.png",import.meta.url).href,Cs=""+new URL("../imgs/case-logo/jingdong.png",import.meta.url).href,xs=""+new URL("../imgs/case-logo/zijie.png",import.meta.url).href,Is=""+new URL("../imgs/case-logo/shunfeng.png",import.meta.url).href,Ss={class:"landing-header"},Ts={class:"header-content"},Ms={class:"nav"},Ls={href:"https://www.showdoc.com.cn/clients",target:"_blank"},Vs={class:"toggle-group"},zs=W({__name:"LandingHeader",setup(c){const t=Qe();return(a,o)=>{const l=H("router-link");return C(),L("header",Ss,[e("div",Ts,[o[1]||(o[1]=e("a",{href:"/",class:"logo"},[e("span",{class:"logo-text"},"ShowDoc")],-1)),e("nav",Ms,[s(l,{to:"/"},{default:m(()=>[O(i(a.$t("index.home")||"首页"),1)]),_:1}),e("a",Ls,i(a.$t("index.clients")||"客户端"),1),o[0]||(o[0]=e("div",{class:"nav-separator"},null,-1)),e("div",Vs,[s(ht),s(ea)]),z(t).isLoggedIn?(C(),B(l,{key:1,to:"/item/index",class:"btn-primary"},{default:m(()=>[O(i(a.$t("index.my_item")),1)]),_:1})):(C(),B(l,{key:0,to:"/user/login"},{default:m(()=>[O(i(a.$t("index.login_or_register")),1)]),_:1}))])])])}}});const Us=Y(zs,[["__scopeId","data-v-ffcc94ed"]]),Ps={class:"landing-footer"},As={class:"footer-content"},Ds={class:"footer-section"},Os={class:"footer-section"},Ns={href:"https://github.com/star7th/showdoc",target:"_blank"},Fs={class:"footer-bottom"},qs={key:0,href:"https://beian.miit.gov.cn/",target:"_blank"},Rs=W({__name:"LandingFooter",setup(c){const t=b("");return oe(async()=>{try{const a=await X("/api/common/homePageSetting",{},"post",!1);a&&a.data&&a.data.beian&&(t.value=a.data.beian)}catch(a){console.error("Failed to load home page setting:",a)}}),(a,o)=>(C(),L("footer",Ps,[e("div",As,[e("div",Ds,[o[0]||(o[0]=e("h4",null,"ShowDoc",-1)),e("p",null,i(a.$t("index.footer_slogan")||"让文档协作更简单"),1)]),e("div",Os,[e("h4",null,i(a.$t("index.about_us")||"关于我们"),1),e("a",Ns,i(a.$t("index.about")||"关于"),1)])]),e("div",Fs,[o[1]||(o[1]=e("span",null,[O("本站基于开源项目"),e("a",{href:"https://github.com/star7th/showdoc",target:"_blank"},"showdoc"),O("构建")],-1)),t.value?(C(),L("a",qs,i(t.value),1)):F("",!0)])]))}});const Hs=Y(Rs,[["__scopeId","data-v-103cb343"]]),Es={class:"hero-illustration"},js={viewBox:"0 0 700 500",xmlns:"http://www.w3.org/2000/svg"},Bs={id:"heroGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Gs={id:"heroShadow"},Ks=["flood-color"],Js={id:"gridPattern",x:"0",y:"0",width:"40",height:"40",patternUnits:"userSpaceOnUse"},Ws=["fill"],Ys=["fill"],Xs=["fill"],Qs=["fill"],Zs={class:"code-editor",filter:"url(#heroShadow)"},el=["fill","stroke"],tl=["fill"],al=["fill"],ol={class:"code-content"},sl=["fill"],ll=["fill"],nl=["fill"],il=["fill"],rl=["fill"],cl=["fill"],dl=["fill"],ul=["fill"],ml=["fill"],_l={class:"method-badge"},pl=["fill"],fl={class:"method-badge"},vl=["fill"],hl=["fill"],gl=["fill"],yl=["fill"],wl=["fill"],bl={class:"main-document",filter:"url(#heroShadow)"},$l=["fill","stroke"],kl=["fill"],Cl=["fill"],xl=["fill"],Il={class:"api-item"},Sl=["fill","stroke"],Tl=["fill"],Ml=["fill"],Ll=["fill"],Vl=["fill"],zl=["fill"],Ul={class:"api-item"},Pl=["fill","stroke"],Al=["fill"],Dl=["fill"],Ol=["fill"],Nl=["fill"],Fl=["fill"],ql={class:"api-item"},Rl=["fill","stroke"],Hl=["fill"],El=["fill"],jl=["fill"],Bl=["fill"],Gl=["fill"],Kl={class:"stats-bar"},Jl=["fill"],Wl=["fill"],Yl={transform:"translate(390, 382)"},Xl=["fill"],Ql=["fill"],Zl=["fill"],en=["fill"],tn=["fill"],an=["fill"],on={class:"mobile-preview float-device-1"},sn=["fill","stroke"],ln=["fill"],nn=["fill"],rn=["fill"],cn=["fill"],dn=["fill"],un=["fill"],mn={class:"browser-preview float-device-2"},_n=["fill","stroke"],pn=["fill"],fn=["fill"],vn=["fill"],hn=["fill"],gn=["fill"],yn=["fill"],wn={class:"team-avatars"},bn={class:"avatar float-avatar-1",transform:"translate(570, 80)"},$n=["fill"],kn=["fill"],Cn={class:"avatar float-avatar-2",transform:"translate(620, 100)"},xn=["fill"],In=["fill"],Sn={class:"avatar float-avatar-3",transform:"translate(655, 65)"},Tn=["fill"],Mn=["fill"],Ln={class:"data-flow"},Vn=["stroke"],zn=["stroke"],Un=["stroke"],Pn={class:"data-packet-1",filter:"url(#glow)"},An=["fill"],Dn={class:"data-packet-2",filter:"url(#glow)"},On=["fill"],Nn={class:"data-packet-3",filter:"url(#glow)"},Fn=["fill"],qn=["stroke"],Rn=["fill"],Hn={class:"float-tag float-tag-1"},En=["fill","stroke"],jn=["fill"],Bn={class:"float-tag float-tag-2"},Gn=["fill","stroke"],Kn=["fill"],Jn={class:"float-tag float-tag-3"},Wn=["fill","stroke"],Yn=["fill"],Xn=["fill"],Qn=W({__name:"HeroIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#4a9eff":"#007bff"),l=q(()=>a.value?"#46c93a":"#28a745"),u=q(()=>a.value?"#ffa940":"#fd7e14"),v=q(()=>a.value?"#1e1e1e":"#ffffff"),d=q(()=>a.value?"#1e1e1e":"#282c34"),p=q(()=>a.value?"#2d2d30":"#21252b"),f=q(()=>a.value?"#252525":"#f8f9fa"),$=q(()=>a.value?"#2d2d2d":"#ffffff"),g=q(()=>a.value?"#000000":"#f5f5f5"),n=q(()=>a.value?"#e0e0e0":"#2c3e50"),y=q(()=>a.value?"#8b949e":"#6c757d"),k=q(()=>a.value?"rgba(255, 255, 255, 0.15)":"rgba(0, 0, 0, 0.1)"),r=q(()=>(a.value,"#000000")),_=q(()=>a.value?"#4a9eff":"#007bff");return(h,w)=>(C(),L("div",Es,[(C(),L("svg",js,[e("defs",null,[e("linearGradient",Bs,[e("stop",{offset:"0%",style:ra(`stop-color:${o.value};stop-opacity:1`)},null,4),e("stop",{offset:"100%",style:ra(`stop-color:${l.value};stop-opacity:1`)},null,4)]),w[0]||(w[0]=e("filter",{id:"glow"},[e("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),e("feMerge",null,[e("feMergeNode",{in:"coloredBlur"}),e("feMergeNode",{in:"SourceGraphic"})])],-1)),e("filter",Gs,[e("feDropShadow",{dx:"0",dy:"8",stdDeviation:"12","flood-color":r.value,"flood-opacity":"0.3"},null,8,Ks)]),e("pattern",Js,[e("circle",{cx:"2",cy:"2",r:"1.5",fill:_.value,opacity:"0.3"},null,8,Ws)]),w[1]||(w[1]=e("linearGradient",{id:"codeGlow",x1:"0%",y1:"0%",x2:"100%",y2:"0%"},[e("stop",{offset:"0%",style:{"stop-color":"#28a745","stop-opacity":"0"}}),e("stop",{offset:"50%",style:{"stop-color":"#28a745","stop-opacity":"0.8"}}),e("stop",{offset:"100%",style:{"stop-color":"#28a745","stop-opacity":"0"}})],-1))]),w[30]||(w[30]=e("rect",{x:"0",y:"0",width:"700",height:"500",fill:"url(#gridPattern)",opacity:"0.4"},null,-1)),e("circle",{cx:"550",cy:"100",r:"180",fill:o.value,opacity:"0.05",class:"bg-circle-1"},null,8,Ys),e("circle",{cx:"120",cy:"400",r:"150",fill:l.value,opacity:"0.05",class:"bg-circle-2"},null,8,Xs),e("circle",{cx:"650",cy:"450",r:"100",fill:u.value,opacity:"0.05",class:"bg-circle-3"},null,8,Qs),e("g",Zs,[e("rect",{x:"30",y:"120",width:"220",height:"280",rx:"16",fill:d.value,stroke:k.value,"stroke-width":"2"},null,8,el),e("rect",{x:"30",y:"120",width:"220",height:"35",rx:"16",fill:p.value},null,8,tl),e("rect",{x:"30",y:"140",width:"220",height:"16",fill:p.value},null,8,al),w[10]||(w[10]=e("circle",{cx:"48",cy:"137",r:"5",fill:"#ff5f57"},null,-1)),w[11]||(w[11]=e("circle",{cx:"65",cy:"137",r:"5",fill:"#ffbd2e"},null,-1)),w[12]||(w[12]=e("circle",{cx:"82",cy:"137",r:"5",fill:"#28c840"},null,-1)),e("g",ol,[w[4]||(w[4]=e("text",{x:"45",y:"180","font-size":"10",fill:"#6c757d","font-family":"Monaco, monospace"},"// API Definition",-1)),w[5]||(w[5]=e("rect",{x:"40",y:"190",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-1"},null,-1)),e("text",{x:"45",y:"200","font-size":"11",fill:l.value,"font-family":"Monaco, monospace","font-weight":"600"},"function",8,sl),e("text",{x:"100",y:"200","font-size":"11",fill:n.value,"font-family":"Monaco, monospace"}," getUserInfo()",8,ll),e("text",{x:"45",y:"220","font-size":"10",fill:y.value,"font-family":"Monaco, monospace"},"{",8,nl),w[6]||(w[6]=e("rect",{x:"40",y:"228",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-2"},null,-1)),e("text",{x:"60",y:"238","font-size":"10",fill:u.value,"font-family":"Monaco, monospace"},"const",8,il),e("text",{x:"95",y:"238","font-size":"10",fill:n.value,"font-family":"Monaco, monospace"}," url =",8,rl),w[7]||(w[7]=e("text",{x:"130",y:"238","font-size":"10",fill:"#28a745","font-family":"Monaco, monospace"},"'/api/user'",-1)),w[8]||(w[8]=e("rect",{x:"40",y:"248",width:"190",height:"16",fill:"url(#codeGlow)",opacity:"0",class:"code-highlight-3"},null,-1)),e("text",{x:"60",y:"258","font-size":"10",fill:u.value,"font-family":"Monaco, monospace"},"return",8,cl),e("text",{x:"105",y:"258","font-size":"10",fill:o.value,"font-family":"Monaco, monospace"}," fetch",8,dl),e("text",{x:"140",y:"258","font-size":"10",fill:n.value,"font-family":"Monaco, monospace"},"(url)",8,ul),e("text",{x:"45",y:"278","font-size":"10",fill:y.value,"font-family":"Monaco, monospace"},"}",8,ml),w[9]||(w[9]=e("text",{x:"45",y:"300","font-size":"9",fill:"#6c757d","font-family":"Monaco, monospace"},"@swagger",-1)),e("g",_l,[e("rect",{x:"45",y:"315",width:"40",height:"20",rx:"6",fill:l.value},null,8,pl),w[2]||(w[2]=e("text",{x:"65",y:"329","font-size":"10",fill:"white","text-anchor":"middle","font-weight":"bold"},"GET",-1))]),e("g",fl,[e("rect",{x:"92",y:"315",width:"45",height:"20",rx:"6",fill:o.value},null,8,vl),w[3]||(w[3]=e("text",{x:"114",y:"329","font-size":"10",fill:"white","text-anchor":"middle","font-weight":"bold"},"POST",-1))]),e("rect",{x:"170",y:"252",width:"2",height:"12",fill:o.value,class:"cursor-blink"},null,8,hl)]),e("rect",{x:"30",y:"385",width:"220",height:"15",fill:p.value},null,8,gl),e("text",{x:"40",y:"396","font-size":"8",fill:y.value},"main.js",8,yl),e("text",{x:"200",y:"396","font-size":"8",fill:l.value,"text-anchor":"end"},"✓ Saved",8,wl)]),e("g",bl,[e("rect",{x:"280",y:"80",width:"260",height:"340",rx:"20",fill:v.value,stroke:k.value,"stroke-width":"3",class:"doc-pulse"},null,8,$l),w[15]||(w[15]=e("rect",{x:"280",y:"80",width:"260",height:"45",rx:"20",fill:"url(#heroGradient)",opacity:"0.12"},null,-1)),w[16]||(w[16]=e("rect",{x:"280",y:"110",width:"260",height:"16",fill:"url(#heroGradient)",opacity:"0.08"},null,-1)),w[17]||(w[17]=e("text",{x:"420",y:"108","font-size":"18",fill:"url(#heroGradient)","text-anchor":"middle","font-weight":"bold"},"ShowDoc",-1)),e("rect",{x:"295",y:"140",width:"230",height:"35",rx:"10",fill:f.value},null,8,kl),e("text",{x:"310",y:"163","font-size":"14",fill:n.value,"font-weight":"600"},"User Management API Docs",8,Cl),e("circle",{cx:"500",cy:"157",r:"4",fill:l.value,class:"status-dot"},null,8,xl),e("g",Il,[e("rect",{x:"295",y:"190",width:"230",height:"40",rx:"8",fill:f.value,stroke:k.value,"stroke-width":"1"},null,8,Sl),e("rect",{x:"305",y:"200",width:"40",height:"20",rx:"5",fill:l.value,opacity:"0.15"},null,8,Tl),e("text",{x:"325",y:"214","font-size":"10",fill:l.value,"text-anchor":"middle","font-weight":"bold"},"GET",8,Ml),e("text",{x:"355",y:"210","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users",8,Ll),e("text",{x:"355",y:"223","font-size":"9",fill:y.value},"Get Users List",8,Vl),e("circle",{cx:"508",cy:"210",r:"3",fill:l.value},null,8,zl)]),e("g",Ul,[e("rect",{x:"295",y:"240",width:"230",height:"40",rx:"8",fill:f.value,stroke:k.value,"stroke-width":"1"},null,8,Pl),e("rect",{x:"305",y:"250",width:"45",height:"20",rx:"5",fill:o.value,opacity:"0.15"},null,8,Al),e("text",{x:"327",y:"264","font-size":"10",fill:o.value,"text-anchor":"middle","font-weight":"bold"},"POST",8,Dl),e("text",{x:"360",y:"260","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users",8,Ol),e("text",{x:"360",y:"273","font-size":"9",fill:y.value},"Create User",8,Nl),e("circle",{cx:"508",cy:"260",r:"3",fill:o.value},null,8,Fl)]),e("g",ql,[e("rect",{x:"295",y:"290",width:"230",height:"40",rx:"8",fill:f.value,stroke:k.value,"stroke-width":"1"},null,8,Rl),e("rect",{x:"305",y:"300",width:"40",height:"20",rx:"5",fill:u.value,opacity:"0.15"},null,8,Hl),e("text",{x:"325",y:"314","font-size":"10",fill:u.value,"text-anchor":"middle","font-weight":"bold"},"PUT",8,El),e("text",{x:"355",y:"310","font-size":"11",fill:n.value,"font-weight":"500"},"/api/users/:id",8,jl),e("text",{x:"355",y:"323","font-size":"9",fill:y.value},"Update User",8,Bl),e("circle",{cx:"508",cy:"310",r:"3",fill:u.value},null,8,Gl)]),e("g",Kl,[w[13]||(w[13]=e("rect",{x:"295",y:"350",width:"230",height:"55",rx:"10",fill:"url(#heroGradient)",opacity:"0.08"},null,-1)),e("text",{x:"310",y:"370","font-size":"10",fill:y.value},"Total APIs",8,Jl),w[14]||(w[14]=e("text",{x:"310",y:"390","font-size":"20",fill:"url(#heroGradient)","font-weight":"bold"},"24",-1)),e("text",{x:"390",y:"368","font-size":"10",fill:y.value},"Team Members",8,Wl),e("g",Yl,[e("circle",{cx:"0",cy:"0",r:"8",fill:o.value},null,8,Xl),e("circle",{cx:"14",cy:"0",r:"8",fill:l.value},null,8,Ql),e("circle",{cx:"28",cy:"0",r:"8",fill:u.value},null,8,Zl),e("text",{x:"42",y:"4","font-size":"12",fill:n.value,"font-weight":"600"},"+5",8,en)]),e("circle",{cx:"500",cy:"380",r:"5",fill:l.value,class:"pulse-dot"},null,8,tn),e("text",{x:"510",y:"384","font-size":"9",fill:l.value},"Real-time",8,an)])]),e("g",on,[e("rect",{x:"580",y:"150",width:"90",height:"160",rx:"12",fill:$.value,stroke:k.value,"stroke-width":"2",filter:"url(#heroShadow)"},null,8,sn),e("rect",{x:"585",y:"155",width:"80",height:"140",rx:"8",fill:g.value},null,8,ln),e("rect",{x:"605",y:"158",width:"40",height:"3",rx:"2",fill:k.value},null,8,nn),w[18]||(w[18]=e("rect",{x:"590",y:"170",width:"70",height:"8",rx:"2",fill:"url(#heroGradient)",opacity:"0.3"},null,-1)),e("rect",{x:"590",y:"185",width:"60",height:"4",rx:"2",fill:y.value,opacity:"0.3"},null,8,rn),e("rect",{x:"590",y:"193",width:"65",height:"4",rx:"2",fill:y.value,opacity:"0.3"},null,8,cn),e("rect",{x:"590",y:"210",width:"70",height:"30",rx:"6",fill:f.value},null,8,dn),e("circle",{cx:"605",cy:"225",r:"8",fill:l.value,opacity:"0.2"},null,8,un)]),e("g",mn,[e("rect",{x:"565",y:"280",width:"120",height:"100",rx:"10",fill:$.value,stroke:k.value,"stroke-width":"2",filter:"url(#heroShadow)"},null,8,_n),e("rect",{x:"565",y:"280",width:"120",height:"18",rx:"10",fill:p.value},null,8,pn),e("rect",{x:"565",y:"293",width:"120",height:"6",fill:p.value},null,8,fn),w[19]||(w[19]=e("circle",{cx:"575",cy:"289",r:"3",fill:"#ff5f57"},null,-1)),w[20]||(w[20]=e("circle",{cx:"585",cy:"289",r:"3",fill:"#ffbd2e"},null,-1)),w[21]||(w[21]=e("circle",{cx:"595",cy:"289",r:"3",fill:"#28c840"},null,-1)),w[22]||(w[22]=e("rect",{x:"572",y:"305",width:"106",height:"10",rx:"3",fill:"url(#heroGradient)",opacity:"0.2"},null,-1)),e("rect",{x:"572",y:"322",width:"90",height:"6",rx:"2",fill:y.value,opacity:"0.3"},null,8,vn),e("rect",{x:"572",y:"332",width:"95",height:"6",rx:"2",fill:y.value,opacity:"0.3"},null,8,hn),e("rect",{x:"572",y:"345",width:"50",height:"20",rx:"5",fill:l.value,opacity:"0.2"},null,8,gn),e("text",{x:"597",y:"359","font-size":"10",fill:l.value,"text-anchor":"middle","font-weight":"600"},"200",8,yn)]),e("g",wn,[e("g",bn,[e("circle",{r:"22",fill:o.value,opacity:"0.2",filter:"url(#glow)"},null,8,$n),e("circle",{r:"18",fill:o.value},null,8,kn),w[23]||(w[23]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"A",-1))]),e("g",Cn,[e("circle",{r:"22",fill:l.value,opacity:"0.2",filter:"url(#glow)"},null,8,xn),e("circle",{r:"18",fill:l.value},null,8,In),w[24]||(w[24]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"B",-1))]),e("g",Sn,[e("circle",{r:"22",fill:u.value,opacity:"0.2",filter:"url(#glow)"},null,8,Tn),e("circle",{r:"18",fill:u.value},null,8,Mn),w[25]||(w[25]=e("text",{y:"6","font-size":"14",fill:"white","text-anchor":"middle","font-weight":"bold"},"C",-1))])]),e("g",Ln,[e("path",{d:"M 250 250 Q 265 240 280 240",stroke:o.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,Vn),e("path",{d:"M 540 240 Q 555 200 580 180",stroke:l.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,zn),e("path",{d:"M 540 300 Q 555 310 570 320",stroke:u.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.4",class:"flow-line"},null,8,Un),e("g",Pn,[e("circle",{r:"4",fill:o.value},[...w[26]||(w[26]=[e("animateMotion",{dur:"2.5s",repeatCount:"indefinite",path:"M 250 250 Q 265 240 280 240"},null,-1)])],8,An)]),e("g",Dn,[e("circle",{r:"4",fill:l.value},[...w[27]||(w[27]=[e("animateMotion",{dur:"2.8s",repeatCount:"indefinite",path:"M 540 240 Q 555 200 580 180"},null,-1)])],8,On)]),e("g",Nn,[e("circle",{r:"4",fill:u.value},[...w[28]||(w[28]=[e("animateMotion",{dur:"3s",repeatCount:"indefinite",path:"M 540 300 Q 555 310 570 320"},null,-1)])],8,Fn)]),e("path",{d:"M 520 150 Q 545 130 570 105",stroke:o.value,"stroke-width":"2","stroke-dasharray":"4 4",opacity:"0.3"},null,8,qn),e("circle",{r:"3",fill:o.value,opacity:"0.8"},[...w[29]||(w[29]=[e("animateMotion",{dur:"2s",repeatCount:"indefinite",path:"M 520 150 Q 545 130 570 105"},null,-1)])],8,Rn)]),e("g",Hn,[e("rect",{x:"70",y:"50",width:"60",height:"28",rx:"14",fill:o.value,opacity:"0.15",stroke:o.value,"stroke-width":"1.5"},null,8,En),e("text",{x:"100",y:"68","font-size":"11",fill:o.value,"text-anchor":"middle","font-weight":"600"},"API",8,jn)]),e("g",Bn,[e("rect",{x:"30",y:"420",width:"80",height:"28",rx:"14",fill:l.value,opacity:"0.15",stroke:l.value,"stroke-width":"1.5"},null,8,Gn),e("text",{x:"70",y:"438","font-size":"11",fill:l.value,"text-anchor":"middle","font-weight":"600"},"Markdown",8,Kn)]),e("g",Jn,[e("rect",{x:"600",y:"410",width:"80",height:"28",rx:"14",fill:u.value,opacity:"0.15",stroke:u.value,"stroke-width":"1.5"},null,8,Wn),e("circle",{cx:"615",cy:"424",r:"4",fill:u.value,class:"pulse-dot-2"},null,8,Yn),e("text",{x:"650",y:"428","font-size":"11",fill:u.value,"text-anchor":"middle","font-weight":"600"},"Real-time",8,Xn)])]))]))}});const Zn=Y(Qn,[["__scopeId","data-v-30a4bb36"]]),ei={class:"api-illustration"},ti={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},ai=["fill"],oi=["fill"],si={class:"api-request",filter:"url(#apiShadow)"},li=["fill","stroke"],ni=["fill"],ii=["fill","stroke"],ri=["fill"],ci={class:"params-table"},di=["fill"],ui=["fill","stroke"],mi=["fill"],_i=["fill"],pi=["fill","stroke"],fi=["fill"],vi=["fill"],hi=["fill"],gi={class:"api-document",filter:"url(#apiShadow)"},yi=["fill","stroke"],wi=["fill"],bi=["fill"],$i=["fill"],ki=["fill"],Ci=["fill"],xi=["fill"],Ii={class:"copy-icon"},Si=["stroke"],Ti=["fill","stroke"],Mi=["stroke"],Li={id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto"},Vi=["fill"],zi={class:"float-icons"},Ui=["fill","stroke"],Pi=["fill","stroke"],Ai=W({__name:"ApiDocumentIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#1e1e1e":"#f8f9fa"),u=q(()=>a.value?"#252525":"#f9f9f9"),v=q(()=>a.value?"#1e1e1e":"#f5f5f5"),d=q(()=>a.value?"#2d2d2d":"#ffffff"),p=q(()=>a.value?"#e0e0e0":"#343a40"),f=q(()=>a.value?"#8b949e":"#6c757d"),$=q(()=>a.value?"#8b949e":"#6c757d"),g=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),n=q(()=>a.value?"rgba(74, 158, 255, 0.1)":"rgba(0, 123, 255, 0.1)"),y=q(()=>a.value?"#4a9eff":"#007bff");return(k,r)=>(C(),L("div",ei,[(C(),L("svg",ti,[r[7]||(r[7]=Ee('<defs data-v-5474d550><linearGradient id="apiPrimaryGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-5474d550><stop offset="0%" style="stop-color:#007bff;" data-v-5474d550></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-5474d550></stop></linearGradient><filter id="apiShadow" data-v-5474d550><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-5474d550></feGaussianBlur><feOffset dx="0" dy="3" result="offsetblur" data-v-5474d550></feOffset><feComponentTransfer data-v-5474d550><feFuncA type="linear" slope="0.15" data-v-5474d550></feFuncA></feComponentTransfer><feMerge data-v-5474d550><feMergeNode data-v-5474d550></feMergeNode><feMergeNode in="SourceGraphic" data-v-5474d550></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"480",cy:"100",r:"100",fill:n.value,opacity:"0.3"},null,8,ai),e("circle",{cx:"80",cy:"320",r:"60",fill:n.value,opacity:"0.2"},null,8,oi),e("g",si,[e("rect",{x:"50",y:"80",width:"240",height:"260",rx:"16",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,li),e("text",{x:"170",y:"110","font-size":"16",fill:p.value,"text-anchor":"middle","font-weight":"600"},"API Request",8,ni),r[0]||(r[0]=Ee('<g class="method-tags" data-v-5474d550><rect x="70" y="130" width="45" height="24" rx="6" fill="#28a745" data-v-5474d550></rect><text x="92" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>GET</text><rect x="125" y="130" width="50" height="24" rx="6" fill="#007bff" data-v-5474d550></rect><text x="150" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>POST</text><rect x="185" y="130" width="45" height="24" rx="6" fill="#fd7e14" data-v-5474d550></rect><text x="207" y="147" font-size="11" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>PUT</text><rect x="240" y="130" width="35" height="24" rx="6" fill="#dc3545" data-v-5474d550></rect><text x="257" y="147" font-size="10" fill="white" text-anchor="middle" font-weight="bold" data-v-5474d550>DEL</text></g>',1)),e("rect",{x:"70",y:"170",width:"210",height:"30",rx:"6",fill:l.value,stroke:g.value,"stroke-width":"1"},null,8,ii),e("text",{x:"80",y:"191","font-size":"11",fill:f.value,"font-family":"monospace"},"/api/users/login",8,ri),e("g",ci,[e("text",{x:"70",y:"220","font-size":"12",fill:p.value,"font-weight":"600"},"Parameters",8,di),e("rect",{x:"70",y:"230",width:"210",height:"22",fill:u.value,stroke:g.value,"stroke-width":"1"},null,8,ui),e("text",{x:"80",y:"245","font-size":"10",fill:f.value},"username",8,mi),e("text",{x:"180",y:"245","font-size":"10",fill:f.value},"string",8,_i),e("rect",{x:"70",y:"252",width:"210",height:"22",fill:o.value,stroke:g.value,"stroke-width":"1"},null,8,pi),e("text",{x:"80",y:"267","font-size":"10",fill:f.value},"password",8,fi),e("text",{x:"180",y:"267","font-size":"10",fill:f.value},"string",8,vi)]),e("rect",{x:"70",y:"290",width:"210",height:"35",rx:"6",fill:v.value},null,8,hi),r[1]||(r[1]=e("text",{x:"80",y:"307","font-size":"9",fill:"#28a745","font-family":"monospace"},"curl -X POST \\",-1)),r[2]||(r[2]=e("text",{x:"80",y:"318","font-size":"9",fill:"#007bff","font-family":"monospace"}," /api/users/login",-1))]),e("g",gi,[e("rect",{x:"320",y:"80",width:"240",height:"260",rx:"16",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,yi),e("text",{x:"440",y:"110","font-size":"16",fill:p.value,"text-anchor":"middle","font-weight":"600"},"Documentation",8,wi),e("rect",{x:"340",y:"130",width:"200",height:"10",rx:"5",fill:$.value,opacity:"0.6"},null,8,bi),e("rect",{x:"340",y:"150",width:"180",height:"8",rx:"4",fill:$.value,opacity:"0.4"},null,8,$i),e("rect",{x:"340",y:"166",width:"190",height:"8",rx:"4",fill:$.value,opacity:"0.5"},null,8,ki),e("text",{x:"340",y:"195","font-size":"12",fill:p.value,"font-weight":"600"},"Response",8,Ci),e("rect",{x:"340",y:"205",width:"200",height:"50",rx:"6",fill:v.value},null,8,xi),r[3]||(r[3]=Ee('<text x="350" y="223" font-size="9" fill="#28a745" font-family="monospace" data-v-5474d550>{</text><text x="360" y="234" font-size="9" fill="#007bff" font-family="monospace" data-v-5474d550>&quot;status&quot;: &quot;success&quot;,</text><text x="360" y="245" font-size="9" fill="#fd7e14" font-family="monospace" data-v-5474d550>&quot;token&quot;: &quot;abc123&quot;</text><text x="350" y="253" font-size="9" fill="#28a745" font-family="monospace" data-v-5474d550>}</text><rect x="340" y="270" width="60" height="22" rx="6" fill="#28a745" opacity="0.2" data-v-5474d550></rect><text x="370" y="285" font-size="11" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-5474d550>200 OK</text><rect x="410" y="270" width="60" height="22" rx="6" fill="#dc3545" opacity="0.2" data-v-5474d550></rect><text x="440" y="285" font-size="11" fill="#dc3545" text-anchor="middle" font-weight="bold" data-v-5474d550>401</text>',8)),e("g",Ii,[e("rect",{x:"530",y:"135",width:"18",height:"18",rx:"3",fill:"none",stroke:f.value,"stroke-width":"1.5"},null,8,Si),e("rect",{x:"533",y:"138",width:"18",height:"18",rx:"3",fill:d.value,stroke:f.value,"stroke-width":"1.5"},null,8,Ti)])]),e("g",{stroke:y.value,"stroke-width":"2",fill:"none",class:"arrow-animate"},[...r[4]||(r[4]=[e("path",{d:"M 290 200 L 320 200","marker-end":"url(#arrowhead)"},null,-1)])],8,Mi),e("defs",null,[e("marker",Li,[e("polygon",{points:"0 0, 10 3, 0 6",fill:y.value},null,8,Vi)])]),e("g",zi,[e("circle",{cx:"160",cy:"50",r:"20",fill:d.value,stroke:g.value,"stroke-width":"1.5",class:"icon-float-1"},null,8,Ui),r[5]||(r[5]=e("text",{x:"160",y:"58","font-size":"16",fill:"#007bff","text-anchor":"middle","font-weight":"bold"},"API",-1)),e("circle",{cx:"450",cy:"360",r:"18",fill:d.value,stroke:g.value,"stroke-width":"1.5",class:"icon-float-2"},null,8,Pi),r[6]||(r[6]=e("path",{d:"M 445 360 L 455 360 M 450 355 L 450 365",stroke:"#28a745","stroke-width":"2.5","stroke-linecap":"round"},null,-1))])]))]))}});const Di=Y(Ai,[["__scopeId","data-v-5474d550"]]),Oi={class:"data-dictionary-illustration"},Ni={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Fi=["fill"],qi=["fill"],Ri={class:"database-icon",filter:"url(#dbShadow)"},Hi=["fill","stroke"],Ei=["fill"],ji={class:"data-table",filter:"url(#dbShadow)"},Bi=["fill","stroke"],Gi=["fill"],Ki=["fill"],Ji=["fill"],Wi=["fill"],Yi=["fill"],Xi={class:"table-row"},Qi=["fill","stroke"],Zi=["fill"],er=["fill"],tr=["fill"],ar={class:"table-row"},or=["fill","stroke"],sr=["fill"],lr=["fill"],nr=["fill"],ir={class:"table-row"},rr=["fill","stroke"],cr=["fill"],dr=["fill"],ur=["fill"],mr={class:"table-row"},_r=["fill","stroke"],pr=["fill"],fr=["fill"],vr=["fill"],hr={class:"table-row"},gr=["fill","stroke"],yr=["fill"],wr=["fill"],br=["fill"],$r=["stroke"],kr={class:"sql-icon float-icon"},Cr=["fill","stroke"],xr={class:"relation-icon float-icon"},Ir=["fill","stroke"],Sr=W({__name:"DataDictionaryIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),u=q(()=>a.value?"#1e1e1e":"#f0f7ff"),v=q(()=>a.value?"#252525":"#f9f9f9"),d=q(()=>a.value?"#e0e0e0":"#343a40"),p=q(()=>a.value?"#8b949e":"#6c757d"),f=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),$=q(()=>(a.value,"rgba(40, 167, 69, 0.1)")),g=q(()=>a.value?"#3fb950":"#28a745");return(n,y)=>(C(),L("div",Oi,[(C(),L("svg",Ni,[y[9]||(y[9]=Ee('<defs data-v-e2504d87><linearGradient id="dbGradient" x1="0%" y1="0%" x2="0%" y2="100%" data-v-e2504d87><stop offset="0%" style="stop-color:#28a745;" data-v-e2504d87></stop><stop offset="100%" style="stop-color:#20833a;" data-v-e2504d87></stop></linearGradient><filter id="dbShadow" data-v-e2504d87><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-e2504d87></feGaussianBlur><feOffset dx="0" dy="3" data-v-e2504d87></feOffset><feComponentTransfer data-v-e2504d87><feFuncA type="linear" slope="0.15" data-v-e2504d87></feFuncA></feComponentTransfer><feMerge data-v-e2504d87><feMergeNode data-v-e2504d87></feMergeNode><feMergeNode in="SourceGraphic" data-v-e2504d87></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"100",cy:"80",r:"80",fill:$.value,opacity:"0.3"},null,8,Fi),e("circle",{cx:"520",cy:"330",r:"70",fill:$.value,opacity:"0.2"},null,8,qi),e("g",Ri,[e("circle",{cx:"150",cy:"200",r:"70",fill:l.value,stroke:f.value,"stroke-width":"2"},null,8,Hi),y[0]||(y[0]=Ee('<g transform="translate(150, 200)" data-v-e2504d87><ellipse cx="0" cy="-25" rx="35" ry="10" fill="url(#dbGradient)" data-v-e2504d87></ellipse><rect x="-35" y="-25" width="70" height="15" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="-10" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse><rect x="-35" y="-10" width="70" height="15" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="5" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse><rect x="-35" y="5" width="70" height="20" fill="url(#dbGradient)" data-v-e2504d87></rect><ellipse cx="0" cy="25" rx="35" ry="10" fill="#28a745" data-v-e2504d87></ellipse></g>',1)),e("text",{x:"150",y:"290","font-size":"12",fill:d.value,"text-anchor":"middle","font-weight":"600"},"MySQL",8,Ei)]),e("g",ji,[e("rect",{x:"280",y:"60",width:"280",height:"280",rx:"16",fill:o.value,stroke:f.value,"stroke-width":"2"},null,8,Bi),e("text",{x:"420",y:"90","font-size":"14",fill:d.value,"text-anchor":"middle","font-weight":"600"},"users Table Structure",8,Gi),e("rect",{x:"300",y:"110",width:"240",height:"32",rx:"6",fill:u.value},null,8,Ki),e("text",{x:"320",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Field",8,Ji),e("text",{x:"400",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Type",8,Wi),e("text",{x:"480",y:"130","font-size":"11",fill:d.value,"font-weight":"600"},"Description",8,Yi),e("g",Xi,[e("rect",{x:"300",y:"142",width:"240",height:"28",fill:v.value,stroke:f.value,"stroke-width":"1"},null,8,Qi),y[1]||(y[1]=e("circle",{cx:"310",cy:"156",r:"6",fill:"#ffc107"},null,-1)),y[2]||(y[2]=e("path",{d:"M 307 156 L 310 153 L 313 156 L 310 159 Z M 310 153 L 310 158",stroke:"white","stroke-width":"1.5",fill:"none"},null,-1)),e("text",{x:"320",y:"160","font-size":"10",fill:d.value},"id",8,Zi),e("text",{x:"400",y:"160","font-size":"10",fill:p.value},"INT",8,er),e("text",{x:"480",y:"160","font-size":"9",fill:p.value},"User ID",8,tr)]),e("g",ar,[e("rect",{x:"300",y:"170",width:"240",height:"28",fill:o.value,stroke:f.value,"stroke-width":"1"},null,8,or),e("text",{x:"320",y:"188","font-size":"10",fill:d.value},"username",8,sr),e("text",{x:"400",y:"188","font-size":"10",fill:p.value},"VARCHAR",8,lr),e("text",{x:"480",y:"188","font-size":"9",fill:p.value},"Username",8,nr)]),e("g",ir,[e("rect",{x:"300",y:"198",width:"240",height:"28",fill:v.value,stroke:f.value,"stroke-width":"1"},null,8,rr),e("text",{x:"320",y:"216","font-size":"10",fill:d.value},"email",8,cr),e("text",{x:"400",y:"216","font-size":"10",fill:p.value},"VARCHAR",8,dr),e("text",{x:"480",y:"216","font-size":"9",fill:p.value},"Email",8,ur)]),e("g",mr,[e("rect",{x:"300",y:"226",width:"240",height:"28",fill:o.value,stroke:f.value,"stroke-width":"1"},null,8,_r),e("text",{x:"320",y:"244","font-size":"10",fill:d.value},"password",8,pr),e("text",{x:"400",y:"244","font-size":"10",fill:p.value},"VARCHAR",8,fr),e("text",{x:"480",y:"244","font-size":"9",fill:p.value},"Password",8,vr)]),e("g",hr,[e("rect",{x:"300",y:"254",width:"240",height:"28",fill:v.value,stroke:f.value,"stroke-width":"1"},null,8,gr),e("text",{x:"320",y:"272","font-size":"10",fill:d.value},"created_at",8,yr),e("text",{x:"400",y:"272","font-size":"10",fill:p.value},"DATETIME",8,wr),e("text",{x:"480",y:"272","font-size":"9",fill:p.value},"Created At",8,br)]),y[3]||(y[3]=Ee('<g class="index-badges" data-v-e2504d87><rect x="305" y="295" width="55" height="20" rx="4" fill="#28a745" opacity="0.2" data-v-e2504d87></rect><text x="332" y="308" font-size="9" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-e2504d87>PRIMARY</text><rect x="370" y="295" width="45" height="20" rx="4" fill="#007bff" opacity="0.2" data-v-e2504d87></rect><text x="392" y="308" font-size="9" fill="#007bff" text-anchor="middle" font-weight="bold" data-v-e2504d87>INDEX</text></g>',1))]),e("g",{stroke:g.value,"stroke-width":"2",fill:"none",opacity:"0.5",class:"connection-line"},[...y[4]||(y[4]=[e("path",{d:"M 220 200 L 280 140","stroke-dasharray":"4,4",class:"line-animate"},null,-1)])],8,$r),e("g",kr,[e("circle",{cx:"420",cy:"30",r:"22",fill:l.value,stroke:f.value,"stroke-width":"1.5"},null,8,Cr),y[5]||(y[5]=e("text",{x:"420",y:"37","font-size":"12",fill:"#28a745","text-anchor":"middle","font-weight":"bold"},"SQL",-1))]),e("g",xr,[e("circle",{cx:"180",cy:"350",r:"18",fill:l.value,stroke:f.value,"stroke-width":"1.5"},null,8,Ir),y[6]||(y[6]=e("rect",{x:"173",y:"345",width:"6",height:"10",rx:"1",fill:"#007bff"},null,-1)),y[7]||(y[7]=e("rect",{x:"182",y:"345",width:"6",height:"10",rx:"1",fill:"#fd7e14"},null,-1)),y[8]||(y[8]=e("line",{x1:"176",y1:"350",x2:"185",y2:"350",stroke:"#28a745","stroke-width":"2"},null,-1))])]))]))}});const Tr=Y(Sr,[["__scopeId","data-v-e2504d87"]]),Mr={class:"team-collaboration-illustration"},Lr={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Vr=["fill"],zr=["fill"],Ur={class:"central-document",filter:"url(#teamShadow)"},Pr=["fill","stroke"],Ar=["fill"],Dr=["fill"],Or=["fill"],Nr=["fill"],Fr=["fill","stroke"],qr=["stroke"],Rr=["stroke"],Hr=["stroke"],Er={class:"user-avatar user-1",filter:"url(#teamShadow)"},jr=["fill","stroke"],Br=["fill"],Gr=["fill"],Kr=["stroke"],Jr={class:"user-avatar user-2",filter:"url(#teamShadow)"},Wr=["fill","stroke"],Yr=["fill"],Xr=["fill"],Qr={transform:"translate(500, 100)"},Zr=["stroke"],ec=["stroke"],tc={class:"user-avatar user-3",filter:"url(#teamShadow)"},ac=["fill","stroke"],oc=["fill"],sc=["fill"],lc={transform:"translate(320, 340)"},nc=["stroke"],ic=["fill"],rc=["stroke"],cc={class:"comment-bubble float-element",filter:"url(#teamShadow)"},dc=["fill","stroke"],uc=["fill"],mc=["fill"],_c=["fill"],pc={class:"history-icon float-element",filter:"url(#teamShadow)"},fc=["fill","stroke"],vc=["stroke"],hc=["stroke"],gc=["stroke"],yc={class:"sync-icon float-element",filter:"url(#teamShadow)"},wc=["fill","stroke"],bc={class:"sync-rotate"},$c=["stroke"],kc=["fill"],Cc=["stroke"],xc=["fill"],Ic=W({__name:"TeamCollaborationIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),u=q(()=>a.value?"#1e1e1e":"#f8f9fa"),v=q(()=>a.value?"#2d2d2d":"#fff3cd"),d=q(()=>a.value?"#e0e0e0":"#343a40"),p=q(()=>a.value?"#8b949e":"#6c757d"),f=q(()=>a.value?"#8b949e":"#6c757d"),$=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),g=q(()=>a.value?"rgba(74, 158, 255, 0.1)":"rgba(0, 123, 255, 0.1)"),n=q(()=>a.value?"#4a9eff":"#007bff"),y=q(()=>a.value?"#2d2d2d":"#e3f2fd"),k=q(()=>a.value?"#2d2d2d":"#fff3e0"),r=q(()=>a.value?"#2d2d2d":"#f3e5f5"),_=q(()=>a.value?"#4a9eff":"#007bff"),h=q(()=>a.value?"#ff8c2e":"#fd7e14"),w=q(()=>a.value?"#c77dff":"#9c27b0"),T=q(()=>"#007bff"),x=q(()=>"#fd7e14"),I=q(()=>"#9c27b0"),S=q(()=>a.value?"#ff8c2e":"#fd7e14"),M=q(()=>a.value?"#c77dff":"#9c27b0"),V=q(()=>a.value?"#4a9eff":"#007bff"),U=q(()=>a.value?"#3fb950":"#28a745");return(N,A)=>(C(),L("div",Mr,[(C(),L("svg",Lr,[A[2]||(A[2]=Ee('<defs data-v-804d79a6><linearGradient id="teamGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-804d79a6><stop offset="0%" style="stop-color:#007bff;" data-v-804d79a6></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-804d79a6></stop></linearGradient><filter id="teamShadow" data-v-804d79a6><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-804d79a6></feGaussianBlur><feOffset dx="0" dy="3" data-v-804d79a6></feOffset><feComponentTransfer data-v-804d79a6><feFuncA type="linear" slope="0.15" data-v-804d79a6></feFuncA></feComponentTransfer><feMerge data-v-804d79a6><feMergeNode data-v-804d79a6></feMergeNode><feMergeNode in="SourceGraphic" data-v-804d79a6></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"500",cy:"90",r:"90",fill:g.value,opacity:"0.3"},null,8,Vr),e("circle",{cx:"90",cy:"330",r:"70",fill:g.value,opacity:"0.2"},null,8,zr),e("g",Ur,[e("rect",{x:"230",y:"140",width:"140",height:"180",rx:"12",fill:o.value,stroke:$.value,"stroke-width":"2"},null,8,Pr),A[0]||(A[0]=e("rect",{x:"240",y:"150",width:"120",height:"25",rx:"6",fill:"url(#teamGradient)",opacity:"0.15"},null,-1)),e("text",{x:"300",y:"167","font-size":"11",fill:d.value,"text-anchor":"middle","font-weight":"600"},"Project Doc",8,Ar),e("rect",{x:"245",y:"185",width:"110",height:"6",rx:"3",fill:f.value,opacity:"0.6"},null,8,Dr),e("rect",{x:"245",y:"200",width:"100",height:"6",rx:"3",fill:f.value,opacity:"0.4"},null,8,Or),e("rect",{x:"245",y:"215",width:"105",height:"6",rx:"3",fill:f.value,opacity:"0.5"},null,8,Nr),e("rect",{x:"245",y:"235",width:"110",height:"60",rx:"6",fill:u.value,stroke:$.value,"stroke-width":"1"},null,8,Fr),e("line",{x1:"260",y1:"245",x2:"260",y2:"255",stroke:T.value,"stroke-width":"2",class:"cursor-blink"},null,8,qr),e("line",{x1:"295",y1:"260",x2:"295",y2:"270",stroke:x.value,"stroke-width":"2",class:"cursor-blink",style:{"animation-delay":"0.5s"}},null,8,Rr),e("line",{x1:"275",y1:"280",x2:"275",y2:"290",stroke:I.value,"stroke-width":"2",class:"cursor-blink",style:{"animation-delay":"1s"}},null,8,Hr)]),e("g",Er,[e("circle",{cx:"120",cy:"120",r:"35",fill:y.value,stroke:$.value,"stroke-width":"2"},null,8,jr),e("circle",{cx:"120",cy:"115",r:"10",fill:_.value},null,8,Br),e("path",{d:"M 105 138 Q 120 130 135 138",fill:_.value},null,8,Gr),A[1]||(A[1]=e("g",{transform:"translate(140, 100)"},[e("path",{d:"M -4 0 L -2 -6 L 0 -2 L 2 -6 L 4 0 Z",fill:"#ffc107"}),e("rect",{x:"-4",y:"0",width:"8",height:"3",fill:"#ffc107"})],-1)),e("path",{d:"M 145 135 L 230 170",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,Kr)]),e("g",Jr,[e("circle",{cx:"480",cy:"120",r:"35",fill:k.value,stroke:$.value,"stroke-width":"2"},null,8,Wr),e("circle",{cx:"480",cy:"115",r:"10",fill:h.value},null,8,Yr),e("path",{d:"M 465 138 Q 480 130 495 138",fill:h.value},null,8,Xr),e("g",Qr,[e("path",{d:"M -3 -3 L 3 3 M 3 3 L 1 5 L -1 3 Z",stroke:S.value,"stroke-width":"1.5",fill:"none","stroke-linecap":"round"},null,8,Zr)]),e("path",{d:"M 455 135 L 370 170",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,ec)]),e("g",tc,[e("circle",{cx:"300",cy:"360",r:"35",fill:r.value,stroke:$.value,"stroke-width":"2"},null,8,ac),e("circle",{cx:"300",cy:"355",r:"10",fill:w.value},null,8,oc),e("path",{d:"M 285 378 Q 300 370 315 378",fill:w.value},null,8,sc),e("g",lc,[e("ellipse",{cx:"0",cy:"0",rx:"5",ry:"3",fill:"none",stroke:M.value,"stroke-width":"1.5"},null,8,nc),e("circle",{cx:"0",cy:"0",r:"2",fill:M.value},null,8,ic)]),e("path",{d:"M 300 325 L 300 320",stroke:n.value,"stroke-width":"2","stroke-dasharray":"4,4",opacity:"0.5",class:"connection-animate"},null,8,rc)]),e("g",cc,[e("rect",{x:"400",y:"240",width:"100",height:"50",rx:"10",fill:v.value,stroke:$.value,"stroke-width":"1.5"},null,8,dc),e("path",{d:"M 430 290 L 425 300 L 440 290 Z",fill:v.value},null,8,uc),e("text",{x:"450",y:"260","font-size":"9",fill:p.value,"text-anchor":"middle"},"Need Change",8,mc),e("text",{x:"450",y:"273","font-size":"9",fill:p.value,"text-anchor":"middle"},"This part...",8,_c)]),e("g",pc,[e("circle",{cx:"100",cy:"250",r:"28",fill:l.value,stroke:$.value,"stroke-width":"2"},null,8,fc),e("circle",{cx:"100",cy:"250",r:"15",fill:"none",stroke:V.value,"stroke-width":"2"},null,8,vc),e("path",{d:"M 100 240 L 100 250 L 108 250",stroke:V.value,"stroke-width":"2","stroke-linecap":"round"},null,8,hc),e("path",{d:"M 90 235 L 85 240 L 90 245",stroke:V.value,"stroke-width":"2",fill:"none","stroke-linecap":"round"},null,8,gc)]),e("g",yc,[e("circle",{cx:"500",cy:"280",r:"25",fill:l.value,stroke:$.value,"stroke-width":"2"},null,8,wc),e("g",bc,[e("path",{d:"M 505 270 A 10 10 0 1 1 495 280",fill:"none",stroke:U.value,"stroke-width":"2","stroke-linecap":"round"},null,8,$c),e("path",{d:"M 503 268 L 505 270 L 507 268",fill:U.value},null,8,kc),e("path",{d:"M 495 290 A 10 10 0 1 1 505 280",fill:"none",stroke:U.value,"stroke-width":"2","stroke-linecap":"round"},null,8,Cc),e("path",{d:"M 497 292 L 495 290 L 493 292",fill:U.value},null,8,xc)])])]))]))}});const Sc=Y(Ic,[["__scopeId","data-v-804d79a6"]]),Tc={class:"auto-generate-illustration"},Mc={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},Lc=["fill"],Vc=["fill"],zc={class:"code-editor",filter:"url(#autoShadow)"},Uc=["fill","stroke"],Pc=["fill"],Ac=["fill"],Dc={"font-family":"monospace","font-size":"9"},Oc=["fill"],Nc=["fill"],Fc=["fill"],qc=["fill"],Rc=["fill"],Hc={class:"transformation-magic"},Ec={class:"tool-icons"},jc=["fill","stroke"],Bc=["fill","stroke"],Gc=["fill","stroke"],Kc=["fill"],Jc={class:"generated-doc",filter:"url(#autoShadow)"},Wc=["fill","stroke"],Yc=["fill"],Xc=["fill"],Qc=["fill"],Zc=["fill"],ed=["fill"],td=["fill","stroke"],ad=["fill"],od=["fill"],sd=["fill","stroke"],ld=["fill"],nd=["fill"],id=["fill"],rd=["fill"],cd={class:"success-icon float-icon",filter:"url(#autoShadow)"},dd=["fill","stroke"],ud=W({__name:"AutoGenerateIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#1e1e1e":"#0d1117"),l=q(()=>a.value?"#2d2d2d":"#161b22"),u=q(()=>a.value?"#2d2d2d":"#ffffff"),v=q(()=>a.value?"#2d2d2d":"#ffffff"),d=q(()=>a.value?"#1e1e1e":"#f8f9fa"),p=q(()=>a.value?"#252525":"#f9f9f9"),f=q(()=>a.value?"#e0e0e0":"#343a40"),$=q(()=>a.value?"#8b949e":"#6c757d"),g=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),n=q(()=>(a.value,"rgba(255, 193, 7, 0.1)"));return(y,k)=>(C(),L("div",Tc,[(C(),L("svg",Mc,[k[19]||(k[19]=Ee('<defs data-v-9a3a589d><linearGradient id="autoGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-9a3a589d><stop offset="0%" style="stop-color:#ffc107;" data-v-9a3a589d></stop><stop offset="100%" style="stop-color:#ff8c2e;" data-v-9a3a589d></stop></linearGradient><filter id="autoShadow" data-v-9a3a589d><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-9a3a589d></feGaussianBlur><feOffset dx="0" dy="3" data-v-9a3a589d></feOffset><feComponentTransfer data-v-9a3a589d><feFuncA type="linear" slope="0.15" data-v-9a3a589d></feFuncA></feComponentTransfer><feMerge data-v-9a3a589d><feMergeNode data-v-9a3a589d></feMergeNode><feMergeNode in="SourceGraphic" data-v-9a3a589d></feMergeNode></feMerge></filter><filter id="glow" data-v-9a3a589d><feGaussianBlur stdDeviation="4" result="coloredBlur" data-v-9a3a589d></feGaussianBlur><feMerge data-v-9a3a589d><feMergeNode in="coloredBlur" data-v-9a3a589d></feMergeNode><feMergeNode in="SourceGraphic" data-v-9a3a589d></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"480",cy:"100",r:"90",fill:n.value,opacity:"0.3"},null,8,Lc),e("circle",{cx:"100",cy:"330",r:"70",fill:n.value,opacity:"0.2"},null,8,Vc),e("g",zc,[e("rect",{x:"50",y:"100",width:"200",height:"220",rx:"12",fill:o.value,stroke:g.value,"stroke-width":"2"},null,8,Uc),e("rect",{x:"50",y:"100",width:"200",height:"30",rx:"12",fill:l.value},null,8,Pc),k[7]||(k[7]=e("circle",{cx:"65",cy:"115",r:"4",fill:"#ff5f57"},null,-1)),k[8]||(k[8]=e("circle",{cx:"80",cy:"115",r:"4",fill:"#febc2e"},null,-1)),k[9]||(k[9]=e("circle",{cx:"95",cy:"115",r:"4",fill:"#28c840"},null,-1)),e("text",{x:"150",y:"120","font-size":"10",fill:$.value,"text-anchor":"middle"},"main.js",8,Ac),e("g",Dc,[k[0]||(k[0]=Ee('<text x="60" y="150" fill="#8b949e" data-v-9a3a589d>1</text><text x="75" y="150" fill="#ff7b72" data-v-9a3a589d>/**</text><text x="60" y="164" fill="#8b949e" data-v-9a3a589d>2</text><text x="75" y="164" fill="#7ee787" data-v-9a3a589d> * @api {POST} /api/login</text><text x="60" y="178" fill="#8b949e" data-v-9a3a589d>3</text><text x="75" y="178" fill="#7ee787" data-v-9a3a589d> * @param {string} username</text><text x="60" y="192" fill="#8b949e" data-v-9a3a589d>4</text><text x="75" y="192" fill="#7ee787" data-v-9a3a589d> * @param {string} password</text><text x="60" y="206" fill="#8b949e" data-v-9a3a589d>5</text><text x="75" y="206" fill="#ff7b72" data-v-9a3a589d> */</text><text x="60" y="220" fill="#8b949e" data-v-9a3a589d>6</text><text x="75" y="220" fill="#d2a8ff" data-v-9a3a589d>function</text><text x="118" y="220" fill="#ffa657" data-v-9a3a589d> login</text>',13)),e("text",{x:"143",y:"220",fill:f.value},"(username, pwd)",8,Oc),k[1]||(k[1]=e("text",{x:"60",y:"234",fill:"#8b949e"},"7",-1)),e("text",{x:"75",y:"234",fill:f.value},"{",8,Nc),k[2]||(k[2]=e("text",{x:"60",y:"248",fill:"#8b949e"},"8",-1)),k[3]||(k[3]=e("text",{x:"85",y:"248",fill:"#ff7b72"},"return",-1)),k[4]||(k[4]=e("text",{x:"120",y:"248",fill:"#79c0ff"}," api",-1)),e("text",{x:"138",y:"248",fill:f.value},".",8,Fc),k[5]||(k[5]=e("text",{x:"143",y:"248",fill:"#d2a8ff"},"post",-1)),e("text",{x:"168",y:"248",fill:f.value},"(...)",8,qc),k[6]||(k[6]=e("text",{x:"60",y:"262",fill:"#8b949e"},"9",-1)),e("text",{x:"75",y:"262",fill:f.value},"}",8,Rc)])]),e("g",Hc,[k[12]||(k[12]=Ee('<g class="magic-circle" data-v-9a3a589d><circle cx="300" cy="210" r="50" fill="url(#autoGradient)" opacity="0.1" filter="url(#glow)" class="magic-pulse" data-v-9a3a589d></circle><circle cx="300" cy="210" r="40" fill="none" stroke="url(#autoGradient)" stroke-width="2" opacity="0.5" class="magic-rotate" data-v-9a3a589d></circle><circle cx="300" cy="210" r="30" fill="none" stroke="url(#autoGradient)" stroke-width="2" opacity="0.3" class="magic-rotate-reverse" data-v-9a3a589d></circle></g><g transform="translate(300, 210)" class="magic-icon" data-v-9a3a589d><path d="M -8 -15 L 0 -5 L -5 -5 L 5 10 L -2 0 L 3 0 Z" fill="url(#autoGradient)" filter="url(#glow)" data-v-9a3a589d></path></g>',2)),e("g",Ec,[e("circle",{cx:"280",cy:"140",r:"18",fill:v.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-1"},null,8,jc),k[10]||(k[10]=e("text",{x:"280",y:"146","font-size":"8",fill:"#85ea2d","text-anchor":"middle","font-weight":"bold"},"Swagger",-1)),e("circle",{cx:"340",cy:"150",r:"18",fill:v.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-2"},null,8,Bc),k[11]||(k[11]=e("text",{x:"340",y:"156","font-size":"8",fill:"#ff6c37","text-anchor":"middle","font-weight":"bold"},"Postman",-1)),e("circle",{cx:"320",cy:"290",r:"18",fill:v.value,stroke:g.value,"stroke-width":"1.5",class:"tool-icon-3"},null,8,Gc),e("text",{x:"320",y:"296","font-size":"9",fill:f.value,"text-anchor":"middle","font-weight":"bold"},"MD",8,Kc)]),k[13]||(k[13]=Ee('<g class="particles" data-v-9a3a589d><circle r="3" fill="#ffc107" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle><circle r="3" fill="#ff8c2e" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" begin="0.5s" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle><circle r="3" fill="#ffc107" opacity="0.8" filter="url(#glow)" data-v-9a3a589d><animateMotion dur="2s" repeatCount="indefinite" begin="1s" path="M 250 210 L 300 210" data-v-9a3a589d></animateMotion></circle></g><defs data-v-9a3a589d><marker id="arrowGold" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" data-v-9a3a589d><polygon points="0 0, 10 3, 0 6" fill="#ffc107" data-v-9a3a589d></polygon></marker></defs><path d="M 250 210 L 280 210" stroke="#ffc107" stroke-width="2" marker-end="url(#arrowGold)" opacity="0.6" data-v-9a3a589d></path><path d="M 320 210 L 350 210" stroke="#ffc107" stroke-width="2" marker-end="url(#arrowGold)" opacity="0.6" data-v-9a3a589d></path>',4))]),e("g",Jc,[e("rect",{x:"370",y:"100",width:"200",height:"220",rx:"12",fill:u.value,stroke:g.value,"stroke-width":"2"},null,8,Wc),k[16]||(k[16]=e("rect",{x:"380",y:"110",width:"180",height:"30",rx:"8",fill:"url(#autoGradient)",opacity:"0.15"},null,-1)),e("text",{x:"470",y:"130","font-size":"12",fill:f.value,"text-anchor":"middle","font-weight":"600"},"API Docs",8,Yc),e("g",null,[e("text",{x:"390",y:"160","font-size":"11",fill:f.value,"font-weight":"600"},"POST /api/login",8,Xc),e("text",{x:"390",y:"180","font-size":"9",fill:$.value},"User Login API",8,Qc),e("rect",{x:"390",y:"195",width:"160",height:"20",rx:"4",fill:d.value},null,8,Zc),e("text",{x:"400",y:"209","font-size":"9",fill:f.value,"font-weight":"600"},"Request Parameters",8,ed),e("rect",{x:"390",y:"215",width:"160",height:"18",fill:p.value,stroke:g.value,"stroke-width":"0.5"},null,8,td),e("text",{x:"400",y:"227","font-size":"8",fill:$.value},"username",8,ad),e("text",{x:"490",y:"227","font-size":"8",fill:$.value},"string",8,od),e("rect",{x:"390",y:"233",width:"160",height:"18",fill:u.value,stroke:g.value,"stroke-width":"0.5"},null,8,sd),e("text",{x:"400",y:"245","font-size":"8",fill:$.value},"password",8,ld),e("text",{x:"490",y:"245","font-size":"8",fill:$.value},"string",8,nd),e("text",{x:"390",y:"270","font-size":"9",fill:f.value,"font-weight":"600"},"Response Example",8,id),e("rect",{x:"390",y:"275",width:"160",height:"30",rx:"4",fill:o.value},null,8,rd),k[14]||(k[14]=e("text",{x:"400",y:"290","font-size":"8",fill:"#28a745","font-family":"monospace"},'{ "code": 200,',-1)),k[15]||(k[15]=e("text",{x:"400",y:"300","font-size":"8",fill:"#007bff","font-family":"monospace"},' "token": "..." }',-1))])]),e("g",cd,[e("circle",{cx:"540",cy:"340",r:"22",fill:v.value,stroke:g.value,"stroke-width":"2"},null,8,dd),k[17]||(k[17]=e("circle",{cx:"540",cy:"340",r:"14",fill:"none",stroke:"#28a745","stroke-width":"2"},null,-1)),k[18]||(k[18]=e("path",{d:"M 534 340 L 538 344 L 547 333",stroke:"#28a745","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1))])]))]))}});const md=Y(ud,[["__scopeId","data-v-9a3a589d"]]),_d={class:"integration-illustration"},pd={viewBox:"0 0 600 400",xmlns:"http://www.w3.org/2000/svg"},fd=["fill"],vd=["fill"],hd={class:"runapi-panel",filter:"url(#intShadow)"},gd=["fill","stroke"],yd=["fill"],wd={class:"debug-panel"},bd=["fill","stroke"],$d=["fill"],kd=["fill"],Cd=["fill"],xd={class:"showdoc-panel",filter:"url(#intShadow)"},Id=["fill","stroke"],Sd=["fill"],Td={class:"doc-panel"},Md=["fill"],Ld=["fill"],Vd=["fill"],zd=["fill"],Ud=["fill","stroke"],Pd=["fill"],Ad=["fill"],Dd=["fill"],Od=["fill","stroke"],Nd=["fill"],Fd=["fill"],qd=["fill"],Rd=["fill"],Hd=["fill"],Ed={class:"integration-connection"},jd=["fill"],Bd={class:"feature-badges"},Gd=["fill","stroke"],Kd=["fill"],Jd=["fill","stroke"],Wd=["fill"],Yd=["fill","stroke"],Xd=["fill"],Qd={class:"deco-icons"},Zd=["fill","stroke"],eu=["fill","stroke"],tu=W({__name:"IntegrationIllustration",setup(c){const t=He(),a=q(()=>t.theme==="dark"),o=q(()=>a.value?"#2d2d2d":"#ffffff"),l=q(()=>a.value?"#2d2d2d":"#ffffff"),u=q(()=>a.value?"#1e1e1e":"#f8f9fa"),v=q(()=>a.value?"#1e1e1e":"#0d1117"),d=q(()=>a.value?"#1e1e1e":"#f0f7ff"),p=q(()=>a.value?"#252525":"#f9f9f9"),f=q(()=>a.value?"#2d2d2d":"#ffffff"),$=q(()=>a.value?"#2d2d2d":"#f8f9fa"),g=q(()=>a.value?"#e0e0e0":"#343a40"),n=q(()=>a.value?"#8b949e":"#6c757d"),y=q(()=>a.value?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),k=q(()=>"rgba(111, 66, 193, 0.15)"),r=q(()=>"rgba(0, 123, 255, 0.15)");return(_,h)=>(C(),L("div",_d,[(C(),L("svg",pd,[h[9]||(h[9]=Ee('<defs data-v-ffdb77b9><linearGradient id="runApiGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#5a32a3;" data-v-ffdb77b9></stop></linearGradient><linearGradient id="showDocGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#007bff;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#0056b3;" data-v-ffdb77b9></stop></linearGradient><linearGradient id="integrationGradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-ffdb77b9><stop offset="0%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop><stop offset="50%" style="stop-color:#007bff;" data-v-ffdb77b9></stop><stop offset="100%" style="stop-color:#6f42c1;" data-v-ffdb77b9></stop></linearGradient><filter id="intShadow" data-v-ffdb77b9><feGaussianBlur in="SourceAlpha" stdDeviation="3" data-v-ffdb77b9></feGaussianBlur><feOffset dx="0" dy="3" data-v-ffdb77b9></feOffset><feComponentTransfer data-v-ffdb77b9><feFuncA type="linear" slope="0.15" data-v-ffdb77b9></feFuncA></feComponentTransfer><feMerge data-v-ffdb77b9><feMergeNode data-v-ffdb77b9></feMergeNode><feMergeNode in="SourceGraphic" data-v-ffdb77b9></feMergeNode></feMerge></filter><filter id="glow" data-v-ffdb77b9><feGaussianBlur stdDeviation="4" result="coloredBlur" data-v-ffdb77b9></feGaussianBlur><feMerge data-v-ffdb77b9><feMergeNode in="coloredBlur" data-v-ffdb77b9></feMergeNode><feMergeNode in="SourceGraphic" data-v-ffdb77b9></feMergeNode></feMerge></filter></defs>',1)),e("circle",{cx:"90",cy:"90",r:"80",fill:k.value,opacity:"0.3"},null,8,fd),e("circle",{cx:"510",cy:"320",r:"70",fill:r.value,opacity:"0.3"},null,8,vd),e("g",hd,[e("rect",{x:"50",y:"90",width:"220",height:"240",rx:"16",fill:o.value,stroke:y.value,"stroke-width":"2"},null,8,gd),h[3]||(h[3]=e("rect",{x:"60",y:"100",width:"200",height:"35",rx:"8",fill:"url(#runApiGradient)",opacity:"0.15"},null,-1)),e("text",{x:"160",y:"123","font-size":"14",fill:g.value,"text-anchor":"middle","font-weight":"700"},"RunAPI",8,yd),e("g",wd,[h[0]||(h[0]=e("rect",{x:"70",y:"150",width:"50",height:"24",rx:"6",fill:"#6f42c1"},null,-1)),h[1]||(h[1]=e("text",{x:"95",y:"166","font-size":"11",fill:"white","text-anchor":"middle","font-weight":"bold"},"POST",-1)),e("rect",{x:"130",y:"150",width:"120",height:"24",rx:"6",fill:u.value,stroke:y.value,"stroke-width":"1"},null,8,bd),e("text",{x:"140",y:"166","font-size":"9",fill:n.value,"font-family":"monospace"},"/api/users",8,$d),e("text",{x:"70",y:"195","font-size":"10",fill:g.value,"font-weight":"600"},"Request Body",8,kd),e("rect",{x:"70",y:"200",width:"180",height:"50",rx:"6",fill:v.value},null,8,Cd),h[2]||(h[2]=Ee('<text x="80" y="218" font-size="8" fill="#c792ea" font-family="monospace" data-v-ffdb77b9>{</text><text x="90" y="230" font-size="8" fill="#82aaff" font-family="monospace" data-v-ffdb77b9>&quot;name&quot;: &quot;test&quot;,</text><text x="90" y="240" font-size="8" fill="#c3e88d" font-family="monospace" data-v-ffdb77b9>&quot;age&quot;: 25</text><text x="80" y="248" font-size="8" fill="#c792ea" font-family="monospace" data-v-ffdb77b9>}</text><rect x="70" y="265" width="180" height="32" rx="8" fill="url(#runApiGradient)" class="debug-button" data-v-ffdb77b9></rect><text x="160" y="285" font-size="12" fill="white" text-anchor="middle" font-weight="600" data-v-ffdb77b9>Send Request</text><rect x="70" y="305" width="55" height="20" rx="4" fill="#28a745" opacity="0.2" data-v-ffdb77b9></rect><text x="97" y="318" font-size="9" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-ffdb77b9>200 OK</text>',8))])]),e("g",xd,[e("rect",{x:"330",y:"90",width:"220",height:"240",rx:"16",fill:o.value,stroke:y.value,"stroke-width":"2"},null,8,Id),h[5]||(h[5]=e("rect",{x:"340",y:"100",width:"200",height:"35",rx:"8",fill:"url(#showDocGradient)",opacity:"0.15"},null,-1)),e("text",{x:"440",y:"123","font-size":"14",fill:g.value,"text-anchor":"middle","font-weight":"700"},"ShowDoc",8,Sd),e("g",Td,[e("text",{x:"350",y:"160","font-size":"12",fill:g.value,"font-weight":"600"},"POST /api/users",8,Md),e("text",{x:"350",y:"178","font-size":"9",fill:n.value},"Create User API",8,Ld),e("rect",{x:"350",y:"190",width:"180",height:"20",rx:"4",fill:d.value},null,8,Vd),e("text",{x:"360",y:"204","font-size":"9",fill:g.value,"font-weight":"600"},"Parameters",8,zd),e("rect",{x:"350",y:"210",width:"180",height:"18",fill:p.value,stroke:y.value,"stroke-width":"0.5"},null,8,Ud),e("text",{x:"360",y:"222","font-size":"8",fill:n.value},"name",8,Pd),e("text",{x:"420",y:"222","font-size":"8",fill:n.value},"string",8,Ad),e("text",{x:"475",y:"222","font-size":"8",fill:n.value},"Username",8,Dd),e("rect",{x:"350",y:"228",width:"180",height:"18",fill:o.value,stroke:y.value,"stroke-width":"0.5"},null,8,Od),e("text",{x:"360",y:"240","font-size":"8",fill:n.value},"age",8,Nd),e("text",{x:"420",y:"240","font-size":"8",fill:n.value},"number",8,Fd),e("text",{x:"475",y:"240","font-size":"8",fill:n.value},"Age",8,qd),e("text",{x:"350",y:"265","font-size":"9",fill:g.value,"font-weight":"600"},"Example Code",8,Rd),e("rect",{x:"350",y:"270",width:"180",height:"40",rx:"6",fill:v.value},null,8,Hd),h[4]||(h[4]=Ee('<text x="360" y="286" font-size="8" fill="#82aaff" font-family="monospace" data-v-ffdb77b9>POST /api/users</text><text x="360" y="297" font-size="8" fill="#c3e88d" font-family="monospace" data-v-ffdb77b9>{&quot;name&quot;:&quot;test&quot;}</text><g class="sync-badge" data-v-ffdb77b9><rect x="480" y="148" width="45" height="18" rx="4" fill="#28a745" opacity="0.2" data-v-ffdb77b9></rect><circle cx="488" cy="157" r="3" fill="#28a745" class="sync-dot" data-v-ffdb77b9></circle><text x="510" y="160" font-size="8" fill="#28a745" text-anchor="middle" font-weight="bold" data-v-ffdb77b9>Sync</text></g>',3))])]),e("g",Ed,[e("rect",{x:"260",y:"195",width:"80",height:"40",rx:"20",fill:f.value,opacity:"0.9",filter:"url(#intShadow)"},null,8,jd),h[6]||(h[6]=Ee('<path d="M 280 215 L 295 215 M 282 210 L 280 215 L 282 220" stroke="url(#integrationGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" class="arrow-flow-1" data-v-ffdb77b9></path><path d="M 305 215 L 320 215 M 318 210 L 320 215 L 318 220" stroke="url(#integrationGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" class="arrow-flow-2" data-v-ffdb77b9></path><g transform="translate(300, 215)" class="sync-icon-center" data-v-ffdb77b9><circle r="8" fill="url(#integrationGradient)" opacity="0.2" data-v-ffdb77b9></circle><path d="M 3 -5 A 5 5 0 1 1 -3 0" fill="none" stroke="url(#integrationGradient)" stroke-width="1.5" stroke-linecap="round" data-v-ffdb77b9></path><path d="M 2 -6 L 3 -5 L 4 -6" stroke="url(#integrationGradient)" stroke-width="1.5" fill="none" stroke-linecap="round" data-v-ffdb77b9></path><path d="M -3 5 A 5 5 0 1 1 3 0" fill="none" stroke="url(#integrationGradient)" stroke-width="1.5" stroke-linecap="round" data-v-ffdb77b9></path><path d="M -2 6 L -3 5 L -4 6" stroke="url(#integrationGradient)" stroke-width="1.5" fill="none" stroke-linecap="round" data-v-ffdb77b9></path></g><g class="data-particles" data-v-ffdb77b9><circle r="2.5" fill="#6f42c1" opacity="0.8" filter="url(#glow)" data-v-ffdb77b9><animateMotion dur="2s" repeatCount="indefinite" path="M 270 215 L 330 215" data-v-ffdb77b9></animateMotion></circle><circle r="2.5" fill="#007bff" opacity="0.8" filter="url(#glow)" data-v-ffdb77b9><animateMotion dur="2s" repeatCount="indefinite" begin="1s" path="M 330 215 L 270 215" data-v-ffdb77b9></animateMotion></circle></g>',4))]),e("g",Bd,[e("rect",{x:"150",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:y.value,"stroke-width":"1"},null,8,Gd),e("text",{x:"190",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Real-time Sync",8,Kd),e("rect",{x:"260",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:y.value,"stroke-width":"1"},null,8,Jd),e("text",{x:"300",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Seamless",8,Wd),e("rect",{x:"370",y:"350",width:"80",height:"24",rx:"12",fill:$.value,stroke:y.value,"stroke-width":"1"},null,8,Yd),e("text",{x:"410",y:"366","font-size":"10",fill:g.value,"text-anchor":"middle","font-weight":"600"},"Efficient",8,Xd)]),e("g",Qd,[e("circle",{cx:"120",cy:"50",r:"20",fill:l.value,stroke:y.value,"stroke-width":"1.5",class:"float-icon-1"},null,8,Zd),h[7]||(h[7]=e("text",{x:"120",y:"57","font-size":"12",fill:"#007bff","text-anchor":"middle","font-weight":"bold"},"Client",-1)),e("circle",{cx:"480",cy:"50",r:"20",fill:l.value,stroke:y.value,"stroke-width":"1.5",class:"float-icon-2"},null,8,eu),h[8]||(h[8]=e("text",{x:"480",y:"57","font-size":"12",fill:"#6f42c1","text-anchor":"middle","font-weight":"bold"},"Web",-1))])]))]))}});const au=Y(tu,[["__scopeId","data-v-ffdb77b9"]]),ou={class:"landing-page"},su={class:"hero"},lu={class:"hero-content"},nu={class:"hero-text"},iu={class:"subtitle"},ru={class:"highlight"},cu={class:"hero-description"},du={class:"cta-buttons"},uu=["href"],mu=["href"],_u={class:"feature-tags"},pu={class:"tag"},fu={class:"tag"},vu={class:"hero-image"},hu={class:"features-section"},gu={class:"section-header"},yu={class:"features-grid"},wu={class:"feature-card"},bu={class:"feature-icon"},$u={class:"feature-card"},ku={class:"feature-icon"},Cu={class:"feature-card"},xu={class:"feature-icon"},Iu={class:"feature-card"},Su={class:"feature-icon"},Tu={class:"feature-card"},Mu={class:"feature-icon"},Lu={class:"feature-card"},Vu={class:"feature-icon"},zu={class:"feature-detail"},Uu={class:"detail-row"},Pu={class:"detail-content"},Au={class:"detail-desc"},Du={class:"detail-list"},Ou={class:"detail-image"},Nu={class:"detail-row reverse"},Fu={class:"detail-image"},qu={class:"detail-content"},Ru={class:"detail-desc"},Hu={class:"detail-list"},Eu={class:"detail-row"},ju={class:"detail-content"},Bu={class:"detail-desc"},Gu={class:"detail-list"},Ku={class:"detail-image"},Ju={class:"detail-row reverse"},Wu={class:"detail-image"},Yu={class:"detail-content"},Xu={class:"detail-desc"},Qu={class:"detail-list"},Zu={class:"detail-row"},em={class:"detail-content"},tm={class:"detail-desc"},am={class:"detail-list"},om={class:"detail-image"},sm={class:"trust-section"},lm={class:"trust-content"},nm={class:"trust-subtitle"},im={class:"comparison-section"},rm={class:"comparison-table"},cm={class:"comparison-traditional"},dm={class:"comparison-showdoc"},um={class:"comparison-stats"},mm={class:"comparison-stat-item"},_m={class:"stat-desc"},pm={class:"comparison-stat-item"},fm={class:"stat-desc"},vm={class:"comparison-stat-item"},hm={class:"stat-desc"},gm={class:"comparison-stat-item"},ym={class:"stat-desc"},wm={class:"cta-section"},bm={class:"cta-buttons"},$m=["href"],km=["href"],Cm={class:"feature-tags"},xm={class:"tag"},Im={class:"tag"},Sm=W({__name:"Index",setup(c){const t=Qe(),a=xe(),{locale:o}=te(),l=q(()=>o.value==="en-US"?"https://www.showdoc.com.cn/demo-en":"https://www.showdoc.com.cn/demo"),u=q(()=>o.value==="en-US"?"https://www.showdoc.com.cn/help-en":"https://www.showdoc.com.cn/help"),v=async()=>{try{const d=await X("/api/common/homePageSetting",{},"post",!1);d.error_code===0&&d.data&&(d.data.home_page==2?a.replace({path:"/user/login"}):d.data.home_page==3&&d.data.home_item&&a.replace({path:"/"+d.data.home_item}))}catch(d){console.error("获取首页设置失败:",d)}};return oe(()=>{t.fetchUserInfo().catch(()=>{}),v()}),(d,p)=>{const f=H("router-link");return C(),L("div",ou,[s(Us),e("section",su,[e("div",lu,[e("div",nu,[e("h1",null,[e("span",iu,i(d.$t("index.hero_subtitle")||"专为IT团队打造的"),1),p[0]||(p[0]=e("br",{class:"title-break"},null,-1)),e("span",ru,i(d.$t("index.hero_title")||"技术文档协作平台"),1)]),e("p",cu,[e("span",null,i(d.$t("index.api_docs")||"API文档"),1),e("span",null,i(d.$t("index.data_dict")||"数据字典"),1),e("span",null,i(d.$t("index.tech_spec")||"技术规范"),1),e("span",null,i(d.$t("index.team_kb")||"团队知识库"),1)]),e("div",du,[e("a",{href:l.value,target:"_blank",class:"btn btn-landing-primary"},i(d.$t("index.view_example")||"查看示例"),9,uu),e("a",{href:u.value,target:"_blank",class:"btn btn-landing-outline"},i(d.$t("index.learn_more")||"了解更多"),9,mu)]),e("div",_u,[e("span",pu,[s(z(ca)),O(" "+i(d.$t("index.quick_start")||"5分钟上手"),1)]),e("span",fu,[s(z(Dt)),O(" "+i(d.$t("index.team_collab")||"团队协作"),1)])])]),e("div",vu,[s(Zn)])])]),e("section",hu,[e("div",gu,[e("h2",null,i(d.$t("index.why_choose")||"为什么选择 ShowDoc？"),1),e("p",null,i(d.$t("index.why_choose_desc")||"让API文档管理简单高效，团队协作如丝般顺滑"),1)]),e("div",yu,[e("div",wu,[e("div",bu,[s(z(Qa))]),e("h3",null,i(d.$t("index.section_title2")||"API文档"),1),e("p",null,i(d.$t("index.api_card_desc")||"简单快速编写美观的API文档"),1)]),e("div",$u,[e("div",ku,[s(z(Za))]),e("h3",null,i(d.$t("index.section_title3")||"数据字典"),1),e("p",null,i(d.$t("index.data_dict_desc")||"清晰展示数据库结构"),1)]),e("div",Cu,[e("div",xu,[s(z(eo))]),e("h3",null,i(d.$t("index.section_title4")||"说明文档"),1),e("p",null,i(d.$t("index.manual_desc")||"工具说明书和技术规范文档"),1)]),e("div",Iu,[e("div",Su,[s(z(Dt))]),e("h3",null,i(d.$t("index.section_title5")||"团队协作"),1),e("p",null,i(d.$t("index.team_card_desc")||"权限管理机制，团队协同编写文档"),1)]),e("div",Tu,[e("div",Mu,[s(z(to))]),e("h3",null,i(d.$t("index.auto_doc_title")||"文档自动化"),1),e("p",null,i(d.$t("index.auto_card_desc")||"代码注释自动生成文档"),1)]),e("div",Lu,[e("div",Vu,[s(z(ao))]),e("h3",null,i(d.$t("index.section_title6")||"免费开源"),1),e("p",null,i(d.$t("index.open_source_desc")||"可私有部署，数据自主可控"),1)])])]),e("section",zu,[e("div",Uu,[e("div",Pu,[e("h2",null,i(d.$t("index.api_doc_title")||"强大的API文档管理"),1),e("p",Au,i(d.$t("index.api_doc_subtitle")||"APP、web前端与服务器常用API交互，方便快速编写美观的API文档"),1),e("ul",Du,[e("li",null,i(d.$t("index.api_feature_1")||"支持HTTP方法标识（GET/POST/PUT/DELETE）"),1),e("li",null,i(d.$t("index.api_feature_2")||"代码示例一键复制"),1),e("li",null,i(d.$t("index.api_feature_3")||"参数表格清晰展示"),1),e("li",null,i(d.$t("index.api_feature_4")||"支持Markdown格式化"),1)])]),e("div",Ou,[s(Di)])]),e("div",Nu,[e("div",Fu,[s(Tr)]),e("div",qu,[e("h2",null,i(d.$t("index.data_dict_title")||"清晰展示数据库结构"),1),e("p",Ru,i(d.$t("index.data_dict_detail_desc")||"好的数据字典可以方便描述数据库结构，用ShowDoc编辑出美观的数据字典"),1),e("ul",Hu,[e("li",null,i(d.$t("index.data_feature_1")||"表结构可视化展示"),1),e("li",null,i(d.$t("index.data_feature_2")||"字段类型和说明清晰"),1),e("li",null,i(d.$t("index.data_feature_3")||"支持多数据库格式"),1),e("li",null,i(d.$t("index.data_feature_4")||"一键导出共享"),1)])])]),e("div",Eu,[e("div",ju,[e("h2",null,i(d.$t("index.team_collab_title")||"高效的团队协作"),1),e("p",Bu,i(d.$t("index.team_collab_subtitle")||"团队权限管理机制让团队良好协同编写文档"),1),e("ul",Gu,[e("li",null,i(d.$t("index.team_feature_1")||"多种权限级别控制"),1),e("li",null,i(d.$t("index.team_feature_2")||"变更历史追溯"),1),e("li",null,i(d.$t("index.team_feature_3")||"评论反馈机制"),1)])]),e("div",Ku,[s(Sc)])]),e("div",Ju,[e("div",Wu,[s(md)]),e("div",Yu,[e("h2",null,i(d.$t("index.auto_gen_title")||"多种方式自动生成文档"),1),e("p",Xu,i(d.$t("index.auto_gen_subtitle")||"支持从代码注释、Swagger、Postman等多种方式自动生成API文档"),1),e("ul",Qu,[e("li",null,i(d.$t("index.auto_gen_feature_1")||"代码注释自动生成"),1),e("li",null,i(d.$t("index.auto_gen_feature_2")||"Swagger/OpenAPI导入"),1),e("li",null,i(d.$t("index.auto_gen_feature_3")||"Postman一键导入"),1),e("li",null,i(d.$t("index.auto_gen_feature_4")||"Markdown压缩包导入"),1)])])]),e("div",Zu,[e("div",em,[e("h2",null,i(d.$t("index.runapi_title")||"搭配RunAPI，提升接口开发效率"),1),e("p",tm,i(d.$t("index.runapi_subtitle")||"ShowDoc与RunAPI完美集成，接口调试与文档编写无缝衔接，让API开发更高效"),1),e("ul",am,[e("li",null,i(d.$t("index.runapi_feature_1")||"实时同步接口信息到文档"),1),e("li",null,i(d.$t("index.runapi_feature_2")||"在RunAPI调试，自动生成文档"),1),e("li",null,i(d.$t("index.runapi_feature_3")||"Mock服务与文档联动"),1),e("li",null,i(d.$t("index.runapi_feature_4")||"前后端协作更顺畅"),1)])]),e("div",om,[s(au)])])]),e("section",sm,[e("div",lm,[e("h2",null,[O(i(d.$t("index.over_prefix")||"超过")+" ",1),p[1]||(p[1]=e("span",{class:"stat-highlight"},[e("span",{class:"num-digit"},"100000+")],-1)),O(" "+i(d.$t("index.trust_desc")||"互联网团队正在使用 ShowDoc"),1)]),e("p",nm,i(d.$t("index.company_list")||"包括且不仅以下公司团队："),1),p[2]||(p[2]=Ee('<div class="company-logos" data-v-7376b30d><img src="'+bs+'" alt="腾讯" data-v-7376b30d><img src="'+$s+'" alt="华为" data-v-7376b30d><img src="'+ks+'" alt="百度" data-v-7376b30d><img src="'+Cs+'" alt="京东" data-v-7376b30d><img src="'+xs+'" alt="字节跳动" data-v-7376b30d><img src="'+Is+'" alt="顺丰" data-v-7376b30d></div>',1)),s(f,{to:"/user/register",class:"btn btn-primary btn-large"},{default:m(()=>[O(i(d.$t("index.try_now")||"立即体验"),1)]),_:1})])]),e("section",im,[e("h2",null,i(d.$t("index.comparison_title")||"告别传统方式，拥抱现代化文档管理"),1),e("div",rm,[e("div",cm,[e("h3",null,i(d.$t("index.traditional_doc")||"传统文档管理方式"),1),e("ul",null,[e("li",null,i(d.$t("index.comparison_1_no")||"通过IM或邮件沟通，信息零散，沟通成本高"),1),e("li",null,i(d.$t("index.comparison_2_no")||"Word等离线文档，更新后需重新发送，无法实时同步"),1),e("li",null,i(d.$t("index.comparison_3_no")||"文件多次修改后版本混乱，难以找到最新版"),1),e("li",null,i(d.$t("index.comparison_4_no")||"无法搜索历史文档，查找信息困难"),1),e("li",null,i(d.$t("index.comparison_5_no")||"多人文档协作时容易冲突，权限管理弱"),1)])]),e("div",dm,[p[3]||(p[3]=e("h3",null,"ShowDoc",-1)),e("ul",null,[e("li",null,i(d.$t("index.comparison_1_yes")||"集中管理API文档，信息一目了然"),1),e("li",null,i(d.$t("index.comparison_2_yes")||"在线实时更新，团队成员随时访问最新内容"),1),e("li",null,i(d.$t("index.comparison_3_yes")||"自动保存历史版本，可随时追溯和回滚"),1),e("li",null,i(d.$t("index.comparison_4_yes")||"强大的全文搜索，快速找到所需内容"),1),e("li",null,i(d.$t("index.comparison_5_yes")||"多人协作无缝衔接，精细权限控制"),1)])])]),e("div",um,[e("div",mm,[p[4]||(p[4]=e("div",{class:"stat-value"},"70%",-1)),e("div",_m,i(d.$t("index.comparison_communication_save")||"沟通时间节省"),1)]),e("div",pm,[p[5]||(p[5]=e("div",{class:"stat-value"},"5倍",-1)),e("div",fm,i(d.$t("index.comparison_search_speed")||"文档查找速度提升"),1)]),e("div",vm,[p[6]||(p[6]=e("div",{class:"stat-value"},"90%",-1)),e("div",hm,i(d.$t("index.comparison_update_efficiency")||"文档更新效率提升"),1)]),e("div",gm,[p[7]||(p[7]=e("div",{class:"stat-value"},"100%",-1)),e("div",ym,i(d.$t("index.comparison_version_conflict")||"版本冲突减少"),1)])])]),e("section",wm,[e("h2",null,i(d.$t("index.start_now_title")||"立即开始使用 ShowDoc"),1),e("p",null,[O(i(d.$t("index.join_teams")||"加入")+" ",1),p[8]||(p[8]=e("span",{class:"stat-highlight"},[e("span",{class:"num-digit"},"100000+")],-1)),O(" "+i(d.$t("index.join_teams_suffix")||"团队，让文档协作更高效"),1)]),e("div",bm,[e("a",{href:l.value,target:"_blank",class:"btn btn-landing-white"},i(d.$t("index.view_example")||"查看示例"),9,$m),e("a",{href:u.value,target:"_blank",class:"btn btn-landing-transparent"},i(d.$t("index.learn_more")||"了解更多"),9,km)]),e("div",Cm,[e("span",xm,[s(z(ca)),O(" "+i(d.$t("index.quick_start")||"5分钟上手"),1)]),e("span",Im,[s(z(Dt)),O(" "+i(d.$t("index.team_collab")||"团队协作"),1)])])]),s(Hs),s(ta,{visibilityHeight:400})])}}});const Tm=Y(Sm,[["__scopeId","data-v-7376b30d"]]),dS=Object.freeze(Object.defineProperty({__proto__:null,default:Tm},Symbol.toStringTag,{value:"Module"})),Mm={class:"login-page"},Lm={class:"toggle-wrapper"},Vm={class:"toggle-group"},zm={class:"login-card"},Um={class:"card-header"},Pm={class:"title"},Am={class:"form-inputs"},Dm={class:"captcha-input"},Om=["src"],Nm={class:"footer-links"},Fm=W({__name:"Login",setup(c){const{t}=te(),a=Ge(),o=xe(),l=Qe(),u=b({username:"",password:"",captcha:""}),v=b(!1),d=b(0),p=b(""),f=b(!1),$=b({enabled:!1,entrance_tips:""}),g=b(!0),n=async()=>{try{const x=await X("/api/common/createCaptcha",{},"post",!1);if(x.error_code===0){d.value=x.data.captcha_id;let S=`${ot()}/api/common/showCaptcha`;S=dt(S,{captcha_id:d.value,t:Date.now()}),p.value=S}}catch(x){console.error("获取验证码失败:",x)}},y=async()=>{try{const x=await X("/api/user/oauthInfo",{},"get",!1);x.error_code===0&&x.data&&($.value.enabled=x.data.oauth2_open>0||x.data.oauth2_open===!0,$.value.entrance_tips=x.data.oauth2_entrance_tips||"")}catch(x){console.error("获取OAuth2配置失败:",x)}},k=async()=>{try{const x=await X("/api/common/homePageSetting",{},"post",!1);x.error_code===0&&x.data&&(g.value=x.data.register_open>0||x.data.register_open===!0)}catch(x){console.error("获取注册配置失败:",x)}},r=async()=>{try{await X("/api/ScriptCron/run",{},"get",!1)}catch(x){console.error("脚本定时任务失败:",x)}},_=x=>{try{const I=decodeURIComponent(x);return!(I.search(/[^A-Za-z0-9/:\?\._\*\+\-]+.*/i)>-1||I.indexOf(".")>-1||I.indexOf("//")>-1)}catch{return!1}},h=async()=>{if(!f.value){if(a.query.redirect&&!_(a.query.redirect)){G(t("user.illegal_redirect"));return}v.value=!0;try{const x=await X("/api/user/loginByVerify",{username:u.value.username,password:u.value.password,captcha:u.value.captcha,captcha_id:d.value,redirect_login:!1},"post",!1);x.error_code===0?await w(x.data):(n(),f.value=!0,G(x.error_message||t("common.error"),{callback:()=>{setTimeout(()=>{f.value=!1},500)}}))}catch(x){n(),console.error("登录失败:",x)}finally{v.value=!1}}},w=async x=>{if(x.same_email_accounts&&x.same_email_accounts.length>0){const M=x.same_email_accounts.join("、");if(await Se(t("user.multi_account_binding_tip",{email:x.email,accounts:M,username:x.username}),t("user.multi_account_binding_title"),{confirmText:t("user.continue_login"),cancelText:t("user.switch_account")})){localStorage.setItem("userinfo",JSON.stringify(x)),l.setUserInfo(x);const U=a.query.redirect?String(a.query.redirect):"/item/index";o.replace({path:U})}else{var I=document.cookie.match(/[^ =;]+(?=\=)/g);if(I)for(var S=I.length;S--;)document.cookie=I[S]+"=0;expires="+new Date(0).toUTCString()+";path=/";localStorage.clear(),x.same_email_accounts.length>0&&(u.value.username=x.same_email_accounts[0],u.value.password="",u.value.captcha="",n())}}else{localStorage.setItem("userinfo",JSON.stringify(x)),l.setUserInfo(x);let M=decodeURIComponent(a.query.redirect||"/item/index");o.replace({path:M})}},T=()=>{const x=ot();window.location.href=`${x}/api/ExtLogin/oauth2`};return oe(async()=>{if(a.query.redirect&&!_(a.query.redirect)){G(t("user.illegal_redirect"));return}try{const I=await X("/api/user/info",{redirect_login:!1},"post",!1),S=await X("/api/user/info",{redirect_login:!1},"post",!1);if(I.error_code===0&&S.error_code===0){let M=decodeURIComponent(a.query.redirect||"/item/index");o.replace({path:M})}}catch{}const x=document.getElementsByClassName("v-modal-leave");for(let I=0;I<x.length;I++)x[I].remove();await n(),await y(),await k(),await r()}),(x,I)=>{const S=H("router-link");return C(),L("div",Mm,[e("div",Lm,[e("div",Vm,[s(ea),s(ht)])]),e("div",zm,[e("div",Um,[e("h2",Pm,i(x.$t("user.login")),1)]),e("div",Am,[s(ne,{modelValue:u.value.username,"onUpdate:modelValue":I[0]||(I[0]=M=>u.value.username=M),placeholder:x.$t("user.username_description"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:u.value.password,"onUpdate:modelValue":I[1]||(I[1]=M=>u.value.password=M),type:"password",placeholder:x.$t("user.password"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),e("div",Dm,[s(ne,{modelValue:u.value.captcha,"onUpdate:modelValue":I[2]||(I[2]=M=>u.value.captcha=M),placeholder:x.$t("user.verification_code"),onKeyup:Fe(h,["enter"])},null,8,["modelValue","placeholder"]),p.value?(C(),L("img",{key:0,src:p.value,alt:"验证码",class:"captcha-img",onClick:n},null,8,Om)):F("",!0)])]),s(K,{text:x.$t("user.login"),theme:"dark",loading:v.value,"full-width":!0,onClick:h},null,8,["text","loading"]),e("div",Nm,[g.value?(C(),B(S,{key:0,to:"/user/register"},{default:m(()=>[O(i(x.$t("user.register_new_account")),1)]),_:1})):F("",!0),$.value.enabled?(C(),L("a",{key:1,class:"oauth2-link",onClick:T},i($.value.entrance_tips||x.$t("user.oauth2_login")),1)):F("",!0)])])])}}});const qm=Y(Fm,[["__scopeId","data-v-9459121e"]]),uS=Object.freeze(Object.defineProperty({__proto__:null,default:qm},Symbol.toStringTag,{value:"Module"})),Rm={class:"register-page"},Hm={class:"toggle-wrapper"},Em={class:"toggle-group"},jm={class:"register-card"},Bm={class:"card-header"},Gm={class:"title"},Km={class:"form-inputs"},Jm={class:"captcha-input"},Wm=["src"],Ym={class:"footer-links"},Xm=W({__name:"Register",setup(c){const{t}=te();Ge();const a=xe(),o=Qe(),l=b({username:"",password:"",confirmPassword:"",captcha:""}),u=b(!1),v=b(0),d=b(""),p=async()=>{try{const $=await X("/api/common/createCaptcha",{},"post",!1);if($.error_code===0){v.value=$.data.captcha_id;let n=`${ot()}/api/common/showCaptcha`;n=dt(n,{captcha_id:v.value,t:Date.now()}),d.value=n}}catch($){console.error("获取验证码失败:",$)}},f=async()=>{u.value=!0;const $=setTimeout(()=>{u.value=!1},3e3);try{const g=await X("/api/user/registerByVerify",{username:l.value.username,password:l.value.password,confirm_password:l.value.confirmPassword,captcha:l.value.captcha,captcha_id:v.value},"post",!1);clearTimeout($),g.error_code===0?(localStorage.setItem("userinfo",JSON.stringify(g.data)),o.setUserInfo(g.data),ie.success(t("user.register_success")),a.push({path:"/item/index"})):(p(),G(g.error_message||t("common.error")))}catch(g){clearTimeout($),p(),console.error("注册失败:",g)}finally{u.value=!1}};return oe(async()=>{await p();try{(await X("/api/user/info",{redirect_login:!1},"post",!1)).error_code===0&&a.push({path:"/item/index"})}catch{}const $=document.getElementsByClassName("v-modal-leave");for(let g=0;g<$.length;g++)$[g].remove()}),($,g)=>{const n=H("router-link");return C(),L("div",Rm,[e("div",Hm,[e("div",Em,[s(ea),s(ht)])]),e("div",jm,[e("div",Bm,[e("h2",Gm,i($.$t("user.register")),1)]),e("div",Km,[s(ne,{modelValue:l.value.username,"onUpdate:modelValue":g[0]||(g[0]=y=>l.value.username=y),placeholder:$.$t("user.username_description"),onKeyup:Fe(f,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:l.value.password,"onUpdate:modelValue":g[1]||(g[1]=y=>l.value.password=y),type:"password",placeholder:$.$t("user.password"),onKeyup:Fe(f,["enter"])},null,8,["modelValue","placeholder"]),s(ne,{modelValue:l.value.confirmPassword,"onUpdate:modelValue":g[2]||(g[2]=y=>l.value.confirmPassword=y),type:"password",placeholder:$.$t("user.password_again"),onKeyup:Fe(f,["enter"])},null,8,["modelValue","placeholder"]),e("div",Jm,[s(ne,{modelValue:l.value.captcha,"onUpdate:modelValue":g[3]||(g[3]=y=>l.value.captcha=y),placeholder:$.$t("user.verification_code"),onKeyup:Fe(f,["enter"])},null,8,["modelValue","placeholder"]),d.value?(C(),L("img",{key:0,src:d.value,alt:"验证码",class:"captcha-img",onClick:p},null,8,Wm)):F("",!0)])]),s(K,{text:u.value?$.$t("user.register_loading"):$.$t("user.register"),theme:"dark",loading:u.value,"full-width":!0,onClick:f},null,8,["text","loading"]),e("div",Ym,[s(n,{to:"/user/login"},{default:m(()=>[O(i($.$t("user.login")),1)]),_:1})])])])}}});const Qm=Y(Xm,[["__scopeId","data-v-453f3347"]]),mS=Object.freeze(Object.defineProperty({__proto__:null,default:Qm},Symbol.toStringTag,{value:"Module"})),Zm={class:"reset-password-page"},e_={class:"reset-password-card"},t_={class:"card-header"},a_={class:"title"},o_={class:"form-inputs"},s_={class:"captcha-input"},l_=["src"],n_={class:"footer-links"},i_=W({__name:"ResetPassword",setup(c){const{t}=te(),a=b({email:"",captcha:""}),o=b(!1),l=b(0),u=b(""),v=async()=>{try{const p=await X("/api/common/createCaptcha",{},"post",!1);if(p.error_code===0){l.value=p.data.captcha_id;let $=`${ot()}/api/common/showCaptcha`;$=dt($,{captcha_id:l.value,t:Date.now()}),u.value=$}}catch(p){console.error("获取验证码失败:",p)}},d=async()=>{if(!a.value.email){G(t("user.email_required"));return}if(!a.value.captcha){G(t("user.captcha_required"));return}o.value=!0;try{const p=await X("/api/user/resetPasswordEmail",{email:a.value.email,captcha:a.value.captcha,captcha_id:l.value},"post",!1);p.error_code===0?(G(t("user.reset_password_email_sent")),v()):(v(),G(p.error_message||t("common.error")))}catch(p){v(),console.error("重置密码失败:",p)}finally{o.value=!1}};return oe(()=>{v();const p=document.getElementsByClassName("v-modal-leave");for(let f=0;f<p.length;f++)p[f].remove()}),(p,f)=>{const $=H("router-link");return C(),L("div",Zm,[e("div",e_,[e("div",t_,[e("h2",a_,i(p.$t("user.reset_password")),1)]),e("div",o_,[s(ne,{modelValue:a.value.email,"onUpdate:modelValue":f[0]||(f[0]=g=>a.value.email=g),type:"email",placeholder:p.$t("user.email"),onKeyup:Fe(d,["enter"])},null,8,["modelValue","placeholder"]),e("div",s_,[s(ne,{modelValue:a.value.captcha,"onUpdate:modelValue":f[1]||(f[1]=g=>a.value.captcha=g),placeholder:p.$t("user.verification_code"),onKeyup:Fe(d,["enter"])},null,8,["modelValue","placeholder"]),u.value?(C(),L("img",{key:0,src:u.value,alt:"验证码",class:"captcha-img",onClick:v},null,8,l_)):F("",!0)])]),s(K,{text:o.value?p.$t("common.submitting"):p.$t("common.submit"),theme:"dark",loading:o.value,"full-width":!0,onClick:d},null,8,["text","loading"]),e("div",n_,[s($,{to:"/user/login"},{default:m(()=>[O(i(p.$t("user.remember_password_login")),1)]),_:1})])])])}}});const r_=Y(i_,[["__scopeId","data-v-40ae47c4"]]),_S=Object.freeze(Object.defineProperty({__proto__:null,default:r_},Symbol.toStringTag,{value:"Module"})),c_={class:"reset-password-by-url-page"},d_={class:"reset-password-card"},u_={class:"card-header"},m_={class:"title"},__={class:"form-inputs"},p_={class:"footer-links"},f_=W({__name:"ResetPasswordByUrl",setup(c){const{t}=te(),a=Ge(),o=xe(),l=b({password:""}),u=b(!1),v=async()=>{if(!l.value.password){G(t("user.password_required"));return}u.value=!0;try{const d=await X("/api/user/resetPasswordByUrlToken",{new_password:l.value.password,token:a.params.token},"post",!1);d.error_code===0?G(t("user.reset_password_success"),{callback:()=>{o.replace({path:"/user/login"})}}):G(d.error_message||t("common.error"))}catch(d){console.error("重置密码失败:",d)}finally{u.value=!1}};return oe(()=>{const d=document.getElementsByClassName("v-modal-leave");for(let p=0;p<d.length;p++)d[p].remove()}),(d,p)=>{const f=H("router-link");return C(),L("div",c_,[e("div",d_,[e("div",u_,[e("h2",m_,i(d.$t("user.reset_password")),1)]),e("div",__,[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=$=>l.value.password=$),type:"password",placeholder:d.$t("user.new_password"),onKeyup:Fe(v,["enter"])},null,8,["modelValue","placeholder"])]),s(K,{text:u.value?d.$t("common.submitting"):d.$t("common.submit"),theme:"dark",loading:u.value,"full-width":!0,onClick:v},null,8,["text","loading"]),e("div",p_,[s(f,{to:"/user/login"},{default:m(()=>[O(i(d.$t("user.remember_password_login")),1)]),_:1})])])])}}});const v_=Y(f_,[["__scopeId","data-v-5fc93290"]]),pS=Object.freeze(Object.defineProperty({__proto__:null,default:v_},Symbol.toStringTag,{value:"Module"})),h_={class:"verify-email-by-url-page"},g_=W({__name:"VerifyEmailByUrl",setup(c){const t=xe(),a=Ge(),{t:o}=te();return oe(async()=>{const l=a.params.token;if(!l){await G(o("user.invalid_token")),t.replace("/user/login");return}try{await X("/api/user/verifyEmailByUrlToken",{token:l}),await Se({msg:o("user.verify_email_success"),confirmText:o("common.confirm")}),t.replace("/user/login")}catch(u){console.error("验证邮箱失败:",u),await G(o("common.error")),t.replace("/user/login")}}),(l,u)=>(C(),L("div",h_))}});const y_=Y(g_,[["__scopeId","data-v-e32ac40e"]]),fS=Object.freeze(Object.defineProperty({__proto__:null,default:y_},Symbol.toStringTag,{value:"Module"})),w_={class:"password-modal"},b_={class:"modal-content"},$_={class:"form-item"},k_={class:"form-label"},C_={class:"form-item"},x_={class:"form-label"},I_={class:"form-item"},S_={class:"form-label"},T_={class:"modal-footer"},M_=W({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(0),u=b(!1),v=b({password:"",new_password:"",confirm_password:""}),d=async()=>{if(!v.value.password){await G(t("user.old_password_required"));return}if(!v.value.new_password){await G(t("user.new_password_required"));return}if(v.value.new_password!==v.value.confirm_password){await G(t("user.password_mismatch"));return}u.value=!0;try{await X("/api/user/resetPassword",{new_password:v.value.new_password,password:v.value.password}),G(t("user.modify_success"),{callback:()=>{a.onClose(!0)}})}catch(f){console.error("修改密码失败:",f)}finally{u.value=!1}},p=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{l.value++,setTimeout(()=>{o.value=!0})}),(f,$)=>(C(),L("div",w_,[s(de,{class:re({show:o.value}),title:f.$t("user.modify_password"),onClose:p},{default:m(()=>[e("div",b_,[e("div",$_,[e("label",k_,i(f.$t("user.old_password")),1),s(ne,{modelValue:v.value.password,"onUpdate:modelValue":$[0]||($[0]=g=>v.value.password=g),type:"password",placeholder:f.$t("user.old_password")},null,8,["modelValue","placeholder"])]),e("div",C_,[e("label",x_,i(f.$t("user.new_password")),1),s(ne,{modelValue:v.value.new_password,"onUpdate:modelValue":$[1]||($[1]=g=>v.value.new_password=g),type:"password",placeholder:f.$t("user.new_password")},null,8,["modelValue","placeholder"])]),e("div",I_,[e("label",S_,i(f.$t("user.confirm_password")),1),s(ne,{modelValue:v.value.confirm_password,"onUpdate:modelValue":$[2]||($[2]=g=>v.value.confirm_password=g),type:"password",placeholder:f.$t("user.confirm_password")},null,8,["modelValue","placeholder"])])]),e("div",T_,[s(K,{onClick:p},{default:m(()=>[O(i(f.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:d,loading:u.value},{default:m(()=>[O(i(f.$t("common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["class","title"])]))}});const L_=Y(M_,[["__scopeId","data-v-fb58e031"]]);function V_(){return new Promise(c=>{const{app:t,mountNode:a}=ve(L_,{onClose:()=>{c(),me(t,a)}});t.mount(a)})}const z_={class:"push-url-modal"},U_={class:"modal-content"},P_={class:"description"},A_={class:"steps"},D_={class:"form-item"},O_={class:"form-label"},N_={class:"modal-footer"},F_=W({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(0),u=b(!1),v=b({push_url:""}),d=async()=>{try{const $=await X("/api/user/getPushUrl",{});$&&$.data&&(v.value.push_url=$.data.push_url||$.data)}catch($){console.error("获取推送地址失败:",$)}},p=async()=>{if(!v.value.push_url){ie.warning(t("user.push_url_required"));return}u.value=!0;try{await X("/api/user/savePushUrl",{push_url:v.value.push_url}),ie.success(t("user.save_success")),a.onClose(!0)}catch($){console.error("保存推送地址失败:",$)}finally{u.value=!1}},f=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{l.value++,setTimeout(()=>{o.value=!0,d()})}),($,g)=>(C(),L("div",z_,[s(de,{class:re({show:o.value}),title:$.$t("user.wechat_push_url"),onClose:f},{default:m(()=>[e("div",U_,[e("div",P_,[e("p",null,i($.$t("user.push_url_desc_title")),1),e("ol",A_,[e("li",null,i($.$t("user.push_url_step1")),1),e("li",null,i($.$t("user.push_url_step2")),1),e("li",null,i($.$t("user.push_url_step3")),1),e("li",null,i($.$t("user.push_url_step4")),1)]),e("p",null,i($.$t("user.push_url_desc_footer")),1)]),e("div",D_,[e("label",O_,i($.$t("user.wechat_push_url")),1),s(ne,{modelValue:v.value.push_url,"onUpdate:modelValue":g[0]||(g[0]=n=>v.value.push_url=n),placeholder:$.$t("user.push_url_placeholder")},null,8,["modelValue","placeholder"])])]),e("div",N_,[s(K,{onClick:f},{default:m(()=>[O(i($.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:p,loading:u.value},{default:m(()=>[O(i($.$t("common.save")),1)]),_:1},8,["loading"])])]),_:1},8,["class","title"])]))}});const q_=Y(F_,[["__scopeId","data-v-258f557b"]]);let Nt=!1;function R_(){return new Promise(c=>{if(Nt){console.warn("[PushUrlModal] 已经有弹窗在显示，忽略新的调用"),c(!1);return}Nt=!0;const{app:t,mountNode:a}=ve(q_,{onClose:o=>{Nt=!1,c(o),me(t,a)}});t.mount(a)})}const H_={class:"user-center-modal"},E_={class:"modal-content"},j_={key:0,class:"user-info"},B_={class:"name"},G_={class:"username"},K_={class:"menu-list"},J_={class:"menu-item-content"},W_={class:"menu-item-label"},Y_={class:"menu-item-content"},X_={class:"menu-item-label"},Q_={class:"bottom-actions"},Z_=W({__name:"index",props:{onClose:{type:Function}},setup(c){const{t,locale:a}=te(),o=xe(),l=Qe(),u=c,v=b(!1),d=b({username:"",name:""}),p=b({url:""}),f=q(()=>a.value.toLowerCase()==="zh-cn"),$=async()=>{try{const h=await X("/api/user/info",{});h&&h.data&&(d.value=h.data,y())}catch(h){console.error("获取用户信息失败:",h)}},g=async()=>{const h=await it(t("user.edit_name"),d.value.name,t("user.name_tips"));if(h&&h!==d.value.name)try{await X("/api/user/updateInfo",{name:h}),ie.success(t("user.modify_success")),$()}catch(w){console.error("修改姓名失败:",w)}},n=async()=>{await V_()},y=async()=>{try{const h=await X("/api/user/getPushUrl",{});h&&h.data&&(p.value.url=h.data)}catch(h){console.error("获取推送地址失败:",h)}},k=async()=>{await R_()&&await y()},r=async()=>{if(await Se({title:t("common.confirm"),msg:t("user.confirm_logout"),confirmText:t("common.confirm"),cancelText:t("common.cancel")})){await X("/api/user/logout",{confirm:"1"});const w=document.cookie.match(/[^ =;]+(?==)/g);w&&w.forEach(T=>{document.cookie=`${T}=0;expires=${new Date(0).toUTCString()}`}),localStorage.clear(),l.logout(),o.push({path:"/"}),_()}},_=()=>{v.value=!1,setTimeout(()=>{u.onClose(!0)},300)};return oe(()=>{$(),setTimeout(()=>{v.value=!0})}),(h,w)=>(C(),L("div",H_,[s(de,{class:re({show:v.value}),title:h.$t("user.user_center"),icon:["fas","user"],width:"600px",onClose:_},{default:m(()=>[e("div",E_,[d.value.username?(C(),L("div",j_,[e("div",{onClick:g,class:"user-name"},[e("span",B_,i(d.value.name||h.$t("user.unnamed_user")),1),w[0]||(w[0]=e("i",{class:"fas fa-pencil edit-icon"},null,-1))]),e("div",G_,i(d.value.username),1)])):F("",!0),e("div",K_,[f.value?(C(),L("div",{key:0,class:"menu-item",onClick:k},[e("div",J_,[w[1]||(w[1]=e("div",{class:"menu-item-icon push-icon"},[e("i",{class:"fas fa-bell"})],-1)),e("span",W_,i(h.$t("user.wechat_push_url")),1)]),w[2]||(w[2]=e("i",{class:"fas fa-chevron-right arrow-icon"},null,-1))])):F("",!0),e("div",{class:"menu-item",onClick:n},[e("div",Y_,[w[3]||(w[3]=e("div",{class:"menu-item-icon password-icon"},[e("i",{class:"fas fa-key"})],-1)),e("span",X_,i(h.$t("user.modify_password")),1)]),w[4]||(w[4]=e("i",{class:"fas fa-chevron-right arrow-icon"},null,-1))])]),e("div",Q_,[e("div",{class:"action-btn logout-btn",onClick:r},i(h.$t("user.logout")),1)])])]),_:1},8,["class","title"])]))}});const ep=Y(Z_,[["__scopeId","data-v-d94d25b0"]]);function oa(){return new Promise(c=>{const{app:t,mountNode:a}=ve(ep,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const tp={class:"user-setting-page"},ap=W({__name:"Setting",setup(c){const t=xe(),a=()=>{t.push("/item/index")};return oe(async()=>{await oa(),a()}),(o,l)=>(C(),L("div",tp))}});const op=Y(ap,[["__scopeId","data-v-5993ba92"]]),vS=Object.freeze(Object.defineProperty({__proto__:null,default:op},Symbol.toStringTag,{value:"Module"})),sp={class:"login-by-token-page"},lp={class:"loading-container"},np={class:"loading-text"},ip=W({__name:"LoginByUserToken",setup(c){const t=xe(),a=Ge(),{t:o}=te(),l=He(),u=b(o("user.token_login_loading"));return oe(async()=>{try{const v=a.query.user_token;if(!v){u.value=o("user.token_login_parameter_error"),setTimeout(()=>{t.replace("/user/login")},2e3);return}const d=await X("/api/user/info",{user_token:v,redirect_login:!1},"post",!1);if(d.error_code===0&&d.data){const p=d.data;p.user_token=v,ro(p);const f=new Date;f.setTime(f.getTime()+180*24*60*60*1e3);const $=`expires=${f.toGMTString()}`;document.cookie=`cookie_token=${v}; samesite=strict; path=/; ${$}`,l.setNewMsg(d.data.new_msg||0),u.value=o("user.token_login_success")}else u.value=o("user.token_login_failed")}catch(v){console.error("Token 登录失败:",v),u.value=o("user.token_login_failed")}setTimeout(()=>{const v=decodeURIComponent(a.query.redirect_uri||"/item/index");t.replace({path:v})},1e3)}),(v,d)=>(C(),L("div",sp,[e("div",lp,[d[0]||(d[0]=e("div",{class:"loading-spinner"},null,-1)),e("p",np,i(u.value),1)])]))}});const rp=Y(ip,[["__scopeId","data-v-fe023571"]]),hS=Object.freeze(Object.defineProperty({__proto__:null,default:rp},Symbol.toStringTag,{value:"Module"})),cp={class:"feedback-modal"},dp={class:"modal-content"},up={class:"feedback-info"},mp={class:"info-text"},_p={class:"link-box"},pp={class:"link-text"},fp={class:"star-tip"},vp={class:"modal-footer"},hp="https://github.com/star7th/showdoc/issues",gp=W({__name:"index",props:{onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=()=>{window.open(hp,"_blank")},l=()=>{a.value=!1,setTimeout(()=>{t.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{a.value=!0})}),(u,v)=>(C(),L("div",cp,[a.value?(C(),B(de,{key:0,class:re({show:a.value}),title:u.$t("feedback.feedback"),icon:["fas","circle-info"],maxWidth:"500px",onClose:l},{default:m(()=>[e("div",dp,[e("div",up,[e("div",mp,[e("span",null,i(u.$t("feedback.feedbackDescription")),1)]),e("div",_p,[e("div",{class:"github-link",onClick:o},[e("span",pp,i(u.$t("feedback.githubLinkText")),1)]),e("div",fp,[v[0]||(v[0]=e("i",{class:"fas fa-star"},null,-1)),e("span",null,i(u.$t("feedback.starTip")),1)])])])]),e("div",vp,[e("div",{class:"secondary-button",onClick:l},i(u.$t("common.cancel")),1),e("div",{class:"primary-button",onClick:o},i(u.$t("feedback.goToGithub")),1)])]),_:1},8,["class","title"])):F("",!0)]))}});const yp=Y(gp,[["__scopeId","data-v-a3a5d7b9"]]);function Ra(){return new Promise(c=>{const{app:t,mountNode:a}=ve(yp,{onClose:(o=!1)=>{c(o),me(t,a)}});t.mount(a)})}const wp={class:"message-modal"},bp={class:"modal-content"},$p={class:"message-content"},kp={key:0},Cp={class:"message-line"},xp={key:0,class:"message-remark"},Ip={key:1},Sp={class:"message-line"},Tp={key:2},Mp=["innerHTML"],Lp=["innerHTML"],Vp={class:"modal-footer"},zp={class:"center-button"},Up=W({__name:"index",props:{onClose:{type:Function},initialTab:{}},setup(c){const{t,locale:a}=te(),o=xe(),l=c,u=b(!1),v=b(l.initialTab||"remindList"),d=b([]),p=b([]),f=b(!1),$=b(!1),g=q(()=>[{text:t("feedback.feedback"),icon:["fas","headphones"],onClick:()=>{Ra()}}]),n=q(()=>[{title:"",key:"status",width:70},{title:t("message.send_time"),key:"addtime",width:180},{title:t("message.content"),key:"message_content"}]),y=q(()=>[{title:"",key:"status",width:70},{title:t("message.send_time"),key:"addtime",width:180},{title:t("message.content"),key:"message_content"}]),k=b({current:1,pageSize:6,total:0}),r=q(()=>a.value==="zh-CN"?'你在showdoc购买的付费版资格很快过期了，你可以<a href="/user/setting" target="_blank">点此进入用户中心</a>进行续费 (如已续费请忽略该通知)':'Your paid ShowDoc subscription will expire soon. <a href="/user/setting" target="_blank">Click here to go to User Center</a> to renew (ignore if already renewed)'),_=async()=>{$.value=!0;try{const U=(await co()).data||[];p.value=U.filter(N=>{const A=N.message_type||"announce";return A==="announce"||A==="announce_web"||A==="announce_all"});for(const N of p.value)w(N.from_uid,N.message_content_id)}catch(V){console.error("获取公告列表失败:",V)}finally{$.value=!1}},h=async()=>{f.value=!0;try{const V=await uo({page:k.value.current,count:k.value.pageSize});d.value=V.data.list||[],k.value.total=V.data.total||0;for(const U of d.value)w(U.from_uid,U.message_content_id)}catch(V){console.error("获取提醒列表失败:",V)}finally{f.value=!1}},w=async(V,U)=>{if(U)try{await mo({from_uid:V,message_content_id:U})}catch(N){console.error("设置已读失败:",N)}},T=(V,U)=>{const N=o.resolve({path:`/${V}/${U}`});window.open(N.href,"_blank")},x=(V,U)=>{const N=o.resolve({path:`/${V}/${U}`});window.open(N.href+"#comment-area","_blank")},I=V=>{k.value.current=V,h()},S=V=>{V==="remindList"?h():V==="announcementList"&&_()},M=()=>{u.value=!1,setTimeout(()=>{l.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{u.value=!0}),h(),_()}),(V,U)=>{const N=H("a-badge"),A=H("a-button"),P=H("a-tab-pane"),D=H("a-tabs");return C(),L("div",wp,[s(de,{class:re({show:u.value}),title:V.$t("message.my_notice"),icon:["fas","message"],headerButtons:g.value,width:"800px",onClose:M},{default:m(()=>[e("div",bp,[s(D,{activeKey:v.value,"onUpdate:activeKey":U[0]||(U[0]=E=>v.value=E),onChange:S},{default:m(()=>[s(P,{key:"remindList",tab:V.$t("message.system_reminder")},{default:m(()=>[s(Le,{tableHeader:n.value,tableData:d.value,pagination:k.value,loading:f.value,rowKey:E=>E.id,onPageChange:I},{"cell-status":m(({row:E})=>[E.status===0?(C(),B(N,{key:0,value:"new"})):F("",!0)]),"cell-message_content":m(({row:E})=>[e("div",$p,[(E.action_type==="create"||E.action_type==="update")&&E.object_type==="page"&&E.page_data?(C(),L("div",kp,[e("div",Cp,[O(i(E.from_name)+" "+i(V.$t("message.update_the_page"))+" ",1),s(A,{type:"link",onClick:ae=>T(E.page_data.item_id,E.page_data.page_id)},{default:m(()=>[O(i(E.page_data.page_title),1)]),_:2},1032,["onClick"])]),E.message_content?(C(),L("div",xp,i(V.$t("message.update_remark"))+": "+i(E.message_content),1)):F("",!0)])):F("",!0),(E.action_type==="comment"||E.action_type==="comment_reply")&&E.object_type==="page"&&E.page_data?(C(),L("div",Ip,[e("div",Sp,[O(i(E.message_content)+" ",1),s(A,{type:"link",onClick:ae=>x(E.page_data.item_id,E.page_data.page_id)},{default:m(()=>[O(i(E.page_data.page_title),1)]),_:2},1032,["onClick"])])])):F("",!0),E.object_type==="vip"?(C(),L("div",Tp,[e("span",{innerHTML:r.value},null,8,Mp)])):F("",!0)])]),_:1},8,["tableHeader","tableData","pagination","loading","rowKey"])]),_:1},8,["tab"]),s(P,{key:"announcementList",tab:V.$t("message.system_announcement")},{default:m(()=>[s(Le,{tableHeader:y.value,tableData:p.value,loading:$.value,rowKey:E=>E.id,"max-height":"500px"},{"cell-status":m(({row:E})=>[E.status===0?(C(),B(N,{key:0,value:"new"})):F("",!0)]),"cell-message_content":m(({row:E})=>[e("div",{class:"message-content",innerHTML:E.message_content},null,8,Lp)]),_:1},8,["tableHeader","tableData","loading","rowKey"])]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),e("div",Vp,[e("div",zp,[s(K,{onClick:M},{default:m(()=>[O(i(V.$t("common.close")),1)]),_:1})])])]),_:1},8,["class","title","headerButtons"])])}}});const Pp=Y(Up,[["__scopeId","data-v-d5889703"]]);function sa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Pp,{initialTab:c,onClose:(l=!1)=>{t(l),me(a,o)}});a.mount(o)})}const Ap={class:"upload-modal"},Dp={class:"upload-container"},Op=["innerHTML"],Np={class:"ant-upload-hint"},Fp={key:0,class:"upload-queue"},qp={class:"queue-title"},Rp={class:"queue-list"},Hp={class:"file-info"},Ep={class:"file-name"},jp={class:"file-size"},Bp={class:"status-info"},Gp={key:0,class:"status waiting"},Kp={key:1,class:"status uploading"},Jp={key:2,class:"status success"},Wp=["href"],Yp={key:1},Xp={key:3,class:"status error"},Qp={key:0,class:"upload-actions"},Zp={key:1,class:"upload-progress"},ef={class:"progress-text"},tf=W({__name:"index",props:{onClose:{type:Function},callback:{type:Function}},setup(c){const{t}=te(),a=Qe(),o=c,l=b(!1),u=b([]),v=b(!1),d=b(0),p=b(0),f=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=(w,T)=>(u.value.find(I=>I.file.name===w.name&&I.file.size===w.size)||(u.value.push({file:w,status:"waiting",error:""}),v.value||setTimeout(()=>{n()},100)),!1),n=async()=>{if(u.value.length!==0){if(v.value){p.value=u.value.filter(w=>w.status==="waiting"||w.status==="uploading"||w.status==="success").length;return}v.value=!0,d.value=0,p.value=u.value.filter(w=>w.status==="waiting").length,f.value=0,y()}},y=()=>{for(;f.value<u.value.length;){const x=u.value[f.value];if(x.status==="waiting"){x.status="uploading",k(x.file);return}f.value++}v.value=!1;const w=u.value.filter(x=>x.status==="success").length,T=u.value.filter(x=>x.status==="error").length;T===0?(j.success(t("attachment.batch_upload_complete_success",{count:w})),setTimeout(()=>{h(!0)},1500)):j.warning(t("attachment.batch_upload_complete_partial",{success:w,error:T}))},k=async w=>{const T=new FormData;T.append("file",w),T.append("user_token",a.userToken);try{const x=await X("/api/page/upload",T,"post",!1);r(x)}catch(x){console.error("上传文件失败:",x),uploadError(null,w)}},r=w=>{const T=u.value[f.value];T&&(w.success===1?(T.status="success",T.url=w.url):(T.status="error",T.error=w.error_message||t("attachment.upload_failed_error")),d.value++,y())},_=w=>{if(w===0)return"0 B";const T=1024,x=["B","KB","MB","GB"],I=Math.floor(Math.log(w)/Math.log(T));return parseFloat((w/Math.pow(T,I)).toFixed(2))+" "+x[I]},h=w=>{l.value=!1,setTimeout(()=>{o.onClose(w)},300)};return oe(()=>{setTimeout(()=>{l.value=!0})}),(w,T)=>{const x=H("a-upload-dragger"),I=H("a-progress");return C(),L("div",Ap,[s(de,{class:re({show:l.value}),title:w.$t("common.upload"),maxWidth:"700px",onClose:T[0]||(T[0]=S=>h(!1))},{default:m(()=>[e("div",Dp,[s(x,{name:"file",multiple:!0,"show-upload-list":!1,"before-upload":g,"custom-request":()=>{}},{default:m(()=>[T[1]||(T[1]=e("p",{class:"ant-upload-drag-icon"},[e("i",{class:"fas fa-cloud-upload-alt"})],-1)),e("p",{class:"ant-upload-text",innerHTML:w.$t("attachment.import_file_tips2")},null,8,Op),e("p",Np,i(w.$t("attachment.batch_upload_support")),1)]),_:1}),u.value.length>0?(C(),L("div",Fp,[e("div",qp,i(w.$t("attachment.upload_queue_files",{count:u.value.length}))+": ",1),e("div",Rp,[(C(!0),L(Ce,null,Pe(u.value,(S,M)=>(C(),L("div",{key:M,class:re(["queue-item",{uploading:S.status==="uploading",success:S.status==="success",error:S.status==="error"}])},[e("div",Hp,[T[2]||(T[2]=e("i",{class:"fas fa-file"},null,-1)),e("span",Ep,i(S.file.name),1),e("span",jp,"("+i(_(S.file.size))+")",1)]),e("div",Bp,[S.status==="waiting"?(C(),L("span",Gp,i(w.$t("attachment.file_waiting")),1)):S.status==="uploading"?(C(),L("span",Kp,[T[3]||(T[3]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(w.$t("attachment.file_uploading")),1)])):S.status==="success"?(C(),L("span",Jp,[T[4]||(T[4]=e("i",{class:"fas fa-check"},null,-1)),S.url?(C(),L("a",{key:0,href:S.url,target:"_blank",class:"success-link"},i(w.$t("attachment.file_upload_success")),9,Wp)):(C(),L("span",Yp,i(w.$t("attachment.file_upload_success")),1))])):S.status==="error"?(C(),L("span",Xp,[T[5]||(T[5]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(w.$t("attachment.file_upload_failed"))+": "+i(S.error),1)])):F("",!0)])],2))),128))]),u.value.length>0&&!v.value?(C(),L("div",Qp,[s(K,{onClick:w.clearQueue},{default:m(()=>[O(i(w.$t("attachment.clear_queue")),1)]),_:1},8,["onClick"])])):F("",!0),v.value?(C(),L("div",Zp,[e("div",ef,i(w.$t("attachment.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(I,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const af=Y(tf,[["__scopeId","data-v-fadd0a36"]]);function of(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(af,{...c,onClose:l=>{c!=null&&c.callback&&c.callback(),t(l),me(a,o)}});a.mount(o)})}const sf={class:"attachment-modal"},lf={class:"search-bar"},nf={class:"search-item"},rf={class:"search-item"},cf={class:"search-item"},df={class:"search-item"},uf={class:"info-bar"},mf={class:"tools"},_f=["onClick"],pf=["onClick"],ff=["onClick"],vf=W({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b(""),v=b("-1"),d=q(()=>[{label:t("attachment.all_attachment_type"),value:"-1"},{label:t("attachment.image"),value:"1"},{label:t("attachment.general_attachment"),value:"2"}]),p=b(0),f=b(0),$=b(!1),g=b([]),n=b({current:1,pageSize:10,total:0}),y=q(()=>[{title:t("attachment.file_id"),key:"file_id",width:60},{title:t("attachment.display_name"),key:"display_name",width:180},{title:t("attachment.file_type"),key:"file_type",width:80},{title:t("attachment.file_size_m"),key:"file_size_m",width:70},{title:t("attachment.visit_times"),key:"visit_times",width:70},{title:t("attachment.add_time"),key:"addtime",width:120},{title:t("common.operation"),key:"tools",width:180,tools:!0}]),k=async()=>{l.value=!0;try{const I=await _o({page:n.value.current,count:n.value.pageSize,attachment_type:v.value,display_name:u.value});I.data&&(g.value=I.data.list||[],n.value.total=I.data.total||0,p.value=I.data.used_m||0,f.value=I.data.used_flow_m||0)}catch(I){console.error("Failed to fetch attachment list:",I)}finally{l.value=!1}},r=()=>{n.value.current=1,k()},_=I=>{n.value.current=I,k()},h=I=>{I.url&&window.open(I.url,"_blank")},w=I=>{I.url&&navigator.clipboard.writeText(I.url).then(()=>{j.success(t("common.copy_success"))}).catch(()=>{j.error(t("common.copy_failed"))})},T=async I=>{try{await new Promise((S,M)=>{po(()=>import("./components-bd088a2a.js").then(V=>V.t),["./components-bd088a2a.js","./vendor-vue-f1f9849c.js","./vendor-8fa27e24.js","./vendor-49dc2278.css","./vendor-vue-e0182f4b.css","./core-31cf74c4.js","./components-1f240282.css"],import.meta.url).then(({default:V})=>{V({msg:t("attachment.confirm_delete"),title:t("common.tips")}).then(S).catch(M)})}),await fo({file_id:I.file_id}),j.success(t("common.op_success")),k()}catch{}},x=I=>{o.value=!1,setTimeout(()=>{a.onClose(I)},300)};return oe(()=>{setTimeout(()=>{o.value=!0}),k()}),(I,S)=>(C(),L("div",sf,[s(de,{class:re({show:o.value}),title:I.$t("attachment.my_attachment"),width:"1100px",onClose:S[3]||(S[3]=M=>x(!1))},{default:m(()=>[e("div",lf,[e("div",nf,[s(ne,{modelValue:u.value,"onUpdate:modelValue":S[0]||(S[0]=M=>u.value=M),placeholder:I.$t("attachment.display_name"),onKeyup:Fe(r,["enter"])},null,8,["modelValue","placeholder"])]),e("div",rf,[s(Re,{value:v.value,"onUpdate:value":S[1]||(S[1]=M=>v.value=M),options:d.value,style:{width:"150px"},onChange:r},null,8,["value","options"])]),e("div",cf,[s(K,{onClick:r},{default:m(()=>[O(i(I.$t("common.search")),1)]),_:1})]),e("div",df,[s(K,{type:"primary",onClick:S[2]||(S[2]=M=>$.value=!0)},{default:m(()=>[O(i(I.$t("common.upload")),1)]),_:1})])]),e("div",uf,[e("span",null,i(I.$t("attachment.accumulated_used_space"))+" "+i(p.value)+"M , "+i(I.$t("attachment.month_flow"))+" "+i(f.value)+"M ",1)]),s(Le,{tableHeader:y.value,tableData:g.value,pagination:n.value,loading:l.value,maxHeight:"400px",onPageChange:_},{"cell-tools":m(({row:M})=>[e("div",mf,[e("span",{class:"tools-item clickable",onClick:V=>h(M)},i(I.$t("attachment.visit")),9,_f),e("span",{class:"tools-item clickable",onClick:V=>w(M)},i(I.$t("attachment.copy_link")),9,pf),e("span",{class:"tools-item clickable",onClick:V=>T(M)},i(I.$t("common.delete")),9,ff)])]),_:1},8,["tableHeader","tableData","pagination","loading"])]),_:1},8,["class","title"]),$.value?(C(),B(z(of),{key:0,callback:()=>{$.value=!1,k()}},null,8,["callback"])):F("",!0)]))}});const hf=Y(vf,[["__scopeId","data-v-1ef80ed5"]]);function gf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(hf,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const yf={class:"add-team-member-modal"},wf={class:"form-content"},bf={class:"form-item"},$f={class:"form-label"},kf={class:"select-wrapper"},Cf={class:"user-option"},xf={class:"username"},If={key:0,class:"name"},Sf={class:"form-item"},Tf={class:"form-label"},Mf={class:"radio-group-wrapper"},Lf={class:"modal-footer"},Vf=W({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=b({member_username:"",team_member_group_id:"1"}),d=async()=>{l.value=!0;try{const g=await jt({username:""});g.error_code===0&&g.data&&(u.value=g.data.map(n=>({username:n.username,name:n.name,value:n.username,label:n.name?`${n.username}(${n.name})`:n.username})))}catch(g){console.error("获取全站用户列表失败:",g)}finally{l.value=!1}},p=(g,n)=>{var r,_;const y=((r=n.label)==null?void 0:r.toLowerCase())||"",k=((_=n.value)==null?void 0:_.toLowerCase())||"";return y.includes(g.toLowerCase())||k.includes(g.toLowerCase())},f=async()=>{if(!v.value.member_username.trim()){await G(t("item.member_username")+t("common.required"));return}try{const g=await wa({team_id:a.team_id,member_username:v.value.member_username,team_member_group_id:v.value.team_member_group_id});g.error_code===0?(ie.success(t("common.op_success")),$(),a.onClose(!0)):g.error_code===10310?await G(t("item.member_limit_exceeded_with_link"),{dangerouslyUseHTMLString:!0}):await G(g.error_message||t("common.op_failed"))}catch(g){console.error("添加成员失败:",g),await G(t("common.op_failed"))}},$=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{d(),setTimeout(()=>{o.value=!0})}),(g,n)=>{const y=H("a-select-option"),k=H("a-select"),r=H("a-radio"),_=H("a-radio-group");return C(),L("div",yf,[s(de,{class:re({show:o.value}),title:z(t)("item.add_member"),icon:["fas","user-plus"],width:"500px",onClose:$},{default:m(()=>[e("div",wf,[e("div",bf,[e("div",$f,i(z(t)("item.member_username")),1),e("div",kf,[s(k,{value:v.value.member_username,"onUpdate:value":n[0]||(n[0]=h=>v.value.member_username=h),"show-search":"","filter-option":p,placeholder:z(t)("item.search_member_placeholder"),loading:l.value,style:{width:"100%"}},{default:m(()=>[(C(!0),L(Ce,null,Pe(u.value,h=>(C(),B(y,{key:h.username,value:h.username,label:h.username},{default:m(()=>[e("div",Cf,[e("span",xf,i(h.username),1),h.name&&h.name!==h.username?(C(),L("span",If," ("+i(h.name)+") ",1)):F("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","loading"])])]),e("div",Sf,[e("div",Tf,i(z(t)("item.member_authority")),1),e("div",Mf,[s(_,{value:v.value.team_member_group_id,"onUpdate:value":n[1]||(n[1]=h=>v.value.team_member_group_id=h)},{default:m(()=>[s(r,{value:"1",class:"radio-option"},{default:m(()=>[O(i(z(t)("item.ordinary_member")),1)]),_:1}),s(r,{value:"2",class:"radio-option"},{default:m(()=>[O(i(z(t)("item.team_admin")),1)]),_:1})]),_:1},8,["value"])])])]),e("div",Lf,[e("div",{class:"secondary-button",onClick:n[2]||(n[2]=h=>$())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:n[3]||(n[3]=h=>f())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const zf=Y(Vf,[["__scopeId","data-v-86bbe5b4"]]);function Uf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(zf,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Pf={class:"team-member-modal"},Af={class:"modal-content"},Df={class:"member-info"},Of=["onClick"],Nf=W({__name:"index",props:{team_id:{},team_manage:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=q(()=>[{title:t("item.member_username"),key:"member_username",width:200},{title:t("item.member_authority"),key:"team_member_group_id",width:150},{title:t("team.name"),key:"name",width:150},{title:t("item.addtime"),key:"addtime",width:180},{title:t("common.operation"),key:"operation",width:100}]),d=q(()=>a.team_manage>0?[{text:t("item.add_member"),icon:["fas","plus"],onClick:f}]:[]),p=async()=>{l.value=!0;try{const n=await Bt(a.team_id);n.error_code===0&&(u.value=n.data||[])}catch(n){console.error("获取团队成员列表失败:",n)}finally{l.value=!1}},f=async()=>{await Uf(a.team_id)&&p()},$=async n=>{if(await Se({msg:t("item.confirm_delete_member"),title:t("item.confirm_delete")}))try{await ba(n),ie.success(t("common.op_success")),p()}catch(k){console.error("删除成员失败:",k)}},g=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{o.value=!0,p()})}),(n,y)=>{const k=H("a-tag");return C(),L("div",Pf,[s(de,{class:re({show:o.value}),title:z(t)("item.manage_members"),icon:["fas","user-group"],width:"1000px",headerButtons:d.value,onClose:g},{default:m(()=>[e("div",Af,[s(Le,{tableHeader:v.value,tableData:u.value,loading:l.value},{"cell-member_username":m(({row:r})=>[e("div",Df,[e("span",null,i(r.member_username),1)])]),"cell-team_member_group_id":m(({row:r})=>[s(k,{color:r.team_member_group_id==2?"blue":"default"},{default:m(()=>[O(i(r.team_member_group_id==2?z(t)("team.team_admin"):z(t)("item.ordinary_member")),1)]),_:2},1032,["color"])]),"cell-name":m(({row:r})=>[e("span",null,i(r.name),1)]),"cell-addtime":m(({row:r})=>[e("span",null,i(r.addtime),1)]),"cell-operation":m(({row:r})=>[c.team_manage>0?(C(),L("span",{key:0,class:"operation-btn danger",onClick:_=>$(r.id)},i(z(t)("common.delete")),9,Of)):F("",!0)]),_:1},8,["tableHeader","tableData","loading"])])]),_:1},8,["class","title","headerButtons"])])}}});const Ff=Y(Nf,[["__scopeId","data-v-f9953c68"]]);function qf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ff,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Rf={class:"bind-item-modal"},Hf={class:"form-content"},Ef={class:"form-item"},jf={class:"form-label"},Bf={class:"form-item"},Gf=["href"],Kf={class:"modal-footer"},Jf=W({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),u=b([]),v=b({item_id:[]}),d=q(()=>u.value.map(y=>({label:y.item_name,value:y.item_id}))),p=q(()=>a.resolve({path:"/item/index"}).href),f=(y,k)=>k.label.toLowerCase().includes(y.toLowerCase()),$=async()=>{try{const y=await kt(0);y.error_code===0&&(u.value=(y.data||[]).filter(k=>k.manage))}catch(y){console.error("获取项目列表失败:",y)}},g=async()=>{if(!v.value.item_id||v.value.item_id.length===0){await G(t("item.item")+t("common.required"));return}try{for(const y of v.value.item_id)await Gt(String(y),String(o.team_id));ie.success(t("common.op_success")),n(),o.onClose(!0)}catch(y){console.error("绑定项目失败:",y),await G(t("common.op_failed"))}},n=()=>{l.value=!1,setTimeout(()=>{o.onClose(!1)},300)};return oe(()=>{$(),setTimeout(()=>{l.value=!0})}),(y,k)=>{const r=H("a-select");return C(),L("div",Rf,[s(de,{class:re({show:l.value}),title:z(t)("item.item"),icon:["fas","folder-plus"],width:"500px",onClose:n},{default:m(()=>[e("div",Hf,[e("div",Ef,[e("div",jf,i(z(t)("item.please_choose")),1),s(r,{value:v.value.item_id,"onUpdate:value":k[0]||(k[0]=_=>v.value.item_id=_),mode:"multiple",placeholder:z(t)("item.please_choose"),options:d.value,"filter-option":f,"show-search":"",style:{width:"100%"}},null,8,["value","placeholder","options"])]),e("div",Bf,[e("a",{href:p.value,target:"_blank",class:"link-text"},i(z(t)("item.go_to_new_an_item")),9,Gf)])]),e("div",Kf,[e("div",{class:"secondary-button",onClick:k[1]||(k[1]=_=>n())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:k[2]||(k[2]=_=>g())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const Wf=Y(Jf,[["__scopeId","data-v-e68d3227"]]);function Yf(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Wf,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Xf={class:"team-item-member-modal"},Qf={class:"modal-content"},Zf={class:"action-bar"},ev={key:1,class:"all-cats-text"},tv=W({__name:"index",props:{item_id:{},team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=b([]),d=q(()=>[{label:t("item.readonly_member"),value:0},{label:t("item.edit_member"),value:1},{label:t("item.item_admin"),value:2}]),p=q(()=>[{title:t("item.username"),key:"member_username",width:150},{title:t("team.name"),key:"name",width:150},{title:t("item.member_authority"),key:"member_group_id",width:150},{title:t("item.catalog"),key:"cat_ids",width:220},{title:t("item.addtime"),key:"addtime",width:180}]),f=async()=>{l.value=!0;try{const r=await Kt(a.item_id,a.team_id);r.error_code===0&&(u.value=(r.data||[]).map(_=>({..._,member_group_id:Number(_.member_group_id),cat_ids:Array.isArray(_.cat_ids)?_.cat_ids.map(h=>Number(h)):typeof _.cat_ids=="string"?_.cat_ids.split(",").map(h=>Number(h.trim())):[]})))}catch(r){console.error("获取成员列表失败:",r)}finally{l.value=!1}},$=async()=>{try{const r=await xt(a.item_id);if(r.error_code===0){let _=r.data||[];Array.isArray(_)||(Array.isArray(_.items)?_=_.items:Array.isArray(_.list)&&(_=_.list)),_.unshift({cat_id:0,cat_name:t("item.all_cat")}),v.value=_.map(h=>({...h,cat_id:Number(h.cat_id)}))}}catch(r){console.error("获取目录列表失败:",r)}},g=async()=>{for(const r of u.value)try{await nt({id:r.id,member_group_id:0}),r.member_group_id=0}catch(_){console.error("设置成员为只读失败:",_)}ie.success(t("item.auth_success"))},n=async r=>{try{await nt({id:r.id,member_group_id:r.member_group_id}),ie.success(t("item.auth_success"))}catch(_){console.error("修改权限失败:",_)}},y=async r=>{try{await nt({id:r.id,cat_ids:(r.cat_ids||[]).map(_=>Number(_)).join(",")}),ie.success(t("item.cat_success"))}catch(_){console.error("修改目录失败:",_)}},k=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{f(),$(),setTimeout(()=>{o.value=!0})}),(r,_)=>{const h=H("a-select"),w=H("a-select-option");return C(),L("div",Xf,[s(de,{class:re({show:o.value}),title:z(t)("item.adjust_member_authority"),icon:["fas","user-shield"],width:"1000px",onClose:k},{default:m(()=>[e("div",Qf,[e("div",Zf,[e("a",{onClick:g,class:"set-all-read"},i(z(t)("item.all_member_read")),1)]),s(Le,{tableHeader:p.value,tableData:u.value,loading:l.value,emptyText:z(t)("item.team_member_empty_tips")},{"cell-member_group_id":m(({row:T})=>[s(h,{value:T.member_group_id,"onUpdate:value":x=>T.member_group_id=x,size:"small",style:{width:"120px"},onChange:x=>n(T),options:d.value,fieldNames:{label:"label",value:"value"}},null,8,["value","onUpdate:value","onChange","options"])]),"cell-cat_ids":m(({row:T})=>[T.member_group_id<=1?(C(),B(h,{key:0,value:T.cat_ids,"onUpdate:value":x=>T.cat_ids=x,mode:"multiple",size:"small",style:{width:"200px"},onChange:x=>y(T)},{default:m(()=>[(C(!0),L(Ce,null,Pe(v.value,x=>(C(),B(w,{key:x.cat_id,value:x.cat_id},{default:m(()=>[O(i(x.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(C(),L("span",ev,i(z(t)("item.all_cat")),1))]),_:1},8,["tableHeader","tableData","loading","emptyText"])])]),_:1},8,["class","title"])])}}});const av=Y(tv,[["__scopeId","data-v-43d70e02"]]);function ov(c,t){return new Promise(a=>{const{app:o,mountNode:l}=ve(av,{item_id:c,team_id:t,onClose:u=>{a(u),me(o,l)}});o.mount(l)})}const sv={class:"team-item-modal"},lv={class:"modal-content"},nv={class:"item-info"},iv={class:"operation-buttons"},rv=["onClick"],cv=["onClick"],dv=["onClick"],uv=W({__name:"index",props:{team_id:{},team_manage:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),u=b(!1),v=b([]),d=q(()=>o.team_manage>0?[{text:t("item.binding_item"),icon:["fas","plus"],onClick:$}]:[]),p=q(()=>[{title:t("item.item_name"),key:"item_name",width:300},{title:t("team.join_time"),key:"addtime",width:200},{title:t("common.operation"),key:"operation",width:300}]),f=async()=>{u.value=!0;try{const r=await $a(o.team_id);r.error_code===0&&(v.value=r.data||[])}catch(r){console.error("获取团队项目列表失败:",r)}finally{u.value=!1}},$=async()=>{await Yf(o.team_id)&&f()},g=r=>{window.open(a.resolve({path:`/${r}`}).href,"_blank")},n=async r=>{if(await Se(t("item.confirm_unassign_item")))try{await Jt(r),ie.success(t("common.op_success")),f()}catch(h){console.error("解绑项目失败:",h)}},y=async r=>{await ov(r,o.team_id)},k=()=>{l.value=!1,setTimeout(()=>{o.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{l.value=!0,f()})}),(r,_)=>(C(),L("div",sv,[s(de,{class:re({show:l.value}),title:z(t)("team.item_manage"),icon:["fas","folder"],width:"900px",headerButtons:d.value,onClose:k},{default:m(()=>[e("div",lv,[s(Le,{tableHeader:p.value,tableData:v.value,loading:u.value},{"cell-item_name":m(({row:h})=>[e("div",nv,[e("span",null,i(h.item_name),1)])]),"cell-operation":m(({row:h})=>[e("div",iv,[e("span",{class:"operation-btn",onClick:w=>g(h.item_id)},i(z(t)("item.check_item")),9,rv),c.team_manage>0?(C(),L(Ce,{key:0},[_[0]||(_[0]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:w=>y(h.item_id)},i(z(t)("item.member_authority")),9,cv),_[1]||(_[1]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:w=>n(h.id)},i(z(t)("item.unassign")),9,dv)],64)):F("",!0)])]),_:1},8,["tableHeader","tableData","loading"])])]),_:1},8,["class","title","headerButtons"])]))}});const mv=Y(uv,[["__scopeId","data-v-ad8ae728"]]);function _v(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(mv,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const pv={class:"attorn-team-modal"},fv={class:"form-content"},vv={class:"form-item"},hv={class:"form-label"},gv={class:"form-item"},yv={class:"form-label"},wv={class:"tips-text"},bv={class:"modal-footer"},$v=W({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({username:"",password:""}),u=async()=>{if(!l.value.username.trim()){await G(t("item.attorn_username")+t("common.required"));return}if(!l.value.password.trim()){await G(t("item.input_login_password")+t("common.required"));return}try{(await ka(a.team_id,l.value.username,l.value.password)).error_code===0&&(ie.success(t("common.op_success")),v(),a.onClose(!0))}catch(d){console.error("转让团队失败:",d)}},v=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>(C(),L("div",pv,[s(de,{class:re({show:o.value}),title:z(t)("item.attorn_team"),icon:["fas","user-group"],width:"500px",onClose:v},{default:m(()=>[e("div",fv,[e("div",vv,[e("div",hv,i(z(t)("item.attorn_username")),1),s(ne,{modelValue:l.value.username,"onUpdate:modelValue":p[0]||(p[0]=f=>l.value.username=f),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),e("div",gv,[e("div",yv,i(z(t)("item.input_login_password")),1),s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[1]||(p[1]=f=>l.value.password=f),type:"password",placeholder:z(t)("item.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),e("div",wv,i(z(t)("item.attornTeamTips")),1)]),e("div",bv,[e("div",{class:"secondary-button",onClick:p[2]||(p[2]=f=>v())},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:p[3]||(p[3]=f=>u())},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])]))}});const kv=Y($v,[["__scopeId","data-v-830eb7a4"]]);function Cv(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(kv,{team_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const xv={class:"team-modal"},Iv={class:"modal-content"},Sv={class:"table-wrapper"},Tv=["onClick"],Mv=["onClick"],Lv={class:"operation-buttons"},Vv=["onClick"],zv=["onClick"],Uv=["onClick"],Pv=["onClick"],Av=["onClick"],Dv=["onClick"],Ov={class:"footer-buttons"},Nv=W({__name:"index",props:{onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=b({id:0,team_manage:0,team_name:""}),d=q(()=>[{text:t("item.add_team"),icon:["fas","plus"],onClick:g}]),p=q(()=>[{title:t("item.team_name"),key:"team_name",width:200},{title:t("team.member_count"),key:"memberCount",width:100},{title:t("team.item_count"),key:"itemCount",width:100},{title:t("common.operation"),key:"operation",width:300}]),f=async()=>{l.value=!0;try{const T=await Wt();T.error_code===0?u.value=T.data||[]:await G(T.error_message||t("common.op_failed"))}catch(T){console.error("获取团队列表失败:",T),await G(t("common.op_failed"))}finally{l.value=!1}},$=()=>{},g=async()=>{const T=await it(t("item.add_team"),"",t("item.team_name"));if(T&&T.trim())try{const x=await Rt({id:"",team_name:T.trim()});x.error_code===0?(ie.success(t("common.op_success")),f()):await G(x.error_message||t("common.op_failed"))}catch(x){console.error("保存团队失败:",x),await G(t("common.op_failed"))}},n=async T=>{const x=await it(t("item.edit_team"),T.team_name,t("item.team_name"));if(x&&x.trim())try{const I=await Rt({id:T.id,team_name:x.trim()});I.error_code===0?(ie.success(t("common.op_success")),f()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("保存团队失败:",I),await G(t("common.op_failed"))}},y=async T=>{if(await Se({msg:t("item.confirm_delete_team"),title:t("item.confirm_delete")}))try{const I=await Ca(T);I.error_code===0?(ie.success(t("common.op_success")),f()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("删除团队失败:",I),await G(t("common.op_failed"))}},k=async T=>{await Cv(T.id)&&f()},r=async T=>{if(await Se({msg:t("item.team_exit_confirm_content"),title:t("item.team_exit_confirm")}))try{const I=await xa(T);I.error_code===0?(ie.success(t("common.op_success")),f()):await G(I.error_message||t("common.op_failed"))}catch(I){console.error("退出团队失败:",I),await G(t("common.op_failed"))}},_=async T=>{v.value=T,await qf({team_id:T.id,team_manage:T.team_manage}),f()},h=async T=>{v.value=T,await _v({team_id:T.id,team_manage:T.team_manage}),f()},w=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{o.value=!0,f()})}),(T,x)=>(C(),L("div",xv,[s(de,{class:re({show:o.value}),title:z(t)("team.team_manage"),icon:["fas","users"],width:"900px",height:"400px",headerButtons:d.value,onClose:w},{footer:m(()=>[e("div",Ov,[s(K,{onClick:w},{default:m(()=>[O(i(z(t)("common.close")),1)]),_:1})])]),default:m(()=>[e("div",Iv,[e("div",Sv,[s(Le,{tableHeader:p.value,tableData:u.value,loading:l.value,rowClickable:!0,emptyText:z(t)("team.empty_team_tips"),onRowClick:$},{"cell-memberCount":m(({row:I})=>[e("a",{onClick:S=>_(I),class:"clickable-link"},i(I.memberCount),9,Tv)]),"cell-itemCount":m(({row:I})=>[e("a",{onClick:S=>h(I),class:"clickable-link"},i(I.itemCount),9,Mv)]),"cell-operation":m(({row:I})=>[e("div",Lv,[e("span",{class:"operation-btn",onClick:S=>_(I)},i(z(t)("team.member")),9,Vv),x[4]||(x[4]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:S=>h(I)},i(z(t)("team.team_item")),9,zv),I.team_manage>0?(C(),L(Ce,{key:0},[x[0]||(x[0]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:S=>n(I)},i(z(t)("common.edit")),9,Uv),x[1]||(x[1]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn",onClick:S=>k(I)},i(z(t)("item.attorn_team")),9,Pv),x[2]||(x[2]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:S=>y(I.id)},i(z(t)("common.delete")),9,Av)],64)):(C(),L(Ce,{key:1},[x[3]||(x[3]=e("span",{class:"operation-divider"},null,-1)),e("span",{class:"operation-btn danger",onClick:S=>r(I.id)},i(z(t)("team.team_exit")),9,Dv)],64))])]),_:1},8,["tableHeader","tableData","loading","emptyText"])])])]),_:1},8,["class","title","headerButtons"])]))}});const Fv=Y(Nv,[["__scopeId","data-v-1fe3650d"]]);function Ha(){return new Promise(c=>{const{app:t,mountNode:a}=ve(Fv,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const qv={class:"header-right"},Rv={class:"icon-item language-item"},Hv=W({__name:"HeaderRight",props:{isAdmin:{type:Boolean}},setup(c){const{t,locale:a}=te(),o=xe(),l=Qe(),u=He(),v=b([]),d=b(!1),p=h=>{o.push({path:h})},f=h=>{window.open(h)},$=()=>{u.toggleTheme()},g=async()=>{await Ra()},n=async()=>{await gf()},y=async()=>{l.setNewMsg(0),await sa()},k=async()=>{await oa()},r=async()=>{await Ha()},_=async()=>{try{const h=await Yt();d.value=h&&h.data&&h.data.enable===1}catch{d.value=!1}};return oe(()=>{_(),v.value=[{title:t("header.runapi_title"),icon:"fas fa-terminal",desc:t("header.runapi_desc"),method:()=>{f("https://www.showdoc.com.cn/runapi")}},{title:t("header.jisuxiang_title"),icon:"fas fa-toolbox",desc:t("header.jisuxiang_desc"),method:()=>{f("https://www.jisuxiang.com")}},{title:t("header.dfyun_title"),icon:"fas fa-cloud",desc:t("header.dfyun_desc"),method:()=>{f("https://www.dfyun.com.cn")}},{title:t("header.push_service_title"),icon:"fas fa-car-side",desc:t("header.push_service_desc"),method:()=>{f("https://push.showdoc.com.cn")}},{title:t("header.back_to_home"),icon:"fas fa-backward",desc:t("header.back_to_home_desc"),method:()=>{p("/")}}]}),(h,w)=>{const T=H("a-tooltip"),x=H("a-badge");return C(),L("div",qv,[e("div",null,[s(T,{title:z(t)("header.switch_language"),placement:"top"},{default:m(()=>[e("div",Rv,[s(ht)])]),_:1},8,["title"]),s(T,{title:z(u).theme==="light"?z(t)("common.dark_mode"):z(t)("common.light_mode"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:$},[...w[2]||(w[2]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),s(T,{title:z(t)("feedback.feedback"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:g},[...w[3]||(w[3]=[e("i",{class:"fas fa-headphones"},null,-1)])])]),_:1},8,["title"]),s(T,{title:z(t)("attachment.my_attachment"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:n},[...w[4]||(w[4]=[e("i",{class:"fas fa-folder-arrow-up"},null,-1)])])]),_:1},8,["title"]),s(T,{title:z(t)("message.my_notice"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:y},[s(x,{count:z(l).newMsg?"New":0},{default:m(()=>[...w[5]||(w[5]=[e("i",{class:"fas fa-message"},null,-1)])]),_:1},8,["count"])])]),_:1},8,["title"]),s(T,{title:z(t)("team.team_manage"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:r},[...w[6]||(w[6]=[e("i",{class:"fas fa-users"},null,-1)])])]),_:1},8,["title"]),d.value?(C(),B(T,{key:0,title:z(t)("item.public_square"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:w[0]||(w[0]=I=>p("/public-square/index"))},[...w[7]||(w[7]=[e("i",{class:"fas fa-landmark"},null,-1)])])]),_:1},8,["title"])):F("",!0),s(T,{title:z(t)("user.user_center"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:k},[...w[8]||(w[8]=[e("i",{class:"fas fa-user"},null,-1)])])]),_:1},8,["title"]),c.isAdmin?(C(),B(T,{key:1,title:z(t)("admin.background"),placement:"top"},{default:m(()=>[e("div",{class:"icon-item",onClick:w[1]||(w[1]=I=>p("/admin/index"))},[...w[9]||(w[9]=[e("i",{class:"fas fa-gear"},null,-1)])])]),_:1},8,["title"])):F("",!0),z(a)==="zh-CN"?(C(),B(Oa,{key:2,title:z(t)("header.more_products"),titleIcon:"fas fa-ellipsis",menuList:v.value,width:"270px"},{default:m(()=>[...w[10]||(w[10]=[e("div",{class:"icon-item"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["title","menuList"])):F("",!0)])])}}});const Ev=Y(Hv,[["__scopeId","data-v-b5f13bec"]]),jv={class:"share-modal"},Bv={class:"modal-content"},Gv={class:"label"},Kv={class:"link-container"},Jv={class:"link"},Wv={key:0,class:"single-page-section"},Yv={class:"label"},Xv={class:"link-container single-link"},Qv={class:"link"},Zv={class:"label"},eh={key:1,class:"tips-text"},th={class:"modal-footer"},ah=W({__name:"index",props:{item_domain:{},item_id:{},page_id:{},page_unique_key:{},page_title:{},item_info:{},onClose:{type:Function}},setup(c){const{t}=te();xe();const a=c,o=q(()=>a.page_id),l=q(()=>a.item_info),u=b(!1),v=b(!1),d=b(0),p=b(a.page_unique_key||""),f=q(()=>{var S,M;const T=a.item_id||((S=l.value)==null?void 0:S.item_id);if(!T)return"";const x=a.item_domain||((M=l.value)==null?void 0:M.item_domain)||T,I=window.location.origin+window.location.pathname;return o.value&&o.value>0?`${I}#/${x}/${o.value}`:`${I}#/${x}`}),$=q(()=>p.value?`${window.location.origin+window.location.pathname}#/p/${p.value}`:""),g=async()=>{await Ht(f.value)?ie.success(t("common.copy_success")):G(t("common.error"))},n=async()=>{await Ht($.value)?ie.success(t("common.copy_success")):G(t("common.error"))},y=async T=>{if(T)await k();else if(await Se({msg:t("item.cancel_single"),confirmText:t("item.cancel_single_yes"),cancelText:t("item.cancel_single_no")})){v.value=!1;const I=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"false",expire_days:0},"post",!1);I.error_code===0?(p.value="",ie.success(t("common.save_success"))):(await G(I.error_message||t("common.op_failed")),v.value=!0)}else v.value=!0},k=async()=>{if(!(!a.page_id||a.page_id<=0))try{const T=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"true",expire_days:d.value},"post",!1);if(T.error_code===0&&T.data){const x=T.data.unique_key;x&&(p.value=x),ie.success(t("common.save_success"))}else await G(T.error_message||t("common.op_failed"))}catch(T){console.error("创建单页失败:",T),await G(t("common.op_failed"))}},r=async()=>{if(v.value&&p.value)try{const T=await X("/api/page/createSinglePage",{page_id:a.page_id,isCreateSiglePage:"true",expire_days:d.value},"post",!1);if(T.error_code===0&&T.data){const x=T.data.unique_key;x&&(p.value=x),ie.success(t("common.save_success"))}else await G(T.error_message||t("common.op_failed"))}catch(T){console.error("更新单页有效期失败:",T),await G(t("common.op_failed"))}},_=()=>{u.value=!1,setTimeout(()=>{a.onClose(!1)},300)};oe(()=>{a.page_unique_key?(v.value=!0,p.value=a.page_unique_key,h()):a.page_id&&a.page_id>0&&w(),setTimeout(()=>{u.value=!0})});const h=async()=>{if(!a.page_id)return;const T=a.page_unique_key||p.value;try{const x=await X("/api/page/infoByKey",{unique_key:T||""},"post",!1);if(x.error_code===0&&x.data){console.log("[fetchSinglePageInfo] API 返回数据:",x.data),console.log("[fetchSinglePageInfo] expire_time:",x.data.expire_time);const I=Math.floor(Date.now()/1e3),S=x.data.expire_time;if(!S||S<=0)d.value=0,console.log("[fetchSinglePageInfo] 永久有效，设置 expireDays.value: 0");else{const M=Math.round((S-I)/86400);console.log("[fetchSinglePageInfo] 当前时间:",I,"diffDays:",M),M<=1?d.value=1:M<=7?d.value=7:M<=30?d.value=30:M<=180?d.value=180:d.value=0,console.log("[fetchSinglePageInfo] 设置 expireDays.value:",d.value)}}else p.value="",v.value=!1}catch(x){console.error("获取单页信息失败:",x),p.value="",v.value=!1}},w=async()=>{if(!(!a.page_id||a.page_id<=0))try{const T=await X("/api/page/info",{page_id:a.page_id},"post",!1);T.error_code===0&&T.data&&(T.data.unique_key?(p.value=T.data.unique_key,v.value=!0,h()):(p.value="",v.value=!1))}catch(T){console.error("检查单页失败:",T)}};return(T,x)=>{const I=H("a-radio"),S=H("a-radio-group");return C(),L("div",jv,[s(de,{class:re({show:u.value}),title:T.$t("item.share"),onClose:_},{default:m(()=>{var M;return[e("div",Bv,[e("p",Gv,i(o.value?T.$t("item.item_page_address"):T.$t("item.item_address"))+":",1),e("div",Kv,[e("code",Jv,i(f.value),1),e("i",{class:"fas fa-copy copy-icon",onClick:g})]),o.value&&((M=a.item_info)!=null&&M.item_edit)?(C(),L("div",Wv,[e("p",Yv,[s(Je,{modelValue:v.value,"onUpdate:modelValue":x[0]||(x[0]=V=>v.value=V),label:T.$t("item.create_single_page"),onChange:y},null,8,["modelValue","label"])]),v.value?(C(),L(Ce,{key:0},[e("div",Xv,[e("code",Qv,i($.value),1),e("i",{class:"fas fa-copy copy-icon",onClick:n})]),e("p",Zv,i(T.$t("item.expire_time"))+":",1),s(S,{value:d.value,"onUpdate:value":x[1]||(x[1]=V=>d.value=V),onChange:r},{default:m(()=>[s(I,{value:0},{default:m(()=>[O(i(T.$t("item.permanent")),1)]),_:1}),s(I,{value:1},{default:m(()=>[O(i(T.$t("item.one_day")),1)]),_:1}),s(I,{value:7},{default:m(()=>[O(i(T.$t("item.seven_days")),1)]),_:1}),s(I,{value:30},{default:m(()=>[O(i(T.$t("item.one_month")),1)]),_:1}),s(I,{value:180},{default:m(()=>[O(i(T.$t("item.half_year")),1)]),_:1})]),_:1},8,["value"])],64)):F("",!0)])):F("",!0),o.value&&(v.value||p.value)?(C(),L("div",eh,i(T.$t("item.create_single_page_tips")),1)):F("",!0)]),e("div",th,[e("div",{class:"secondary-button",onClick:_},i(T.$t("common.close")),1)])]}),_:1},8,["class","title"])])}}});const oh=Y(ah,[["__scopeId","data-v-1a51dbb5"]]);function gt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(oh,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const sh={class:"create-item-modal"},lh={class:"modal-content"},nh={class:"switch-item"},ih={class:"form-item-desc"},rh={class:"switch-item"},ch={class:"form-item-desc"},dh={class:"modal-footer"},uh=W({__name:"index",props:{item_id:{},item_type:{},item_group_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=q(()=>!a.item_id),l=b(!1),u=b(!1),v=b(!0),d=b([]),p=b([]),f=b({item_name:"",item_description:"",password:"",item_type:"1",allow_comment:!1,allow_feedback:!1}),$=h=>{const w=(h||[]).map(T=>Number(T)).filter(T=>!isNaN(T));w.includes(0)?d.value=[0]:d.value=w},g=()=>{v.value&&(f.value.password="")},n=async()=>{try{const h=await vo(String(a.item_id));if(h&&h.data){const w=h.data;w.password?v.value=!1:v.value=!0,f.value.item_name=w.item_name||"",f.value.item_description=w.item_description||"",f.value.password=w.password||"",f.value.item_type=w.item_type||"1",f.value.allow_comment=w.allow_comment===1||w.allow_comment===!0||w.allow_comment==="1",f.value.allow_feedback=w.allow_feedback===1||w.allow_feedback===!0||w.allow_feedback==="1",d.value=Array.isArray(w.group_ids)?w.group_ids.map(T=>Number(T)).filter(T=>!isNaN(T)):[]}}catch(h){console.error("Load item detail failed:",h)}},y=()=>{a.item_type&&(f.value.item_type=String(a.item_type)),a.item_group_id&&a.item_group_id>0&&(d.value=[a.item_group_id]),v.value=!0},k=async()=>{try{const h=await Xt();h&&h.data&&(p.value=h.data||[])}catch(h){console.error("Load group list failed:",h)}},r=async()=>{if(!f.value.item_name||f.value.item_name.trim()===""){await G(t("item.item_name")+" "+t("common.required"));return}if(!v.value&&!f.value.password){await G(t("item.private_item_password"));return}const h={item_name:f.value.item_name,item_description:f.value.item_description,password:v.value?"":f.value.password,item_group_ids:(d.value||[]).map(w=>Number(w)).filter(w=>!isNaN(w))};(f.value.item_type=="1"||Number(f.value.item_type)===1)&&(h.allow_comment=f.value.allow_comment?1:0,h.allow_feedback=f.value.allow_feedback?1:0);try{if(u.value=!0,o.value){h.item_type=Number(f.value.item_type);const w=await Ia(h,!1);if(w.error_code===0)ie.success(t("common.op_success")),_(!0);else if(w.error_code===10309){const T=t("item.item_limit_exceeded_with_link");await G(T,{dangerouslyUseHTMLString:!0})}else if(w.error_code===10313){const T=t("item.realname_auth_required_for_public_item");await G(T,{dangerouslyUseHTMLString:!0})}else await G(w.error_message||t("common.op_failed"))}else{const w=await ho(String(a.item_id),h,!1);w.error_code===0?(ie.success(t("common.modify_success")),_(!0)):await G(w.error_message||t("common.op_failed"))}}catch(w){console.error("Submit item failed:",w),await G(t("common.op_failed"))}finally{u.value=!1}},_=(h=!1)=>{l.value=!1,setTimeout(()=>{a.onClose(h)},300)};return oe(async()=>{setTimeout(()=>{l.value=!0}),await k(),o.value?y():await n()}),(h,w)=>{const T=H("a-select-option"),x=H("a-select"),I=H("a-form-item"),S=H("a-form");return C(),L("div",sh,[s(de,{class:re({show:l.value}),title:o.value?h.$t("item.create_new_item"):h.$t("item.update_base_info"),icon:o.value?["fa","fa-plus"]:["fas","edit"],onClose:_},{default:m(()=>[e("div",lh,[s(S,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:m(()=>[s(I,{label:h.$t("item.item_type")},{default:m(()=>[s(x,{value:f.value.item_type,"onUpdate:value":w[0]||(w[0]=M=>f.value.item_type=M),disabled:!o.value},{default:m(()=>[s(T,{value:"1"},{default:m(()=>[O(i(h.$t("item.regular_item")),1)]),_:1}),s(T,{value:"2"},{default:m(()=>[O(i(h.$t("item.single_item")),1)]),_:1}),s(T,{value:"4"},{default:m(()=>[O(i(h.$t("item.table_item")),1)]),_:1}),s(T,{value:"5"},{default:m(()=>[O(i(h.$t("item.whiteboard_item")),1)]),_:1})]),_:1},8,["value","disabled"])]),_:1},8,["label"]),s(I,{label:h.$t("item.item_name")},{default:m(()=>[s(ne,{modelValue:f.value.item_name,"onUpdate:modelValue":w[1]||(w[1]=M=>f.value.item_name=M),placeholder:h.$t("item.item_name"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p.value&&p.value.length>0?(C(),B(I,{key:0,label:h.$t("item.group")},{default:m(()=>[s(x,{value:d.value,"onUpdate:value":w[2]||(w[2]=M=>d.value=M),mode:"multiple",placeholder:h.$t("item.item_group_desc"),onChange:$},{default:m(()=>[s(T,{value:0},{default:m(()=>[O(i(h.$t("item.all_items")),1)]),_:1}),(C(!0),L(Ce,null,Pe(p.value,M=>(C(),B(T,{key:M.id,value:Number(M.id)},{default:m(()=>[O(i(M.group_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"])):F("",!0),s(I,{label:h.$t("item.item_description")},{default:m(()=>[s(ne,{modelValue:f.value.item_description,"onUpdate:modelValue":w[3]||(w[3]=M=>f.value.item_description=M),placeholder:h.$t("item.item_description"),autocomplete:"off"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(I,{label:h.$t("item.accessibility")},{default:m(()=>[s(x,{value:v.value,"onUpdate:value":w[4]||(w[4]=M=>v.value=M),onChange:g},{default:m(()=>[s(T,{value:!0},{default:m(()=>[O(i(h.$t("item.public_item")),1)]),_:1}),s(T,{value:!1},{default:m(()=>[O(i(h.$t("item.private_item")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),v.value?F("",!0):(C(),B(I,{key:1,label:h.$t("item.visit_password")},{default:m(()=>[s(ne,{modelValue:f.value.password,"onUpdate:modelValue":w[5]||(w[5]=M=>f.value.password=M),type:"password",placeholder:h.$t("item.visit_password")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),f.value.item_type=="1"||Number(f.value.item_type)===1?(C(),B(I,{key:2,label:h.$t("itemSetting.interactionTitle")},{default:m(()=>[e("div",nh,[s(Je,{modelValue:f.value.allow_comment,"onUpdate:modelValue":w[6]||(w[6]=M=>f.value.allow_comment=M),label:h.$t("itemSetting.allowComment")},null,8,["modelValue","label"]),e("div",ih,i(h.$t("itemSetting.allowCommentDesc")),1)]),e("div",rh,[s(Je,{modelValue:f.value.allow_feedback,"onUpdate:modelValue":w[7]||(w[7]=M=>f.value.allow_feedback=M),label:h.$t("itemSetting.allowFeedback")},null,8,["modelValue","label"]),e("div",ch,i(h.$t("itemSetting.allowFeedbackDesc")),1)])]),_:1},8,["label"])):F("",!0)]),_:1})]),e("div",dh,[e("div",{class:"secondary-button",onClick:w[8]||(w[8]=lt(M=>_(!1),["stop"]))},i(h.$t("common.cancel")),1),e("div",{class:re(["primary-button",{disabled:u.value}]),onClick:lt(r,["stop"])},i(u.value?h.$t("common.submiting"):h.$t("common.confirm")),3)])]),_:1},8,["class","title","icon"])])}}});const mh=Y(uh,[["__scopeId","data-v-f06f9198"]]);function at(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(mh,{item_id:c==null?void 0:c.item_id,item_type:c==null?void 0:c.item_type,item_group_id:c==null?void 0:c.item_group_id,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const _h={class:"add-member-modal"},ph={class:"modal-content"},fh={class:"tips-text"},vh={class:"footer-buttons"},hh=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=b([]),v=b([]),d=b({username:[],cat_ids:[],member_group_id:"1"}),p=q(()=>v.value.map(r=>({label:r.cat_name,value:r.cat_id}))),f=q(()=>u.value.map(r=>({label:r.name?`${r.username}(${r.name})`:r.username,value:r.username}))),$=async()=>{try{const r=await jt({username:""});r.error_code===0&&r.data&&(u.value=r.data||[])}catch(r){console.error("获取全站用户列表失败:",r)}},g=async()=>{try{const r=await go();r.error_code===0&&(l.value=r.data||[])}catch(r){console.error("获取成员历史记录失败:",r)}},n=async()=>{try{const r=await xt(String(a.item_id));if(r.error_code===0){const _=r.data||[];_.unshift({cat_id:0,cat_name:t("item.all_cat")}),v.value=_.map(h=>({...h,cat_id:Number(h.cat_id)}))}}catch(r){console.error("获取目录列表失败:",r)}},y=async()=>{if(!d.value.username||d.value.username.length===0){await G(t("item.input_target_member")+t("common.required"));return}try{let r=0,_=0;for(const h of d.value.username){const w=await Sa({item_id:a.item_id,username:h,cat_ids:(d.value.cat_ids||[]).join(","),member_group_id:d.value.member_group_id});w.error_code===0?r++:(_++,console.error(`添加成员 ${h} 失败:`,w.error_message))}if(r>0){let h=t("common.op_success");_>0&&(h=`${h} (成功${r}个，失败${_}个)`),j.success(h),k(!0)}else j.error(t("common.op_failed"))}catch(r){console.error("添加成员失败:",r),j.error(t("common.op_failed"))}},k=(r=!1)=>{o.value=!1,setTimeout(()=>{a.onClose(r)},300)};return oe(()=>{o.value=!0,g(),n(),$()}),(r,_)=>{const h=H("a-form-item"),w=H("a-radio"),T=H("a-radio-group"),x=H("a-form");return C(),L("div",_h,[s(de,{class:re({show:o.value}),title:z(t)("item.add_member"),icon:["fas","fa-user-plus"],maxWidth:"500px",onClose:k},{footer:m(()=>[e("div",vh,[s(K,{text:z(t)("common.cancel"),theme:"light",onClick:k},null,8,["text"]),s(K,{text:z(t)("common.confirm"),theme:"dark",onClick:y},null,8,["text"])])]),default:m(()=>[e("div",ph,[s(x,{layout:"vertical"},{default:m(()=>[s(h,{label:z(t)("item.input_target_member")},{default:m(()=>[s(Re,{value:d.value.username,"onUpdate:value":_[0]||(_[0]=I=>d.value.username=I),options:f.value,placeholder:z(t)("item.search_member_placeholder"),multiple:!0,"show-search":!0},null,8,["value","options","placeholder"])]),_:1},8,["label"]),s(h,{label:z(t)("item.authority")},{default:m(()=>[s(T,{value:d.value.member_group_id,"onUpdate:value":_[1]||(_[1]=I=>d.value.member_group_id=I)},{default:m(()=>[s(w,{value:"1"},{default:m(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(w,{value:"0"},{default:m(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(w,{value:"2"},{default:m(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),d.value.member_group_id<"2"?(C(),B(h,{key:0,label:z(t)("item.catalog")},{default:m(()=>[s(Re,{value:d.value.cat_ids,"onUpdate:value":_[2]||(_[2]=I=>d.value.cat_ids=I),multiple:!0,placeholder:z(t)("item.all_cat2"),options:p.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])):F("",!0)]),_:1}),e("p",fh,i(z(t)("item.member_authority_tips")),1)])]),_:1},8,["class","title"])])}}});const gh=Y(hh,[["__scopeId","data-v-072cc251"]]);function yh(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(gh,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const wh={class:"add-team-modal"},bh={class:"modal-content"},$h={class:"create-team-section"},kh={class:"create-tip"},Ch={class:"footer-buttons"},xh=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=b({team_id:""}),d=q(()=>u.value.map(n=>({label:n.team_name,value:n.id}))),p=async()=>{try{const n=await Wt();n.error_code===0&&(u.value=n.data||[])}catch(n){console.error("获取团队列表失败:",n)}},f=async()=>{await Ha(),await p()},$=async()=>{if(!v.value.team_id){j.warning(t("item.please_choose"));return}try{const n=await Gt(String(a.item_id),v.value.team_id);n.error_code===0?(j.success(t("common.op_success")),g(!0)):j.error(n.error_message||t("common.op_failed"))}catch(n){console.error("添加团队失败:",n),j.error(t("common.op_failed"))}},g=(n=!1)=>{o.value=!1,setTimeout(()=>{a.onClose(n)},300)};return oe(()=>{o.value=!0,p()}),(n,y)=>{const k=H("a-select"),r=H("a-form-item"),_=H("a-form"),h=H("TeamModal");return C(),L(Ce,null,[e("div",wh,[s(de,{class:re({show:o.value}),title:z(t)("item.add_team"),icon:["fas","fa-users"],width:"500px",onClose:g},{footer:m(()=>[e("div",Ch,[s(K,{text:z(t)("common.cancel"),theme:"light",onClick:g},null,8,["text"]),s(K,{text:z(t)("common.confirm"),theme:"dark",onClick:$},null,8,["text"])])]),default:m(()=>[e("div",bh,[s(_,{layout:"vertical"},{default:m(()=>[s(r,{label:z(t)("item.c_team")},{default:m(()=>[s(k,{value:v.value.team_id,"onUpdate:value":y[0]||(y[0]=w=>v.value.team_id=w),placeholder:z(t)("item.please_choose"),options:d.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),e("div",$h,[e("span",kh,i(z(t)("item.or_create_team")),1),e("span",{class:"create-link",onClick:f},i(z(t)("item.create_new_team")),1)])])]),_:1},8,["class","title"])]),l.value?(C(),B(h,{key:0})):F("",!0)],64)}}});const Ih=Y(xh,[["__scopeId","data-v-1831ec85"]]);function Sh(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ih,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Th={class:"team-member-authority-modal"},Mh={class:"modal-content"},Lh={key:1,class:"all-cats-text"},Vh={class:"tips-text"},zh={class:"footer-buttons"},Uh=W({__name:"index",props:{item_id:{},team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=b([]),v=[{title:t("item.member_username"),key:"member_username",width:150},{title:t("item.name"),key:"name",width:150},{title:t("item.member_authority"),key:"member_group_id",width:200},{title:t("item.catalog"),key:"cat_ids",width:200},{title:t("item.add_time"),key:"addtime",width:150}],d=async()=>{try{const n=await Kt(String(a.item_id),a.team_id);n.error_code===0&&(l.value=(n.data||[]).map(y=>({...y,cat_ids:Array.isArray(y.cat_ids)?y.cat_ids.map(k=>Number(k)):[]})))}catch(n){console.error("获取团队成员失败:",n)}},p=async()=>{try{const n=await xt(String(a.item_id));if(n.error_code===0){const y=n.data||[];y.unshift({cat_id:0,cat_name:t("item.all_cat")}),u.value=y.map(k=>({...k,cat_id:Number(k.cat_id)}))}}catch(n){console.error("获取目录列表失败:",n)}},f=async(n,y)=>{try{const k=await nt({member_group_id:n,id:y});k.error_code===0?j.success(t("item.auth_success")):j.error(k.error_message||t("common.op_failed"))}catch(k){console.error("修改权限失败:",k),j.error(t("common.op_failed"))}},$=async(n,y)=>{try{const k=await nt({cat_ids:(n||[]).join(","),id:y});k.error_code===0?j.success(t("item.cat_success")):j.error(k.error_message||t("common.op_failed"))}catch(k){console.error("修改目录失败:",k),j.error(t("common.op_failed"))}},g=()=>{a.onClose(!0)};return oe(()=>{o.value=!0,d(),p()}),(n,y)=>{const k=H("a-select-option"),r=H("a-select");return C(),L("div",Th,[s(de,{class:re({show:o.value}),title:z(t)("item.adjust_member_authority"),icon:["fas","fa-user-cog"],maxWidth:"900px",onClose:g},{footer:m(()=>[e("div",zh,[s(K,{text:z(t)("common.close"),theme:"dark",onClick:g},null,8,["text"])])]),default:m(()=>[e("div",Mh,[s(Le,{tableHeader:v,tableData:l.value,pagination:!1,maxHeight:"400px"},{"cell-member_username":m(({row:_})=>[O(i(_.member_username),1)]),"cell-name":m(({row:_})=>[O(i(_.name),1)]),"cell-member_group_id":m(({row:_})=>[s(r,{size:"small",value:_.member_group_id,"onUpdate:value":h=>_.member_group_id=h,style:{width:"100%"},onChange:h=>f(h,_.id)},{default:m(()=>[s(k,{value:"1"},{default:m(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(k,{value:"0"},{default:m(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(k,{value:"2"},{default:m(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value","onUpdate:value","onChange"])]),"cell-cat_ids":m(({row:_})=>[_.member_group_id<="1"?(C(),B(r,{key:0,size:"small",value:_.cat_ids,"onUpdate:value":h=>_.cat_ids=h,mode:"multiple",style:{width:"100%"},onChange:h=>$(h,_.id)},{default:m(()=>[(C(!0),L(Ce,null,Pe(u.value,h=>(C(),B(k,{key:h.cat_id,value:h.cat_id},{default:m(()=>[O(i(h.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(C(),L("span",Lh,i(z(t)("item.all_cat")),1))]),"cell-addtime":m(({row:_})=>[O(i(_.addtime),1)]),_:1},8,["tableData"]),e("p",Vh,i(z(t)("item.team_member_authority_tips")),1)])]),_:1},8,["class","title"])])}}});const Ph=Y(Uh,[["__scopeId","data-v-8460f41a"]]);function Ah(c,t){return new Promise(a=>{const{app:o,mountNode:l}=ve(Ph,{item_id:c,team_id:t,onClose:u=>{a(u),me(o,l)}});o.mount(l)})}const Dh={class:"member-modal"},Oh={class:"modal-content"},Nh={class:"content-wrapper"},Fh={key:0,class:"section"},qh=["onClick"],Rh={key:1,class:"section"},Hh=["onClick"],Eh=["onClick"],jh={key:2,class:"empty-tips"},Bh={class:"footer-buttons"},Gh=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=b([]),v=async()=>{try{const w=await Ta(String(a.item_id));w.error_code===0&&(l.value=w.data||[])}catch(w){console.error("获取成员列表失败:",w)}},d=async()=>{try{const w=await Ma(String(a.item_id));w.error_code===0&&(u.value=w.data||[])}catch(w){console.error("获取团队项目列表失败:",w)}},p=[{title:t("item.member_username"),key:"username",width:150},{title:t("item.name"),key:"name",width:120},{title:t("item.add_time"),key:"addtime",width:160},{title:t("item.authority"),key:"authority",width:140},{title:t("item.operation"),key:"operation",center:!0}],f=[{title:t("item.team_name"),key:"team_name",width:300},{title:t("item.add_time"),key:"addtime",width:180},{title:t("item.operation"),key:"operation",center:!0}],$=async()=>{await yh(a.item_id)&&v()},g=async()=>{await Sh(a.item_id)&&d()},n=async w=>{if(await Se({title:t("common.confirm_delete"),msg:t("item.confirm_delete_member")}))try{const x=await La(String(a.item_id),w);x.error_code===0?(j.success(t("common.op_success")),v()):j.error(x.error_message||t("common.op_failed"))}catch(x){console.error("删除成员失败:",x),j.error(t("common.op_failed"))}},y=async w=>{if(await Se({title:t("common.confirm_delete"),msg:t("item.confirm_delete_team")}))try{const x=await Jt(w);x.error_code===0?(j.success(t("common.op_success")),d()):j.error(x.error_message||t("common.op_failed"))}catch(x){console.error("删除团队失败:",x),j.error(t("common.op_failed"))}},k=async w=>{await Ah(a.item_id,w)},r=(w,T)=>w==="2"?t("item.item_admin"):w==="1"?`${t("item.edit")}/${t("item.catalog")}: ${T}`:`${t("item.readonly")}/${t("item.catalog")}: ${T}`,_=()=>{o.value=!1,setTimeout(()=>{a.onClose(!0)},300)},h=[{text:t("item.add_member"),icon:["fas","fa-plus"],onClick:$},{text:t("item.add_team"),icon:["fas","fa-plus"],onClick:g}];return oe(()=>{o.value=!0,v(),d()}),(w,T)=>{const x=H("a-divider");return C(),L("div",Dh,[s(de,{class:re({show:o.value}),title:z(t)("item.member_manage"),icon:["fas","fa-users"],headerButtons:h,width:"800px",height:"600px",onClose:_},{footer:m(()=>[e("div",Bh,[s(K,{text:z(t)("common.close"),theme:"dark",onClick:_},null,8,["text"])])]),default:m(()=>[e("div",Oh,[e("div",Nh,[l.value.length>0?(C(),L("div",Fh,[s(Le,{tableHeader:p,tableData:l.value,pagination:!1},{"cell-username":m(({row:I})=>[O(i(I.username),1)]),"cell-name":m(({row:I})=>[O(i(I.name),1)]),"cell-addtime":m(({row:I})=>[O(i(I.addtime),1)]),"cell-authority":m(({row:I})=>[O(i(r(I.member_group_id,I.cat_name)),1)]),"cell-operation":m(({row:I})=>[e("a",{class:"delete-action",onClick:S=>n(I.item_member_id)},i(z(t)("common.delete")),9,qh)]),_:1},8,["tableData"])])):F("",!0),u.value.length>0?(C(),L("div",Rh,[s(Le,{tableHeader:f,tableData:u.value,pagination:!1},{"cell-team_name":m(({row:I})=>[O(i(I.team_name),1)]),"cell-addtime":m(({row:I})=>[O(i(I.addtime),1)]),"cell-operation":m(({row:I})=>[e("a",{onClick:S=>k(I.team_id)},i(z(t)("item.member_authority")),9,Hh),s(x,{type:"vertical"}),e("a",{class:"delete-action",onClick:S=>y(I.id)},i(z(t)("common.delete")),9,Eh)]),_:1},8,["tableData"])])):F("",!0),l.value.length===0&&u.value.length===0?(C(),L("p",jh,i(z(t)("item.no_member_tips")),1)):F("",!0)])])]),_:1},8,["class","title"])])}}});const Kh=Y(Gh,[["__scopeId","data-v-c893fca8"]]);function yt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Kh,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const Jh={class:"recycle-content"},Wh={class:"tips"},Yh=W({__name:"index",props:{itemId:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b([]),v=q(()=>[{title:t("item.page_title"),key:"page_title",width:180},{title:t("item.deleter"),key:"del_by_username",width:120},{title:t("item.del_time"),key:"del_time",width:150},{title:t("item.operation"),key:"action",width:80}]),d=async()=>{l.value=!0;try{const $=await yo(String(a.itemId));$&&$.data&&(u.value=$.data)}catch($){console.error("获取回收站列表失败:",$)}finally{l.value=!1}},p=async $=>{if(await Se(t("item.recover_tips"),t("common.confirm"))){l.value=!0;try{await wo(String(a.itemId),String($.page_id)),ie.success(t("common.op_success")),await d()}catch(n){console.error("恢复页面失败:",n)}finally{l.value=!1}}},f=()=>{a.onClose()};return oe(()=>{o.value=!0,d()}),($,g)=>{const n=H("a-button"),y=H("a-empty"),k=H("a-spin");return C(),B(de,{width:"900px",show:o.value,title:$.$t("item.recycle"),useClose:!0,onClose:f},{default:m(()=>[s(k,{spinning:l.value},{default:m(()=>[e("div",Jh,[e("p",Wh,i($.$t("item.recycle_tips")),1),u.value.length>0?(C(),B(Le,{key:0,tableData:u.value,tableHeader:v.value,pagination:!1,rowKey:"page_id",maxHeight:"380px"},{"cell-action":m(({row:r})=>[s(n,{type:"link",size:"small",onClick:_=>p(r)},{default:m(()=>[O(i($.$t("item.recover")),1)]),_:1},8,["onClick"])]),_:1},8,["tableData","tableHeader"])):(C(),B(y,{key:1,description:$.$t("item.recycle_empty")},null,8,["description"]))])]),_:1},8,["spinning"])]),_:1},8,["show","title"])}}});const Xh=Y(Yh,[["__scopeId","data-v-b6976406"]]);function Mt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Xh,{itemId:c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const Qh={class:"archive-modal"},Zh={class:"modal-content"},eg={class:"tips-text"},tg={class:"modal-footer"},ag=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({password:""}),u=async()=>{if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await bo(String(a.item_id),l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("归档项目失败:",d),j.error(t("common.op_failed"))}},v=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>{const f=H("a-form-item"),$=H("a-form");return C(),L("div",Qh,[s(de,{class:re({show:o.value}),title:z(t)("item.archive"),onClose:v},{default:m(()=>[e("div",Zh,[s($,{layout:"vertical"},{default:m(()=>[s(f,{label:z(t)("user.input_login_password")},{default:m(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",eg,i(z(t)("item.archive_tips")),1)]),e("div",tg,[e("div",{class:"secondary-button",onClick:v},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:u},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])])}}});const og=Y(ag,[["__scopeId","data-v-946c3979"]]);function wt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(og,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const sg={class:"attorn-modal"},lg={class:"modal-content"},ng={class:"tips-text"},ig={class:"button-bar"},rg=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({username:"",password:""}),u=async()=>{if(!l.value.username){j.error(t("item.attorn_username")+t("user.required"));return}if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await $o(String(a.item_id),l.value.username,l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("转让项目失败:",d),j.error(t("common.op_failed"))}},v=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{o.value=!0}),(d,p)=>{const f=H("a-form-item"),$=H("a-form");return C(),L("div",sg,[s(de,{show:o.value,title:z(t)("item.attorn"),onClose:v},{default:m(()=>[e("div",lg,[s($,{layout:"vertical"},{default:m(()=>[s(f,{label:z(t)("item.attorn_username")},{default:m(()=>[s(ne,{modelValue:l.value.username,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.username=g),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(f,{label:z(t)("user.input_login_password")},{default:m(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[1]||(p[1]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",ng,i(z(t)("item.attorn_tips")),1),e("div",ig,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:v},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),onClick:u},null,8,["text"])])])]),_:1},8,["show","title"])])}}});const cg=Y(rg,[["__scopeId","data-v-f6bb970c"]]);function bt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(cg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const dg={class:"my-modal"},ug={class:"modal-content"},mg={class:"modal-footer"},_g=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b(void 0),v=b(""),d=b(""),p=b(!0),f=b(""),$=b([]),g=q(()=>$.value.map(_=>({label:_.item_name,value:String(_.item_id)}))),n=async()=>{try{const _=await kt();_.error_code===0?($.value=_.data||[],a.item_id&&(u.value=String(a.item_id),y(a.item_id))):j.error(_.error_message||t("common.op_failed"))}catch(_){console.error("获取项目列表失败:",_),j.error(t("common.op_failed"))}},y=_=>{const h=$.value.find(w=>String(w.item_id)===String(_));h&&(v.value=h.item_name+"--copy",d.value=h.item_description||"")},k=async()=>{if(!u.value){j.warning(t("common.please_choose"));return}if(!v.value.trim()){j.warning(t("item.copy_item_tips2"));return}if(!p.value&&!f.value.trim()){j.warning(t("item.private_item_password"));return}l.value=!0;try{const _=await Ia({copy_item_id:Number(u.value),item_name:v.value,item_description:d.value,password:p.value?"":f.value});_.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(_.error_message||t("common.op_failed"))}catch(_){console.error("复制项目失败:",_),j.error(t("common.op_failed"))}finally{l.value=!1}},r=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{n(),setTimeout(()=>{o.value=!0})}),(_,h)=>{const w=H("a-form-item"),T=H("a-radio"),x=H("a-radio-group"),I=H("a-form");return C(),L("div",dg,[s(de,{class:re({show:o.value}),title:z(t)("item.copy_item"),icon:["fa","fa-copy"],onClose:r},{default:m(()=>[e("div",ug,[s(I,{"label-col":{span:6},"wrapper-col":{span:18}},{default:m(()=>[s(w,{label:z(t)("common.source")},{default:m(()=>[s(Re,{value:u.value,"onUpdate:value":h[0]||(h[0]=S=>u.value=S),placeholder:z(t)("common.please_choose"),options:g.value,"show-search":!0,onChange:y},null,8,["value","placeholder","options"])]),_:1},8,["label"]),s(w,{label:z(t)("item.item_name")},{default:m(()=>[s(ne,{modelValue:v.value,"onUpdate:modelValue":h[1]||(h[1]=S=>v.value=S),placeholder:z(t)("item.copy_item_tips2")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(w,{label:z(t)("item.item_type")},{default:m(()=>[s(x,{value:p.value,"onUpdate:value":h[2]||(h[2]=S=>p.value=S)},{default:m(()=>[s(T,{value:!0},{default:m(()=>[O(i(z(t)("item.public_item")),1)]),_:1}),s(T,{value:!1},{default:m(()=>[O(i(z(t)("item.private_item")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),p.value?F("",!0):(C(),B(w,{key:0,label:z(t)("item.visit_password")},{default:m(()=>[s(ne,{modelValue:f.value,"onUpdate:modelValue":h[3]||(h[3]=S=>f.value=S),type:"password",placeholder:z(t)("item.input_visit_password")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]))]),_:1})]),e("div",mg,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:r},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),spinning:l.value,onClick:k},null,8,["text","spinning"])])]),_:1},8,["class","title"])])}}});const pg=Y(_g,[["__scopeId","data-v-60807128"]]);function Ea(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(pg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const fg={class:"delete-modal"},vg={class:"modal-content"},hg={class:"tips-container"},gg={class:"danger-tag"},yg={class:"modal-footer"},wg=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({password:""}),u=async()=>{if(!l.value.password){j.error(t("user.password_required"));return}try{const d=await ko(String(a.item_id),l.value.password);d.error_code===0?(j.success(t("common.op_success")),a.onClose(!0)):j.error(d.error_message||t("common.op_failed"))}catch(d){console.error("删除项目失败:",d),j.error(t("common.op_failed"))}},v=()=>{o.value=!1,setTimeout(()=>{a.onClose(!1)},300)};return oe(()=>{setTimeout(()=>{o.value=!0})}),(d,p)=>{const f=H("a-form-item"),$=H("a-form");return C(),L("div",fg,[s(de,{class:re({show:o.value}),title:z(t)("item.delete_item"),onClose:v},{default:m(()=>[e("div",vg,[s($,{layout:"vertical"},{default:m(()=>[s(f,{label:z(t)("user.input_login_password")},{default:m(()=>[s(ne,{modelValue:l.value.password,"onUpdate:modelValue":p[0]||(p[0]=g=>l.value.password=g),type:"password",placeholder:z(t)("user.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("div",hg,[e("div",gg,i(z(t)("item.delete_tips")),1)])]),e("div",yg,[e("div",{class:"secondary-button",onClick:v},i(z(t)("common.cancel")),1),e("div",{class:"primary-button danger-button",onClick:u},i(z(t)("item.delete_confirm_text")),1)])]),_:1},8,["class","title"])])}}});const bg=Y(wg,[["__scopeId","data-v-faadb9a0"]]);function $t(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(bg,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const $g={class:"ai-knowledge-base-modal"},kg={class:"ai-knowledge-base"},Cg={class:"function-switch-section"},xg={class:"switch-row"},Ig={key:0,class:"switch-desc"},Sg={key:0,class:"system-warning"},Tg={key:1,class:"info-warning"},Mg={key:2,class:"ai-config-section"},Lg={class:"config-form"},Vg={class:"form-row"},zg={class:"form-item"},Ug={class:"form-row"},Pg={class:"form-item full-width"},Ag={class:"form-label"},Dg={class:"form-hint"},Og={class:"form-row action-row"},Ng={key:3,class:"index-management-section"},Fg={class:"index-form"},qg={class:"index-overview"},Rg={class:"overview-item"},Hg={class:"overview-label"},Eg={class:"overview-value"},jg={key:0,class:"status-badge success"},Bg={key:1,class:"status-badge processing"},Gg={key:2,class:"status-badge warning"},Kg={key:3,class:"status-badge neutral"},Jg={key:0,class:"overview-item"},Wg={class:"overview-label"},Yg={class:"overview-value"},Xg={class:"count-number"},Qg={class:"count-unit"},Zg={key:0,class:"count-increase"},e1={key:1,class:"overview-item"},t1={class:"overview-label"},a1={class:"overview-value"},o1={key:0,class:"indexing-alert"},s1={class:"indexing-detail"},l1={key:0,class:"progress-info"},n1={key:0,class:"progress-badge"},i1={key:1,class:"index-complete-alert"},r1={class:"success-content"},c1={class:"action-row"},d1=120,u1=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b(!1),v=b(!1),d=b({enabled:!1,dialog_expanded:!1,welcome_message:""}),p=b(""),f=b({status:"unknown",document_count:0,last_update_time:null}),$=b(!1),g=b(null),n=b(0),y=b(!1),k=b(0),r=b(!1),_=async()=>{try{const P=await X("/api/item/info",{item_id:a.item_id});P.error_code===0&&P.data&&(p.value=String(P.data.item_id),P.data.ai_config?(d.value={enabled:P.data.ai_config.enabled>0,dialog_expanded:P.data.ai_config.dialog_collapsed===0,welcome_message:P.data.ai_config.welcome_message||""},u.value=P.data.ai_config.enabled>0):(u.value=P.data.ai_knowledge_base_enabled>0,d.value.enabled=P.data.ai_knowledge_base_enabled>0))}catch(P){console.error("加载项目信息失败:",P)}},h=async()=>{if(p.value||await _(),!p.value){console.error("无法获取项目ID");return}try{const P=await X("/api/ai/getIndexStatus",{item_id:String(p.value)});P.error_code===0&&P.data&&(f.value=P.data,P.data.status==="not_configured"&&P.data.message&&P.data.message.indexOf("AI 服务未配置")>-1?v.value=!1:v.value=!0)}catch(P){console.error("加载索引状态失败:",P),v.value=!1}},w=async()=>{if(p.value||await _(),!!p.value)try{const P=await X("/api/item/getAiKnowledgeBaseConfig",{item_id:String(p.value)});P.error_code===0&&P.data&&(d.value={enabled:P.data.enabled>0,dialog_expanded:P.data.dialog_collapsed===0,welcome_message:P.data.welcome_message||""},u.value=P.data.enabled>0)}catch(P){console.error("加载AI配置失败:",P)}},T=async()=>{if(!p.value){await AlertModal("无法获取项目ID");return}l.value=!0;try{const P=await X("/api/item/setAiKnowledgeBaseConfig",{item_id:String(p.value),enabled:d.value.enabled?1:0,dialog_collapsed:d.value.dialog_expanded?0:1,welcome_message:d.value.welcome_message});if(P.error_code===0){ie.success(d.value.enabled?t("ai.ai_project_enabled_success"):t("ai.ai_project_disabled_success"));const D=u.value;u.value=d.value.enabled,await w(),!D&&d.value.enabled&&(y.value=!0),d.value.enabled&&(await h(),(!D||f.value.status==="not_configured")&&setTimeout(()=>{I()},500))}else await AlertModal(P.error_message||t("ai.ai_update_failed")),await w()}catch(P){console.error("保存配置失败:",P),await AlertModal(t("ai.ai_update_failed")),await w()}finally{l.value=!1}},x=async()=>{await Se({msg:t("ai.ai_rebuild_confirm"),title:t("common.tips"),confirmText:t("common.confirm"),cancelText:t("common.cancel")})&&await I()},I=async()=>{if(!p.value){await AlertModal("无法获取项目ID");return}$.value=!0,M();try{(await X("/api/ai/rebuildIndex",{item_id:String(p.value)})).error_code===0?(ie.info(t("ai.ai_rebuild_started")),f.value.status="indexing",n.value=0,k.value=0,r.value=!1,S()):$.value=!1}catch(P){console.error("索引构建失败:",P),$.value=!1}},S=()=>{g.value&&clearInterval(g.value),V(),g.value=setInterval(()=>{V()},5e3)},M=()=>{g.value&&(clearInterval(g.value),g.value=null),n.value=0,r.value=!1},V=async()=>{if(n.value++,n.value>d1){M(),$.value=!1,ie.info("索引构建超时，请手动刷新状态");return}try{const P=await X("/api/ai/getIndexStatus",{item_id:String(p.value)});if(P.error_code===0&&P.data){const D=P.data;if(D.status==="error"){f.value=D,M(),$.value=!1;return}if(D.status==="indexed"){f.value=D,k.value=D.document_count||0,r.value=!1,M(),$.value=!1,ie.success(t("ai.ai_index_completed"));return}else if(D.status==="indexing"){const E=D.document_count||0,ae=f.value.document_count||0;E>ae?(r.value=!0,k.value=ae,setTimeout(()=>{r.value=!1},1e3)):r.value=!1,f.value=D}else f.value={...D,status:"indexing"},r.value=!1}}catch(P){console.error("轮询索引状态失败:",P)}},U=()=>{h(),ie.success(t("common.refreshed"))},N=P=>P?new Date(P*1e3).toLocaleString():"",A=()=>{o.value=!1,setTimeout(()=>{a.onClose(y.value)},300)};return oe(()=>{setTimeout(()=>{o.value=!0}),p.value=String(a.item_id),_().then(()=>{w(),h()})}),Xe(()=>{M()}),(P,D)=>{const E=H("a-tooltip"),ae=H("a-alert"),ge=H("a-divider"),fe=H("a-textarea");return C(),L("div",$g,[s(de,{class:re({show:o.value}),title:P.$t("ai.ai_knowledge_base"),width:"800",onClose:A},{footer:m(()=>[s(K,{onClick:A,size:"large"},{default:m(()=>[D[12]||(D[12]=e("i",{class:"fas fa-times"},null,-1)),e("span",null,i(P.$t("common.close")),1)]),_:1})]),default:m(()=>[e("div",kg,[e("div",Cg,[e("div",xg,[s(Je,{modelValue:d.value.enabled,"onUpdate:modelValue":D[0]||(D[0]=ee=>d.value.enabled=ee),label:P.$t("ai.ai_enable_for_project"),disabled:!v.value},null,8,["modelValue","label","disabled"]),s(E,{title:P.$t("ai.ai_enable_for_project_tips")},{default:m(()=>[...D[3]||(D[3]=[e("i",{class:"fas fa-question-circle help-icon"},null,-1)])]),_:1},8,["title"])]),v.value?(C(),L("div",Ig,i(P.$t("ai.ai_enable_for_project_tips")),1)):F("",!0)]),v.value?d.value.enabled?F("",!0):(C(),L("div",Tg,[s(ae,{type:"info","show-icon":!0,message:P.$t("ai.ai_project_not_enabled")},null,8,["message"])])):(C(),L("div",Sg,[s(ae,{type:"warning","show-icon":!0,message:P.$t("ai.ai_system_not_configured")},null,8,["message"])])),v.value?(C(),L("div",Mg,[s(ge,{orientation:"left"},{default:m(()=>[O(i(P.$t("ai.ai_config")),1)]),_:1}),e("div",Lg,[e("div",Vg,[e("div",zg,[s(Je,{modelValue:d.value.dialog_expanded,"onUpdate:modelValue":D[1]||(D[1]=ee=>d.value.dialog_expanded=ee),label:P.$t("ai.ai_dialog_expanded_tips")},null,8,["modelValue","label"])])]),e("div",Ug,[e("div",Pg,[e("div",Ag,i(P.$t("ai.ai_welcome_message")),1),s(fe,{value:d.value.welcome_message,"onUpdate:value":D[2]||(D[2]=ee=>d.value.welcome_message=ee),rows:4,placeholder:P.$t("ai.ai_welcome_message_placeholder")},null,8,["value","placeholder"]),e("div",Dg,i(P.$t("ai.ai_welcome_message_tips")),1)])]),e("div",Og,[s(K,{type:"primary",onClick:T,loading:l.value,size:"large"},{default:m(()=>[D[4]||(D[4]=e("i",{class:"fas fa-save"},null,-1)),e("span",null,i(P.$t("common.save")),1)]),_:1},8,["loading"])])])])):F("",!0),v.value&&u.value?(C(),L("div",Ng,[s(ge,{orientation:"left"},{default:m(()=>[O(i(P.$t("ai.ai_index_management")),1)]),_:1}),e("div",Fg,[e("div",qg,[e("div",Rg,[e("div",Hg,i(P.$t("ai.ai_index_status")),1),e("div",Eg,[f.value.status==="indexed"?(C(),L("div",jg,[D[5]||(D[5]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",null,i(P.$t("ai.ai_indexed")),1)])):f.value.status==="indexing"?(C(),L("div",Bg,[D[6]||(D[6]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(P.$t("ai.ai_indexing")),1)])):f.value.status==="not_configured"?(C(),L("div",Gg,[D[7]||(D[7]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,i(P.$t("ai.ai_not_configured")),1)])):(C(),L("div",Kg,[D[8]||(D[8]=e("i",{class:"fas fa-info-circle"},null,-1)),e("span",null,i(P.$t("ai.ai_unknown_status")),1)]))])]),f.value.document_count!==void 0?(C(),L("div",Jg,[e("div",Wg,i(P.$t("ai.ai_chunk_count")),1),e("div",Yg,[e("span",Xg,i(f.value.document_count),1),e("span",Qg,i(P.$t("ai.ai_chunks")),1),r.value&&f.value.document_count>k.value?(C(),L("span",Zg," +"+i(f.value.document_count-k.value),1)):F("",!0)])])):F("",!0),f.value.last_update_time?(C(),L("div",e1,[e("div",t1,i(P.$t("ai.ai_last_update")),1),e("div",a1,i(N(f.value.last_update_time)),1)])):F("",!0)]),f.value.status==="indexing"?(C(),L("div",o1,[s(ae,{type:"info","show-icon":!0,message:P.$t("ai.ai_indexing_alert_title")},null,8,["message"]),e("div",s1,[e("p",null,i(P.$t("ai.ai_indexing_alert_message")),1),f.value.document_count!==void 0?(C(),L("div",l1,[D[9]||(D[9]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(P.$t("ai.ai_indexing_progress_info",{count:f.value.document_count})),1),r.value&&f.value.document_count>k.value?(C(),L("span",n1," +"+i(f.value.document_count-k.value),1)):F("",!0)])):F("",!0)])])):F("",!0),f.value.status==="indexed"&&f.value.document_count>0?(C(),L("div",i1,[s(ae,{type:"success","show-icon":!0,message:P.$t("ai.ai_indexed_ready_title")},null,8,["message"]),e("div",r1,i(P.$t("ai.ai_indexed_ready_message")),1)])):F("",!0),e("div",c1,[s(K,{type:"primary",onClick:x,loading:$.value,disabled:f.value.status==="not_configured",size:"large"},{default:m(()=>[D[10]||(D[10]=e("i",{class:"fas fa-sync-alt"},null,-1)),e("span",null,i(P.$t("ai.ai_rebuild_index")),1)]),_:1},8,["loading","disabled"]),s(K,{onClick:U,size:"large"},{default:m(()=>[D[11]||(D[11]=e("i",{class:"fas fa-redo"},null,-1)),e("span",null,i(P.$t("common.refresh")),1)]),_:1})])])])):F("",!0)])]),_:1},8,["class","title"])])}}});const m1=Y(u1,[["__scopeId","data-v-8bbc07ea"]]);function la(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(m1,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const _1={class:"my-modal"},p1={class:"open-api-container"},f1={class:"tips-section"},v1=["innerHTML"],h1=["innerHTML"],g1=["innerHTML"],y1=["innerHTML"],w1=["innerHTML"],b1=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(""),u=b(""),v=async()=>{try{const f=await Co(String(a.item_id));f.error_code===0?(l.value=f.data.api_key||"",u.value=f.data.api_token||""):j.error(f.error_message||t("common.op_failed"))}catch(f){console.error("获取 API 密钥失败:",f),j.error(t("common.op_failed"))}},d=async()=>{if(await Se(t("item.confirm_reset_token")))try{const $=await xo(String(a.item_id));$.error_code===0?(j.success(t("common.op_success")),await v()):j.error($.error_message||t("common.op_failed"))}catch($){console.error("重置 API Token 失败:",$),j.error(t("common.op_failed"))}},p=()=>{o.value=!1,setTimeout(()=>{a.onClose(!0)},300)};return oe(()=>{v(),setTimeout(()=>{o.value=!0})}),(f,$)=>{const g=H("a-input"),n=H("a-form-item"),y=H("a-form");return C(),L("div",_1,[s(de,{class:re({show:o.value}),title:z(t)("item.open_api"),icon:["fa","fa-plug"],onClose:p},{default:m(()=>[e("div",p1,[s(y,{"label-col":{span:6},"wrapper-col":{span:18}},{default:m(()=>[s(n,{label:z(t)("item.api_key_label")},{default:m(()=>[s(g,{value:l.value,"onUpdate:value":$[0]||($[0]=k=>l.value=k),readonly:!0},null,8,["value"])]),_:1},8,["label"]),s(n,{label:z(t)("item.api_token_label")},{default:m(()=>[s(g,{value:u.value,"onUpdate:value":$[1]||($[1]=k=>u.value=k),readonly:!0},null,8,["value"])]),_:1},8,["label"]),s(n,{"wrapper-col":{span:18,offset:6}},{default:m(()=>[s(K,{text:z(t)("item.reset_token"),theme:"dark",onClick:d},null,8,["text"])]),_:1})]),_:1}),e("div",f1,[e("p",{innerHTML:z(t)("item.open_api_tips1")},null,8,v1),e("p",{innerHTML:z(t)("item.open_api_tips2")},null,8,h1),e("p",{innerHTML:z(t)("item.open_api_tips3")},null,8,g1),e("p",{innerHTML:z(t)("item.open_api_tips4")},null,8,y1),e("p",{innerHTML:z(t)("item.open_api_tips5")},null,8,w1)])])]),_:1},8,["class","title"])])}}});const $1=Y(b1,[["__scopeId","data-v-551d32ec"]]);function na(c){return new Promise(t=>{const{app:a,mountNode:o}=ve($1,{item_id:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const k1={class:"item-list"},C1={class:"item-list-container"},x1=["data-key","onClick"],I1={class:"left float-left"},S1={key:0,class:"item-icon fas fa-file"},T1={key:1,class:"item-icon fas fa-table"},M1={key:2,class:"item-icon fas fa-terminal"},L1={key:3,class:"item-icon fas fa-notes"},V1={key:4,class:"star-flag fas fa-star v3-color-yellow"},z1=W({__name:"ItemList",props:{itemList:{},getItemList:{type:Function},itemGroupId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),u=b({item_domain:"",item_id:0}),v=M=>{const V=[{icon:["fas","fa-right-to-bracket"],text:t("item.open_item"),value:"open"},{icon:["fas","fa-share-nodes"],text:t("item.share_project"),value:"share"},M.is_star>0?{icon:["fas","fa-star"],text:t("item.unstar_item"),value:"unstar"}:{icon:["far","fa-star"],text:t("item.star_item"),value:"star"}];return M.manage!=1&&V.push({icon:["fas","fa-trash"],text:t("item.item_exit"),value:"exit"}),M.manage==1&&(V.push({icon:["fas","fa-edit"],text:t("item.update_base_info"),value:"update"},{icon:["far","fa-users"],text:t("item.member_manage"),value:"member"},{icon:["fas","fa-plug"],text:t("item.open_api"),value:"open_api"}),(M.item_type=="1"||M.item_type==1)&&V.push({icon:["fas","fa-brain"],text:t("ai.ai_knowledge_base"),value:"ai_knowledge_base"}),V.push({icon:["fas","fa-trash"],text:t("item.recycle"),value:"recycle"},{icon:["fas","fa-recycle"],text:t("item.attorn"),value:"attorn"},{icon:["fas","fa-copy"],text:t("item.copy_item"),value:"copy"},{icon:["fas","fa-box-archive"],text:t("item.archive"),value:"archive"},{icon:["fas","fa-trash-can"],text:t("item.delete_item"),value:"delete"})),V},d=async(M,V)=>{switch(V){case"open":p(M);break;case"share":$(M);break;case"star":case"unstar":f(M);break;case"exit":x(M.item_id);break;case"update":g(M);break;case"member":n(M);break;case"open_api":y(M);break;case"ai_knowledge_base":k(M);break;case"recycle":r(M);break;case"attorn":h(M);break;case"copy":w(M);break;case"archive":_(M);break;case"delete":T(M);break}},p=M=>{const V="/"+(M.item_domain?M.item_domain:M.item_id);a.push({path:V})},f=async M=>{const V=M.is_star,U=M.item_id;V>0?(await za(U),M.is_star=0,ie.success(t("common.op_success"))):(await Ua(U),M.is_star=1,ie.success(t("common.op_success")))},$=async M=>{await gt({item_domain:M.item_domain,item_id:M.item_id})},g=async M=>{await at({item_id:M.item_id})&&await o.getItemList()},n=async M=>{u.value=M,await yt(M.item_id),await o.getItemList()},y=async M=>{await na(M.item_id)},k=async M=>{await la(M.item_id),window.location.reload()},r=async M=>{await Mt(M.item_id)},_=async M=>{await wt(M.item_id)&&await o.getItemList()},h=async M=>{await bt(M.item_id)&&await o.getItemList()},w=async M=>{await Ea(M.item_id)&&await o.getItemList()},T=async M=>{await $t(M.item_id)&&await o.getItemList()},x=async M=>{await Pa(String(M)),ie.success(t("common.op_success"))},I=async({oldIndex:M,newIndex:V})=>{if(M===V)return;const U=document.querySelector(".item-list-container"),N=U==null?void 0:U.children;if(!N)return;const A={};for(let P=0;P<N.length;P++){const E=N[P].dataset.key;E&&(A[E]=P+1)}try{await Va(A,o.itemGroupId),ie.success(t("common.op_success")),await o.getItemList()}catch(P){console.error("Sort item failed:",P),await G(t("common.op_failed")),await o.getItemList()}};let S=null;return oe(()=>{const M=document.querySelector(".item-list-container");M&&(S=Fa.create(M,{animation:200,ghostClass:"sortable-ghost",dragClass:"sortable-drag",chosenClass:"sortable-chosen",onEnd:V=>{const{newIndex:U,oldIndex:N}=V;N!==U&&U!==null&&I({oldIndex:N,newIndex:U})}}))}),Xe(()=>{S&&S.destroy()}),(M,V)=>{const U=H("a-spin");return C(),L("div",k1,[s(U,{spinning:l.value,style:{width:"100%"}},{default:m(()=>[e("div",C1,[(C(!0),L(Ce,null,Pe(c.itemList,N=>(C(),L("div",{key:N.item_id,"data-key":N.item_id,onClick:A=>p(N),class:re(["item-list-one",N.item_type=="1"||N.item_type=="3"?"shadow-hover":""])},[e("div",{class:re(["item-list-one-block",N.item_type=="1"||N.item_type=="3"?"":"shadow-hover"])},[e("div",I1,[N.item_type=="2"?(C(),L("i",S1)):N.item_type=="4"?(C(),L("i",T1)):N.item_type=="3"?(C(),L("i",M1)):(C(),L("i",L1)),N.is_star>0?(C(),L("i",V1)):F("",!0),O(" "+i(N.item_name),1)]),e("div",{class:"right show-more float-right",onClick:lt(()=>{},["stop"])},[s(ut,{list:v(N),trigger:"hover",placement:"right",offsetX:20,onSelect:A=>d(N,A.value)},{default:m(()=>[...V[0]||(V[0]=[e("span",{class:"el-dropdown-link"},[e("i",{class:"item-icon-more fas fa-ellipsis"})],-1)])]),_:1},8,["list","onSelect"])])],2),e("div",{class:re(["item-list-one-block-bg",N.item_type=="1"||N.item_type=="3"?"":"item-list-one-block-bg-none"])},null,2)],10,x1))),128))])]),_:1},8,["spinning"])])}}});const U1=Y(z1,[["__scopeId","data-v-ec5be99b"]]),P1={class:"item-card-list"},A1={class:"card-container"},D1=["onClick"],O1={class:"item-card-header"},N1={class:"item-icon-wrapper"},F1={key:0,class:"item-icon fas fa-file"},q1={key:1,class:"item-icon fas fa-table"},R1={key:2,class:"item-icon fas fa-terminal"},H1={key:3,class:"item-icon fas fa-chalkboard"},E1={key:4,class:"item-icon fas fa-book"},j1={class:"item-card-title"},B1={class:"item-card-footer"},G1={class:"item-meta"},K1={class:"meta-item"},J1=W({__name:"ItemCardList",props:{itemList:{},getItemList:{type:Function},itemGroupId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b({}),u=U=>{const N=[{icon:["fas","fa-right-to-bracket"],text:t("item.open_item"),value:"open"},{icon:["fas","fa-share-nodes"],text:t("item.share_project"),value:"share"},U.is_star>0?{icon:["fas","fa-star"],text:t("item.unstar_item"),value:"unstar"}:{icon:["far","fa-star"],text:t("item.star_item"),value:"star"}];return U.manage!=1&&N.push({icon:["fas","fa-trash"],text:t("item.item_exit"),value:"exit"}),U.manage==1&&(N.push({icon:["fas","fa-edit"],text:t("item.update_base_info"),value:"update"},{icon:["far","fa-users"],text:t("item.member_manage"),value:"member"},{icon:["fas","fa-plug"],text:t("item.open_api"),value:"open_api"}),(U.item_type=="1"||U.item_type==1)&&N.push({icon:["fas","fa-brain"],text:t("ai.ai_knowledge_base"),value:"ai_knowledge_base"}),N.push({icon:["fas","fa-trash"],text:t("item.recycle"),value:"recycle"},{icon:["fas","fa-recycle"],text:t("item.attorn"),value:"attorn"},{icon:["fas","fa-copy"],text:t("item.copy_item"),value:"copy"},{icon:["fas","fa-box-archive"],text:t("item.archive"),value:"archive"},{icon:["fas","fa-trash-can"],text:t("item.delete_item"),value:"delete"})),N},v=async(U,N)=>{switch(N){case"open":d(U);break;case"share":f(U);break;case"star":case"unstar":p(U);break;case"exit":T(U.item_id);break;case"update":$(U);break;case"member":g(U);break;case"open_api":n(U);break;case"ai_knowledge_base":y(U);break;case"recycle":k(U);break;case"attorn":_(U);break;case"copy":h(U);break;case"archive":r(U);break;case"delete":w(U);break}},d=U=>{const N="/"+(U.item_domain?U.item_domain:U.item_id);a.push({path:N})},p=async U=>{const N=U.is_star,A=U.item_id;N>0?(await za(A),U.is_star=0,ie.success(t("common.op_success"))):(await Ua(A),U.is_star=1,ie.success(t("common.op_success")))},f=async U=>{await gt({item_domain:U.item_domain,item_id:U.item_id})},$=async U=>{await at({item_id:U.item_id})&&await o.getItemList()},g=async U=>{l.value=U,await yt(U.item_id),await o.getItemList()},n=async U=>{await na(U.item_id)},y=async U=>{await la(U.item_id),window.location.reload()},k=async U=>{await Mt(U.item_id)},r=async U=>{await wt(U.item_id)&&await o.getItemList()},_=async U=>{await bt(U.item_id)&&await o.getItemList()},h=async U=>{await Ea(U.item_id)&&await o.getItemList()},w=async U=>{await $t(U.item_id)&&await o.getItemList()},T=async U=>{await Pa(String(U)),ie.success(t("common.op_success"))},x=(U,N)=>!U&&!N?0:U?N?Math.max(U,N):U:N,I=U=>{if(!U)return"";const A=Date.now()/1e3-U;if(A<3600){const fe=Math.floor(A/60);return fe<=1?t("time.just_now"):t("time.minutes_ago",{n:fe})}if(A<86400){const fe=Math.floor(A/3600);return t("time.hours_ago",{n:fe})}if(A<604800){const fe=Math.floor(A/86400);return t("time.days_ago",{n:fe})}const P=new Date(U*1e3),D=P.getFullYear(),E=String(P.getMonth()+1).padStart(2,"0"),ae=String(P.getDate()).padStart(2,"0"),ge=new Date().getFullYear();return D===ge?`${E}-${ae}`:`${D}-${E}-${ae}`},S=U=>({1:t("item.type_regular"),2:t("item.type_single"),3:t("item.type_runapi"),4:t("item.type_table"),5:t("item.type_whiteboard")})[String(U)]||t("item.type_regular"),M=async({oldIndex:U,newIndex:N})=>{if(U===N)return;const A=document.querySelector(".draggable-container"),P=A==null?void 0:A.children;if(!P)return;const D={};for(let E=0;E<P.length;E++){const ge=P[E].dataset.key;ge&&(D[ge]=E+1)}try{await Va(D,o.itemGroupId),ie.success(t("common.op_success")),await o.getItemList()}catch(E){console.error("Sort item failed:",E),await G(t("common.op_failed")),await o.getItemList()}};let V=null;return oe(()=>{const U=document.querySelector(".draggable-container");U&&(V=Fa.create(U,{animation:200,ghostClass:"sortable-ghost",dragClass:"sortable-drag",chosenClass:"sortable-chosen",onEnd:N=>{const{newIndex:A,oldIndex:P}=N;P!==A&&A!==null&&M({oldIndex:P,newIndex:A})}}))}),Xe(()=>{V&&V.destroy()}),(U,N)=>{const A=H("a-col"),P=H("a-row");return C(),L("div",P1,[e("div",A1,[s(P,{gutter:[24,24],class:"draggable-container"},{default:m(()=>[(C(!0),L(Ce,null,Pe(c.itemList,D=>(C(),B(A,{xs:24,sm:12,md:12,lg:8,xl:8,key:D.item_id,"data-key":D.item_id},{default:m(()=>[e("div",{class:re(["item-card",{"is-starred":D.is_star>0}]),onClick:E=>d(D)},[D.is_star>0?(C(),L("div",{key:0,class:"star-corner",onClick:N[0]||(N[0]=lt(()=>{},["stop"]))},[...N[2]||(N[2]=[e("i",{class:"fas fa-star"},null,-1)])])):F("",!0),e("div",O1,[e("div",N1,[D.item_type=="2"?(C(),L("i",F1)):D.item_type=="4"?(C(),L("i",q1)):D.item_type=="3"?(C(),L("i",R1)):D.item_type=="5"?(C(),L("i",H1)):(C(),L("i",E1))]),e("div",j1,i(D.item_name),1),e("div",{class:"item-card-actions",onClick:N[1]||(N[1]=lt(()=>{},["stop"]))},[s(ut,{list:u(D),trigger:"hover",placement:"right",offsetX:20,onSelect:E=>v(D,E.value)},{default:m(()=>[...N[3]||(N[3]=[e("span",{class:"action-trigger"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["list","onSelect"])])]),e("div",B1,[e("div",G1,[e("span",K1,[N[4]||(N[4]=e("i",{class:"far fa-clock"},null,-1)),O(" "+i(I(x(D.last_update_time,D.addtime))),1)])]),e("div",{class:re(["item-type-badge",`type-${D.item_type}`])},i(S(D.item_type)),3)])],10,D1)]),_:2},1032,["data-key"]))),128))]),_:1})])])}}});const W1=Y(J1,[["__scopeId","data-v-af55266f"]]),Y1={class:"page"},X1={class:"item-list"},Q1=["onClick"],Z1={class:"left float-left"},e0={class:"item-page-content"},t0=["onClick"],a0={class:"search-content break-all"},o0={key:0,class:"loading-indicator"},s0=W({__name:"Search",props:{keyword:{},itemList:{}},setup(c){const t=xe(),a=c,o=b(!1),l=b([]),u=b([]);qe(()=>a.keyword,f=>{l.value=[],l.value.push(f),u.value=[],v()});const v=async()=>{o.value=!0;for(let f=0;f<a.itemList.length;f++){const $=a.itemList[f];let g=0,n=0,y=[];$&&$.item_name&&$.item_name.indexOf(a.keyword)>-1&&(g=1);try{const r=(await Io(a.keyword,$.item_id)).data;r&&r.pages&&r.pages.length>0&&(n=1,y=r.pages)}catch(k){console.error("Search item failed:",k)}(g||n)&&u.value.push({...$,pages:y})}o.value=!1},d=f=>{const $="/"+(f.item_domain?f.item_domain:f.item_id),g=t.resolve({path:$});window.open(g.href,"_blank")},p=f=>{const $="/"+f.item_id+"/"+f.page_id,g=t.resolve({path:$});window.open(g.href,"_blank")};return oe(()=>{l.value=[],l.value.push(a.keyword),v()}),(f,$)=>{const g=H("a-spin"),n=H("a-empty");return C(),L("div",Y1,[e("div",X1,[(C(!0),L(Ce,null,Pe(u.value,y=>(C(),L("div",{class:"item-list-one",key:y.item_id},[e("div",{class:"item-title",onClick:k=>d(y)},[e("div",Z1,[$[0]||($[0]=e("i",{class:"item-icon fas fa-file"},null,-1)),s(Ot,{queries:l.value},{default:m(()=>[O(i(y.item_name),1)]),_:2},1032,["queries"])])],8,Q1),e("div",e0,[(C(!0),L(Ce,null,Pe(y.pages,k=>(C(),L("div",{key:k.page_id},[e("div",{onClick:r=>p(k),class:"page-title"},[$[1]||($[1]=e("i",{class:"item-icon fas fa-file"},null,-1)),s(Ot,{queries:l.value},{default:m(()=>[O(i(k.page_title),1)]),_:2},1032,["queries"])],8,t0),e("div",a0,[s(Ot,{queries:l.value},{default:m(()=>[O(i(k.search_content),1)]),_:2},1032,["queries"])])]))),128))])]))),128)),o.value?(C(),L("div",o0,[s(g),e("span",null,i(f.$t("common.searching")),1)])):F("",!0)]),u.value.length===0&&!o.value?(C(),B(n,{key:0,description:f.$t("item.search_no_results")},null,8,["description"])):F("",!0)])}}});const l0=Y(s0,[["__scopeId","data-v-d4041ad6"]]),n0={class:"import-openapi-modal"},i0={class:"modal-content"},r0={class:"tips-container"},c0={class:"tips"},d0=["innerHTML"],u0={class:"tips"},m0=["innerHTML"],_0={class:"tips"},p0=["innerHTML"],f0={class:"tips"},v0=["innerHTML"],h0={class:"tips"},g0=["innerHTML"],y0={class:"modal-footer"},w0=W({__name:"index",props:{onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=()=>{a.value=!1,setTimeout(()=>{t.onClose(!1)},300)};return oe(async()=>{setTimeout(()=>{a.value=!0})}),(l,u)=>(C(),L("div",n0,[s(de,{class:re({show:a.value}),title:l.$t("item.open_api"),icon:["fas","fa-terminal"],onClose:o},{default:m(()=>[e("div",i0,[e("div",r0,[e("p",c0,[e("span",{innerHTML:l.$t("item.open_api_tips1")},null,8,d0)]),e("p",u0,[e("span",{innerHTML:l.$t("item.open_api_tips2")},null,8,m0)]),e("p",_0,[e("span",{innerHTML:l.$t("item.open_api_tips3")},null,8,p0)]),e("p",f0,[e("span",{innerHTML:l.$t("item.open_api_tips4")},null,8,v0)]),e("p",h0,[e("span",{innerHTML:l.$t("item.open_api_tips5")},null,8,g0)])])]),e("div",y0,[e("div",{class:"secondary-button",onClick:o},i(l.$t("common.cancel")),1)])]),_:1},8,["class","title"])]))}});const b0=Y(w0,[["__scopeId","data-v-fbba83f6"]]);function $0(){return new Promise(c=>{const{app:t,mountNode:a}=ve(b0,{onClose:o=>{c(o),me(t,a)}});t.mount(a)})}const k0={class:"import-file-modal"},C0={class:"modal-content"},x0={class:"tips"},I0=["innerHTML"],S0={class:"upload-area"},T0={class:"upload-text"},M0=["innerHTML"],L0={key:0,class:"loading-overlay"},V0={class:"modal-footer"},z0=W({__name:"index",props:{onClose:{type:Function},itemId:{}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!1),u=b(!1),v=Qt(),d=b({user_token:(v==null?void 0:v.user_token)||"",item_id:o.itemId||""}),p=q(()=>ot()+"/api/import/auto"),f=n=>(u.value=!0,!0),$=n=>{if(n.file.status==="done"){const y=n.file.response;y&&y.error_code===0?(ie.success(t("common.op_success")),u.value=!1,g(!0)):(u.value=!1,G((y==null?void 0:y.error_message)||t("common.op_failed")))}else n.file.status==="error"?(u.value=!1,G(t("common.op_failed"))):n.file.status==="uploading"&&(u.value=!0)},g=(n=!1)=>{l.value=!1,setTimeout(()=>{o.onClose(n),n&&(o.itemId&&o.itemId>0?window.location.reload():a.push({path:"/item/index"}))},300)};return oe(async()=>{setTimeout(()=>{l.value=!0})}),(n,y)=>{const k=H("a-upload");return C(),L("div",k0,[s(de,{class:re({show:l.value}),title:n.$t("item.import_file"),icon:["fa","fa-upload"],onClose:g},{default:m(()=>[e("div",C0,[e("p",x0,[e("span",{class:"tips-text",innerHTML:n.$t("item.import_file_tips1")},null,8,I0)]),e("div",S0,[s(k,{data:d.value,class:"upload-demo",action:p.value,"before-upload":f,"show-upload-list":!1,onChange:$,disabled:u.value,drag:""},{default:m(()=>[e("div",{class:re(["upload-content",{"is-loading":u.value}])},[y[2]||(y[2]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",T0,[e("span",{innerHTML:n.$t("item.import_file_tips2")},null,8,M0)]),u.value?(C(),L("div",L0,[y[1]||(y[1]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),e("span",null,i(n.$t("common.uploading")||"文件上传和导入中，请稍候..."),1)])):F("",!0)],2)]),_:1},8,["data","action","disabled"])])]),e("div",V0,[e("div",{class:"secondary-button",onClick:y[0]||(y[0]=()=>g(!1))},i(n.$t("common.cancel")),1)])]),_:1},8,["class","title"])])}}});const U0=Y(z0,[["__scopeId","data-v-5a4b06c9"]]);function ja(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(U0,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const P0={class:"create-item-btn-div"},A0={class:"left"},D0={class:"right"},O0=W({__name:"ItemAdd",props:{itemGroupId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=async()=>{await at({item_type:"1",item_group_id:a.itemGroupId})&&a.callback()},u=async()=>{await at({item_type:"2",item_group_id:a.itemGroupId})&&a.callback()},v=async()=>{await at({item_type:"4",item_group_id:a.itemGroupId})&&a.callback()},d=async()=>{await at({item_type:"5",item_group_id:a.itemGroupId})&&a.callback()},p=async()=>{await ja()&&a.callback()},f=async()=>{await $0()&&a.callback()};return o.value=[{group_name:t("item.create"),listMenu:[{title:t("item.regular_item"),icon:"fas fa-notes",desc:t("item.regular_item_desc"),method:l},{title:t("item.single_item"),icon:"fas fa-file",desc:t("item.single_item_desc"),method:u},{title:t("item.table_item"),icon:"fas fa-table",desc:t("item.table_item_desc"),method:v},{title:t("item.whiteboard_item"),icon:"fas fa-pen",desc:t("item.whiteboard_item_desc"),method:d}]},{group_name:t("item.import"),listMenu:[{title:t("item.import_file"),icon:"fas fa-upload",desc:t("item.import_file_desc"),method:p},{title:t("item.auto_create"),icon:"fas fa-terminal",desc:t("item.auto_create_desc"),method:f}]}],($,g)=>(C(),L("div",P0,[e("div",A0,[e("div",{onClick:l,class:"create-item-left-btn"},[g[0]||(g[0]=e("i",{class:"mr-3 fas fa-plus"},null,-1)),e("span",null,i(z(t)("item.create_new_item")),1)])]),e("div",D0,[s(Oa,{title:z(t)("item.create_new_item"),titleIcon:"fas fa-plus",menuListGroup:o.value,placement:"top"},{default:m(()=>[...g[1]||(g[1]=[e("div",{class:"create-item-right-btn"},[e("i",{class:"fas fa-ellipsis"})],-1)])]),_:1},8,["title","menuListGroup"])])]))}});const N0=Y(O0,[["__scopeId","data-v-4281ad9d"]]),F0={class:"item-group-modal"},q0={class:"modal-content"},R0={key:0,class:"tips"},H0={class:"group-info"},E0={class:"group-name"},j0={class:"group-actions"},B0={class:"modal-footer"},G0={class:"edit-modal-content"},K0={class:"form-group"},J0={class:"form-label"},W0={class:"item-selection"},Y0={class:"selection-title"},X0={class:"modal-footer"},Q0=W({__name:"ItemGroup",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b({id:"",group_name:""}),u=b([]),v=b(!1),d=b([]),p=b([]),f=q(()=>[{title:t("item.item_name"),key:"item_name",width:300}]),$=q(()=>({selectedRowKeys:p.value,onChange:I=>{p.value=I}})),g=(I,S)=>{p.value=I},n=()=>{l.value={id:"",group_name:""},p.value=[],v.value=!0},y=q(()=>[{text:t("item.add_group"),icon:"fas fa-plus",type:"default",size:"small",onClick:n}]),k=async()=>{try{const I=await Xt();I&&I.data&&(u.value=I.data)}catch(I){console.error("Get group list failed:",I)}},r=async()=>{try{const I=await kt(0);I&&I.data&&(d.value=I.data)}catch(I){console.error("Get item list failed:",I)}},_=async()=>{const I=l.value.group_name||"default",S=l.value.id,M=p.value.join(",");try{await So({group_name:I,id:S,item_ids:M}),await k(),v.value=!1,p.value=[],l.value={id:"",group_name:""},ie.success(t("common.op_success"))}catch(V){console.error("Save group failed:",V),await G(t("common.error"))}},h=I=>{l.value.id=I.id,l.value.group_name=I.group_name,p.value=[],(I.item_ids?I.item_ids.split(","):[]).forEach(M=>{const V=d.value.find(U=>String(U.item_id)===M);V&&p.value.push(V.item_id)}),v.value=!0},w=async I=>{if(await Se({title:t("common.confirm"),msg:t("common.confirm_delete"),confirmText:t("common.confirm"),cancelText:t("common.cancel")}))try{await To({id:I}),await k(),ie.success(t("common.op_success"))}catch(M){console.error("Delete group failed:",M),await G(t("common.error"))}},T=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)},x=async({oldIndex:I,newIndex:S})=>{const M=u.value[I];u.value.splice(I,1),u.value.splice(S,0,M);const V=u.value.map((U,N)=>({id:U.id,s_number:N+1}));try{await Mo({groups:JSON.stringify(V)}),a.callback()}catch(U){console.error("Save group sort failed:",U)}};return oe(async()=>{setTimeout(()=>{o.value=!0}),await r(),await k()}),(I,S)=>{const M=H("a-empty"),V=H("a-button");return C(),L("div",F0,[s(de,{class:re({show:o.value}),title:I.$t("item.manage_item_group"),headerButtons:y.value,onClose:T},{default:m(()=>[e("div",q0,[u.value&&u.value.length>1?(C(),L("p",R0,i(z(t)("item.draggable_tips")),1)):F("",!0),s(vs,{handle:".group-item",listClass:"group-list",animate:200,onDrop:x},{default:m(()=>[!u.value||u.value.length===0?(C(),B(M,{key:0,description:z(t)("item.item_group_empty_tips")},null,8,["description"])):F("",!0),(C(!0),L(Ce,null,Pe(u.value,U=>(C(),L("div",{key:U.id,class:"group-item"},[e("div",H0,[S[3]||(S[3]=e("i",{class:"fas fa-bars handle-icon"},null,-1)),e("span",E0,i(U.group_name),1)]),e("div",j0,[s(V,{type:"link",size:"small",onClick:N=>h(U)},{default:m(()=>[O(i(z(t)("common.edit")),1)]),_:1},8,["onClick"]),s(V,{type:"link",size:"small",danger:"",onClick:N=>w(U.id)},{default:m(()=>[O(i(z(t)("common.delete")),1)]),_:1},8,["onClick"])])]))),128))]),_:1})]),e("div",B0,[e("div",{class:"secondary-button",onClick:T},i(z(t)("common.close")),1)])]),_:1},8,["class","title","headerButtons"]),v.value?(C(),B(de,{key:0,class:re({show:v.value}),title:l.value.id?z(t)("item.edit_group"):z(t)("item.add_group"),onClose:S[2]||(S[2]=U=>v.value=!1)},{default:m(()=>[e("div",G0,[e("div",K0,[e("label",J0,i(z(t)("item.group_name"))+":",1),s(ne,{modelValue:l.value.group_name,"onUpdate:modelValue":S[0]||(S[0]=U=>l.value.group_name=U),placeholder:z(t)("item.group_name")},null,8,["modelValue","placeholder"])]),e("div",W0,[e("p",Y0,i(z(t)("item.select_item")),1),s(Le,{"table-header":f.value,"table-data":d.value,"row-selection":$.value,"row-key":"item_id",pagination:!1,"max-height":"400px",onSelectionChange:g},{"cell-item_name":m(({value:U})=>[O(i(U),1)]),_:1},8,["table-header","table-data","row-selection"])])]),e("div",X0,[e("div",{class:"secondary-button",onClick:S[1]||(S[1]=U=>v.value=!1)},i(z(t)("common.cancel")),1),e("div",{class:"primary-button",onClick:_},i(z(t)("common.confirm")),1)])]),_:1},8,["class","title"])):F("",!0)])}}});const Z0=Y(Q0,[["__scopeId","data-v-d5834eae"]]),ey={class:"item-home"},ty={class:"header"},ay={class:""},oy={class:"v3-color-aux logo-desc"},sy={class:"left-side"},ly={class:"all-star-item-group"},ny={class:"item-one-block-content"},iy={class:"item-one-block-content"},ry={class:"item-one-block-content"},cy={class:"divider-item-block"},dy={class:"divider-text"},uy=["onClick"],my={class:"item-one-block-content"},_y={key:0,class:"left-bottom-bar"},py={class:"content"},fy={class:"right-side"},vy={class:"search-and-view-control"},hy={class:"search-box-div"},gy={class:"search-box"},yy={class:"divider-item-block mt-3 mb-3"},wy={class:"divider-text"},by={class:"view-switcher"},$y={key:2,class:"loading-container"},ky=W({__name:"Index",setup(c){const{t,locale:a}=te(),o=xe(),l=Qe();b(new Date);const u=b([]),v=b(!1),d=b(""),p=b(!1),f=b(0),$=b([]),g=b(!1),n=b("card"),y=b(!1),k=b(!1),r=q(()=>{if(d.value)return a.value==="en-US"?`Search results with "${d.value}"`:`含有"${d.value}"的搜索结果`;if(f.value===0)return t("item.all_items");if(f.value===-1)return t("item.star_items");const V=$.value.find(U=>parseInt(U.id)==f.value);return V?V.group_name:""});qe(d,V=>{if(V)if(V&&V.length===1){var U=new RegExp("[一-龥]+");U.test(V)&&(p.value=!0)}else p.value=!0;else p.value=!1}),qe(n,V=>{localStorage.setItem("defaultViewMode",V)});const _=async()=>{k.value=!0;try{const V=await kt(f.value);V&&V.data&&(u.value=V.data)}finally{k.value=!1}},h=async()=>{const V=await Xt();if(V&&V.data){$.value=V.data;const U=localStorage.getItem("deaultItemGroupId");$.value.forEach(N=>{N.id==U&&(f.value=parseInt(U))}),_()}},w=V=>{f.value=V,localStorage.setItem("deaultItemGroupId",String(V)),p.value=!1,d.value="",_()},T=()=>{window.location.reload()},x=async()=>{try{await I()}catch(V){console.error("Refresh user info failed:",V)}},I=async()=>{try{const V=await X("/api/user/info",{});V&&V.error_code===0&&V.data.groupid==1&&(v.value=!0)}catch(V){console.error("Fetch user info failed:",V)}},S=V=>{window.open(V)},M=()=>{o.push({path:"/public-square/index"})};return oe(async()=>{console.log("[ItemHome] 页面加载"),console.log("[ItemHome] userStore.isLoggedIn:",l.isLoggedIn),console.log("[ItemHome] userStore.userInfo:",l.userInfo),l.loadUserInfo(),console.log("[ItemHome] 加载后 userStore.isLoggedIn:",l.isLoggedIn),console.log("[ItemHome] 加载后 userStore.userInfo:",l.userInfo);const V=localStorage.getItem("deaultItemGroupId");V===null?f.value=0:f.value=parseInt(V);const U=localStorage.getItem("defaultViewMode");U&&(n.value=U),h(),x();try{const N=await Yt();y.value=N&&N.data&&N.data.enable===1}catch{y.value=!1}}),(V,U)=>{const N=H("a-divider"),A=H("a-tooltip"),P=H("a-spin");return C(),L("div",ey,[e("div",ty,[e("div",{class:"logo ml-10",onClick:T},[U[8]||(U[8]=e("div",{class:"logo-img-div"},[e("img",{onerror:"this.style.display='none';",class:"logo-img",src:Tt,alt:"ShowDoc"})],-1)),e("div",ay,[U[7]||(U[7]=e("div",{class:"font-bold logo-title"},"ShowDoc",-1)),e("div",oy,i(z(t)("index.home_logo_title")),1)])]),s(Ev,{isAdmin:v.value},null,8,["isAdmin"])]),ft(s(Na,{popup:!1},null,512),[[ga,z(l).isLoggedIn]]),e("div",{class:re(["container",{"card-view-mode":n.value==="card"}])},[e("div",sy,[e("div",ly,[e("div",{class:re(f.value===0?"item-one-block item-one-block-active":"item-one-block"),onClick:U[0]||(U[0]=D=>w(0))},[e("div",ny,[U[9]||(U[9]=e("i",{class:"mr-1 fas fa-notes"},null,-1)),O(" "+i(z(t)("item.all_items")),1)])],2),e("div",{class:re(f.value===-1?"item-one-block item-one-block-active":"item-one-block"),onClick:U[1]||(U[1]=D=>w(-1))},[e("div",iy,[U[10]||(U[10]=e("i",{class:"mr-1 fas fa-star v3-color-yellow"},null,-1)),O(" "+i(z(t)("item.star_items")),1)])],2),y.value?(C(),L("div",{key:0,class:"item-one-block public-square-link",onClick:M},[e("div",ry,[U[11]||(U[11]=e("i",{class:"mr-1 fas fa-landmark"},null,-1)),O(" "+i(z(t)("item.public_square")),1)])])):F("",!0)]),s(N,{class:"item-group-divider"}),e("div",cy,[e("div",dy,i(z(t)("item.group")),1),e("div",{class:"divider-icon",onClick:U[2]||(U[2]=D=>g.value=!0)},[s(A,{title:z(t)("item.item_group_desc"),placement:"top"},{default:m(()=>[...U[12]||(U[12]=[e("i",{class:"fas fa-plus mr-1"},null,-1)])]),_:1},8,["title"])])]),e("div",null,[(C(!0),L(Ce,null,Pe($.value,D=>(C(),L("div",{key:D.item_id,class:re(f.value==D.id?"item-one-block item-one-block-active":"item-one-block"),onClick:E=>w(D.id)},[e("div",my,[U[13]||(U[13]=e("i",{class:"mr-1 far fa-hashtag v3-font-size-sm"},null,-1)),O(" "+i(D.group_name),1)])],10,uy))),128))]),z(a)==="zh-CN"?(C(),L("div",_y,[e("div",py,[U[14]||(U[14]=e("i",{class:"far fa-fire"},null,-1)),U[15]||(U[15]=O(" 调试API并自动生成文档 ",-1)),e("a",{class:"text-link ml-2",onClick:U[3]||(U[3]=D=>S("https://www.showdoc.com.cn/runapi"))},"试试")])])):F("",!0)]),e("div",fy,[e("div",vy,[e("div",hy,[e("div",gy,[s(ne,{modelValue:d.value,"onUpdate:modelValue":U[4]||(U[4]=D=>d.value=D),placeholder:z(t)("item.search_keyword"),"allow-clear":"",autocomplete:"off",class:"search-input"},{prefix:m(()=>[...U[16]||(U[16]=[e("i",{class:"fas fa-search"},null,-1)])]),_:1},8,["modelValue","placeholder"])])])]),e("div",yy,[e("div",wy,i(r.value),1),e("div",by,[s(A,{title:z(t)("item.list_view"),placement:"top"},{default:m(()=>[e("div",{class:re(["view-switch-btn",{active:n.value==="list"}]),onClick:U[5]||(U[5]=D=>n.value="list")},[...U[17]||(U[17]=[e("i",{class:"fas fa-list-ul"},null,-1)])],2)]),_:1},8,["title"]),s(A,{title:z(t)("item.card_view"),placement:"top"},{default:m(()=>[e("div",{class:re(["view-switch-btn",{active:n.value==="card"}]),onClick:U[6]||(U[6]=D=>n.value="card")},[...U[18]||(U[18]=[e("i",{class:"fas fa-th-large"},null,-1)])],2)]),_:1},8,["title"])])]),!k.value&&!p.value&&n.value==="list"?(C(),B(U1,{key:0,itemList:u.value,getItemList:_,itemGroupId:f.value},null,8,["itemList","itemGroupId"])):F("",!0),!k.value&&!p.value&&n.value==="card"?(C(),B(W1,{key:1,itemList:u.value,getItemList:_,itemGroupId:f.value},null,8,["itemList","itemGroupId"])):F("",!0),k.value&&!p.value?(C(),L("div",$y,[s(P,{size:"large"})])):F("",!0),p.value?(C(),B(l0,{key:3,keyword:d.value,itemList:u.value},null,8,["keyword","itemList"])):F("",!0),e("div",{class:re(["content-wrapper",{"card-view-mode":n.value==="card"}])},[s(N0,{itemGroupId:f.value,callback:()=>{_()}},null,8,["itemGroupId","callback"])],2)])],2),g.value?(C(),B(Z0,{key:0,callback:()=>{g.value=!1,h()}},null,8,["callback"])):F("",!0)])}}});const Cy=Y(ky,[["__scopeId","data-v-454c8b0a"]]),gS=Object.freeze(Object.defineProperty({__proto__:null,default:Cy},Symbol.toStringTag,{value:"Module"})),xy={class:"item-setting-page"},Iy=W({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),L("div",xy,[e("h2",null,i(t.$t("item.item_setting")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:m(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const Sy=Y(Iy,[["__scopeId","data-v-1704147b"]]),yS=Object.freeze(Object.defineProperty({__proto__:null,default:Sy},Symbol.toStringTag,{value:"Module"})),Ty={class:"item-export-page"},My=W({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),L("div",Ty,[e("h2",null,i(t.$t("item.export")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:m(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const Ly=Y(My,[["__scopeId","data-v-1fa43a5c"]]),wS=Object.freeze(Object.defineProperty({__proto__:null,default:Ly},Symbol.toStringTag,{value:"Module"})),Vy={class:"item-password-page"},zy={class:"password-card"},Uy={class:"title"},Py={class:"form-group"},Ay={class:"form-group captcha-group"},Dy=["src","title"],Oy={class:"footer-links"},Ny=W({__name:"Index",setup(c){const t=Ge(),a=xe(),{t:o}=te(),l=b(""),u=b(""),v=b(0),d=b(""),p=b(!1),f=b("/"),$=async()=>{try{const n=await X("/api/common/createCaptcha",{});if(n.error_code===0){const y=n.data;v.value=y.captcha_id;let r=`${ot()}/api/common/showCaptcha`;r=dt(r,{captcha_id:y.captcha_id,t:Date.now()}),d.value=r}}catch(n){console.error("获取验证码失败:",n),G(o("common.error"))}},g=async()=>{if(!l.value){G(o("item.visit_password_placeholder"));return}if(!u.value){G(o("user.captcha_required"));return}const n=t.params.item_id||0,y=t.query.page_id||0;p.value=!0;try{const k={item_id:n,page_id:y,password:l.value,captcha:u.value,captcha_id:v.value},r=await X("/api/item/pwd",k,"post",!1);if(r.error_code===0){sessionStorage.setItem("_item_pwd",l.value);const _=decodeURIComponent(f.value||`/${n}`);a.replace(_)}else $(),G(r.error_message||o("common.error"))}catch(k){console.error("密码验证失败:",k),$(),G(o("common.error"))}finally{p.value=!1}};return oe(()=>{const n=t.params.item_id||0;f.value=t.query.redirect||`/${n}`,$()}),(n,y)=>{const k=H("router-link");return C(),L("div",Vy,[e("div",zy,[e("h2",Uy,i(n.$t("item.input_visit_password")),1),e("div",Py,[s(ne,{modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=r=>l.value=r),type:"password",placeholder:n.$t("item.visit_password_placeholder"),onKeyup:Fe(g,["enter"])},null,8,["modelValue","placeholder"])]),e("div",Ay,[s(ne,{modelValue:u.value,"onUpdate:modelValue":y[1]||(y[1]=r=>u.value=r),placeholder:n.$t("user.verification_code"),onKeyup:Fe(g,["enter"])},null,8,["modelValue","placeholder"]),d.value?(C(),L("img",{key:0,src:d.value,class:"captcha-img",onClick:$,title:n.$t("item.click_to_refresh")},null,8,Dy)):F("",!0)]),s(K,{theme:"dark",loading:p.value,"full-width":!0,onClick:g,class:"submit-btn"},{default:m(()=>[O(i(n.$t("common.submit")),1)]),_:1},8,["loading"]),e("div",Oy,[s(k,{to:`/user/login?redirect=${encodeURIComponent(f.value)}`},{default:m(()=>[O(i(n.$t("user.login")),1)]),_:1},8,["to"])])])])}}});const Fy=Y(Ny,[["__scopeId","data-v-d4d69cd9"]]),bS=Object.freeze(Object.defineProperty({__proto__:null,default:Fy},Symbol.toStringTag,{value:"Module"})),qy={class:"notify-modal"},Ry={class:"form-section"},Hy={class:"notify-info"},Ey={class:"notify-count"},jy={class:"tips-text"},By={class:"footer-buttons"},Gy={class:"member-modal-content"},Ky={class:"member-actions"},Jy={class:"add-member-content"},Wy={class:"form-section"},Yy={class:"select-wrapper"},Xy={class:"tips-text"},Qy={class:"footer-buttons"},Zy=W({__name:"index",props:{itemId:{},pageId:{},onClose:{type:Function},onConfirm:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),u=b(!1),v=b(""),d=b(!1),p=b([]),f=b([]),$=b([]),g=q(()=>f.value.map(M=>({label:`${M.username}${M.name?` (${M.name})`:""}`,value:M.uid}))),n=q(()=>[{title:a("page.username"),key:"username",width:150},{title:a("page.name"),key:"name",width:120},{title:a("page.addtime"),key:"sub_time",width:180},{title:a("common.operation"),key:"action",width:100,center:!0}]),y=q(()=>p.value),k=()=>{var M;o.value=!1,(M=t.onClose)==null||M.call(t)},r=()=>{t.onConfirm(v.value)},_=async()=>{try{d.value=!0;const M=await Lo(t.pageId);p.value=M}catch(M){console.error("加载订阅者列表失败:",M)}finally{d.value=!1}},h=async()=>{try{const M=await Vo(t.itemId);f.value=M}catch(M){console.error("加载成员列表失败:",M)}},w=(M,V)=>V.label.toLowerCase().indexOf(M.toLowerCase())>=0,T=async()=>{if($.value.length===0){ie.info(a("page.select_member_first"));return}try{await ua(t.pageId,$.value),await _(),$.value=[],u.value=!1,ie.success(a("common.op_success"))}catch(M){console.error("添加成员失败:",M),await G(a("common.op_failed"))}},x=async()=>{if(f.value.length===0){ie.info(a("page.no_member_to_add"));return}try{const M=f.value.map(V=>V.uid);await ua(t.pageId,M),await _(),ie.success(a("common.op_success"))}catch(M){console.error("添加全部成员失败:",M),await G(a("common.op_failed"))}},I=async M=>{try{await zo(t.pageId,[M.uid]),await _(),ie.success(a("common.delete_success"))}catch(V){console.error("删除成员失败:",V),await G(a("common.delete_failed"))}},S=M=>M?typeof M=="string"?M:new Date(M*1e3).toLocaleString():"-";return oe(()=>{o.value=!0,_(),h()}),qe(u,M=>{M&&h()}),(M,V)=>{const U=H("a-select"),N=H("a-tooltip");return C(),L(Ce,null,[s(de,{show:o.value,title:M.$t("page.save_and_notify"),icon:["fas","fa-comment-dots"],width:"500px",onClose:k},{footer:m(()=>[e("div",By,[s(K,{text:M.$t("common.cancel"),theme:"light",onClick:k},null,8,["text"]),s(K,{text:M.$t("common.confirm"),theme:"dark",onClick:r},null,8,["text"])])]),default:m(()=>[e("div",qy,[e("div",Ry,[s(tt,{modelValue:v.value,"onUpdate:modelValue":V[0]||(V[0]=A=>v.value=A),label:M.$t("page.notify_content"),placeholder:M.$t("page.notify_content_placeholder"),rows:4},null,8,["modelValue","label","placeholder"])]),e("div",Hy,[s(K,{type:"link",text:M.$t("page.click_to_edit_member"),onClick:V[1]||(V[1]=A=>l.value=!0)},null,8,["text"]),e("span",Ey," ( "+i(M.$t("page.cur_setting_notify"))+" "+i(p.value.length)+" "+i(M.$t("page.people"))+" ) ",1)]),e("p",jy,i(M.$t("page.notify_tips1")),1)])]),_:1},8,["show","title"]),l.value?(C(),B(de,{key:0,show:l.value,title:M.$t("page.edit_notify_member"),icon:["fas","fa-users"],width:"700px",onClose:V[4]||(V[4]=A=>l.value=!1)},{footer:m(()=>[s(K,{text:M.$t("common.close"),theme:"light",onClick:V[3]||(V[3]=A=>l.value=!1)},null,8,["text"])]),default:m(()=>[e("div",Gy,[e("div",Ky,[s(K,{text:M.$t("page.add_single_member"),"left-icon":["fas","fa-user-plus"],theme:"light",onClick:V[2]||(V[2]=A=>u.value=!0)},null,8,["text"]),s(K,{text:M.$t("page.add_all_member"),"left-icon":["fas","fa-users"],theme:"light",onClick:x},null,8,["text"])]),s(Le,{"table-header":n.value,"table-data":y.value,loading:d.value,"row-key":A=>A.uid,"max-height":"400px"},{"cell-username":m(({row:A})=>[O(i(A.username),1)]),"cell-name":m(({row:A})=>[O(i(A.name||"-"),1)]),"cell-sub_time":m(({row:A})=>[O(i(S(A.sub_time)),1)]),"cell-action":m(({row:A})=>[s(K,{type:"link",text:M.$t("common.delete"),theme:"light",onClick:P=>I(A)},null,8,["text","onClick"])]),_:1},8,["table-header","table-data","loading","row-key"])])]),_:1},8,["show","title"])):F("",!0),u.value?(C(),B(de,{key:1,show:u.value,title:M.$t("page.add_single_member"),icon:["fas","fa-user-plus"],width:"500px",onClose:V[7]||(V[7]=A=>u.value=!1)},{footer:m(()=>[e("div",Qy,[s(K,{text:M.$t("common.cancel"),theme:"light",onClick:V[6]||(V[6]=A=>u.value=!1)},null,8,["text"]),s(K,{text:M.$t("common.confirm"),theme:"dark",onClick:T},null,8,["text"])])]),default:m(()=>[e("div",Jy,[e("div",Wy,[e("label",null,i(M.$t("page.username")),1),e("div",Yy,[s(U,{value:$.value,"onUpdate:value":V[5]||(V[5]=A=>$.value=A),mode:"multiple",placeholder:M.$t("page.select_or_search_member"),options:g.value,"show-search":"","filter-option":w,style:{flex:"1"}},null,8,["value","placeholder","options"]),s(N,{title:M.$t("page.refresh_member_list")},{default:m(()=>[e("i",{class:"fas fa-sync-alt refresh-btn",onClick:h})]),_:1},8,["title"])])]),e("p",Xy,i(M.$t("page.notify_add_member_tips1")),1)])]),_:1},8,["show","title"])):F("",!0)],64)}}});const ew=Y(Zy,[["__scopeId","data-v-f6141e88"]]);function tw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(ew,{itemId:c.itemId,pageId:c.pageId,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onConfirm:l=>{var u;(u=c.onConfirm)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const aw={class:"json-to-table"},ow={class:"description"},sw=W({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),u=()=>{t.onClose()},v=()=>{if(!l.value.trim()){G(a("common.required"));return}try{const p=JSON.parse(l.value),f=d(p);t.onInsert(f),t.onClose()}catch(p){console.error("JSON解析失败:",p),G(a("page.invalid_json"))}},d=p=>{let f=[];const $=[],g=(n,y="",k=1)=>{if(!n||typeof n!="object")return;Object.keys(n).forEach(_=>{let h=_;if(k>2||k>1&&y&&!isNaN(Number(y))?isNaN(Number(_))?h=y+"."+_:h=y:k>1&&y&&isNaN(Number(y))&&isNaN(Number(_))&&(h=y+"."+_),!($.indexOf(h)>-1)){if(typeof n[_]=="object"&&n[_]!==null)isNaN(Number(_))&&f.push({name:h,type:Array.isArray(n[_])?"array":"object",require:"1",remark:"",value:""}),n[_]&&g(n[_],h,k+1);else{const w=typeof n[_];f.push({name:h,type:w==="boolean"?"boolean":w==="number"?"number":"string",require:"1",remark:"",value:n[_]})}$.push(h)}})};try{if(g(p),f&&f.length>0){f=(k=>{const r=new Map;return k.filter(_=>{const h=_.name;return r.has(h)?!1:(r.set(h,!0),!0)})})(f);let y=`| 参数 | 类型 | 描述 |
`;return y+=`| :------- | :------- | :------- |
`,f.forEach(k=>{y+=`| ${k.name} | ${k.type} | |
`}),y}else return`| 参数 | 类型 | 描述 |
| :------- | :------- | :------- |
`}catch(n){return console.error("JSON 解析错误:",n),`| 参数 | 类型 | 描述 |
| :------- | :------- | :------- |
`}};return oe(()=>{o.value=!0}),(p,f)=>(C(),B(de,{show:o.value,title:p.$t("page.json_to_table"),width:"700px",onClose:u},{footer:m(()=>[s(K,{onClick:u},{default:m(()=>[O(i(p.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:v},{default:m(()=>[O(i(p.$t("common.confirm")),1)]),_:1})]),default:m(()=>[e("div",aw,[e("div",ow,i(p.$t("page.json_to_table_description")),1),s(tt,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=$=>l.value=$),placeholder:p.$t("page.json_content_placeholder"),rows:10},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const lw=Y(sw,[["__scopeId","data-v-3809aba7"]]);function nw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(lw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var u;(u=c.onInsert)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const iw={class:"json-beautify"},rw=W({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),u=()=>{t.onClose()},v=()=>{try{const d=JSON.parse(l.value),p=JSON.stringify(d,null,2);t.onInsert(`\`\`\`json
${p}
\`\`\``)}catch{G(a("page.invalid_json"))}};return oe(()=>{o.value=!0}),(d,p)=>(C(),B(de,{show:o.value,title:d.$t("page.beautify_json"),width:"600px",onClose:u},{footer:m(()=>[s(K,{onClick:u},{default:m(()=>[O(i(d.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:v},{default:m(()=>[O(i(d.$t("common.confirm")),1)]),_:1})]),default:m(()=>[e("div",iw,[s(tt,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=f=>l.value=f),label:d.$t("page.json_content"),placeholder:d.$t("page.json_content_placeholder"),rows:8},null,8,["modelValue","label","placeholder"])])]),_:1},8,["show","title"]))}});const cw=Y(rw,[["__scopeId","data-v-a4424b8f"]]);function dw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(cw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var u;(u=c.onInsert)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const uw={class:"paste-table"},mw=W({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c;te();const a=b(!1),o=b(""),l=()=>{t.onClose()},u=()=>{const v=o.value.trim().split(`
`);if(v.length===0)return;const d=v.map($=>$.split("	")),p=Math.max(...d.map($=>$.length));let f="| "+d[0].map($=>$.trim()).join(" | ")+` |
`;f+="| "+Array(p).fill("---").join(" | ")+` |
`,d.slice(1).forEach($=>{const g=Array(p).fill("").map((n,y)=>($[y]||"").trim());f+="| "+g.join(" | ")+` |
`}),t.onInsert(f)};return oe(()=>{a.value=!0}),(v,d)=>(C(),B(de,{show:a.value,title:v.$t("page.paste_insert_table"),width:"600px",onClose:l},{footer:m(()=>[s(K,{onClick:l},{default:m(()=>[O(i(v.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:u},{default:m(()=>[O(i(v.$t("common.confirm")),1)]),_:1})]),default:m(()=>[e("div",uw,[s(tt,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=p=>o.value=p),label:v.$t("page.table_content"),placeholder:v.$t("page.table_content_placeholder"),rows:8},null,8,["modelValue","label","placeholder"])])]),_:1},8,["show","title"]))}});const _w=Y(mw,[["__scopeId","data-v-a519bf5b"]]);function pw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(_w,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var u;(u=c.onInsert)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const fw={class:"sql-to-markdown"},vw={class:"description"},hw=W({__name:"index",props:{onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),u=b(!1),v=()=>{t.onClose()},d=async()=>{if(!l.value.trim()){await G(a("common.required"));return}u.value=!0;try{const p=await X("/api/page/sqlToMarkdownTable",{sql:l.value},"post",!1);p.error_code===0&&p.data&&p.data.markdown?(t.onInsert(p.data.markdown),t.onClose(),ie.success(a("common.op_success"))):await G(p.error_message||a("common.op_failed"))}catch(p){console.error("SQL 转换失败:",p),await G(a("common.op_failed"))}finally{u.value=!1}};return oe(()=>{o.value=!0}),(p,f)=>(C(),B(de,{show:o.value,title:p.$t("page.sql_to_markdown_table"),width:"700px",onClose:v},{footer:m(()=>[s(K,{onClick:v},{default:m(()=>[O(i(p.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",loading:u.value,onClick:d},{default:m(()=>[O(i(p.$t("common.confirm")),1)]),_:1},8,["loading"])]),default:m(()=>[e("div",fw,[e("div",vw,i(p.$t("page.sql_to_markdown_table_description")),1),s(tt,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=$=>l.value=$),placeholder:p.$t("page.sql_content_placeholder"),rows:10},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const gw=Y(hw,[["__scopeId","data-v-9d196cec"]]);function yw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(gw,{onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t("")},onInsert:l=>{var u;(u=c.onInsert)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const ww={class:"mock-config"},bw={class:"mock-response-section"},$w={class:"section-label"},kw={class:"section-tips"},Cw={class:"mock-url-section"},xw={class:"section-label"},Iw={class:"url-container"},Sw={class:"mock-url-prefix"},Tw=["title"],Mw={key:0,class:"full-mock-url"},Lw={class:"action-buttons"},Vw={href:"https://www.showdoc.com.cn/p/d952ed6b7b5fb454df13dce74d1b41f8",target:"_blank",class:"help-link"},zw=W({__name:"index",props:{pageId:{},itemId:{},onClose:{type:Function}},setup(c){const t=c,{t:a}=te();Ge();const o=b(!1),l=b({content:"",path:"/"}),u=b(""),v=q(()=>l.value.path?u.value+l.value.path:""),d=()=>{t.onClose()},p=async()=>{try{const y=await X("/api/mock/add",{page_id:t.pageId,template:l.value.content,path:l.value.path},"post",!1);y.error_code===0?(ie.success(a("page.save_success")),t.onClose()):await G(y.error_message||a("page.save_failed"))}catch(y){console.error("保存 Mock 配置失败:",y),await G(a("page.save_failed"))}},f=async()=>{v.value&&await Ht(v.value)&&ie.success(a("common.copy_success"))},$=()=>{try{const y=l.value.content.trim();if(!y){ie.warning(a("page.please_input_content"));return}const k=JSON.parse(y);l.value.content=JSON.stringify(k,null,2),ie.success(a("page.beautify_success"))}catch{G(a("page.json_format_error"))}},g=async()=>{if(t.pageId<=0){ie.warning(a("page.please_save_page_first")),t.onClose();return}try{const y=await X("/api/mock/infoByPageId",{page_id:t.pageId},"post",!1);y.error_code===0&&y.data&&y.data.unique_key&&y.data.template&&(l.value.content=n(y.data.template),l.value.path=y.data.path||"/")}catch(y){console.error("获取 Mock 配置失败:",y)}},n=y=>y?y.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'"):"";return oe(()=>{o.value=!0;const y=window.location.protocol+"//"+window.location.host;u.value=`${y}${ot()}mock-path/${t.itemId}?path=`,g()}),(y,k)=>(C(),B(de,{show:o.value,title:y.$t("page.mock_config"),width:"900px",onClose:d},{footer:m(()=>[s(K,{onClick:d},{default:m(()=>[O(i(y.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:p},{default:m(()=>[O(i(y.$t("common.save")),1)]),_:1})]),default:m(()=>[e("div",ww,[e("div",bw,[e("label",$w,i(y.$t("page.mock_response")),1),e("p",kw,i(y.$t("page.mock_response_tips")),1),s(tt,{modelValue:l.value.content,"onUpdate:modelValue":k[0]||(k[0]=r=>l.value.content=r),placeholder:y.$t("page.mock_response_placeholder"),rows:15,class:"mock-textarea"},null,8,["modelValue","placeholder"])]),e("div",Cw,[e("label",xw,i(y.$t("page.mock_url_and_path")),1),e("div",Iw,[e("code",Sw,i(u.value),1),s(ne,{modelValue:l.value.path,"onUpdate:modelValue":k[1]||(k[1]=r=>l.value.path=r),class:"path-input",placeholder:"/path"},null,8,["modelValue"]),e("i",{class:"fas fa-copy copy-icon",onClick:f,title:y.$t("common.copy")},null,8,Tw)]),v.value?(C(),L("code",Mw,i(v.value),1)):F("",!0)]),e("div",Lw,[s(K,{text:y.$t("page.beautify_json"),"left-icon":["fas","fa-th"],onClick:$},null,8,["text"]),e("a",Vw,[k[2]||(k[2]=e("i",{class:"fas fa-question-circle"},null,-1)),O(" "+i(y.$t("page.help_document")),1)])])])]),_:1},8,["show","title"]))}});const Uw=Y(zw,[["__scopeId","data-v-09d8a72e"]]);function Pw(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Uw,{pageId:c.pageId||0,itemId:c.itemId||0,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(!1)}});a.mount(o)})}const Aw={class:"history-modal"},Dw=W({__name:"index",props:{pageId:{},onRestore:{},onClose:{},allowRecover:{type:Boolean,default:!0},allowEdit:{type:Boolean,default:!0}},setup(c){const{t}=te(),a=xe(),o=c,l=b(!0),u=b(!1),v=b([]),d=b({current:1,pageSize:20,total:0}),p=q(()=>[{title:t("page.update_time"),key:"addtime",width:170},{title:t("page.update_by_who"),key:"author_username",width:120},{title:t("page.remark"),key:"page_comments",width:300},{title:t("page.operation"),key:"actions",width:200}]),f=async()=>{u.value=!0;try{const r=await X("/api/page/history",{page_id:o.pageId},"post",!1);r.error_code===0&&r.data?(v.value=r.data,d.value.total=r.data.length):await G(r.error_message||t("common.fetch_failed"))}catch(r){console.error("获取历史版本失败:",r),await G(t("common.fetch_failed"))}finally{u.value=!1}},$=r=>{d.value.current=r},g=r=>{const _=r.page_history_id,h=a.resolve({path:`/page/diff/${o.pageId}/${_}`});window.open(h.href,"_blank")},n=async r=>{if(await Se({title:t("page.recover_to_this_version"),msg:t("page.confirm_recover_version")}))try{const h=Zt(r.page_content);if(o.onRestore){o.onRestore(h),ie.success(t("common.op_success")),k();return}const w=await X("/api/page/save",{page_id:o.pageId,page_content:r.page_content,is_urlencode:1},"post",!1);w.error_code===0?(ie.success(t("common.op_success")),k()):await G(w.error_message||t("common.op_failed"))}catch(h){console.error("恢复版本失败:",h),await G(t("common.op_failed"))}},y=async r=>{const _=await it(t("page.edit_remark"),r.page_comments||"",t("page.remark"));if(!(_===null||_===r.page_comments))try{const h=await X("/api/page/updateHistoryComments",{page_id:o.pageId,page_history_id:r.page_history_id,page_comments:_},"post",!1);h.error_code===0?(ie.success(t("common.save_success")),f()):await G(h.error_message||t("common.save_failed"))}catch(h){console.error("更新备注失败:",h),await G(t("common.save_failed"))}},k=()=>{l.value=!1,setTimeout(()=>{o.onClose()},300)};return oe(()=>{f()}),(r,_)=>{const h=H("a-button");return C(),B(de,{show:l.value,title:r.$t("page.page_history_version"),onClose:k,width:"900px"},{default:m(()=>[e("div",Aw,[s(Le,{tableHeader:p.value,tableData:v.value,loading:u.value,pagination:d.value,onPageChange:$,rowKey:"page_history_id"},{"cell-page_comments":m(({row:w})=>[e("span",null,i(w.page_comments||"-"),1),c.allowEdit?(C(),B(h,{key:0,type:"link",size:"small",onClick:T=>y(w)},{default:m(()=>[O(i(r.$t("page.edit")),1)]),_:1},8,["onClick"])):F("",!0)]),"cell-actions":m(({row:w})=>[s(h,{type:"link",size:"small",onClick:T=>g(w)},{default:m(()=>[O(i(r.$t("page.overview")),1)]),_:1},8,["onClick"]),c.allowRecover?(C(),B(h,{key:0,type:"link",size:"small",danger:"",onClick:T=>n(w)},{default:m(()=>[O(i(r.$t("page.recover_to_this_version")),1)]),_:1},8,["onClick"])):F("",!0)]),_:1},8,["tableHeader","tableData","loading","pagination"])])]),_:1},8,["show","title"])}}});const Ow=Y(Dw,[["__scopeId","data-v-f1e3fe2b"]]);function Lt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Ow,{pageId:c.pageId,allowRecover:c.allowRecover??!0,allowEdit:c.allowEdit??!0,onRestore:l=>{var u;(u=c.onRestore)==null||u.call(c,l),me(a,o),t(!0)},onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(!1)}});a.mount(o)})}const Nw={class:"filehub-upload-modal"},Fw={style:{"text-align":"center"}},qw={class:"upload-content"},Rw={class:"upload-text"},Hw=["innerHTML"],Ew={class:"batch-upload-support"},jw={key:0,style:{"margin-top":"15px"}},Bw={style:{"margin-bottom":"10px","font-weight":"bold"}},Gw={class:"upload-queue"},Kw={class:"file-info"},Jw={class:"file-name"},Ww={class:"file-size"},Yw={class:"status-info"},Xw={key:0,class:"status waiting"},Qw={key:1,class:"status uploading"},Zw={key:2,class:"status success"},eb={key:3,class:"status error"},tb={key:0,style:{"margin-top":"15px","text-align":"center"}},ab={key:1,style:{"margin-top":"15px"}},ob={style:{"margin-bottom":"8px","font-size":"14px"}},sb=W({__name:"index",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=b([]),v=b(!1),d=b(0),p=b(0),f=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=x=>(u.value.find(S=>S.file.name===x.name&&S.file.size===x.size)||(u.value.push({file:x,status:"waiting",error:""}),v.value||setTimeout(()=>{y()},100)),!1),n=()=>{},y=()=>{if(u.value.length!==0){if(v.value){p.value=u.value.filter(x=>x.status==="waiting"||x.status==="uploading"||x.status==="success").length;return}v.value=!0,d.value=0,p.value=u.value.filter(x=>x.status==="waiting").length,f.value=0,k()}},k=()=>{for(;f.value<u.value.length;){const S=u.value[f.value];if(S.status==="waiting"){S.status="uploading",r(S.file);return}f.value++}v.value=!1;const x=u.value.filter(S=>S.status==="success").length,I=u.value.filter(S=>S.status==="error").length;I===0?(j.success(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}`),setTimeout(()=>{T(),h()},1500)):j.warning(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}，${t("page.upload_failed_count",{count:I})}`)},r=async x=>{const I=new FormData;I.append("file",x);try{const S=await X("/api/page/upload",I,"post",!0),M=u.value[f.value];M&&(S.success===1?M.status="success":(M.status="error",M.error=S.error_message||t("page.upload_failed")),d.value++),k()}catch(S){console.error("上传文件失败:",S);const M=u.value[f.value];M&&(M.status="error",M.error=t("page.upload_failed"),d.value++),k()}},_=()=>{u.value=[],l.value=[]},h=()=>{_(),v.value=!1,d.value=0,p.value=0,f.value=0},w=x=>{if(x===0)return"0 B";const I=1024,S=["B","KB","MB","GB"],M=Math.floor(Math.log(x)/Math.log(I));return parseFloat((x/Math.pow(I,M)).toFixed(2))+" "+S[M]},T=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return setTimeout(()=>{o.value=!0},0),(x,I)=>{const S=H("a-upload"),M=H("a-progress");return C(),L("div",Nw,[s(de,{class:re({show:o.value}),title:x.$t("common.upload"),width:"600px",showOk:!1,showCancel:!1,onClose:T},{default:m(()=>[e("div",Fw,[s(S,{"file-list":l.value,"before-upload":g,multiple:!0,"show-upload-list":!1,"custom-request":n,class:"upload-area"},{default:m(()=>[e("div",qw,[I[0]||(I[0]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",Rw,[e("span",{class:"tips-text",innerHTML:x.$t("page.import_file_tips2")},null,8,Hw),e("div",Ew,i(x.$t("page.batch_upload_support")),1)])])]),_:1},8,["file-list"]),u.value.length>0?(C(),L("div",jw,[e("div",Bw,i(x.$t("page.upload_queue_files",{count:u.value.length}))+": ",1),e("div",Gw,[(C(!0),L(Ce,null,Pe(u.value,(V,U)=>(C(),L("div",{key:U,class:re(["queue-item",{uploading:V.status==="uploading",success:V.status==="success",error:V.status==="error"}])},[e("div",Kw,[I[1]||(I[1]=e("i",{class:"fas fa-file"},null,-1)),e("span",Jw,i(V.file.name),1),e("span",Ww,"("+i(w(V.file.size))+")",1)]),e("div",Yw,[V.status==="waiting"?(C(),L("span",Xw,i(x.$t("page.file_waiting")),1)):V.status==="uploading"?(C(),L("span",Qw,[I[2]||(I[2]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(x.$t("page.file_uploading")),1)])):V.status==="success"?(C(),L("span",Zw,[I[3]||(I[3]=e("i",{class:"fas fa-check"},null,-1)),e("span",null,i(x.$t("page.file_upload_success")),1)])):V.status==="error"?(C(),L("span",eb,[I[4]||(I[4]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(x.$t("page.file_upload_failed"))+": "+i(V.error),1)])):F("",!0)])],2))),128))]),u.value.length>0&&!v.value?(C(),L("div",tb,[s(K,{onClick:_},{default:m(()=>[O(i(x.$t("page.clear_queue")),1)]),_:1})])):F("",!0),v.value?(C(),L("div",ab,[e("div",ob,i(x.$t("page.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(M,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const lb=Y(sb,[["__scopeId","data-v-6cdb8a17"]]);function nb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(lb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const ib={class:"filehub-modal"},rb={class:"search-bar"},cb={class:"search-item"},db={class:"search-item"},ub={class:"search-item"},mb={class:"search-item"},_b={class:"info-bar"},pb={class:"tools"},fb=["onClick"],vb=["onClick"],hb=["onClick"],gb=W({__name:"index",props:{itemId:{},pageId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b(""),v=b("-1"),d=q(()=>[{label:t("attachment.all_attachment_type"),value:"-1"},{label:t("attachment.image"),value:"1"},{label:t("attachment.general_attachment"),value:"2"}]),p=b(0),f=b(0),$=b(!1),g=b([]),n=b({current:1,pageSize:5,total:0}),y=q(()=>[{title:t("attachment.file_id"),key:"file_id",width:60},{title:t("attachment.display_name"),key:"display_name",width:180},{title:t("attachment.file_type"),key:"file_type",width:120},{title:t("attachment.file_size_m"),key:"file_size_m",width:80},{title:t("attachment.visit_times"),key:"visit_times",width:70},{title:t("attachment.add_time"),key:"addtime",width:120},{title:t("common.operation"),key:"tools",width:150,tools:!0}]),k=async()=>{l.value=!0;try{const S=await X("/api/attachment/getMyList",{page:n.value.current,count:n.value.pageSize,attachment_type:v.value,display_name:u.value},"post",!1);S.error_code===0&&S.data&&(g.value=S.data.list||[],n.value.total=S.data.total||0,p.value=S.data.used_m||0,f.value=S.data.used_flow_m||0)}catch(S){console.error("获取文件库列表失败:",S),j.error(t("attachment.fetch_list_failed"))}finally{l.value=!1}},r=()=>{n.value.current=1,k()},_=S=>{n.value.current=S,k()},h=async S=>{try{const M=await X("/api/attachment/bindingPage",{file_id:S.file_id,page_id:a.pageId},"post",!1);M.error_code===0?(j.success(t("page.bind_success")),I()):j.error(M.error_message||t("page.bind_failed"))}catch(M){console.error("绑定文件失败:",M),j.error(t("page.bind_failed"))}},w=S=>{S.url&&window.open(S.url,"_blank")},T=async S=>{try{await Se({msg:t("attachment.confirm_delete"),title:t("common.tips")});const M=await X("/api/attachment/deleteMyAttachment",{file_id:S.file_id},"post",!1);M.error_code===0?(j.success(t("common.op_success")),k()):j.error(M.error_message||t("common.op_failed"))}catch{}},x=()=>{$.value=!1,k()},I=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return oe(()=>{setTimeout(()=>{o.value=!0}),k()}),(S,M)=>(C(),L("div",ib,[s(de,{class:re({show:o.value}),title:S.$t("page.filehub"),width:"900px",onClose:I},{default:m(()=>[e("div",rb,[e("div",cb,[s(ne,{modelValue:u.value,"onUpdate:modelValue":M[0]||(M[0]=V=>u.value=V),placeholder:S.$t("attachment.display_name"),onKeyup:Fe(r,["enter"])},null,8,["modelValue","placeholder"])]),e("div",db,[s(Re,{value:v.value,"onUpdate:value":M[1]||(M[1]=V=>v.value=V),options:d.value,style:{width:"120px"},onChange:r},null,8,["value","options"])]),e("div",ub,[s(K,{onClick:r},{default:m(()=>[O(i(S.$t("common.search")),1)]),_:1})]),e("div",mb,[s(K,{type:"primary",onClick:M[2]||(M[2]=V=>$.value=!0)},{default:m(()=>[O(i(S.$t("common.upload")),1)]),_:1})])]),e("div",_b,[e("span",null,i(S.$t("attachment.accumulated_used_space"))+" "+i(p.value)+"M , "+i(S.$t("attachment.month_flow"))+" "+i(f.value)+"M ",1)]),s(Le,{tableHeader:y.value,tableData:g.value,pagination:n.value,loading:l.value,maxHeight:"400px",onPageChange:_},{"cell-tools":m(({row:V})=>[e("div",pb,[e("span",{class:"tools-item clickable",onClick:U=>h(V)},i(S.$t("page.select")),9,fb),e("span",{class:"tools-item clickable",onClick:U=>w(V)},i(S.$t("attachment.visit")),9,vb),e("span",{class:"tools-item clickable",onClick:U=>T(V)},i(S.$t("common.delete")),9,hb)])]),_:1},8,["tableHeader","tableData","pagination","loading"])]),_:1},8,["class","title"]),$.value?(C(),B(z(nb),{key:0,callback:x})):F("",!0)]))}});const yb=Y(gb,[["__scopeId","data-v-accacfb4"]]);function wb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(yb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const bb={class:"page-upload-modal"},$b={style:{"text-align":"center"}},kb={class:"upload-content"},Cb={class:"upload-text"},xb=["innerHTML"],Ib={class:"batch-upload-support"},Sb={key:0,style:{"margin-top":"15px"}},Tb={style:{"margin-bottom":"10px","font-weight":"bold"}},Mb={class:"upload-queue"},Lb={class:"file-info"},Vb={class:"file-name"},zb={class:"file-size"},Ub={class:"status-info"},Pb={key:0,class:"status waiting"},Ab={key:1,class:"status uploading"},Db={key:2,class:"status success"},Ob=["href"],Nb={key:1},Fb={key:3,class:"status error"},qb={key:0,style:{"margin-top":"15px","text-align":"center"}},Rb={key:1,style:{"margin-top":"15px"}},Hb={style:{"margin-bottom":"8px","font-size":"14px"}},Eb=W({__name:"index",props:{itemId:{},pageId:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=b([]),v=b(!1),d=b(0),p=b(0),f=b(0),$=q(()=>p.value===0?0:Math.round(d.value/p.value*100)),g=x=>(u.value.find(S=>S.file.name===x.name&&S.file.size===x.size)||(u.value.push({file:x,status:"waiting",error:""}),v.value||setTimeout(()=>{y()},100)),!1),n=()=>{},y=()=>{if(u.value.length!==0){if(v.value){p.value=u.value.filter(x=>x.status==="waiting"||x.status==="uploading"||x.status==="success").length;return}v.value=!0,d.value=0,p.value=u.value.filter(x=>x.status==="waiting").length,f.value=0,k()}},k=()=>{for(;f.value<u.value.length;){const S=u.value[f.value];if(S.status==="waiting"){S.status="uploading",r(S.file);return}f.value++}v.value=!1;const x=u.value.filter(S=>S.status==="success").length,I=u.value.filter(S=>S.status==="error").length;I===0?(j.success(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}`),setTimeout(()=>{T(),h()},1500)):j.warning(`${t("page.batch_upload_complete")}！${t("page.upload_success_count",{count:x})}，${t("page.upload_failed_count",{count:I})}`)},r=async x=>{const I=new FormData;I.append("file",x),I.append("page_id",String(a.pageId)),I.append("item_id",String(a.itemId));try{const S=await X("/api/page/upload",I,"post",!1),M=u.value[f.value];M&&(S.success===1?(M.status="success",M.url=S.url):(M.status="error",M.error=S.message||S.error_message||t("page.upload_failed")),d.value++),k()}catch(S){console.error("上传文件失败:",S);const M=u.value[f.value];M&&(M.status="error",M.error=t("page.upload_failed"),d.value++),k()}},_=()=>{u.value=[],l.value=[]},h=()=>{_(),v.value=!1,d.value=0,p.value=0,f.value=0},w=x=>{if(x===0)return"0 B";const I=1024,S=["B","KB","MB","GB"],M=Math.floor(Math.log(x)/Math.log(I));return parseFloat((x/Math.pow(I,M)).toFixed(2))+" "+S[M]},T=()=>{o.value=!1,setTimeout(()=>{a.callback()},300)};return setTimeout(()=>{o.value=!0},0),(x,I)=>{const S=H("a-upload"),M=H("a-progress");return C(),L("div",bb,[s(de,{class:re({show:o.value}),title:x.$t("common.upload"),width:"600px",showOk:!1,showCancel:!1,onClose:T},{default:m(()=>[e("div",$b,[s(S,{"file-list":l.value,"before-upload":g,multiple:!0,"show-upload-list":!1,"custom-request":n,class:"upload-area"},{default:m(()=>[e("div",kb,[I[0]||(I[0]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),e("div",Cb,[e("span",{class:"tips-text",innerHTML:x.$t("page.import_file_tips2")},null,8,xb),e("div",Ib,i(x.$t("page.batch_upload_support")),1)])])]),_:1},8,["file-list"]),u.value.length>0?(C(),L("div",Sb,[e("div",Tb,i(x.$t("page.upload_queue_files",{count:u.value.length}))+": ",1),e("div",Mb,[(C(!0),L(Ce,null,Pe(u.value,(V,U)=>(C(),L("div",{key:U,class:re(["queue-item",{uploading:V.status==="uploading",success:V.status==="success",error:V.status==="error"}])},[e("div",Lb,[I[1]||(I[1]=e("i",{class:"fas fa-file"},null,-1)),e("span",Vb,i(V.file.name),1),e("span",zb,"("+i(w(V.file.size))+")",1)]),e("div",Ub,[V.status==="waiting"?(C(),L("span",Pb,i(x.$t("page.file_waiting")),1)):V.status==="uploading"?(C(),L("span",Ab,[I[2]||(I[2]=e("i",{class:"fas fa-spinner fa-spin"},null,-1)),O(" "+i(x.$t("page.file_uploading")),1)])):V.status==="success"?(C(),L("span",Db,[I[3]||(I[3]=e("i",{class:"fas fa-check"},null,-1)),V.url?(C(),L("a",{key:0,href:V.url,target:"_blank",class:"upload-success-link"},i(x.$t("page.file_upload_success")),9,Ob)):(C(),L("span",Nb,i(x.$t("page.file_upload_success")),1))])):V.status==="error"?(C(),L("span",Fb,[I[4]||(I[4]=e("i",{class:"fas fa-times"},null,-1)),O(" "+i(x.$t("page.file_upload_failed"))+": "+i(V.error),1)])):F("",!0)])],2))),128))]),u.value.length>0&&!v.value?(C(),L("div",qb,[s(K,{onClick:_},{default:m(()=>[O(i(x.$t("page.clear_queue")),1)]),_:1})])):F("",!0),v.value?(C(),L("div",Rb,[e("div",Hb,i(x.$t("page.upload_progress"))+": "+i(d.value)+"/"+i(p.value),1),s(M,{percent:$.value,status:$.value===100?"success":"active"},null,8,["percent","status"])])):F("",!0)])):F("",!0)])]),_:1},8,["class","title"])])}}});const jb=Y(Eb,[["__scopeId","data-v-4f4afca7"]]);function Bb(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(jb,{...c,callback:()=>{c.callback(),me(a,o),t()}});a.mount(o)})}const Gb={class:"page-attachment-modal"},Kb={key:0,class:"action-bar"},Jb={class:"tips"},Wb={class:"tools"},Yb=["onClick"],Xb=["onClick"],Qb=["onClick"],Zb={key:1,class:"empty-state"},e$=W({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean},onClose:{type:Function},onInsert:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(!1),u=b(!1),v=b(!1),d=b([]),p=q(()=>[{title:t("page.add_time"),key:"addtime",width:170},{title:t("page.file_name"),key:"display_name",minWidth:200},{title:t("common.operation"),key:"tools",width:180,tools:!0}]),f=async()=>{if(a.pageId){l.value=!0;try{const _=await X("/api/page/uploadList",{page_id:a.pageId},"post",!1);_.error_code===0&&_.data&&(d.value=_.data||[])}catch(_){console.error("获取页面附件列表失败:",_),j.error(t("page.fetch_attachments_failed"))}finally{l.value=!1}}},$=_=>{_.url&&window.open(_.url,"_blank")},g=_=>{const h=`[${_.display_name}](${_.url} "${_.display_name}")`;a.onInsert&&(a.onInsert(h),j.success(t("page.insert_success")))},n=async _=>{try{await Se({msg:t("common.confirm_delete"),title:t("common.tips")});const h=await X("/api/page/deleteUploadFile",{file_id:_.file_id,page_id:a.pageId},"post",!1);h.error_code===0?(j.success(t("common.delete_success")),f()):j.error(h.error_message||t("common.delete_failed"))}catch{}},y=()=>{u.value=!1,f()},k=()=>{v.value=!1,f()},r=_=>{o.value=!1,setTimeout(()=>{a.onClose()},300)};return oe(()=>{setTimeout(()=>{o.value=!0}),f()}),(_,h)=>(C(),L("div",Gb,[s(de,{class:re({show:o.value}),title:_.$t("page.attachments"),width:"900px",onClose:h[2]||(h[2]=w=>r())},{default:m(()=>[c.manage?(C(),L("div",Kb,[s(K,{onClick:h[0]||(h[0]=w=>u.value=!0)},{default:m(()=>[h[3]||(h[3]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(_.$t("page.from_filehub")),1)]),_:1}),s(K,{type:"primary",onClick:h[1]||(h[1]=w=>v.value=!0)},{default:m(()=>[h[4]||(h[4]=e("i",{class:"fas fa-cloud-upload-alt"},null,-1)),O(" "+i(_.$t("common.upload")),1)]),_:1}),e("small",Jb,i(_.$t("page.file_size_tips")),1)])):F("",!0),s(Le,{tableHeader:p.value,tableData:d.value,loading:l.value,maxHeight:"400px",pagination:null},{"cell-tools":m(({row:w})=>[e("div",Wb,[e("span",{class:"tools-item clickable",onClick:T=>$(w)},i(_.$t("common.download")),9,Yb),c.manage?(C(),L("span",{key:0,class:"tools-item clickable",onClick:T=>g(w)},i(_.$t("page.insert")),9,Xb)):F("",!0),c.manage?(C(),L("span",{key:1,class:"tools-item clickable",onClick:T=>n(w)},i(_.$t("common.delete")),9,Qb)):F("",!0)])]),_:1},8,["tableHeader","tableData","loading"]),!l.value&&d.value.length===0?(C(),L("div",Zb,[h[5]||(h[5]=e("i",{class:"fas fa-paperclip"},null,-1)),e("p",null,i(_.$t("page.no_attachments")),1)])):F("",!0)]),_:1},8,["class","title"]),u.value?(C(),B(z(wb),{key:0,itemId:c.itemId,pageId:c.pageId,callback:y},null,8,["itemId","pageId"])):F("",!0),v.value?(C(),B(z(Bb),{key:1,itemId:c.itemId,pageId:c.pageId,callback:k},null,8,["itemId","pageId"])):F("",!0)]))}});const t$=Y(e$,[["__scopeId","data-v-1bc9518f"]]);function Ba(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(t$,{...c,onClose:()=>{c.onClose(),me(a,o),t()}});a.mount(o)})}const a$={class:"template-select"},o$={class:"share-form"},s$={class:"form-label"},l$={class:"tips-text"},n$=W({__name:"index",props:{itemId:{},onClose:{type:Function},onInsert:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),u=b(!1),v=b(!1),d=b("my"),p=b([]),f=b([]),$=b(!1),g=b(!1),n=b([]),y=b(null),k=b([]),r=q(()=>[{text:a("page.my_template"),value:"my"},{text:a("page.item_template"),value:"item"}]),_=q(()=>[{title:a("page.save_time"),key:"addtime",width:170},{title:a("page.template_title"),key:"template_title"},{title:a("common.operation"),key:"action",width:300}]),h=q(()=>[{title:a("page.save_time"),key:"created_at",width:170},{title:a("page.sharer"),key:"username",width:120},{title:a("page.template_title"),key:"template_title"},{title:a("common.operation"),key:"action",width:150}]),w=D=>qa(D).format("YYYY-MM-DD HH:mm:ss"),T=(D,E)=>E.label.toLowerCase().includes(D.toLowerCase()),x=async()=>{u.value=!0;try{const D=await X("/api/template/getMyList",{},"post",!1);D.error_code===0&&D.data&&(p.value=D.data)}catch(D){console.error("获取我的模板失败:",D),await G(a("common.fetch_failed"))}finally{u.value=!1}},I=async()=>{v.value=!0;try{const D=await X("/api/template/getItemList",{item_id:t.itemId},"post",!1);D.error_code===0&&D.data&&(f.value=D.data)}catch(D){console.error("获取项目模板失败:",D),await G(a("common.fetch_failed"))}finally{v.value=!1}},S=async()=>{try{const D=await X("/api/item/myList",{},"post",!1);D.error_code===0&&D.data&&(k.value=D.data.map(E=>({label:E.item_name,value:E.item_id})))}catch(D){console.error("获取项目列表失败:",D)}},M=D=>{d.value=D},V=D=>{t.onInsert(D.template_content),P()},U=async D=>{if(await Se({msg:`${a("common.confirm_delete")}「${D.template_title}」?`,title:a("common.tips"),confirmText:a("common.confirm"),cancelText:a("common.cancel")}))try{const ae=await X("/api/template/delete",{id:D.id},"post",!1);ae.error_code===0?(ie.success(a("common.delete_success")),x(),I()):await G(ae.error_message||a("common.delete_failed"))}catch(ae){console.error("删除模板失败:",ae),await G(a("common.delete_failed"))}},N=D=>{y.value=D,n.value=[],D.share_item_count>0&&D.share_item&&(n.value=D.share_item.map(E=>E.item_id)),S(),$.value=!0},A=async()=>{if(y.value){g.value=!0;try{const D=await X("/api/template/shareToItem",{template_id:y.value.id,item_id:n.value.join(",")},"post",!1);D.error_code===0?(ie.success(a("common.save_success")),$.value=!1,x(),I()):await G(D.error_message||a("common.save_failed"))}catch(D){console.error("共享模板失败:",D),await G(a("common.save_failed"))}finally{g.value=!1}}},P=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return oe(()=>{o.value=!0,x(),I()}),(D,E)=>{const ae=H("a-spin"),ge=H("a-select");return C(),L(Ce,null,[s(de,{show:o.value,title:D.$t("page.template_list"),width:"900px",onClose:P},{footer:m(()=>[s(K,{text:D.$t("common.close"),onClick:P},null,8,["text"])]),default:m(()=>[e("div",a$,[s(ae,{spinning:l.value},{default:m(()=>[s(vt,{items:r.value,value:d.value,type:"card",onUpdateValue:M},{my:m(()=>[s(Le,{tableHeader:_.value,tableData:p.value,loading:u.value,maxHeight:"400px",emptyText:()=>D.$t("page.no_my_template_text")},{"cell-addtime":m(({row:fe})=>[O(i(w(fe.addtime)),1)]),"cell-action":m(({row:fe})=>[s(K,{text:D.$t("page.insert_template"),type:"link",bold:!1,onClick:ee=>V(fe)},null,8,["text","onClick"]),s(K,{text:`${D.$t("page.share_to_items")} (${fe.share_item_count||0})`,type:"link",bold:!1,onClick:ee=>N(fe)},null,8,["text","onClick"]),s(K,{text:D.$t("common.delete"),type:"link",danger:"",bold:!1,onClick:ee=>U(fe)},null,8,["text","onClick"])]),_:1},8,["tableHeader","tableData","loading","emptyText"])]),item:m(()=>[s(Le,{tableHeader:h.value,tableData:f.value,loading:v.value,maxHeight:"400px",emptyText:()=>D.$t("page.no_item_template_text")},{"cell-created_at":m(({row:fe})=>[O(i(w(fe.created_at)),1)]),"cell-action":m(({row:fe})=>[s(K,{text:D.$t("page.insert_template"),type:"link",bold:!1,onClick:ee=>V(fe)},null,8,["text","onClick"])]),_:1},8,["tableHeader","tableData","loading","emptyText"])]),_:1},8,["items","value"])]),_:1},8,["spinning"])])]),_:1},8,["show","title"]),$.value?(C(),B(de,{key:0,title:D.$t("page.share_template_to_items"),width:"500px",onClose:E[2]||(E[2]=fe=>$.value=!1)},{footer:m(()=>[s(K,{text:D.$t("common.cancel"),onClick:E[1]||(E[1]=fe=>$.value=!1)},null,8,["text"]),s(K,{text:D.$t("common.confirm"),theme:"dark",spinning:g.value,onClick:A},null,8,["text","spinning"])]),default:m(()=>[e("div",o$,[e("label",s$,i(D.$t("page.select_items_to_share")),1),s(ge,{value:n.value,"onUpdate:value":E[0]||(E[0]=fe=>n.value=fe),mode:"multiple",placeholder:D.$t("common.please_choose"),options:k.value,"filter-option":T,"show-search":"",style:{width:"100%"}},null,8,["value","placeholder","options"]),e("div",l$,i(D.$t("page.share_items_tips")),1)])]),_:1},8,["title"])):F("",!0)],64)}}});const i$=Y(n$,[["__scopeId","data-v-64be65c6"]]);function pa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(i$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const r$={class:"save-template-modal"},c$={class:"form-item"},d$={class:"form-label"},u$={class:"label-text"},m$={class:"input-counter"},_$={class:"form-item"},p$={class:"form-label"},f$={class:"label-text"},v$={class:"content-preview"},h$=["value"],g$={class:"input-counter"},y$={class:"form-item"},w$={class:"form-label"},b$={class:"label-text"},$$={class:"share-option"},k$={class:"tips-text"},C$={key:0,class:"form-item"},x$={class:"form-label"},I$={class:"label-text"},S$={class:"item-selector"},T$=["onClick"],M$={class:"item-label"},L$={key:0,class:"empty-tip"},V$=W({__name:"index",props:{content:{},onSuccess:{type:Function},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(!1),u=b({title:"",shareToItem:"0",shareItemIds:[]}),v=b([]),d=n=>u.value.shareItemIds.includes(n),p=async()=>{try{const n=await X("/api/item/myList",{},"post",!1);n.error_code===0&&n.data&&(v.value=n.data.map(y=>({label:y.item_name,value:y.item_id})))}catch(n){console.error("获取项目列表失败:",n)}},f=n=>{const y=u.value.shareItemIds.indexOf(n);y>-1?u.value.shareItemIds.splice(y,1):u.value.shareItemIds.push(n)},$=async()=>{var n;if(!u.value.title.trim()){await G(a("page.template_title_required"));return}l.value=!0;try{const y=await X("/api/template/save",{template_title:u.value.title,template_content:t.content},"post",!1);y.error_code===0?(ie.success(a("page.save_template_success")),u.value.shareToItem==="1"&&u.value.shareItemIds.length>0&&((n=y.data)!=null&&n.id)&&await X("/api/template/shareToItem",{template_id:y.data.id,item_id:u.value.shareItemIds.join(",")},"post",!1),t.onSuccess&&t.onSuccess(),g()):await G(y.error_message||a("common.save_failed"))}catch(y){console.error("保存模板失败:",y),await G(a("common.save_failed"))}finally{l.value=!1}},g=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return oe(()=>{o.value=!0,p()}),(n,y)=>(C(),B(de,{show:o.value,title:n.$t("page.save_to_template"),height:"600px",onClose:g},{footer:m(()=>[s(K,{onClick:g},{default:m(()=>[O(i(n.$t("common.cancel")),1)]),_:1}),s(K,{type:"primary",onClick:$,loading:l.value},{default:m(()=>[O(i(n.$t("common.save")),1)]),_:1},8,["loading"])]),default:m(()=>[e("div",r$,[e("div",c$,[e("div",d$,[e("span",u$,i(n.$t("page.template_title")),1),y[2]||(y[2]=e("span",{class:"label-required"},"*",-1))]),s(ne,{modelValue:u.value.title,"onUpdate:modelValue":y[0]||(y[0]=k=>u.value.title=k),placeholder:n.$t("page.input_template_title"),maxlength:100},null,8,["modelValue","placeholder"]),e("div",m$,i(u.value.title.length)+"/100",1)]),e("div",_$,[e("div",p$,[e("span",f$,i(n.$t("page.template_content_preview")),1)]),e("div",v$,[e("textarea",{value:c.content,rows:10,readonly:"",class:"readonly-textarea"},null,8,h$)]),e("div",g$,i(c.content.length),1)]),e("div",y$,[e("div",w$,[e("span",b$,i(n.$t("page.share_template")),1)]),e("div",$$,[s(Je,{modelValue:u.value.shareToItem,"onUpdate:modelValue":y[1]||(y[1]=k=>u.value.shareToItem=k)},null,8,["modelValue"]),e("div",k$,i(n.$t("page.share_template_tips")),1)])]),u.value.shareToItem==="1"?(C(),L("div",C$,[e("div",x$,[e("span",I$,i(n.$t("page.share_to_items")),1)]),e("div",S$,[(C(!0),L(Ce,null,Pe(v.value,k=>(C(),L("div",{key:k.value,class:"item-checkbox",onClick:r=>f(k.value)},[e("i",{class:re([d(k.value)?"fas fa-check-square":"fas fa-square","checkbox-icon"])},null,2),e("span",M$,i(k.label),1)],8,T$))),128)),v.value.length===0?(C(),L("div",L$,i(n.$t("page.no_items_to_share")),1)):F("",!0)])])):F("",!0)])]),_:1},8,["show","title"]))}});const z$=Y(V$,[["__scopeId","data-v-9543405c"]]);function U$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(z$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const P$={class:"ai-modal"},A$={class:"section-header"},D$={class:"action-bar"},O$={class:"section-header"},N$=W({__name:"index",props:{pageId:{},itemId:{},itemName:{},onInsert:{type:Function},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b(""),u=b(""),v=b(!1),d=q(()=>[{icon:["fas","fa-copy"],text:a("common.copy"),size:"small",onClick:f,disabled:!u.value||!u.value.trim()}]),p=async()=>{var y;if(!(!l.value.trim()||v.value)){u.value="",v.value=!0;try{const k={content:l.value},r=Qt();r&&r.user_token&&(k.user_token=r.user_token);const _=ot()+"/api/ai/create",h=await fetch(_,{method:"POST",body:new URLSearchParams(k),headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!h.ok)throw new Error("AI 生成失败");const w=(y=h.body)==null?void 0:y.getReader(),T=new TextDecoder("utf-8");let x="";if(w){const I=async()=>{const{value:S,done:M}=await w.read();if(M)v.value=!1;else{const U=T.decode(S).trim().split("data: ");for(const N of U)if(N.trim()!=="")try{const A=JSON.parse(N.replace("data: ",""));if(A.choices&&A.choices[0]&&A.choices[0].delta&&A.choices[0].delta.content){const P=A.choices[0].delta.content;x+=P,u.value=x}if(A.choices&&A.choices[0]&&A.choices[0].finish_reason==="length")await I();else if(A.choices&&A.choices[0]&&A.choices[0].finish_reason==="stop"){u.value=x,v.value=!1;return}}catch{if(N.trim()==="[DONE]"){u.value=x,v.value=!1;return}if(N.trim().indexOf("usage")>-1)continue;try{const P=JSON.parse(N.trim());if(P.error_code!==0){await G(P.error_message),v.value=!1;return}}catch{}}await I()}};await I()}}catch(k){console.error("AI 生成失败:",k),await G(a("page.ai_generate_failed")),v.value=!1}}},f=()=>{navigator.clipboard.writeText(u.value).then(()=>{ie.success(a("common.copy_success"))}).catch(()=>{G(a("common.copy_failed"))})},$=()=>{const y=a("page.ai_help_url");window.open(y,"_blank")},g=()=>{t.onInsert&&u.value.trim()&&(t.onInsert(u.value),n())},n=()=>{o.value=!1,setTimeout(()=>{t.onClose()},300)};return oe(()=>{o.value=!0}),(y,k)=>{const r=H("a-col"),_=H("a-row");return C(),B(de,{show:o.value,title:y.$t("page.ai_assistant"),onClose:n,maxWidth:"1400px",minWidth:"1000px","use-line":!0,"header-buttons":d.value},{footer:m(()=>[s(K,{onClick:n},{default:m(()=>[O(i(y.$t("common.close")),1)]),_:1}),s(K,{theme:"dark",onClick:g,disabled:!u.value.trim(),"left-icon":["fas","fa-plus"]},{default:m(()=>[O(i(y.$t("page.ai_insert_to_editor")),1)]),_:1},8,["disabled"])]),default:m(()=>[e("div",P$,[s(_,{gutter:24},{default:m(()=>[s(r,{span:12,class:"input-section"},{default:m(()=>[e("div",A$,[e("h3",null,i(y.$t("page.ai_input_area")),1)]),s(tt,{modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=h=>l.value=h),placeholder:y.$t("page.ai_input_placeholder"),class:"ai-textarea",style:{"min-height":"400px"}},null,8,["modelValue","placeholder"]),e("div",D$,[s(K,{theme:"dark",onClick:p,spinning:v.value,disabled:!l.value.trim()||v.value,"left-icon":["fas","fa-magic"]},{default:m(()=>[O(i(y.$t("page.ai_generate")),1)]),_:1},8,["spinning","disabled"]),s(K,{theme:"light",onClick:$,type:"link","left-icon":["fas","fa-question-circle"]},{default:m(()=>[O(i(y.$t("page.ai_help_text")),1)]),_:1})])]),_:1}),s(r,{span:12,class:"output-section"},{default:m(()=>[e("div",O$,[e("h3",null,i(y.$t("page.ai_output_area")),1)]),s(tt,{modelValue:u.value,"onUpdate:modelValue":k[1]||(k[1]=h=>u.value=h),placeholder:y.$t("page.ai_output_placeholder"),class:"ai-textarea ai-textarea-readonly",style:{"min-height":"400px"},readonly:""},null,8,["modelValue","placeholder"])]),_:1})]),_:1})])]),_:1},8,["show","title","header-buttons"])}}});const F$=Y(N$,[["__scopeId","data-v-d296fa83"]]);function q$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(F$,{...c,onClose:()=>{me(a,o),t()}});a.mount(o)})}const R$={class:"create-catalog-container"},H$={class:"form-item"},E$={class:"form-label"},j$={class:"form-item"},B$={class:"form-label"},G$=W({__name:"index",props:{itemId:{},parentCatId:{},onClose:{type:Function},onSuccess:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!0),l=We({catName:"",parentCatId:Number(a.parentCatId||0)}),u=b([]),v=q(()=>{const g=[{label:t("catalog.root_catalog"),value:0}];return u.value.forEach(n=>{g.push({label:n.cat_name,value:Number(n.cat_id||0)})}),g}),d=(g,n)=>n.label.toLowerCase().includes(g.toLowerCase()),p=()=>{var g;o.value=!1,(g=a.onClose)==null||g.call(a)},f=async()=>{try{const g=await X("/api/catalog/catListName",{item_id:a.itemId},"post",!1);g.error_code===0&&(u.value=(g.data||[]).map(n=>({...n,cat_id:Number(n.cat_id||0)})))}catch(g){console.error("获取目录列表失败:",g)}},$=async()=>{var g;if(!l.catName.trim()){j.error(t("catalog.cat_name_required"));return}try{const n=await X("/api/catalog/save",{item_id:a.itemId,cat_id:0,parent_cat_id:l.parentCatId,cat_name:l.catName.trim()},"post",!1);if(n.error_code===0){j.success(t("common.save_success")),o.value=!1;let y=0;typeof n.data=="number"?y=n.data:n.data&&n.data.cat_id&&(y=Number(n.data.cat_id)),y=Number(y||0),console.log("创建目录成功，新目录 ID:",y,"返回数据:",n),(g=a.onSuccess)==null||g.call(a,y,l.catName.trim())}else j.error(n.error_message||t("common.op_failed"))}catch(n){console.error("创建目录失败:",n),j.error(t("common.op_failed"))}};return oe(()=>{f()}),(g,n)=>{const y=H("a-select");return C(),B(de,{show:o.value,title:g.$t("catalog.new_catalog"),width:"500px",onClose:p},{footer:m(()=>[s(K,{onClick:p},{default:m(()=>[O(i(g.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:$},{default:m(()=>[O(i(g.$t("common.confirm")),1)]),_:1})]),default:m(()=>[e("div",R$,[e("div",H$,[e("label",E$,[O(i(g.$t("catalog.cat_name"))+" ",1),n[2]||(n[2]=e("span",{class:"required"},"*",-1))]),s(ne,{modelValue:l.catName,"onUpdate:modelValue":n[0]||(n[0]=k=>l.catName=k),placeholder:g.$t("catalog.cat_name_placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),e("div",j$,[e("label",B$,i(g.$t("catalog.parent_catalog")),1),s(y,{value:l.parentCatId,"onUpdate:value":n[1]||(n[1]=k=>l.parentCatId=k),options:v.value,placeholder:g.$t("catalog.select_parent_catalog"),"show-search":"","filter-option":d,"allow-clear":"",style:{width:"100%"}},null,8,["value","options","placeholder"])])])]),_:1},8,["show","title"])}}});const K$=Y(G$,[["__scopeId","data-v-3320e1ed"]]);function J$(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(K$,{itemId:c.itemId,parentCatId:c.parentCatId||0,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t({catId:0,catName:""})},onSuccess:(l,u)=>{var v;(v=c.onSuccess)==null||v.call(c,l,u),me(a,o),t({catId:l,catName:u})}});a.mount(o)})}const W$={class:"catalog-select-container"},Y$={class:"form-item"},X$={class:"form-label"},Q$=W({__name:"index",props:{itemId:{},catId:{},onClose:{type:Function},onSelect:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b([]),u=b(0),v=q(()=>l.value.map(g=>({label:g.cat_name,value:g.cat_id}))),d=()=>{t.onClose()},p=()=>{t.onSelect(Number(u.value))},f=async()=>{console.log("handleNewCatalog 开始执行");const g=await J$({itemId:t.itemId,parentCatId:Number(u.value)});console.log("CreateCatalogModal 返回结果:",g),g.catId>0?(console.log("开始刷新目录列表，新目录 ID:",g.catId),await $(g.catId),console.log("目录列表刷新完成"),t.onSelect(g.catId),console.log("onSelect 调用完成")):console.log("result.catId <= 0，不执行刷新")},$=async g=>{console.log("loadCatalogs 开始执行，selectedCatalogId:",g);try{const n=await X("/api/catalog/catListName",{item_id:t.itemId},"post",!1);if(console.log("API 返回数据:",n),n.error_code===0&&n.data){const y={cat_id:"0",cat_name:"/"};l.value=[y,...(n.data||[]).map(r=>({...r,cat_id:String(Number(r.cat_id||0))}))],console.log("目录列表更新完成:",l.value);const k=String(g!==void 0?g:t.catId);u.value=k,console.log("设置选中目录 ID:",k,"当前值:",u.value)}}catch(n){console.error("获取目录列表失败:",n),await AlertModal(a("common.operation_failed"))}};return oe(()=>{o.value=!0,$()}),(g,n)=>(C(),B(de,{show:o.value,title:g.$t("page.select_catalog"),width:"500px",onClose:d},{footer:m(()=>[s(K,{onClick:f},{default:m(()=>[n[1]||(n[1]=e("i",{class:"fas fa-plus"},null,-1)),O(" "+i(g.$t("catalog.new_catalog")),1)]),_:1}),n[2]||(n[2]=e("div",{style:{flex:"1"}},null,-1)),s(K,{onClick:d},{default:m(()=>[O(i(g.$t("common.cancel")),1)]),_:1}),s(K,{theme:"dark",onClick:p},{default:m(()=>[O(i(g.$t("common.confirm")),1)]),_:1})]),default:m(()=>[e("div",W$,[e("div",Y$,[e("label",X$,i(g.$t("page.select_catalog")),1),s(Re,{value:u.value,"onUpdate:value":n[0]||(n[0]=y=>u.value=y),options:v.value,placeholder:g.$t("page.select_catalog"),"show-search":!0},null,8,["value","options","placeholder"])])])]),_:1},8,["show","title"]))}});const Z$=Y(Q$,[["__scopeId","data-v-a485fae7"]]);function ek(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(Z$,{itemId:c.itemId,catId:c.catId,onClose:()=>{var l;(l=c.onClose)==null||l.call(c),me(a,o),t(0)},onSelect:l=>{var u;(u=c.onSelect)==null||u.call(c,l),me(a,o),t(l)}});a.mount(o)})}const tk={class:"page-edit-container"},ak={class:"edit-header"},ok={class:"header-left"},sk={class:"header-right"},lk={class:"fun-btn-group"},nk={class:"edit-content"},ik=W({__name:"index",props:{itemId:{},editPageId:{default:""},copyPageId:{default:""},catId:{default:""},onClose:{}},setup(c){const t=c,a=xe(),{t:o,locale:l}=te(),u=He(),v=b({title:"",content:"",catId:0}),d=b(!1),p=b(!1),f=b([]),$=b(null),g=b(null),n=b(!1),y=b(0),k=b(!1),r=b({title:"",content:"",catId:0}),_=b(!1);let h=null,w=null,T=null,x=null;const I=q(()=>({handler:async R=>{const Z=[];for(const pe of R)try{const $e=await we(pe);Z.push({url:$e})}catch($e){throw console.error("上传文件失败:",$e),$e}return Z},maxFileSize:10*1024*1024,accept:"image/*",multiple:!0})),S=q(()=>[{icon:["fas","fa-comment-dots"],text:o("page.save_and_notify"),value:"notify",onclick:je},{icon:["fas","fa-file-export"],text:o("page.save_as_template"),value:"template",onclick:Ze},{icon:n.value?["fas","fa-unlock"]:["fas","fa-lock"],text:n.value?o("page.unlock"):o("page.lock_edit"),value:"lock",onclick:x}]),M=q(()=>[{icon:["fas","fa-plug"],text:o("page.insert_api_template"),value:"apidoc",onclick:()=>ze("apidoc")},{icon:["fas","fa-database"],text:o("page.insert_database_template"),value:"database",onclick:()=>ze("database")},{icon:["fas","fa-folder-open"],text:o("page.template_list"),value:"more",onclick:Ye}]),V=q(()=>[{icon:["fas","fa-table"],text:o("page.json_to_table"),value:"toTable",onclick:()=>Ve("toTable")},{icon:["fas","fa-th"],text:o("page.beautify_json"),value:"beautify",onclick:()=>Ve("beautify")},{icon:["fas","fa-table"],text:o("page.paste_insert_table"),value:"pasteTable",onclick:()=>Ve("pasteTable")},{icon:["fas","fa-database"],text:o("page.sql_to_markdown_table"),value:"sqlToTable",onclick:()=>Ve("sqlToTable")}]),U=q(()=>{const R=[{icon:["fas","fa-history"],text:o("page.page_history_version"),value:"history",onclick:()=>De("history")}];return k.value&&R.push({icon:["fas","fa-robot"],text:o("page.ai_assistant"),value:"ai",onclick:()=>De("ai")}),R.push({icon:["fas","fa-vial"],text:o("page.mock_config"),value:"mock",onclick:()=>De("mock")},{icon:["fas","fa-link"],text:o("page.http_test_api"),value:"runapi",onclick:()=>De("runapi")}),R}),N=b(!0),A=q(()=>t.itemId),P=b(t.editPageId||""),D=q(()=>{const R=f.value.find(Z=>Z.catId===v.value.catId);return R?R.title:o("catalog.root_catalog")}),E=()=>{u.toggleTheme()},ae=()=>{t.onClose(!1),P.value&&(a.replace(`/${A.value}/${P.value}`),setTimeout(()=>{window.location.reload()},100))},ge=async R=>{if(R)try{const Z=await X("/api/page/info",{page_id:String(R)},"post",!1);Z.error_code===0&&Z.data&&(v.value.title=Z.data.page_title||"",v.value.catId=Number(Z.data.cat_id||0),v.value.content=It(Z.data.page_content||""),y.value=Z.data.attachment_count>0?Z.data.attachment_count:0,r.value={title:v.value.title,content:v.value.content,catId:v.value.catId})}catch(Z){console.error("获取页面内容失败:",Z),await G(o("page.fetch_content_failed"))}},fe=async()=>{if(P.value)try{const R=await X("/api/page/info",{page_id:String(P.value)},"post",!1);R.error_code===0&&R.data&&(y.value=R.data.attachment_count>0?R.data.attachment_count:0)}catch(R){console.error("获取附件数量失败:",R)}},ee=async()=>{if(A.value)try{const R=await X("/api/catalog/catListName",{item_id:String(A.value)},"post",!1);R.error_code===0&&R.data&&(f.value=[{catId:0,title:o("catalog.root_catalog")},...(R.data||[]).map(Z=>({catId:Number(Z.cat_id),title:Z.cat_name}))])}catch(R){console.error("获取目录列表失败:",R)}},J=async(R=!1,Z="")=>{var pe;if(!A.value){await G(o("page.item_id_required"));return}v.value.title.trim()||(d.value=!1,v.value.title=o("page.untitled")),p.value=!0;try{const $e=await X("/api/page/save",{page_id:P.value||"",item_id:String(A.value),cat_id:v.value.catId,page_title:v.value.title,is_urlencode:1,page_content:encodeURIComponent(v.value.content),is_notify:R?1:0,notify_content:Z},"post",!1);if($e.error_code===0)ie.success(o("page.save_success")),!P.value&&((pe=$e.data)!=null&&pe.page_id)&&(P.value=$e.data.page_id),Ie(),r.value={title:v.value.title,content:v.value.content,catId:v.value.catId};else if($e.error_code===10401){const Ae=o("page.page_limit_exceeded_with_link");await G(Ae,{dangerouslyUseHTMLString:!0});return}else await G($e.error_message||o("page.save_failed"))}catch($e){console.error("保存失败:",$e),await G(o("page.save_failed"))}finally{p.value=!1}},ce=async()=>{const R=await ek({itemId:A.value,catId:v.value.catId});R>0&&(v.value.catId=R,await ye(),await J())},ye=async()=>{await ee()},ze=async R=>{if(R==="more")await pa({itemId:A.value,onInsert:Z=>{ue(Z)}});else if(R==="apidoc"){const Z=l.value==="en-US"?Uo:Po;ue(Z)}else if(R==="database"){const Z=l.value==="en-US"?Ao:Do;ue(Z)}},Ve=async R=>{R==="toTable"?await nw({onInsert:Z=>{ue(Z)}}):R==="beautify"?await dw({onInsert:Z=>{ue(Z)}}):R==="pasteTable"?await pw({onInsert:Z=>{ue(Z)}}):R==="sqlToTable"&&await yw({onInsert:Z=>{ue(Z)}})},De=async R=>{if(R==="history"){if(!P.value){await G(o("page.please_save_page_first"));return}await Lt({pageId:P.value,onRestore:async Z=>{v.value.content=Z,ie.success(o("page.restore_success"))}})}else if(R==="ai")await Ue();else if(R==="mock"){if(!P.value){await G(o("page.please_save_page_first"));return}await Pw({pageId:P.value,itemId:A.value})}else R==="runapi"&&window.open("http://runapi.showdoc.cc/")},Ze=async()=>{await U$({content:v.value.content,onSuccess:()=>{ie.success(o("page.save_template_success"))}})},je=async()=>{await tw({itemId:A.value,pageId:P.value,onConfirm:async R=>{await J(!0,R)}})},Ye=async()=>{await pa({itemId:A.value,onInsert:R=>{ue(R)}})},Ke=async()=>{if(!P.value){await G(o("page.page_id_required"));return}try{const R={page_id:String(P.value),item_id:String(A.value)};n.value&&(R.lock_to=1e3);const Z=await X("/api/page/setLock",R,"post",!1);Z.error_code===0?(n.value=!n.value,ie.success(n.value?o("page.lock_success"):o("page.unlock_success"))):await G(Z.error_message||o("page.operation_failed"))}catch(R){console.error("锁定操作失败:",R),await G(o("page.operation_failed"))}},Ue=async()=>{await q$({pageId:P.value,itemId:A.value,onInsert:R=>{ue(R)}})},Q=R=>{(R.ctrlKey||R.metaKey)&&R.key==="s"&&(R.preventDefault(),J())},se=()=>{if(!$.value)return!1;let R=null;if($.value.cm&&typeof $.value.cm.getWrapperElement=="function"&&(R=$.value.cm.getWrapperElement()),!R&&$.value.id&&(R=document.querySelector(`#${$.value.id} .CodeMirror-wrap`)),!R&&g.value&&g.value.getInstance){const Z=g.value.getInstance();Z!=null&&Z.cm&&(R=Z.cm.getWrapperElement())}return R?R.contains(document.activeElement):!1},be=async R=>{if(!se()||!$.value)return;const Z=R.clipboardData;if(Z)for(let pe=0;pe<Z.items.length;pe++){const $e=Z.items[pe];if($e.type.indexOf("image")>-1){R.preventDefault();const Ae=$e.getAsFile();if(Ae&&g.value)try{const Ne=await we(Ae);g.value.insertValue(`![${Ae.name}](${Ne})`),g.value.focus()}catch(Ne){console.error("粘贴上传图片失败:",Ne)}return}if($e.type==="text/html"){R.preventDefault();const Ae=await new Promise(et=>{$e.getAsString(et)}),Ne=document.querySelector("#pastebin");if(Ne){Ne.innerHTML=Ae;const et=Ne.innerText||Ne.textContent||"";if(Ne.innerHTML="",et.length<200)ue(et);else if(await Se({msg:o("page.paste_html_tips"),confirmText:o("page.past_html_markdown"),cancelText:o("page.past_html_text")})){const At=Te(Ae);ue(At)}else ue(et)}else{const et=Ae.replace(/<[^>]+>/g,"");if(et.length<200)ue(et);else if(await Se({msg:o("page.paste_html_tips"),confirmText:o("page.past_html_markdown"),cancelText:o("page.past_html_text")})){const At=Te(Ae);ue(At)}else ue(et)}return}}},Te=R=>R.replace(/<strong[^>]*>(.*?)<\/strong>/gi,"**$1**").replace(/<b[^>]*>(.*?)<\/b>/gi,"**$1**").replace(/<em[^>]*>(.*?)<\/em>/gi,"*$1*").replace(/<i[^>]*>(.*?)<\/i>/gi,"*$1*").replace(/<h1[^>]*>(.*?)<\/h1>/gi,`# $1
`).replace(/<h2[^>]*>(.*?)<\/h2>/gi,`## $1
`).replace(/<h3[^>]*>(.*?)<\/h3>/gi,`### $1
`).replace(/<code[^>]*>(.*?)<\/code>/gi,"`$1`").replace(/<pre[^>]*><code[^>]*>(.*?)<\/code><\/pre>/gis,"```\n$1\n```").replace(/<br\s*\/?>/gi,`
`).replace(/<[^>]+>/g,""),we=async R=>{const Z=new FormData;Z.append("file",R),Z.append("item_id",String(A.value)),Z.append("page_id",String(P.value||0));try{const pe=await X("/api/attachment/attachmentUpload",Z,"post",!1);if(pe&&pe.success===1&&pe.url)return pe.url;{const $e=(pe==null?void 0:pe.message)||(pe==null?void 0:pe.error_message)||"上传失败",Ae=new Error($e);throw Ae.apiError=pe,Ae}}catch(pe){throw console.error("上传文件失败:",pe),pe}},le=R=>{var pe,$e;console.error("上传失败:",R);const Z=((pe=R.apiError)==null?void 0:pe.message)||(($e=R.apiError)==null?void 0:$e.error_message)||R.message||o("page.upload_failed");G(Z)},_e=async()=>{try{const R=await X("/api/common/homePageSetting",{},"post",!1);R.data&&R.data.is_show_ai&&(k.value=!0)}catch(R){console.error("获取AI配置失败:",R)}},ke=()=>{if(P.value){if(!(v.value.title!==r.value.title||v.value.content!==r.value.content||v.value.catId!==r.value.catId))return;const Z=`showdoc_draft_${P.value}`;localStorage.setItem(Z,JSON.stringify({title:v.value.title,content:v.value.content,catId:v.value.catId,timestamp:Date.now()}))}},he=async()=>{if(P.value){const R=`showdoc_draft_${P.value}`,Z=localStorage.getItem(R);if(Z)try{const pe=JSON.parse(Z),$e=new Date(pe.timestamp).toLocaleString();await Se({msg:o("page.recover_draft_confirm",{time:$e}),confirmText:o("common.confirm"),cancelText:o("common.cancel")})&&(v.value.title=pe.title,v.value.content=pe.content,v.value.catId=pe.catId),localStorage.removeItem(R)}catch(pe){console.error("读取草稿失败:",pe),localStorage.removeItem(R)}}},Ie=()=>{if(P.value){const R=`showdoc_draft_${P.value}`;localStorage.removeItem(R)}},Me=async()=>{if(P.value)try{const R=await X("/api/page/info",{page_id:String(P.value)},"post",!1);R.error_code===0&&R.data&&(n.value=R.data.is_locked===1)}catch(R){console.error("检查页面锁定状态失败:",R)}},Oe=async()=>{if(P.value)try{(await X("/api/page/setLock",{page_id:String(P.value),item_id:String(A.value)},"post",!1)).error_code===0&&(n.value=!0)}catch(R){console.error("锁定页面失败:",R)}},mt=async()=>{if(n.value)try{(await X("/api/page/setLock",{page_id:String(P.value),item_id:String(A.value),lock_to:1e3},"post",!1)).error_code===0&&(n.value=!1)}catch(R){console.error("解锁页面失败:",R)}},_t=()=>{T=setInterval(()=>{n.value&&Oe()},20*60*1e3)};x=async()=>{await Ke()};const pt=async()=>{if(P.value)try{const R=await X("/api/page/isLock",{page_id:String(P.value),item_id:String(A.value)},"post",!1);R.error_code===0&&R.data&&(R.data.lock>0?R.data.is_cur_user>0?n.value=!0:(alert(o("page.locking")+R.data.lock_username),t.onClose(!1)):await Oe())}catch(R){console.error("检查远程锁定状态失败:",R)}},Ut=async()=>{await Ba({itemId:A.value,pageId:P.value,manage:!0,onClose:()=>{fe()},onInsert:R=>{ue(R)}})},Pt=R=>{$.value=R},ue=R=>{g.value?(g.value.insertValue(R),g.value.focus&&g.value.focus()):$.value&&($.value.insertValue(R),$.value.focus&&$.value.focus())};return qe(()=>[v.value.title,v.value.content,v.value.catId],()=>{clearTimeout(h),h=setTimeout(()=>{ke()},2e3)},{deep:!0}),oe(async()=>{N.value=!0,await ee(),t.copyPageId>0?(await ge(t.copyPageId),v.value.title=o("page.copy_of",{title:v.value.title})):t.editPageId>0?(await ge(t.editPageId),await Me(),await he(),await pt(),_t()):(v.value.catId=Number(t.catId),v.value.title="",v.value.content="",r.value={title:"",content:"",catId:Number(t.catId)}),_.value=!0,await _e(),window.addEventListener("keydown",Q),document.addEventListener("paste",be)}),Xe(()=>{clearTimeout(h),clearInterval(w),clearInterval(T),Ie(),mt(),window.removeEventListener("keydown",Q),document.removeEventListener("paste",be)}),(R,Z)=>{const pe=H("a-button"),$e=H("a-tooltip"),Ae=H("a-badge");return C(),B(hs,{show:N.value,"mask-closable":!1,onClose:ae},{default:m(()=>[e("div",tk,[e("div",ak,[e("div",ok,[s(pe,{class:"close-btn",onClick:ae},{default:m(()=>[...Z[5]||(Z[5]=[e("i",{class:"fas fa-times"},null,-1)])]),_:1}),d.value?(C(),B(ne,{key:1,modelValue:v.value.title,"onUpdate:modelValue":Z[1]||(Z[1]=Ne=>v.value.title=Ne),class:"page-title-input",placeholder:R.$t("page.input_page_title"),onBlur:Z[2]||(Z[2]=Ne=>d.value=!1),onKeyup:Z[3]||(Z[3]=Fe(Ne=>d.value=!1,["enter"]))},null,8,["modelValue","placeholder"])):(C(),B($e,{key:0,title:R.$t("page.click_to_edit_page_title")},{default:m(()=>[e("span",{class:"page-title",onClick:Z[0]||(Z[0]=Ne=>d.value=!0)},i(v.value.title||R.$t("page.untitled")),1)]),_:1},8,["title"])),s($e,{title:R.$t("page.select_catalog")},{default:m(()=>[e("span",{class:"catalog-selector",onClick:ce},[Z[6]||(Z[6]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(D.value),1)])]),_:1},8,["title"])]),e("div",sk,[s($e,{title:z(u).theme==="light"?R.$t("common.dark_mode"):R.$t("common.light_mode"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:E},[...Z[7]||(Z[7]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),s(Ct,{text:R.$t("common.save"),theme:"dark",list:S.value,spinning:p.value,"left-icon":["fas","fa-save"],"on-click":J},null,8,["text","list","spinning"])])]),e("div",lk,[s(Ct,{text:R.$t("page.insert_template"),theme:"light",list:M.value,"left-icon":["far","fa-files"]},null,8,["text","list"]),s(Ct,{text:R.$t("page.format_tools"),theme:"light",list:V.value,"left-icon":["far","fa-gear"]},null,8,["text","list"]),s(Ct,{text:R.$t("page.document_tools"),theme:"light",list:U.value,"left-icon":["fas","fa-gear"]},null,8,["text","list"]),s(Ae,{count:y.value,offset:[10,10],color:"var(--icon-tag-color)"},{default:m(()=>[s(K,{text:R.$t("page.attachments"),"left-icon":["fas","fa-paperclip"],theme:"light",onClick:Ut},null,8,["text"])]),_:1},8,["count"])]),e("div",nk,[_.value?(C(),B(St,{key:0,ref_key:"editormdEditorRef",ref:g,modelValue:v.value.content,"onUpdate:modelValue":Z[4]||(Z[4]=Ne=>v.value.content=Ne),mode:"editor",height:"70vh",upload:I.value,onLoad:Pt,onUploadError:le},null,8,["modelValue","upload"])):F("",!0)]),Z[8]||(Z[8]=e("div",{id:"pastebin",contenteditable:"true"},null,-1))])]),_:1},8,["show"])}}});const rk=Y(ik,[["__scopeId","data-v-f60c9d5b"]]);function rt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(rk,{itemId:c.itemId,editPageId:c.editPageId||0,copyPageId:c.copyPageId||0,catId:c.catId||0,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const ck={class:"page-edit-page"},dk=W({__name:"Index",setup(c){const t=Ge(),a=xe();He();const o=t.params.item_id,l=t.params.page_id,u=t.query.cat_id||"";return oe(async()=>{const v=await rt({itemId:o,editPageId:l,catId:u});v&&l?window.location.reload():a.back()}),(v,d)=>(C(),L("div",ck))}});const uk=Y(dk,[["__scopeId","data-v-592800ea"]]),$S=Object.freeze(Object.defineProperty({__proto__:null,default:uk},Symbol.toStringTag,{value:"Module"})),mk={key:0,class:"pos"},_k={class:"header-wrap"},pk={class:"logo"},fk={class:"logo-content"},vk={class:"font-bold"},hk={class:"doc-container",id:"doc-container"},gk={class:"doc-title-box"},yk={id:"doc-title"},wk={id:"page_md_content",class:"page_content_main"},bk={key:0,class:"error-message"},$k={key:2,class:"toc-side"},kk=W({__name:"Index",setup(c){const t=Ge(),a=xe(),{t:o}=te(),l=b(!1),u=b(""),v=b(""),d=b(0),p=b(0),f=b(0),$=b(!1),g=b(!0),n=b(!0),y=b(""),k=b(!1),r=b(0),_=b(!1),h=b(0),w=()=>{const N=window.innerWidth;l.value=N<=768||N<1e3||k.value},T=()=>{if(!l.value)return;const N=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;N<100||N<h.value?_.value=!1:_.value=!0,h.value=N},x=async()=>{const N=t.params.page_id,A=t.params.unique_key;if(!N&&!A){y.value=o("page.show.page_not_found");return}try{const E=await X(A?"/api/page/infoByKey":"/api/page/info",{page_id:N,unique_key:A},"post",!1);if(E.error_code===0){const ae=E.data.page_content||"";$.value=!1;try{const fe=JSON.parse(Zt(ae));$.value=!!(fe&&fe.info&&fe.info.url)}catch{}u.value=It(ae),v.value=E.data.page_title,d.value=E.data.page_id,p.value=E.data.item_id||0,f.value=E.data.cat_id||0,y.value="",document.title=v.value+"--ShowDoc";const ge=document.querySelector('meta[name="description"]');ge&&ge.setAttribute("content",v.value)}else E.error_code===10104&&!A?a.replace({path:"/captcha/index",query:{page_id:N,unique_key:A,type:"visit_page",redirect:t.fullPath}}):(E.error_code===10307||E.error_code===10303)&&!A?a.replace({path:"/item/password/0",query:{page_id:N,redirect:t.fullPath}}):y.value=E.error_message||o("page.show.load_failed")}catch{y.value=o("page.show.load_failed")}},I=()=>{k.value=!k.value,w(),r.value++},S=()=>{window.location.href="/"},M=()=>{window.location.reload()},V=()=>{if(w(),l.value){g.value=!1,n.value=!1;const N=document.getElementById("doc-container");N&&(N.style.width="95%",N.style.padding="5px")}else U()},U=()=>{const N=document.querySelector(".toc-side"),A=document.querySelector(".toc-list");if(!N||!A)return;const P=window.innerWidth,D=(P-850)/2+850,E=D+40;console.log("屏幕宽度:",P),console.log("内容区右边缘:",D),console.log("TOC left值:",E),N.setAttribute("style",`right: auto; left: ${E}px;`)};return oe(()=>{if(w(),x(),l.value)g.value=!1,n.value=!1;else{const N=A=>{setTimeout(()=>{U()},A)};N(500),N(1e3),N(1500),N(2e3)}window.addEventListener("resize",V),window.addEventListener("scroll",T)}),Xe(()=>{window.removeEventListener("resize",V),window.removeEventListener("scroll",T),document.title="ShowDoc"}),(N,A)=>(C(),L("div",{class:re(["page-show",{"mobile-view":l.value||k.value}])},[l.value?(C(),L("div",mk)):F("",!0),l.value?(C(),L("div",{key:1,class:re(["mobile-header",{"hide-element":_.value}])},[e("div",_k,[e("div",pk,[e("div",fk,[A[1]||(A[1]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",vk,i(v.value||z(o)("page.show.title")),1)])]),k.value?(C(),L("div",{key:1,class:"exit-fullscreen-btn",onClick:M},[A[3]||(A[3]=e("i",{class:"fas fa-compress"},null,-1)),e("span",null,i(z(o)("common.exit_fullscreen")),1)])):(C(),L("div",{key:0,class:"back-btn",onClick:S},[A[2]||(A[2]=e("i",{class:"fas fa-home"},null,-1)),O(" "+i(N.$t("common.home")),1)]))])],2)):F("",!0),e("div",{class:re(["content-wrapper",{"mobile-wrapper":l.value}])},[e("div",hk,[e("div",gk,[e("h2",yk,i(v.value),1),!l.value&&g.value&&!k.value?(C(),L("i",{key:0,class:re(k.value?"fas fa-compress":"fas fa-expand"),id:"full-page",onClick:I},null,2)):F("",!0)]),e("div",wk,[d.value&&u.value?(C(),B(St,{key:r.value,modelValue:u.value,"onUpdate:modelValue":A[0]||(A[0]=P=>u.value=P),mode:"preview"},null,8,["modelValue"])):F("",!0)]),y.value?(C(),L("div",bk,[A[4]||(A[4]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",null,i(y.value),1)])):F("",!0)])],2),d.value&&u.value&&!l.value&&n.value&&!k.value?(C(),L("div",$k,[s(aa)])):F("",!0)],2))}});const Ck=Y(kk,[["__scopeId","data-v-1a0b1c04"]]),kS=Object.freeze(Object.defineProperty({__proto__:null,default:Ck},Symbol.toStringTag,{value:"Module"})),xk={class:"page-diff-page"},Ik={class:"container-narrow"},Sk={class:"view-type-wrapper"},Tk={id:"diffoutput"},Mk=W({__name:"Index",setup(c){const t=Ge(),{t:a}=te(),o=b(""),l=b(""),u=b(0),v=b(!0),d=g=>{u.value=g,p(g)},p=g=>{if(typeof window.difflib>"u"||typeof window.diffview>"u"){console.error("difflib 或 diffview 未加载");return}const n=w=>document.getElementById(w),y=window.difflib.stringAsLines(n("baseText").value),k=window.difflib.stringAsLines(n("newText").value),_=new window.difflib.SequenceMatcher(y,k).get_opcodes(),h=n("diffoutput");h&&(h.innerHTML="",h.appendChild(window.diffview.buildView({baseTextLines:y,newTextLines:k,opcodes:_,baseTextName:a("page.cur_page_content"),newTextName:a("page.history_version"),viewType:g})))},f=async()=>{const g=t.params.page_id,n=t.params.page_history_id;if(!g||!n){console.error("缺少参数: page_id 或 page_history_id");return}v.value=!0;try{const y=await X("/api/page/diff",{page_id:g,page_history_id:n},"post",!1);y.error_code===0&&y.data?(o.value=y.data.page.page_content||"",l.value=y.data.history_page.page_content||"",await ct(),p(u.value)):console.error("获取对比数据失败:",y.error_message)}catch(y){console.error("获取对比数据失败:",y)}finally{v.value=!1}},$=async()=>{const g=y=>new Promise((k,r)=>{const _=document.createElement("script");_.src=y,_.onload=()=>k(),_.onerror=r,document.head.appendChild(_)}),n=document.createElement("link");n.href="/diff/diffview.css",n.rel="stylesheet",document.head.appendChild(n);try{await g("/diff/difflib.js"),await g("/diff/diffview.js")}catch(y){console.error("加载 diff 脚本失败:",y)}};return document.title=`${a("page.version_comparison")}--ShowDoc`,oe(async()=>{await $(),await f()}),(g,n)=>{const y=oo("loading");return C(),L("div",xk,[e("div",Ik,[ft(e("textarea",{id:"baseText","onUpdate:modelValue":n[0]||(n[0]=k=>o.value=k),style:{display:"none"}},null,512),[[qt,o.value]]),ft(e("textarea",{id:"newText","onUpdate:modelValue":n[1]||(n[1]=k=>l.value=k),style:{display:"none"}},null,512),[[qt,l.value]]),e("div",Sk,[s(K,{theme:u.value===0?"dark":"light",onClick:n[2]||(n[2]=k=>d(0))},{default:m(()=>[O(i(g.$t("page.side_by_side")),1)]),_:1},8,["theme"]),s(K,{theme:u.value===1?"dark":"light",onClick:n[3]||(n[3]=k=>d(1))},{default:m(()=>[O(i(g.$t("page.inline")),1)]),_:1},8,["theme"])]),ft(e("div",Tk,null,512),[[y,v.value]])])])}}});const Lk=Y(Mk,[["__scopeId","data-v-60214042"]]),CS=Object.freeze(Object.defineProperty({__proto__:null,default:Lk},Symbol.toStringTag,{value:"Module"})),Vk=["onClick"],zk=W({__name:"Member",props:{team_id:{},team_manage:{},callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=b([]),u=b(!1),v=b(!1),d=b({member_username:[],team_member_group_id:"1"}),p=async()=>{try{const r=await Bt(a.team_id);r.error_code===0&&(o.value=r.data||[])}catch(r){console.error("获取团队成员列表失败:",r)}},f=async()=>{u.value=!0;try{const r=await jt({username:""});if(r.error_code===0&&r.data){const _=r.data,h=[];for(let w=0;w<_.length;w++)o.value.some(x=>x.member_username===_[w].username)||h.push(_[w]);l.value=h.map(w=>({label:w.name?`${w.username}(${w.name})`:w.username,value:w.username}))}}catch(r){console.error("获取全站用户列表失败:",r)}finally{u.value=!1}},$=()=>{d.value={member_username:[],team_member_group_id:"1"},f(),v.value=!0},g=async()=>{if(!d.value.member_username||d.value.member_username.length===0){await G(t("item.member_username")+t("common.required"));return}try{let r=0,_=0;for(const h of d.value.member_username){const w=await wa({team_id:a.team_id,member_username:h,team_member_group_id:d.value.team_member_group_id});w.error_code===0?r++:(_++,console.error(`添加成员 ${h} 失败:`,w.error_message))}if(r>0){let h=t("common.op_success");_>0&&(h=`${h} (成功${r}个，失败${_}个)`),j.success(h),v.value=!1,p()}else j.error(t("common.op_failed"))}catch(r){console.error("添加成员失败:",r),j.error(t("common.op_failed"))}},n=()=>{v.value=!1},y=async r=>{if(await Se(t("item.confirm_delete"),t("item.confirm_delete_member")))try{const h=await ba(r);h.error_code===0?(j.success(t("common.op_success")),p()):j.error(h.error_message||t("common.op_failed"))}catch(h){console.error("删除成员失败:",h),j.error(t("common.op_failed"))}},k=()=>{a.callback()};return oe(()=>{p()}),(r,_)=>{const h=H("a-table-column"),w=H("a-table"),T=H("a-form-item"),x=H("a-radio"),I=H("a-radio-group"),S=H("a-form");return C(),L(Ce,null,[s(de,{show:!0,title:z(t)("item.manage_members"),showCancel:!1,showOk:!1,onClose:k},{extraButtons:m(()=>[c.team_manage==1||c.team_manage==2?(C(),B(K,{key:0,theme:"dark",onClick:$},{default:m(()=>[_[2]||(_[2]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.add_member")),1)]),_:1})):F("",!0)]),default:m(()=>[s(w,{dataSource:o.value,pagination:!1,emptyText:z(t)("item.empty_team_member_tips")},{default:m(()=>[s(h,{key:"member_username",title:z(t)("item.member_username")},{default:m(({record:M})=>[O(i(M.member_username),1)]),_:1},8,["title"]),s(h,{key:"team_member_group_id",title:z(t)("item.member_authority")},{default:m(({record:M})=>[O(i(M.team_member_group_id==2?z(t)("item.team_admin"):z(t)("item.ordinary_member")),1)]),_:1},8,["title"]),s(h,{key:"name",title:z(t)("item.name")},{default:m(({record:M})=>[O(i(M.name),1)]),_:1},8,["title"]),s(h,{key:"addtime",title:z(t)("item.addtime")},{default:m(({record:M})=>[O(i(M.addtime),1)]),_:1},8,["title"]),s(h,{key:"operation",title:z(t)("item.operation")},{default:m(({record:M})=>[c.team_manage==1||c.team_manage==2?(C(),L("a",{key:0,onClick:V=>y(M.id)},i(z(t)("common.delete")),9,Vk)):F("",!0)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),v.value?(C(),B(de,{key:0,title:z(t)("item.add_member"),showCancel:!0,showOk:!0,width:"500px",onClose:n,onConfirm:g},{default:m(()=>[s(S,{layout:"vertical"},{default:m(()=>[s(T,{label:z(t)("item.member_username")},{default:m(()=>[s(Re,{value:d.value.member_username,"onUpdate:value":_[0]||(_[0]=M=>d.value.member_username=M),options:l.value,placeholder:z(t)("item.search_member_placeholder"),loading:u.value,multiple:!0,"show-search":!0},null,8,["value","options","placeholder","loading"])]),_:1},8,["label"]),s(T,null,{default:m(()=>[s(I,{value:d.value.team_member_group_id,"onUpdate:value":_[1]||(_[1]=M=>d.value.team_member_group_id=M)},{default:m(()=>[s(x,{value:"1"},{default:m(()=>[O(i(z(t)("item.ordinary_member")),1)]),_:1}),s(x,{value:"2"},{default:m(()=>[O(i(z(t)("item.team_admin")),1)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1},8,["title"])):F("",!0)],64)}}});const Ga=Y(zk,[["__scopeId","data-v-af29322e"]]),xS=Object.freeze(Object.defineProperty({__proto__:null,default:Ga},Symbol.toStringTag,{value:"Module"})),Uk=["onClick"],Pk=["onClick"],Ak=["onClick"],Dk={href:"/item/index",target:"_blank"},Ok={class:"tips-text"},Nk={components:{ConfirmModal:Se}},Fk=W({...Nk,__name:"Item",props:{team_id:{},team_manage:{},callback:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=b([]),u=b([]),v=b([]),d=b([]),p=b(!1),f=b(!1),$=b({item_id:[]}),g=b(0);q(()=>u.value.map(N=>({label:N.item_name,value:N.item_id})));const n=async()=>{try{const N=await $a(o.team_id);N.error_code===0&&(l.value=N.data||[])}catch(N){console.error("获取团队项目列表失败:",N)}},y=async()=>{try{const N=await kt(0);N.error_code===0&&(u.value=(N.data||[]).filter(A=>A.original===1))}catch(N){console.error("获取项目列表失败:",N)}},k=()=>{$.value={item_id:[]},p.value=!0},r=()=>{p.value=!1},_=async()=>{try{for(const N of $.value.item_id)await Gt(String(N),String(o.team_id));j.success(t("common.op_success")),p.value=!1,$.value={item_id:[]},n()}catch(N){console.error("绑定项目失败:",N),j.error(t("common.op_failed"))}},h=N=>{const A=a.resolve({path:`/${N}`}).href;window.open(A,"_blank")},w=async N=>{if(await Se.confirm({title:t("item.confirm_unassign"),content:t("item.confirm_unassign_item")}))try{const P=await Jt(N);P.error_code===0?(j.success(t("common.op_success")),n()):j.error(P.error_message||t("common.op_failed"))}catch(P){console.error("解绑项目失败:",P),j.error(t("common.op_failed"))}},T=async N=>{g.value=Number(N);try{await V(N);const A=await Kt(N,o.team_id);A.error_code===0&&(v.value=(A.data||[]).map(P=>({...P,cat_ids:Array.isArray(P.cat_ids)?P.cat_ids.map(D=>Number(D)):[]})),f.value=!0)}catch(A){console.error("获取团队成员失败:",A)}},x=()=>{f.value=!1},I=async(N,A)=>{try{const P=await nt({member_group_id:N,id:A});P.error_code===0?j.success(t("item.auth_success")):j.error(P.error_message||t("common.op_failed"))}catch(P){console.error("修改权限失败:",P),j.error(t("common.op_failed"))}},S=async(N,A)=>{try{const P=await nt({cat_ids:(N||[]).join(","),id:A});P.error_code===0?j.success(t("item.cat_success")):j.error(P.error_message||t("common.op_failed"))}catch(P){console.error("修改目录失败:",P),j.error(t("common.op_failed"))}},M=async()=>{for(const N of v.value)try{await nt({member_group_id:"0",id:N.id}),setTimeout(()=>{T(String(N.item_id))},500)}catch(A){console.error("修改权限失败:",A)}},V=async N=>{try{const A=await xt(N);if(A.error_code===0){const P=A.data||[];P.unshift({cat_id:0,cat_name:t("item.all_cat")}),d.value=P.map(D=>({...D,cat_id:Number(D.cat_id)}))}}catch(A){console.error("获取目录列表失败:",A)}},U=()=>{o.callback()};return oe(()=>{n(),y()}),(N,A)=>{const P=H("a-table-column"),D=H("a-divider"),E=H("a-table"),ae=H("a-form-item"),ge=H("a-form"),fe=H("a-select-option"),ee=H("a-select");return C(),L(Ce,null,[s(de,{show:!0,title:z(t)("item.item_manage"),showCancel:!1,showOk:!1,width:"800px",onClose:U},{extraButtons:m(()=>[c.team_manage>0?(C(),B(K,{key:0,type:"primary",onClick:k},{default:m(()=>[A[1]||(A[1]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.binding_item")),1)]),_:1})):F("",!0)]),default:m(()=>[s(E,{dataSource:l.value,pagination:!1,emptyText:z(t)("item.empty_team_item_tips")},{default:m(()=>[s(P,{key:"item_name",title:z(t)("item.item_name")},{default:m(({record:J})=>[O(i(J.item_name),1)]),_:1},8,["title"]),s(P,{key:"addtime",title:z(t)("item.Join_time")},{default:m(({record:J})=>[O(i(J.addtime),1)]),_:1},8,["title"]),s(P,{key:"operation",title:z(t)("item.operation")},{default:m(({record:J})=>[e("a",{onClick:ce=>h(J.item_id),target:"_blank"},i(z(t)("item.check_item")),9,Uk),c.team_manage>0?(C(),L(Ce,{key:0},[s(D,{type:"vertical"}),e("a",{onClick:ce=>T(J.item_id)},i(z(t)("item.member_authority")),9,Pk),s(D,{type:"vertical"}),e("a",{onClick:ce=>w(J.id)},i(z(t)("item.unassign")),9,Ak)],64)):F("",!0)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),p.value?(C(),B(de,{key:0,title:z(t)("item.item"),showCancel:!0,showOk:!0,width:"400px",onClose:r,onConfirm:_},{default:m(()=>[s(ge,{layout:"vertical"},{default:m(()=>[s(ae,{label:z(t)("item.please_choose")},{default:m(()=>[s(Re,{value:$.value.item_id,"onUpdate:value":A[0]||(A[0]=J=>$.value.item_id=J),multiple:!0,placeholder:z(t)("item.please_choose"),options:u.value},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1}),e("p",null,[e("a",Dk,i(z(t)("item.go_to_new_an_item")),1)])]),_:1},8,["title"])):F("",!0),f.value?(C(),B(de,{key:1,title:z(t)("item.adjust_member_authority"),showCancel:!1,showOk:!1,width:"800px",onClose:x},{default:m(()=>[e("p",null,[e("a",{onClick:M},i(z(t)("item.all_member_read")),1)]),s(E,{dataSource:v.value,pagination:!1,emptyText:z(t)("item.team_member_empty_tips")},{default:m(()=>[s(P,{key:"member_username",title:z(t)("item.username")},{default:m(({record:J})=>[O(i(J.member_username),1)]),_:1},8,["title"]),s(P,{key:"name",title:z(t)("item.name")},{default:m(({record:J})=>[O(i(J.name),1)]),_:1},8,["title"]),s(P,{key:"member_group_id",title:z(t)("item.authority"),width:"130"},{default:m(({record:J})=>[s(ee,{size:"small",value:J.member_group_id,"onUpdate:value":ce=>J.member_group_id=ce,style:{width:"100%"},onChange:ce=>I(ce,J.id)},{default:m(()=>[s(fe,{value:"1"},{default:m(()=>[O(i(z(t)("item.edit_member")),1)]),_:1}),s(fe,{value:"0"},{default:m(()=>[O(i(z(t)("item.readonly_member")),1)]),_:1}),s(fe,{value:"2"},{default:m(()=>[O(i(z(t)("item.item_admin")),1)]),_:1})]),_:1},8,["value","onUpdate:value","onChange"])]),_:1},8,["title"]),s(P,{key:"cat_ids",title:z(t)("item.catalog"),width:"200"},{default:m(({record:J})=>[J.member_group_id<="1"?(C(),B(ee,{key:0,size:"small",value:J.cat_ids,"onUpdate:value":ce=>J.cat_ids=ce,mode:"multiple",style:{width:"100%"},onChange:ce=>S(ce,J.id)},{default:m(()=>[(C(!0),L(Ce,null,Pe(d.value,ce=>(C(),B(fe,{key:ce.cat_id,value:ce.cat_id},{default:m(()=>[O(i(ce.cat_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):F("",!0)]),_:1},8,["title"]),s(P,{key:"addtime",title:z(t)("item.add_time")},{default:m(({record:J})=>[O(i(J.addtime),1)]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"]),e("p",Ok,i(z(t)("item.team_member_authority_tips")),1)]),_:1},8,["title"])):F("",!0)],64)}}});const Ka=Y(Fk,[["__scopeId","data-v-2a424623"]]),IS=Object.freeze(Object.defineProperty({__proto__:null,default:Ka},Symbol.toStringTag,{value:"Module"})),qk=["onClick"],Rk=["onClick"],Hk=["onClick"],Ek=["onClick"],jk=["onClick"],Bk=["onClick"],Gk=["onClick"],Kk=["onClick"],Jk={class:"tips-text"},Wk=W({__name:"Index",props:{callback:{type:Function}},setup(c){const{t}=te(),a=c,o=b([]),l=b({id:0,team_manage:0,team_name:""}),u=b(""),v=b(!1),d=b(!1),p=b(!1),f=b(!1),$=b({team_name:""}),g=b({team_id:"",username:"",password:""}),n=async()=>{try{const A=await Wt();A.error_code===0&&(o.value=A.data||[])}catch(A){console.error("获取团队列表失败:",A)}},y=()=>{u.value="",$.value={team_name:""},v.value=!0},k=A=>{u.value=A.id,$.value={team_name:A.team_name},v.value=!0},r=()=>{v.value=!1,$.value={team_name:""}},_=async()=>{try{const A=await Rt({id:u.value,team_name:$.value.team_name});A.error_code===0?(j.success(t("common.op_success")),v.value=!1,$.value={team_name:""},u.value="",n()):j.error(A.error_message||t("common.op_failed"))}catch(A){console.error("保存团队失败:",A),j.error(t("common.op_failed"))}},h=async A=>{if(await Se.confirm({title:t("item.confirm_delete"),content:t("item.confirm_delete_team")}))try{const D=await Ca(A);D.error_code===0?(j.success(t("common.op_success")),n()):j.error(D.error_message||t("common.op_failed"))}catch(D){console.error("删除团队失败:",D),j.error(t("common.op_failed"))}},w=A=>{g.value={team_id:A.id,username:"",password:""},d.value=!0},T=()=>{d.value=!1,g.value={team_id:"",username:"",password:""}},x=async()=>{try{const A=await ka(g.value.team_id,g.value.username,g.value.password);A.error_code===0?(j.success(t("common.op_success")),d.value=!1,g.value={team_id:"",username:"",password:""},n()):j.error(A.error_message||t("common.op_failed"))}catch(A){console.error("转让团队失败:",A),j.error(t("common.op_failed"))}},I=async A=>{if(await Se.confirm({title:t("item.team_exit_confirm"),content:t("item.team_exit_confirm_content")}))try{const D=await xa(A);D.error_code===0?(j.success(t("common.op_success")),n()):j.error(D.error_message||t("common.op_failed"))}catch(D){console.error("退出团队失败:",D),j.error(t("common.op_failed"))}},S=A=>{l.value=A,p.value=!0},M=A=>{l.value=A,f.value=!0},V=()=>{p.value=!1,n()},U=()=>{f.value=!1,n()},N=()=>{a.callback&&a.callback()};return oe(()=>{n()}),(A,P)=>{const D=H("a-table-column"),E=H("a-divider"),ae=H("a-table"),ge=H("a-form-item"),fe=H("a-form");return C(),L(Ce,null,[s(de,{show:!0,title:z(t)("item.team_mamage"),showCancel:!1,showOk:!1,width:"800px",onClose:N},{extraButtons:m(()=>[s(K,{type:"primary",onClick:y},{default:m(()=>[P[3]||(P[3]=e("i",{class:"fas fa-plus mr-2"},null,-1)),O(" "+i(z(t)("item.add_team")),1)]),_:1})]),default:m(()=>[s(ae,{dataSource:o.value,pagination:!1,emptyText:z(t)("item.empty_team_tips")},{default:m(()=>[s(D,{key:"team_name",title:z(t)("item.team_name")},{default:m(({record:ee})=>[O(i(ee.team_name),1)]),_:1},8,["title"]),s(D,{key:"memberCount",title:z(t)("item.memberCount")},{default:m(({record:ee})=>[e("a",{onClick:J=>S(ee)},i(ee.memberCount),9,qk)]),_:1},8,["title"]),s(D,{key:"itemCount",title:z(t)("item.itemCount")},{default:m(({record:ee})=>[e("a",{onClick:J=>M(ee)},i(ee.itemCount),9,Rk)]),_:1},8,["title"]),s(D,{key:"operation",title:z(t)("item.operation")},{default:m(({record:ee})=>[e("a",{onClick:J=>S(ee)},i(z(t)("item.member")),9,Hk),s(E,{type:"vertical"}),e("a",{onClick:J=>M(ee)},i(z(t)("item.team_item")),9,Ek),ee.team_manage==1||ee.team_manage==2?(C(),L(Ce,{key:0},[s(E,{type:"vertical"}),e("a",{onClick:J=>k(ee)},i(z(t)("item.edit")),9,jk),s(E,{type:"vertical"}),e("a",{onClick:J=>w(ee)},i(z(t)("item.attorn_team")),9,Bk),s(E,{type:"vertical"}),e("a",{onClick:J=>h(ee.id)},i(z(t)("item.delete")),9,Gk)],64)):(C(),L(Ce,{key:1},[s(E,{type:"vertical"}),e("a",{onClick:J=>I(ee.id)},i(z(t)("item.team_exit")),9,Kk)],64))]),_:1},8,["title"])]),_:1},8,["dataSource","emptyText"])]),_:1},8,["title"]),v.value?(C(),B(de,{key:0,title:u.value?z(t)("item.edit_team"):z(t)("item.add_team"),showCancel:!0,showOk:!0,width:"400px",onClose:r,onConfirm:_},{default:m(()=>[s(fe,{layout:"vertical"},{default:m(()=>[s(ge,{label:z(t)("item.team_name")},{default:m(()=>[s(ne,{modelValue:$.value.team_name,"onUpdate:modelValue":P[0]||(P[0]=ee=>$.value.team_name=ee),placeholder:z(t)("item.team_name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1},8,["title"])):F("",!0),d.value?(C(),B(de,{key:1,title:z(t)("item.attorn_team"),showCancel:!0,showOk:!0,width:"400px",onClose:T,onConfirm:x},{default:m(()=>[s(fe,{layout:"vertical"},{default:m(()=>[s(ge,{label:z(t)("item.attorn_username")},{default:m(()=>[s(ne,{modelValue:g.value.username,"onUpdate:modelValue":P[1]||(P[1]=ee=>g.value.username=ee),placeholder:z(t)("item.attorn_username"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(ge,{label:z(t)("item.input_login_password")},{default:m(()=>[s(ne,{modelValue:g.value.password,"onUpdate:modelValue":P[2]||(P[2]=ee=>g.value.password=ee),type:"password",placeholder:z(t)("item.input_login_password"),"auto-complete":"new-password"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e("p",Jk,i(z(t)("item.attornTeamTips")),1)]),_:1},8,["title"])):F("",!0),p.value?(C(),B(Ga,{key:2,team_id:l.value.id,team_manage:l.value.team_manage,callback:V},null,8,["team_id","team_manage"])):F("",!0),f.value?(C(),B(Ka,{key:3,team_id:l.value.id,team_manage:l.value.team_manage,callback:U},null,8,["team_id","team_manage"])):F("",!0)],64)}}});const Yk=Y(Wk,[["__scopeId","data-v-a0382503"]]),SS=Object.freeze(Object.defineProperty({__proto__:null,default:Yk},Symbol.toStringTag,{value:"Module"})),Xk={class:"message-page"},Qk=W({__name:"Index",setup(c){const t=Ge();return oe(()=>{const a=t.query.dtab;sa(a)}),(a,o)=>(C(),L("div",Xk))}});const Zk=Y(Qk,[["__scopeId","data-v-e34b9a7d"]]),TS=Object.freeze(Object.defineProperty({__proto__:null,default:Zk},Symbol.toStringTag,{value:"Module"})),e2={class:"attachment-page"},t2=W({__name:"Index",setup(c){return(t,a)=>{const o=H("router-link");return C(),L("div",e2,[e("h2",null,i(t.$t("attachment.my_attachment")),1),a[0]||(a[0]=e("p",null,"页面开发中...",-1)),s(o,{to:"/item/index"},{default:m(()=>[O(i(t.$t("common.goback")),1)]),_:1})])}}});const a2=Y(t2,[["__scopeId","data-v-5e0198e1"]]),MS=Object.freeze(Object.defineProperty({__proto__:null,default:a2},Symbol.toStringTag,{value:"Module"})),o2={class:"modal-form"},s2={class:"form-group"},l2={class:"form-label"},n2={class:"form-group"},i2={class:"form-label"},r2={class:"form-group"},c2={class:"form-label"},d2=["placeholder"],u2={class:"modal-footer"},m2=W({__name:"index",props:{user:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=We({username:"",name:"",password:"",uid:""});oe(()=>{o.value=!0,a.user&&(l.username=a.user.username||"",l.name=a.user.name||"",l.uid=a.user.uid)});const u=()=>a.onClose(!1),v=async()=>{try{const d={username:l.username,name:l.name,uid:l.uid};a.user?l.password&&(d.password=l.password):d.password=l.password,await Oo(d),j.success(t("common.save_success")),a.onClose(!0)}catch{j.error(t("common.save_failed"))}};return(d,p)=>(C(),B(de,{show:o.value,title:c.user?z(t)("admin.edit_user"):z(t)("admin.add_user"),width:"400px",onClose:u},{footer:m(()=>[e("div",u2,[s(K,{theme:"light",text:z(t)("common.cancel"),onClick:u},null,8,["text"]),s(K,{theme:"dark",text:z(t)("common.confirm"),onClick:v},null,8,["text"])])]),default:m(()=>[e("div",o2,[e("div",s2,[e("label",l2,i(z(t)("admin.username")),1),s(ne,{modelValue:l.username,"onUpdate:modelValue":p[0]||(p[0]=f=>l.username=f),placeholder:z(t)("admin.username_placeholder"),disabled:!!c.user},null,8,["modelValue","placeholder","disabled"])]),e("div",n2,[e("label",i2,i(z(t)("admin.name")),1),s(ne,{modelValue:l.name,"onUpdate:modelValue":p[1]||(p[1]=f=>l.name=f),placeholder:z(t)("admin.name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",r2,[e("label",c2,i(z(t)("user.password")),1),ft(e("input",{"onUpdate:modelValue":p[2]||(p[2]=f=>l.password=f),type:"password",class:"password-input",placeholder:c.user?z(t)("admin.password_tip"):z(t)("user.password")},null,8,d2),[[qt,l.password]])])])]),_:1},8,["show","title"]))}});const _2=Y(m2,[["__scopeId","data-v-06150037"]]);function fa(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(_2,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const p2={class:"user-management"},f2={class:"search-section"},v2={class:"search-row"},h2={class:"search-input"},g2={class:"table-section"},y2={class:"table-action-buttons"},w2=["onClick"],b2=["onClick"],$2=W({__name:"UserManagement",setup(c){const{t}=te(),a=b(""),o=b([]),l=b(!1),u=We({current:1,pageSize:10,total:0}),v=q(()=>[{title:t("admin.username"),key:"username",width:140},{title:t("user.name"),key:"name",width:100},{title:t("admin.user_role"),key:"groupid",width:90,center:!0},{title:t("admin.mobile"),key:"mobile",width:130},{title:t("admin.register_time"),key:"reg_time",width:160},{title:t("admin.last_login_time"),key:"last_login_time",width:170},{title:t("common.operation"),key:"action",width:200,center:!0}]),d=async()=>{l.value=!0;try{const r=await No({username:a.value,page:u.current,count:u.pageSize});o.value=r.data.users||[],u.total=r.data.total||0}catch(r){console.error("获取用户列表失败:",r)}finally{l.value=!1}},p=r=>Number(r.groupid)===1?"admin":Number(r.groupid)===2?"normal":"unknown",f=r=>Number(r.groupid)===1?t("admin.admin"):Number(r.groupid)===2?t("admin.normal_user"):t("admin.unknown"),$=()=>{u.current=1,d()},g=(r,_)=>{u.current=r,u.pageSize=_,d()},n=async()=>{await fa()&&d()},y=async r=>{await fa({user:r})&&d()},k=async r=>{if(await Se(t("common.confirm_delete")))try{await Fo({uid:r.uid}),j.success(t("admin.delete_success")),d()}catch{j.error(t("common.delete_failed"))}};return oe(()=>{d()}),(r,_)=>(C(),L("div",p2,[e("div",f2,[e("div",v2,[e("div",h2,[s(ne,{modelValue:a.value,"onUpdate:modelValue":_[0]||(_[0]=h=>a.value=h),placeholder:r.$t("admin.username_search_placeholder")},null,8,["modelValue","placeholder"])]),s(K,{theme:"dark",text:r.$t("common.search"),leftIcon:["fas","search"],onClick:$},null,8,["text"]),s(K,{theme:"light",text:r.$t("admin.add_user"),leftIcon:["fas","plus"],onClick:n},null,8,["text"])])]),e("div",g2,[s(Le,{"table-header":v.value,"table-data":o.value,pagination:u,loading:l.value,"row-key":"uid","max-height":"calc(100vh - 280px)",onPageChange:g},{"cell-groupid":m(({row:h})=>[e("span",{class:re(["role-badge",p(h)])},i(f(h)),3)]),"cell-action":m(({row:h})=>[e("div",y2,[e("span",{class:"table-action-btn edit",onClick:w=>y(h)},[_[1]||(_[1]=e("i",{class:"fas fa-edit"},null,-1)),O(" "+i(r.$t("common.edit")),1)],8,w2),e("span",{class:"table-action-btn delete",onClick:w=>k(h)},[_[2]||(_[2]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(r.$t("common.delete")),1)],8,b2)])]),_:1},8,["table-header","table-data","pagination","loading"])])]))}});const k2=Y($2,[["__scopeId","data-v-8250dc19"]]),C2=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){te();const t=c,a=b(!1),o=b(""),l=()=>t.onClose(!1,null),u=()=>t.onClose(!0,{username:o.value});return oe(()=>{a.value=!0}),(v,d)=>(C(),B(de,{show:a.value,title:v.$t("admin.attorn"),width:"300px",onClose:l},{footer:m(()=>[s(K,{theme:"light",text:v.$t("common.cancel"),onClick:l},null,8,["text"]),s(K,{theme:"dark",text:v.$t("admin.attorn"),onClick:u},null,8,["text"])]),default:m(()=>[s(ne,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=p=>o.value=p),placeholder:v.$t("admin.attorn_username_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["show","title"]))}});function x2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(C2,{...c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const I2={class:"modal-form"},S2={class:"form-label"},T2={class:"modal-footer"},M2=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b(""),u=()=>a.onClose(!1),v=async()=>{if(!l.value.trim()){j.warning(t("admin.input_member_username"));return}try{await Sa({item_id:String(a.item_id),username:l.value,member_group_id:1}),j.success(t("admin.add_member_success")),a.onClose(!0,l.value)}catch{j.error(t("common.op_failed"))}};return oe(()=>{o.value=!0}),(d,p)=>(C(),B(de,{show:o.value,title:d.$t("admin.add_member"),width:"400px",top:"10vh",onClose:u},{footer:m(()=>[e("div",T2,[s(K,{theme:"light",text:d.$t("common.cancel"),onClick:u},null,8,["text"]),s(K,{theme:"dark",text:d.$t("common.confirm"),onClick:v},null,8,["text"])])]),default:m(()=>[e("div",I2,[e("label",S2,i(d.$t("admin.member_username")),1),s(ne,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=f=>l.value=f),placeholder:d.$t("admin.input_member_username")},null,8,["modelValue","placeholder"])])]),_:1},8,["show","title"]))}});const L2=Y(M2,[["__scopeId","data-v-03a1d29e"]]);function V2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(L2,{...c,onClose:(l,u)=>{t(l&&u||null),me(a,o)}});a.mount(o)})}const z2={key:1,class:"tip-text"},U2=W({__name:"index",props:{team_id:{},onClose:{type:Function}},setup(c){const{t}=te(),a=c,o=b(!1),l=b([]),u=q(()=>[{title:t("admin.username"),key:"member_username",width:140},{title:t("user.name"),key:"name",width:140},{title:t("admin.join_time"),key:"addtime",width:160}]),v=async()=>{try{const p=await Bt(a.team_id);l.value=p.data||[]}catch(p){console.error("获取团队成员失败:",p)}},d=()=>a.onClose();return oe(()=>{o.value=!0,v()}),(p,f)=>(C(),B(de,{show:o.value,title:p.$t("admin.team_members"),width:"650px","show-footer":!1,onClose:d},{default:m(()=>[l.value.length>0?(C(),B(Le,{key:0,"table-header":u.value,"table-data":l.value,pagination:!1,"row-key":"id","max-height":"400px"},null,8,["table-header","table-data"])):(C(),L("p",z2,i(p.$t("admin.no_team_member")),1))]),_:1},8,["show","title"]))}});const P2=Y(U2,[["__scopeId","data-v-4ec87f4d"]]);function A2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(P2,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const D2={class:"modal-toolbar"},O2={key:0,class:"member-content"},N2={key:0,class:"tip-text"},F2={class:"table-action-buttons"},q2=["onClick"],R2={key:1,class:"member-content"},H2={key:0,class:"tip-text"},E2={key:1,class:"tip-text"},j2={class:"table-action-buttons"},B2=["onClick"],G2=W({__name:"index",props:{item_id:{},onClose:{type:Function}},setup(c){const t=c,{t:a}=te(),o=b(!1),l=b("members"),u=b([]),v=b([]),d=q(()=>[{text:a("admin.project_members"),value:"members"},{text:a("admin.project_teams"),value:"teams"}]),p=q(()=>[{title:a("admin.member_username"),key:"username",width:120},{title:a("user.name"),key:"name",width:120},{title:a("admin.add_time"),key:"addtime",width:140},{title:a("admin.authority"),key:"member_group",width:100,center:!0},{title:a("common.operation"),key:"action",width:80,center:!0}]),f=q(()=>[{title:a("admin.team_name"),key:"team_name",width:160},{title:a("admin.creator"),key:"username",width:120},{title:a("admin.bind_time"),key:"addtime",width:150},{title:a("common.operation"),key:"action",width:100,center:!0}]),$=h=>{l.value=h,h==="members"&&u.value.length===0?g():h==="teams"&&v.value.length===0&&n()},g=async()=>{try{const h=await Ta(String(t.item_id));u.value=h.data||[]}catch(h){console.error("获取成员列表失败:",h)}},n=async()=>{try{const h=await Ma(String(t.item_id));v.value=h.data||[]}catch(h){console.error("获取团队列表失败:",h)}},y=async()=>{await V2({item_id:t.item_id})&&g()},k=async h=>{if(await Se(a("common.confirm_delete")))try{await La(String(t.item_id),h.item_member_id),g()}catch{j.error(a("common.delete_failed"))}},r=async h=>{await A2({team_id:h.team_id})},_=()=>t.onClose();return oe(()=>{o.value=!0,g(),n()}),(h,w)=>(C(),B(de,{show:o.value,title:h.$t("admin.member_manage"),width:"700px",onClose:_},{default:m(()=>[e("div",D2,[s(K,{theme:"dark",text:h.$t("admin.add_member"),leftIcon:["fas","plus"],onClick:y},null,8,["text"])]),s(vt,{items:d.value,value:l.value,type:"segmented",onUpdateValue:$},null,8,["items","value"]),l.value==="members"?(C(),L("div",O2,[u.value.length>0?(C(),L("p",N2,i(h.$t("admin.member_tip")),1)):F("",!0),u.value.length>0?(C(),B(Le,{key:1,"table-header":p.value,"table-data":u.value,pagination:!1,"row-key":"item_member_id","max-height":"250px"},{"cell-action":m(({row:T})=>[e("div",F2,[e("span",{class:"table-action-btn delete",onClick:x=>k(T)},[w[0]||(w[0]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(h.$t("common.delete")),1)],8,q2)])]),_:1},8,["table-header","table-data"])):F("",!0)])):(C(),L("div",R2,[v.value.length>0?(C(),L("p",H2,i(h.$t("admin.team_tip")),1)):(C(),L("p",E2,i(h.$t("admin.no_team")),1)),v.value.length>0?(C(),B(Le,{key:2,"table-header":f.value,"table-data":v.value,pagination:!1,"row-key":"id","max-height":"250px"},{"cell-action":m(({row:T})=>[e("div",j2,[e("span",{class:"table-action-btn view",onClick:x=>r(T)},[w[1]||(w[1]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(h.$t("admin.view_member")),1)],8,B2)])]),_:1},8,["table-header","table-data"])):F("",!0)]))]),_:1},8,["show","title"]))}});const K2=Y(G2,[["__scopeId","data-v-855f8138"]]);function J2(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(K2,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const W2={class:"item-management"},Y2={class:"search-section"},X2={class:"search-row"},Q2={class:"search-input"},Z2={class:"search-selector"},e8={class:"search-input"},t8={class:"search-selector"},a8={class:"table-section"},o8=["onClick"],s8={key:1,class:"deleted-text"},l8=["onClick"],n8={key:0,class:"table-action-buttons"},i8=["onClick"],r8=["onClick"],c8=["onClick"],d8={key:1,class:"table-action-buttons"},u8=["onClick"],m8=["onClick"],_8=W({__name:"ItemManagement",setup(c){const{t}=te(),a=xe(),o=b([]),l=b(!1),u=b("0"),v=q(()=>[{text:t("admin.item_tab_list"),value:"0"},{text:t("admin.item_tab_deleted"),value:"1"}]),d=P=>{u.value=P,x()},p=b(""),f=b(""),$=b("-1"),g=b("1"),n=b(t("admin.all_item_type")),y=b(t("admin.all_privacy_type")),k=We({current:1,pageSize:10,total:0}),r=q(()=>[{label:t("admin.all_item_type"),value:"-1"},{label:t("admin.normal_item"),value:"1"},{label:t("admin.single_page_item"),value:"2"},{label:t("admin.runapi_item"),value:"3"},{label:t("admin.table_item"),value:"4"}]),_=q(()=>[{label:t("admin.all_privacy_type"),value:"1"},{label:t("admin.public_items"),value:"2"},{label:t("admin.private_items"),value:"3"}]),h=q(()=>[{title:t("admin.item_name"),key:"item_name",width:160},{title:t("admin.item_desc"),key:"item_description",width:180},{title:t("admin.privacy"),key:"password",width:150,center:!0},{title:t("admin.access_link"),key:"item_id",width:130,center:!0},{title:t("admin.owner"),key:"username",width:140},{title:t("admin.member_count"),key:"member_num",width:100,center:!0},{title:t("admin.create_time"),key:"addtime",width:160},...u.value==="1"?[{title:t("admin.delete_time"),key:"del_time",width:160}]:[],{title:t("common.operation"),key:"action",width:220,center:!0}]),w=async()=>{l.value=!0;try{const P=await Aa({item_name:p.value,username:f.value,page:k.current,count:k.pageSize,item_type:$.value,privacy_type:g.value,is_del:u.value});o.value=P.data.items||[],k.total=P.data.total||0}catch(P){console.error("获取项目列表失败:",P)}finally{l.value=!1}},T=P=>P.password?t("admin.password_access"):t("admin.public_access"),x=()=>{k.current=1,w()},I=(P,D)=>{k.current=P,k.pageSize=D,w()},S=P=>{const D=a.resolve({path:`/${P.item_id}`}).href;window.open(D,"_blank")},M=async P=>{const D=await x2({item_id:P.item_id});if(D&&D.username)try{await qo({item_id:P.item_id,username:D.username}),j.success(t("common.save_success")),w()}catch{j.error(t("common.save_failed"))}},V=async P=>{if(await Se(t("common.confirm_delete")))try{await Ro({item_id:P.item_id}),j.success(t("common.delete_success")),w()}catch{j.error(t("common.delete_failed"))}},U=async P=>{if(await Se(t("admin.confirm_recover")))try{await Ho({item_id:P.item_id}),j.success(t("admin.recover_success")),w()}catch{j.error(t("common.op_failed"))}},N=async P=>{if(await Se({title:t("admin.confirm_permanent_delete"),msg:t("admin.permanent_delete_warning")}))try{await Eo({item_id:P.item_id}),j.success(t("admin.permanent_delete_success")),w()}catch{j.error(t("common.op_failed"))}},A=async P=>{await J2({item_id:P.item_id})};return oe(()=>{w()}),(P,D)=>{const E=H("CommonTab");return C(),L("div",W2,[s(E,{items:v.value,value:u.value,type:"segmented",onUpdateValue:d},null,8,["items","value"]),e("div",Y2,[e("div",X2,[e("div",Q2,[s(ne,{modelValue:p.value,"onUpdate:modelValue":D[0]||(D[0]=ae=>p.value=ae),placeholder:P.$t("admin.item_name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",Z2,[s(Re,{"selector-label":n.value,"selector-value":$.value,options:r.value,"onUpdate:selectorLabel":D[1]||(D[1]=ae=>n.value=ae),"onUpdate:selectorValue":D[2]||(D[2]=ae=>$.value=ae)},null,8,["selector-label","selector-value","options"])]),e("div",e8,[s(ne,{modelValue:f.value,"onUpdate:modelValue":D[3]||(D[3]=ae=>f.value=ae),placeholder:P.$t("admin.owner_placeholder")},null,8,["modelValue","placeholder"])]),e("div",t8,[s(Re,{"selector-label":y.value,"selector-value":g.value,options:_.value,"onUpdate:selectorLabel":D[4]||(D[4]=ae=>y.value=ae),"onUpdate:selectorValue":D[5]||(D[5]=ae=>g.value=ae)},null,8,["selector-label","selector-value","options"])]),s(K,{theme:"dark",text:P.$t("common.search"),leftIcon:["fas","search"],onClick:x},null,8,["text"])])]),e("div",a8,[s(Le,{"table-header":h.value,"table-data":o.value,pagination:k,loading:l.value,"row-key":"item_id","max-height":"calc(100vh - 350px)",onPageChange:I},{"cell-password":m(({row:ae})=>[e("span",{class:re(["privacy-badge",ae.password?"private":"public"])},i(T(ae)),3)]),"cell-item_id":m(({row:ae})=>[u.value==="0"?(C(),L("span",{key:0,class:"link-btn",onClick:ge=>S(ae)},i(P.$t("admin.view")),9,o8)):(C(),L("span",s8,i(P.$t("admin.deleted")),1))]),"cell-member_num":m(({row:ae})=>[e("span",{class:"member-btn",onClick:ge=>A(ae)},i(ae.member_num),9,l8)]),"cell-action":m(({row:ae})=>[u.value==="0"?(C(),L("div",n8,[e("span",{class:"table-action-btn attorn",onClick:ge=>M(ae)},[D[6]||(D[6]=e("i",{class:"fas fa-exchange-alt"},null,-1)),O(" "+i(P.$t("admin.attorn")),1)],8,i8),e("span",{class:"table-action-btn member",onClick:ge=>A(ae)},[D[7]||(D[7]=e("i",{class:"fas fa-users"},null,-1)),O(" "+i(P.$t("admin.member_manage")),1)],8,r8),e("span",{class:"table-action-btn delete",onClick:ge=>V(ae)},[D[8]||(D[8]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(P.$t("common.delete")),1)],8,c8)])):(C(),L("div",d8,[e("span",{class:"table-action-btn recover",onClick:ge=>U(ae)},[D[9]||(D[9]=e("i",{class:"fas fa-undo"},null,-1)),O(" "+i(P.$t("admin.recover")),1)],8,u8),e("span",{class:"table-action-btn hard-delete",onClick:ge=>N(ae)},[D[10]||(D[10]=e("i",{class:"fas fa-trash"},null,-1)),O(" "+i(P.$t("admin.permanent_delete")),1)],8,m8)]))]),_:1},8,["table-header","table-data","pagination","loading"])])])}}});const p8=Y(_8,[["__scopeId","data-v-6b6d2513"]]),f8={class:"announcement-management"},v8={class:"publish-section"},h8={class:"section-header"},g8={class:"header-title"},y8={class:"publish-form"},w8={class:"form-row"},b8={class:"form-label"},$8={class:"radio-group"},k8={class:"radio-icon"},C8={key:0,class:"fas fa-circle"},x8={key:1,class:"far fa-circle"},I8={class:"radio-icon"},S8={key:0,class:"fas fa-circle"},T8={key:1,class:"far fa-circle"},M8={class:"radio-icon"},L8={key:0,class:"fas fa-circle"},V8={key:1,class:"far fa-circle"},z8={class:"form-row"},U8={class:"form-label"},P8={class:"form-row"},A8={class:"form-label"},D8={class:"tip-text"},O8={class:"form-actions"},N8={class:"table-section"},F8=["innerHTML"],q8=W({__name:"AnnouncementManagement",setup(c){const{t}=te(),a=b([]),o=b(!1),l=We({message_type:"announce_web",message_content:"",send_at:null}),u=We({current:1,pageSize:10,total:0}),v=q(()=>[{title:"ID",key:"id",width:80},{title:t("admin.announcement_type"),key:"message_type",width:140,center:!0},{title:t("admin.send_time"),key:"addtime",width:180},{title:t("admin.content"),key:"message_content",width:0}]),d=y=>{switch(y){case"announce_all":return"all";case"announce_runapi":return"runapi";default:return"web"}},p=y=>{switch(y){case"announce_all":return t("admin.announce_all");case"announce_runapi":return t("admin.announce_runapi_only");default:return t("admin.announce_web_only")}},f=async()=>{o.value=!0;try{const y=await jo({page:u.current,count:u.pageSize});a.value=y.data||[],u.total=u.current*u.pageSize+(a.value.length===u.pageSize?u.pageSize:0)}catch(y){console.error("获取公告列表失败:",y)}finally{o.value=!1}},$=async()=>{if(!l.message_content){j.error(t("admin.announcement_content_required"));return}if(await Se({title:t("admin.confirm_publish"),msg:t("admin.publish_warning")}))try{const k=l.send_at?qa(l.send_at).format("YYYY-MM-DD HH:mm:ss"):"";await Bo({message_type:l.message_type,message_content:l.message_content,send_at:k}),j.success(t("admin.publish_success")),g(),f()}catch{j.error(t("common.op_failed"))}},g=()=>{l.message_type="announce_web",l.message_content="",l.send_at=null},n=(y,k)=>{u.current=y,u.pageSize=k,f()};return oe(()=>{f()}),(y,k)=>{const r=H("a-date-picker");return C(),L("div",f8,[e("div",v8,[e("div",h8,[e("div",g8,[k[5]||(k[5]=e("i",{class:"fas fa-bullhorn"},null,-1)),e("span",null,i(y.$t("admin.publish_announcement")),1)])]),e("div",y8,[e("div",w8,[e("label",b8,i(y.$t("admin.announcement_type")),1),e("div",$8,[e("div",{class:re(["radio-item",{active:l.message_type==="announce_web"}]),onClick:k[0]||(k[0]=_=>l.message_type="announce_web")},[e("div",k8,[l.message_type==="announce_web"?(C(),L("i",C8)):(C(),L("i",x8))]),e("span",null,i(y.$t("admin.announce_web_only")),1)],2),e("div",{class:re(["radio-item",{active:l.message_type==="announce_runapi"}]),onClick:k[1]||(k[1]=_=>l.message_type="announce_runapi")},[e("div",I8,[l.message_type==="announce_runapi"?(C(),L("i",S8)):(C(),L("i",T8))]),e("span",null,i(y.$t("admin.announce_runapi_only")),1)],2),e("div",{class:re(["radio-item",{active:l.message_type==="announce_all"}]),onClick:k[2]||(k[2]=_=>l.message_type="announce_all")},[e("div",M8,[l.message_type==="announce_all"?(C(),L("i",L8)):(C(),L("i",V8))]),e("span",null,i(y.$t("admin.announce_all")),1)],2)])]),e("div",z8,[e("label",U8,i(y.$t("admin.announcement_content")),1),s(tt,{modelValue:l.message_content,"onUpdate:modelValue":k[3]||(k[3]=_=>l.message_content=_),placeholder:y.$t("admin.announcement_content_placeholder"),rows:6},null,8,["modelValue","placeholder"])]),e("div",P8,[e("label",A8,i(y.$t("admin.send_time")),1),s(r,{value:l.send_at,"onUpdate:value":k[4]||(k[4]=_=>l.send_at=_),"show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:y.$t("admin.send_time_placeholder"),style:{width:"100%",height:"40px"}},null,8,["value","placeholder"]),e("div",D8,i(y.$t("admin.send_time_tip")),1)]),e("div",O8,[s(K,{theme:"dark",text:y.$t("admin.send"),leftIcon:["fas","paper-plane"],onClick:$},null,8,["text"]),s(K,{theme:"light",text:y.$t("admin.reset"),leftIcon:["fas","redo"],onClick:g},null,8,["text"])])])]),e("div",N8,[s(Le,{"table-header":v.value,"table-data":a.value,pagination:u,loading:o.value,"row-key":"id","max-height":"calc(100vh - 450px)",onPageChange:n},{"cell-message_type":m(({row:_})=>[e("span",{class:re(["type-badge",d(_.message_type)])},i(p(_.message_type)),3)]),"cell-message_content":m(({row:_})=>[e("div",{class:"announcement-content",innerHTML:_.message_content},null,8,F8)]),_:1},8,["table-header","table-data","pagination","loading"])])])}}});const R8=Y(q8,[["__scopeId","data-v-3968eae0"]]),H8={class:"attachment-management"},E8={class:"search-section"},j8={class:"search-row"},B8={class:"search-input"},G8={class:"search-selector"},K8={class:"search-input"},J8={class:"cleanup-modal-body"},W8={class:"cleanup-search"},Y8={class:"table-action-buttons"},X8=["onClick"],Q8={class:"modal-footer"},Z8={class:"stats-section"},eC={class:"stats-card"},tC={class:"stats-content"},aC={class:"stats-label"},oC={class:"stats-value"},sC={class:"table-section"},lC={class:"table-action-buttons"},nC=["onClick"],iC=["onClick"],rC=W({__name:"AttachmentManagement",setup(c){const{t}=te(),a=b([]),o=b(!1),l=b([]),u=b(""),v=b(""),d=b("-1"),p=b(0),f=b(!1),$=b([]),g=b(!1),n=b([]),y=We({displayName:"",username:""}),k=We({current:1,pageSize:10,total:0}),r=b(t("admin.all_attachment_type")),_=We({current:1,pageSize:10,total:0}),h=q(()=>[{label:t("admin.all_attachment_type"),value:"-1"},{label:t("admin.image"),value:"1"},{label:t("admin.general_attachment"),value:"2"}]),w=q(()=>[{title:t("admin.file_id"),key:"file_id",width:100},{title:t("admin.display_name"),key:"display_name",width:200},{title:t("admin.file_type"),key:"file_type",width:140},{title:t("admin.file_size"),key:"file_size_m",width:120},{title:t("admin.visit_times"),key:"visit_times",width:100,center:!0},{title:t("admin.uploader"),key:"username",width:140},{title:t("admin.add_time"),key:"addtime",width:160},{title:t("common.operation"),key:"action",width:240,center:!0}]),T=q(()=>[{title:t("admin.file_id"),key:"file_id",width:100},{title:t("admin.display_name"),key:"display_name",width:200},{title:t("admin.file_type"),key:"file_type",width:140},{title:t("admin.file_size"),key:"file_size_m",width:140},{title:t("admin.uploader"),key:"username",width:140},{title:t("admin.add_time"),key:"addtime",width:160},{title:t("common.operation"),key:"action",width:120,center:!0}]),x=q(()=>({selectedRowKeys:l.value,onChange:J=>{l.value=J}})),I=q(()=>({selectedRowKeys:n.value,onChange:J=>{n.value=J}})),S=async()=>{o.value=!0;try{const J=await Go({page:_.current,count:_.pageSize,attachment_type:d.value,display_name:u.value,username:v.value});a.value=J.data.list||[],_.total=parseInt(J.data.total)||0,p.value=J.data.used_m||0}catch(J){console.error("获取附件列表失败:",J)}finally{o.value=!1}},M=()=>{_.current=1,S()},V=(J,ce)=>{_.current=J,_.pageSize=ce,S()},U=(J,ce)=>{l.value=J},N=J=>{window.open(J.url)},A=async J=>{if(await Se(t("common.confirm_delete")))try{await Ko({file_id:J.file_id}),j.success(t("common.op_success")),S()}catch{j.error(t("common.op_failed"))}},P=()=>{f.value=!0,k.current=1,E()},D=()=>{f.value=!1,n.value=[],y.displayName="",y.username=""},E=async()=>{g.value=!0;try{const J=await Jo({page:k.current,count:k.pageSize,display_name:y.displayName,username:y.username});$.value=J.data.list||[],k.total=parseInt(J.data.total)||0}catch(J){console.error("获取未使用附件列表失败:",J)}finally{g.value=!1}},ae=()=>{k.current=1,E()},ge=(J,ce)=>{k.current=J,k.pageSize=ce,E()},fe=(J,ce)=>{n.value=J},ee=async()=>{if(n.value.length===0){j.warning(t("admin.please_select_to_delete"));return}if(await Se({title:t("admin.confirm_delete_selected"),msg:t("admin.confirm_delete_selected_message")}))try{await Wo({file_ids:n.value.join(",")}),j.success(t("common.op_success")),E(),S(),n.value=[]}catch{j.error(t("common.op_failed"))}};return oe(()=>{S()}),(J,ce)=>(C(),L("div",H8,[e("div",E8,[e("div",j8,[e("div",B8,[s(ne,{modelValue:u.value,"onUpdate:modelValue":ce[0]||(ce[0]=ye=>u.value=ye),placeholder:J.$t("admin.display_name_placeholder")},null,8,["modelValue","placeholder"])]),e("div",G8,[s(Re,{"selector-label":r.value,"selector-value":d.value,options:h.value,"onUpdate:selectorLabel":ce[1]||(ce[1]=ye=>r.value=ye),"onUpdate:selectorValue":ce[2]||(ce[2]=ye=>d.value=ye)},null,8,["selector-label","selector-value","options"])]),e("div",K8,[s(ne,{modelValue:v.value,"onUpdate:modelValue":ce[3]||(ce[3]=ye=>v.value=ye),placeholder:J.$t("admin.uploader")},null,8,["modelValue","placeholder"])]),s(K,{theme:"dark",text:J.$t("common.search"),leftIcon:["fas","search"],onClick:M},null,8,["text"]),s(K,{theme:"light",text:J.$t("admin.cleanup_unused_attachments"),leftIcon:["fas","broom"],onClick:P},null,8,["text"])])]),s(de,{show:f.value,title:J.$t("admin.cleanup_dialog_title"),width:"80%",onClose:D},{footer:m(()=>[e("div",Q8,[s(K,{theme:"light",text:J.$t("common.cancel"),onClick:D},null,8,["text"]),s(K,{theme:"dark",text:J.$t("admin.delete_selected"),disabled:n.value.length===0,onClick:ee},null,8,["text","disabled"])])]),default:m(()=>[e("div",J8,[e("div",W8,[s(ne,{modelValue:y.displayName,"onUpdate:modelValue":ce[4]||(ce[4]=ye=>y.displayName=ye),placeholder:J.$t("admin.display_name_placeholder")},null,8,["modelValue","placeholder"]),s(ne,{modelValue:y.username,"onUpdate:modelValue":ce[5]||(ce[5]=ye=>y.username=ye),placeholder:J.$t("admin.uploader")},null,8,["modelValue","placeholder"]),s(K,{theme:"dark",text:J.$t("common.search"),leftIcon:["fas","search"],onClick:ae},null,8,["text"])]),s(Le,{"table-header":T.value,"table-data":$.value,"row-selection":I.value,pagination:k,loading:g.value,"row-key":"file_id","max-height":"500px",onPageChange:ge,onSelectionChange:fe},{"cell-action":m(({row:ye})=>[e("div",Y8,[e("span",{class:"table-action-btn visit",onClick:ze=>N(ye)},[ce[6]||(ce[6]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(J.$t("admin.visit")),1)],8,X8)])]),_:1},8,["table-header","table-data","row-selection","pagination","loading"])])]),_:1},8,["show","title"]),e("div",Z8,[e("div",eC,[ce[7]||(ce[7]=e("div",{class:"stats-icon"},[e("i",{class:"fas fa-hdd"})],-1)),e("div",tC,[e("div",aC,i(J.$t("admin.accumulated_used_space")),1),e("div",oC,i(p.value)+"M",1)])])]),e("div",sC,[s(Le,{"table-header":w.value,"table-data":a.value,"row-selection":x.value,pagination:_,loading:o.value,"row-key":"file_id","max-height":"calc(100vh - 380px)",onPageChange:V,onSelectionChange:U},{"cell-action":m(({row:ye})=>[e("div",lC,[e("span",{class:"table-action-btn visit",onClick:ze=>N(ye)},[ce[8]||(ce[8]=e("i",{class:"fas fa-eye"},null,-1)),O(" "+i(J.$t("admin.visit")),1)],8,nC),e("span",{class:"table-action-btn delete",onClick:ze=>A(ye)},[ce[9]||(ce[9]=e("i",{class:"fas fa-trash-alt"},null,-1)),O(" "+i(J.$t("common.delete")),1)],8,iC)])]),_:1},8,["table-header","table-data","row-selection","pagination","loading"])])]))}});const cC=Y(rC,[["__scopeId","data-v-6fb5aec0"]]),dC={class:"ext-login"},uC={class:"settings-container"},mC={class:"tab-content"},_C={class:"form-row"},pC={class:"form-label"},fC={class:"form-row"},vC={class:"form-label"},hC={class:"form-row"},gC={class:"form-label"},yC={class:"form-row"},wC={class:"form-label"},bC={class:"form-row"},$C={class:"form-label"},kC={class:"form-row"},CC={class:"form-label"},xC={class:"form-row"},IC={class:"form-label"},SC={class:"form-row"},TC={class:"form-label"},MC={class:"form-row"},LC={class:"form-label"},VC={class:"form-row"},zC={class:"form-label"},UC={class:"form-row form-actions"},PC={class:"tab-content"},AC={class:"form-row"},DC={class:"form-label"},OC={class:"form-row"},NC={class:"form-label"},FC={class:"form-row"},qC={class:"form-label"},RC={class:"form-row"},HC={class:"form-label"},EC={class:"form-row"},jC={class:"form-label"},BC={class:"form-row"},GC={class:"form-label"},KC={class:"form-row"},JC={class:"form-label"},WC={class:"form-row"},YC={class:"form-label"},XC={class:"form-row"},QC={class:"form-label"},ZC={class:"form-row"},ex={class:"form-label"},tx={class:"form-row"},ax={class:"form-label"},ox={class:"form-row"},sx={class:"form-label"},lx={class:"tab-content"},nx={class:"form-row"},ix={class:"form-label"},rx={class:"form-row form-actions"},cx={class:"save-button-wrapper"},dx=W({__name:"ExtLogin",setup(c){const{t}=te(),a=b("ldap"),o=b(!1),l=b(!1),u=q(()=>[{text:t("admin.ldap_login"),value:"ldap"},{text:t("admin.oauth2_login"),value:"oauth2"},{text:t("admin.general_login"),value:"general"}]),v=r=>{a.value=String(r)},d=We({ldap_open:"0",ldap_form:{host:"",port:"389",version:"3",base_dn:"",bind_dn:"",bind_password:"",user_field:"",name_field:"",search_filter:"(cn=*)"}}),p=We({oauth2_open:"0",oauth2_form:{redirectUri:"",entrance_tips:"",client_id:"",client_secret:"",protocol:"https",host:"",authorize_path:"",token_path:"",resource_path:"",userinfo_path:"",logout_redirect_uri:""}}),f=We({login_secret_key:""}),$=async()=>{try{const r=await Yo();r.data&&(d.ldap_open=st(r.data.ldap_open),r.data.ldap_form&&Object.assign(d.ldap_form,r.data.ldap_form));const _=await Xo();_.data&&(p.oauth2_open=st(_.data.oauth2_open),_.data.oauth2_form&&Object.assign(p.oauth2_form,_.data.oauth2_form));const h=await Qo();h.data&&h.data.login_secret_key&&(f.login_secret_key=h.data.login_secret_key)}catch(r){console.error("加载扩展登录配置失败:",r)}},g=async()=>{try{await Zo({ldap_open:d.ldap_open==="1",ldap_form:d.ldap_form}),await es({oauth2_open:p.oauth2_open==="1",oauth2_form:p.oauth2_form}),j.success(t("common.save_success"))}catch{j.error(t("common.save_failed"))}},n=async()=>{o.value=!0;try{const r=await ts();r.error_code===0?j.success(t("admin.ldap_sync_success")):j.error(r.error_message||t("admin.ldap_sync_failed"))}catch(r){j.error(`${t("admin.ldap_sync_failed")}: ${r.message||t("admin.unknown_error")}`)}finally{o.value=!1}},y=async()=>{try{const r=await as();r.error_code===0?(f.login_secret_key=r.data.login_secret_key,j.success(t("admin.reset_login_secret_key_success"))):j.error(r.error_message||t("admin.reset_login_secret_key_failed"))}catch(r){j.error(`${t("admin.reset_login_secret_key_failed")}: ${r.message||t("admin.unknown_error")}`)}},k=()=>{window.open("https://www.showdoc.com.cn/p/0fb2753c5a48acc7c3fbbb00f9504e6b","_blank")};return oe(()=>{$()}),(r,_)=>{const h=H("a-alert"),w=H("QuestionCircleOutlined"),T=H("a-tooltip"),x=H("a-select-option"),I=H("a-select");return C(),L("div",dC,[e("div",uC,[s(vt,{items:u.value,value:a.value,type:"segmented",onUpdateValue:v},{ldap:m(()=>[e("div",mC,[s(h,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.ldap_login_tips"),class:"info-alert"},null,8,["message"]),e("div",_C,[e("label",pC,i(r.$t("admin.enable_ldap_login")),1),s(Je,{modelValue:d.ldap_open,"onUpdate:modelValue":_[0]||(_[0]=S=>d.ldap_open=S)},null,8,["modelValue"])]),e("div",fC,[e("label",vC,[O(i(r.$t("admin.ldap_host"))+" ",1),s(T,{title:r.$t("admin.ldap_host_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.host,"onUpdate:modelValue":_[1]||(_[1]=S=>d.ldap_form.host=S),class:"form-input",placeholder:r.$t("admin.ldap_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",hC,[e("label",gC,[O(i(r.$t("admin.ldap_port"))+" ",1),s(T,{title:r.$t("admin.ldap_port_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.port,"onUpdate:modelValue":_[2]||(_[2]=S=>d.ldap_form.port=S),class:"form-input",placeholder:r.$t("admin.ldap_port_placeholder")},null,8,["modelValue","placeholder"])]),e("div",yC,[e("label",wC,[O(i(r.$t("admin.ldap_version"))+" ",1),s(T,{title:r.$t("admin.ldap_version_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(I,{value:d.ldap_form.version,"onUpdate:value":_[3]||(_[3]=S=>d.ldap_form.version=S),class:"form-select"},{default:m(()=>[s(x,{value:"2"},{default:m(()=>[..._[23]||(_[23]=[O("LDAP v2",-1)])]),_:1}),s(x,{value:"3"},{default:m(()=>[..._[24]||(_[24]=[O("LDAP v3",-1)])]),_:1})]),_:1},8,["value"])]),e("div",bC,[e("label",$C,[O(i(r.$t("admin.ldap_base_dn"))+" ",1),s(T,{title:r.$t("admin.ldap_base_dn_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.base_dn,"onUpdate:modelValue":_[4]||(_[4]=S=>d.ldap_form.base_dn=S),class:"form-input",placeholder:r.$t("admin.ldap_base_dn_placeholder")},null,8,["modelValue","placeholder"])]),e("div",kC,[e("label",CC,[O(i(r.$t("admin.ldap_bind_dn"))+" ",1),s(T,{title:r.$t("admin.ldap_bind_dn_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.bind_dn,"onUpdate:modelValue":_[5]||(_[5]=S=>d.ldap_form.bind_dn=S),class:"form-input",placeholder:r.$t("admin.ldap_bind_dn_placeholder")},null,8,["modelValue","placeholder"])]),e("div",xC,[e("label",IC,[O(i(r.$t("admin.ldap_bind_password"))+" ",1),s(T,{title:r.$t("admin.ldap_bind_password_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.bind_password,"onUpdate:modelValue":_[6]||(_[6]=S=>d.ldap_form.bind_password=S),type:"password",class:"form-input",placeholder:r.$t("admin.ldap_bind_password_placeholder")},null,8,["modelValue","placeholder"])]),e("div",SC,[e("label",TC,i(r.$t("admin.ldap_user_field")),1),s(ne,{modelValue:d.ldap_form.user_field,"onUpdate:modelValue":_[7]||(_[7]=S=>d.ldap_form.user_field=S),class:"form-input",placeholder:r.$t("admin.ldap_user_field_placeholder")},null,8,["modelValue","placeholder"])]),e("div",MC,[e("label",LC,[O(i(r.$t("admin.ldap_name_field"))+" ",1),s(T,{title:r.$t("admin.ldap_name_field_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.name_field,"onUpdate:modelValue":_[8]||(_[8]=S=>d.ldap_form.name_field=S),class:"form-input",placeholder:r.$t("admin.ldap_name_field_placeholder")},null,8,["modelValue","placeholder"])]),e("div",VC,[e("label",zC,[O(i(r.$t("admin.ldap_search_filter"))+" ",1),s(T,{title:r.$t("admin.ldap_search_filter_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:d.ldap_form.search_filter,"onUpdate:modelValue":_[9]||(_[9]=S=>d.ldap_form.search_filter=S),class:"form-input",placeholder:r.$t("admin.ldap_search_filter_placeholder")},null,8,["modelValue","placeholder"])]),e("div",UC,[s(K,{theme:"dark",text:r.$t("admin.ldap_sync_users"),leftIcon:["fas","sync"],loading:o.value,onClick:n},null,8,["text","loading"])])])]),oauth2:m(()=>[e("div",PC,[s(h,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.oauth2_login_tips"),class:"info-alert"},null,8,["message"]),e("div",AC,[e("label",DC,i(r.$t("admin.enable_oauth2_login")),1),s(Je,{modelValue:p.oauth2_open,"onUpdate:modelValue":_[10]||(_[10]=S=>p.oauth2_open=S)},null,8,["modelValue"])]),e("div",OC,[e("label",NC,i(r.$t("admin.oauth2_callback_url")),1),s(ne,{modelValue:p.oauth2_form.redirectUri,"onUpdate:modelValue":_[11]||(_[11]=S=>p.oauth2_form.redirectUri=S),class:"form-input",placeholder:r.$t("admin.oauth2_callback_eg")},null,8,["modelValue","placeholder"])]),e("div",FC,[e("label",qC,[O(i(r.$t("admin.oauth2_entrance_tips"))+" ",1),s(T,{title:r.$t("admin.oauth2_entrance_tips_content"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.entrance_tips,"onUpdate:modelValue":_[12]||(_[12]=S=>p.oauth2_form.entrance_tips=S),class:"form-input",placeholder:r.$t("admin.oauth2_entrance_tips_placeholder")},null,8,["modelValue","placeholder"])]),e("div",RC,[e("label",HC,i(r.$t("admin.oauth2_client_id")),1),s(ne,{modelValue:p.oauth2_form.client_id,"onUpdate:modelValue":_[13]||(_[13]=S=>p.oauth2_form.client_id=S),class:"form-input",placeholder:r.$t("admin.oauth2_client_id_placeholder")},null,8,["modelValue","placeholder"])]),e("div",EC,[e("label",jC,i(r.$t("admin.oauth2_client_secret")),1),s(ne,{modelValue:p.oauth2_form.client_secret,"onUpdate:modelValue":_[14]||(_[14]=S=>p.oauth2_form.client_secret=S),type:"password",class:"form-input",placeholder:r.$t("admin.oauth2_client_secret_placeholder")},null,8,["modelValue","placeholder"])]),e("div",BC,[e("label",GC,i(r.$t("admin.oauth2_protocol")),1),s(I,{value:p.oauth2_form.protocol,"onUpdate:value":_[15]||(_[15]=S=>p.oauth2_form.protocol=S),class:"form-select"},{default:m(()=>[s(x,{value:"http"},{default:m(()=>[..._[25]||(_[25]=[O("HTTP",-1)])]),_:1}),s(x,{value:"https"},{default:m(()=>[..._[26]||(_[26]=[O("HTTPS",-1)])]),_:1})]),_:1},8,["value"])]),e("div",KC,[e("label",JC,[O(i(r.$t("admin.oauth2_host"))+" ",1),s(T,{title:r.$t("admin.oauth2_host_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.host,"onUpdate:modelValue":_[16]||(_[16]=S=>p.oauth2_form.host=S),class:"form-input",placeholder:r.$t("admin.oauth2_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",WC,[e("label",YC,[O(i(r.$t("admin.oauth2_authorize_path"))+" ",1),s(T,{title:r.$t("admin.oauth2_authorize_path_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.authorize_path,"onUpdate:modelValue":_[17]||(_[17]=S=>p.oauth2_form.authorize_path=S),class:"form-input",placeholder:r.$t("admin.oauth2_authorize_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",XC,[e("label",QC,[O(i(r.$t("admin.oauth2_token_path"))+" ",1),s(T,{title:r.$t("admin.oauth2_token_path_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.token_path,"onUpdate:modelValue":_[18]||(_[18]=S=>p.oauth2_form.token_path=S),class:"form-input",placeholder:r.$t("admin.oauth2_token_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",ZC,[e("label",ex,[O(i(r.$t("admin.oauth2_resource_path"))+" ",1),s(T,{title:r.$t("admin.oauth2_resource_path_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.resource_path,"onUpdate:modelValue":_[19]||(_[19]=S=>p.oauth2_form.resource_path=S),class:"form-input",placeholder:r.$t("admin.oauth2_resource_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",tx,[e("label",ax,[O(i(r.$t("admin.oauth2_userinfo_path"))+" ",1),s(T,{title:r.$t("admin.oauth2_userinfo_path_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.userinfo_path,"onUpdate:modelValue":_[20]||(_[20]=S=>p.oauth2_form.userinfo_path=S),class:"form-input",placeholder:r.$t("admin.oauth2_userinfo_path_placeholder")},null,8,["modelValue","placeholder"])]),e("div",ox,[e("label",sx,[O(i(r.$t("admin.oauth2_logout_redirect_uri"))+" ",1),s(T,{title:r.$t("admin.oauth2_logout_redirect_uri_tips"),placement:"top"},{default:m(()=>[s(w,{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.oauth2_form.logout_redirect_uri,"onUpdate:modelValue":_[21]||(_[21]=S=>p.oauth2_form.logout_redirect_uri=S),class:"form-input",placeholder:r.$t("admin.oauth2_logout_redirect_uri_placeholder")},null,8,["modelValue","placeholder"])])])]),general:m(()=>[e("div",lx,[s(h,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.general_login_desc"),class:"info-alert"},null,8,["message"]),e("div",nx,[e("label",ix,i(r.$t("admin.login_secret_key")),1),s(ne,{modelValue:f.login_secret_key,"onUpdate:modelValue":_[22]||(_[22]=S=>f.login_secret_key=S),class:"form-input",disabled:""},null,8,["modelValue"])]),e("div",rx,[s(K,{theme:"dark",text:r.$t("admin.reset_login_secret_key"),leftIcon:["fas","redo"],loading:l.value,onClick:y},null,8,["text","loading"]),s(K,{theme:"light",text:r.$t("admin.general_login_doc_link"),leftIcon:["fas","book"],onClick:k},null,8,["text"])])])]),_:1},8,["items","value"]),e("div",cx,[s(K,{theme:"dark",text:r.$t("common.save"),leftIcon:["fas","save"],onClick:g},null,8,["text"]),s(K,{theme:"light",text:r.$t("common.cancel"),onClick:$},null,8,["text"])])])])}}});const ux=Y(dx,[["__scopeId","data-v-3b1d7607"]]),mx={class:"system-settings"},_x={class:"settings-container"},px={class:"tab-content"},fx={class:"form-row"},vx={class:"form-label"},hx={class:"form-row"},gx={class:"form-label"},yx={class:"section-title"},wx={class:"form-row"},bx={class:"form-label"},$x={class:"form-row"},kx={class:"form-label"},Cx={class:"tab-content"},xx={class:"form-row"},Ix={class:"form-label"},Sx={class:"form-row"},Tx={class:"form-label"},Mx={class:"form-row"},Lx={class:"form-label"},Vx={class:"form-row"},zx={class:"form-label"},Ux={class:"form-row"},Px={class:"form-label"},Ax={class:"form-row"},Dx={class:"form-label"},Ox={class:"tab-content"},Nx={class:"form-row"},Fx={class:"form-label"},qx={class:"form-row"},Rx={class:"form-label"},Hx={class:"form-row"},Ex={class:"form-label"},jx={class:"form-row"},Bx={class:"form-label"},Gx={key:0,class:"form-row"},Kx={class:"form-label"},Jx={class:"form-row"},Wx={class:"form-label"},Yx={class:"form-row"},Xx={class:"form-label"},Qx={class:"form-row"},Zx={class:"form-label"},e3={class:"form-row"},t3={class:"form-label"},a3={class:"form-row"},o3={class:"form-label"},s3={class:"form-row"},l3={class:"form-label"},n3={class:"form-row"},i3={class:"form-label"},r3={class:"form-row"},c3={class:"form-label"},d3={class:"tab-content"},u3={class:"section-title"},m3={class:"form-row"},_3={class:"form-label"},p3={class:"form-row"},f3={class:"form-label"},v3={class:"form-row"},h3={class:"form-label"},g3={class:"section-title"},y3={class:"alert-content"},w3={class:"alert-text"},b3={class:"form-row"},$3={class:"form-label"},k3={class:"form-row"},C3={class:"form-label"},x3={class:"form-row form-actions"},I3={class:"tab-content"},S3={key:0,class:"form-row"},T3={class:"form-label"},M3={class:"save-button-wrapper"},L3=W({__name:"SystemSettings",setup(c){const{t,locale:a}=te(),o=b("basic"),l=b(!1),u=b([]),v=q(()=>{const r=[{text:t("admin.basic_settings"),value:"basic"},{text:t("admin.security_settings"),value:"security"},{text:t("admin.storage_settings"),value:"storage"}];return a.value==="zh-CN"&&r.push({text:t("admin.ai_related_settings"),value:"ai"}),a.value==="zh-CN"&&r.push({text:t("admin.other_settings"),value:"other"}),r}),d=r=>{o.value=String(r)},p=We({register_open:"1",ldap_open:"0",home_page:"1",home_item:"",site_url:"",open_api_key:"",open_api_host:"",ai_model_name:"",ai_service_url:"",ai_service_token:"",force_login:"0",enable_public_square:"0",strong_password_enabled:"0",session_expire_days:180,history_version_count:0,show_watermark:"0",beian:""}),f=We({oss_open:"0",oss_setting:{oss_type:"aliyun",key:"",secret:"",endpoint:"",region:"",secretId:"",secretKey:"",bucket:"",subcat:"",protocol:"https",domain:""}}),$=async()=>{try{const r=await os();if(!r.data||r.data.length===0)return;const _=r.data;p.register_open=st(_.register_open),p.ldap_open=st(_.ldap_open),p.home_page=String(_.home_page||"1"),p.home_item=_.home_item||"",p.site_url=_.site_url||"",p.open_api_key=_.open_api_key||"",p.open_api_host=_.open_api_host||"",p.ai_model_name=_.ai_model_name||"",p.ai_service_url=_.ai_service_url||"",p.ai_service_token=_.ai_service_token||"",p.force_login=st(_.force_login),p.enable_public_square=st(_.enable_public_square),p.strong_password_enabled=st(_.strong_password_enabled),p.session_expire_days=_.session_expire_days?parseInt(String(_.session_expire_days)):180,p.history_version_count=_.history_version_count?parseInt(String(_.history_version_count)):0,p.show_watermark=st(_.show_watermark),p.beian=_.beian||"",_.oss_open!==void 0&&(f.oss_open=st(_.oss_open)),_.oss_setting&&Object.assign(f.oss_setting,_.oss_setting)}catch(r){console.error("加载系统配置失败:",r)}},g=async()=>{try{await ss({register_open:p.register_open==="1",site_url:p.site_url,home_page:p.home_page,home_item:p.home_item,open_api_key:p.open_api_key,open_api_host:p.open_api_host,ai_model_name:p.ai_model_name,ai_service_url:p.ai_service_url,ai_service_token:p.ai_service_token,force_login:p.force_login==="1",enable_public_square:p.enable_public_square==="1",strong_password_enabled:p.strong_password_enabled==="1",session_expire_days:p.session_expire_days,history_version_count:p.history_version_count,show_watermark:p.show_watermark==="1",beian:p.beian,oss_open:f.oss_open==="1",oss_setting:f.oss_setting}),j.success(t("common.save_success"))}catch{j.error(t("common.save_failed"))}},n=async()=>{if(!p.ai_service_url){j.warning(t("admin.ai_service_url_required"));return}if(!p.ai_service_token){j.warning(t("admin.ai_service_token_required"));return}l.value=!0;try{const r=await ls({ai_service_url:p.ai_service_url,ai_service_token:p.ai_service_token});r.error_code===0?j.success(t("admin.ai_connection_success")):j.error(r.error_message||t("admin.ai_connection_failed"))}catch(r){j.error(`${t("admin.ai_connection_failed")}: ${r.message||t("admin.unknown_error")}`)}finally{l.value=!1}},y=r=>{window.open(r,"_blank")},k=async()=>{try{const r=await Aa({item_name:"",username:"",page:1,count:100,positive_type:"",item_type:"",privacy_type:"",is_del:""});r.data&&r.data.items&&(u.value=r.data.items)}catch(r){console.error("加载项目列表失败:",r)}};return oe(async()=>{$(),await k()}),(r,_)=>{const h=H("a-tooltip"),w=H("a-select-option"),T=H("a-select"),x=H("a-input-number"),I=H("a-alert");return C(),L("div",mx,[e("div",_x,[s(vt,{items:v.value,value:o.value,type:"segmented",onUpdateValue:d},{basic:m(()=>[e("div",px,[e("div",fx,[e("label",vx,[O(i(r.$t("admin.open_register"))+" ",1),s(h,{title:r.$t("admin.open_register_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(Je,{modelValue:p.register_open,"onUpdate:modelValue":_[0]||(_[0]=S=>p.register_open=S)},null,8,["modelValue"])]),e("div",hx,[e("label",gx,[O(i(r.$t("admin.site_url"))+" ",1),s(h,{title:r.$t("admin.site_url_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[1]||(_[1]=S=>y("https://www.showdoc.com.cn/p/30dd0637811cd5c690ffd547f3c46889"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.site_url,"onUpdate:modelValue":_[2]||(_[2]=S=>p.site_url=S),class:"form-input",placeholder:r.$t("admin.site_url_placeholder")},null,8,["modelValue","placeholder"])]),e("div",yx,i(r.$t("admin.home_page")),1),e("div",wx,[e("label",bx,[O(i(r.$t("admin.home_page"))+" ",1),s(h,{title:r.$t("admin.home_page_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(T,{value:p.home_page,"onUpdate:value":_[3]||(_[3]=S=>p.home_page=S),class:"form-select"},{default:m(()=>[s(w,{value:"1"},{default:m(()=>[O(i(r.$t("admin.full_page")),1)]),_:1}),s(w,{value:"2"},{default:m(()=>[O(i(r.$t("admin.login_page")),1)]),_:1}),s(w,{value:"3"},{default:m(()=>[O(i(r.$t("admin.jump_to_item")),1)]),_:1})]),_:1},8,["value"])]),ft(e("div",$x,[e("label",kx,[O(i(r.$t("admin.home_item"))+" ",1),s(h,{title:r.$t("admin.home_item_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(T,{value:p.home_item,"onUpdate:value":_[4]||(_[4]=S=>p.home_item=S),class:"form-select",placeholder:r.$t("admin.home_item_placeholder"),"show-search":!0,"filter-option":(S,M)=>M.label.toLowerCase().includes(S.toLowerCase())},{default:m(()=>[(C(!0),L(Ce,null,Pe(u.value,S=>(C(),B(w,{key:S.item_id,value:S.item_id,label:S.item_name},{default:m(()=>[O(i(S.item_name),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["value","placeholder","filter-option"])],512),[[ga,p.home_page==="3"]])])]),security:m(()=>[e("div",Cx,[e("div",xx,[e("label",Ix,[O(i(r.$t("admin.force_login"))+" ",1),s(h,{title:r.$t("admin.force_login_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(Je,{modelValue:p.force_login,"onUpdate:modelValue":_[5]||(_[5]=S=>p.force_login=S)},null,8,["modelValue"])]),e("div",Sx,[e("label",Tx,[O(i(r.$t("admin.enable_public_square"))+" ",1),s(h,{title:r.$t("admin.enable_public_square_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(Je,{modelValue:p.enable_public_square,"onUpdate:modelValue":_[6]||(_[6]=S=>p.enable_public_square=S)},null,8,["modelValue"])]),e("div",Mx,[e("label",Lx,[O(i(r.$t("admin.strong_password_enabled"))+" ",1),s(h,{title:r.$t("admin.strong_password_enabled_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(Je,{modelValue:p.strong_password_enabled,"onUpdate:modelValue":_[7]||(_[7]=S=>p.strong_password_enabled=S)},null,8,["modelValue"])]),e("div",Vx,[e("label",zx,[O(i(r.$t("admin.session_expire_days"))+" ",1),s(h,{title:r.$t("admin.session_expire_days_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(x,{value:p.session_expire_days,"onUpdate:value":_[8]||(_[8]=S=>p.session_expire_days=S),min:1,max:3650,class:"form-input-number",placeholder:r.$t("admin.session_expire_days_placeholder")},null,8,["value","placeholder"])]),e("div",Ux,[e("label",Px,[O(i(r.$t("admin.history_version_count"))+" ",1),s(h,{title:r.$t("admin.history_version_count_content"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(x,{value:p.history_version_count,"onUpdate:value":_[9]||(_[9]=S=>p.history_version_count=S),min:0,max:100,class:"form-input-number",placeholder:r.$t("admin.history_version_count_content")},null,8,["value","placeholder"])]),e("div",Ax,[e("label",Dx,[O(i(r.$t("admin.watermark"))+" ",1),s(h,{title:r.$t("admin.watermark_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(Je,{modelValue:p.show_watermark,"onUpdate:modelValue":_[10]||(_[10]=S=>p.show_watermark=S)},null,8,["modelValue"])])])]),storage:m(()=>[e("div",Ox,[e("div",Nx,[e("label",Fx,i(r.$t("admin.oss_open")),1),s(Je,{modelValue:f.oss_open,"onUpdate:modelValue":_[11]||(_[11]=S=>f.oss_open=S)},null,8,["modelValue"])]),e("div",qx,[e("label",Rx,i(r.$t("admin.oss_server")),1),s(T,{value:f.oss_setting.oss_type,"onUpdate:value":_[12]||(_[12]=S=>f.oss_setting.oss_type=S),class:"form-select"},{default:m(()=>[s(w,{value:"aliyun"},{default:m(()=>[O(i(r.$t("admin.aliyun")),1)]),_:1}),s(w,{value:"qiniu"},{default:m(()=>[O(i(r.$t("admin.qiniu")),1)]),_:1}),s(w,{value:"qcloud"},{default:m(()=>[O(i(r.$t("admin.qcloud")),1)]),_:1}),s(w,{value:"s3_storage"},{default:m(()=>[O(i(r.$t("admin.s3_storage")),1)]),_:1})]),_:1},8,["value"])]),f.oss_setting.oss_type==="aliyun"||f.oss_setting.oss_type==="s3_storage"?(C(),L(Ce,{key:0},[e("div",Hx,[e("label",Ex,i(r.$t("admin.oss_key")),1),s(ne,{modelValue:f.oss_setting.key,"onUpdate:modelValue":_[13]||(_[13]=S=>f.oss_setting.key=S),class:"form-input",placeholder:r.$t("admin.oss_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",jx,[e("label",Bx,i(r.$t("admin.oss_secret")),1),s(ne,{modelValue:f.oss_setting.secret,"onUpdate:modelValue":_[14]||(_[14]=S=>f.oss_setting.secret=S),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secret_placeholder")},null,8,["modelValue","placeholder"])]),f.oss_setting.oss_type==="aliyun"?(C(),L("div",Gx,[e("label",Kx,i(r.$t("admin.oss_endpoint")),1),s(ne,{modelValue:f.oss_setting.endpoint,"onUpdate:modelValue":_[15]||(_[15]=S=>f.oss_setting.endpoint=S),class:"form-input",placeholder:r.$t("admin.oss_endpoint_placeholder")},null,8,["modelValue","placeholder"])])):F("",!0)],64)):F("",!0),f.oss_setting.oss_type==="qiniu"?(C(),L(Ce,{key:1},[e("div",Jx,[e("label",Wx,i(r.$t("admin.oss_key")),1),s(ne,{modelValue:f.oss_setting.key,"onUpdate:modelValue":_[16]||(_[16]=S=>f.oss_setting.key=S),class:"form-input",placeholder:r.$t("admin.oss_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",Yx,[e("label",Xx,i(r.$t("admin.oss_secret")),1),s(ne,{modelValue:f.oss_setting.secret,"onUpdate:modelValue":_[17]||(_[17]=S=>f.oss_setting.secret=S),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secret_placeholder")},null,8,["modelValue","placeholder"])])],64)):F("",!0),f.oss_setting.oss_type==="qcloud"?(C(),L(Ce,{key:2},[e("div",Qx,[e("label",Zx,i(r.$t("admin.oss_secretId")),1),s(ne,{modelValue:f.oss_setting.secretId,"onUpdate:modelValue":_[18]||(_[18]=S=>f.oss_setting.secretId=S),class:"form-input",placeholder:r.$t("admin.oss_secretId_placeholder")},null,8,["modelValue","placeholder"])]),e("div",e3,[e("label",t3,i(r.$t("admin.oss_secretKey")),1),s(ne,{modelValue:f.oss_setting.secretKey,"onUpdate:modelValue":_[19]||(_[19]=S=>f.oss_setting.secretKey=S),type:"password",class:"form-input",placeholder:r.$t("admin.oss_secretKey_placeholder")},null,8,["modelValue","placeholder"])]),e("div",a3,[e("label",o3,i(r.$t("admin.oss_region")),1),s(ne,{modelValue:f.oss_setting.region,"onUpdate:modelValue":_[20]||(_[20]=S=>f.oss_setting.region=S),class:"form-input",placeholder:r.$t("admin.oss_region_placeholder")},null,8,["modelValue","placeholder"])])],64)):F("",!0),e("div",s3,[e("label",l3,i(r.$t("admin.oss_bucket")),1),s(ne,{modelValue:f.oss_setting.bucket,"onUpdate:modelValue":_[21]||(_[21]=S=>f.oss_setting.bucket=S),class:"form-input",placeholder:r.$t("admin.oss_bucket_placeholder")},null,8,["modelValue","placeholder"])]),e("div",n3,[e("label",i3,i(r.$t("admin.oss_subcat")),1),s(ne,{modelValue:f.oss_setting.subcat,"onUpdate:modelValue":_[22]||(_[22]=S=>f.oss_setting.subcat=S),class:"form-input",placeholder:r.$t("admin.oss_subcat_placeholder")},null,8,["modelValue","placeholder"])]),e("div",r3,[e("label",c3,i(r.$t("admin.oss_domain")),1),s(ne,{modelValue:f.oss_setting.domain,"onUpdate:modelValue":_[23]||(_[23]=S=>f.oss_setting.domain=S),class:"form-input",placeholder:r.$t("admin.oss_domain_placeholder")},null,8,["modelValue","placeholder"])])])]),ai:m(()=>[e("div",d3,[e("div",u3,i(r.$t("admin.ai_edit_assistant")),1),s(I,{type:"info",closable:!1,"show-icon":"",message:r.$t("admin.ai_edit_assistant_desc"),class:"info-alert"},null,8,["message"]),e("div",m3,[e("label",_3,[O(i(r.$t("admin.ai_edit_assistant_key"))+" ",1),s(h,{title:r.$t("admin.ai_edit_assistant_key_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[24]||(_[24]=S=>y("https://www.showdoc.com.cn/p/30dd0637811cd5c690ffd547f3c46889"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.open_api_key,"onUpdate:modelValue":_[25]||(_[25]=S=>p.open_api_key=S),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_key_placeholder")},null,8,["modelValue","placeholder"])]),e("div",p3,[e("label",f3,[O(i(r.$t("admin.ai_edit_assistant_host"))+" ",1),s(h,{title:r.$t("admin.ai_edit_assistant_host_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon clickable",onClick:_[26]||(_[26]=S=>y("https://github.com/star7th/showdoc/issues/1904"))})]),_:1},8,["title"])]),s(ne,{modelValue:p.open_api_host,"onUpdate:modelValue":_[27]||(_[27]=S=>p.open_api_host=S),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_host_placeholder")},null,8,["modelValue","placeholder"])]),e("div",v3,[e("label",h3,i(r.$t("admin.ai_edit_assistant_model")),1),s(ne,{modelValue:p.ai_model_name,"onUpdate:modelValue":_[28]||(_[28]=S=>p.ai_model_name=S),class:"form-input",placeholder:r.$t("admin.ai_edit_assistant_model_placeholder")},null,8,["modelValue","placeholder"])]),e("div",g3,i(r.$t("admin.ai_knowledge_base_service")),1),s(I,{type:"warning",closable:!1,"show-icon":"",class:"warning-alert"},{message:m(()=>[e("div",y3,[e("div",w3,i(r.$t("admin.ai_knowledge_base_service_desc")),1),e("a",{class:"alert-link",onClick:_[29]||(_[29]=S=>y("https://github.com/star7th/showdoc-ai-service"))},i(r.$t("admin.ai_knowledge_base_install_link")),1)])]),_:1}),e("div",b3,[e("label",$3,[O(i(r.$t("admin.ai_service_url"))+" ",1),s(h,{title:r.$t("admin.ai_service_url_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.ai_service_url,"onUpdate:modelValue":_[30]||(_[30]=S=>p.ai_service_url=S),class:"form-input",placeholder:r.$t("admin.ai_service_url_placeholder")},null,8,["modelValue","placeholder"])]),e("div",k3,[e("label",C3,[O(i(r.$t("admin.ai_service_token"))+" ",1),s(h,{title:r.$t("admin.ai_service_token_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.ai_service_token,"onUpdate:modelValue":_[31]||(_[31]=S=>p.ai_service_token=S),type:"password",class:"form-input",placeholder:r.$t("admin.ai_service_token_placeholder")},null,8,["modelValue","placeholder"])]),e("div",x3,[s(K,{theme:"dark",text:r.$t("admin.ai_test_connection"),leftIcon:["fas","link"],loading:l.value,onClick:n},null,8,["text","loading"])])])]),other:m(()=>[e("div",I3,[z(a)==="zh-CN"?(C(),L("div",S3,[e("label",T3,[O(i(r.$t("admin.beian"))+" ",1),s(h,{title:r.$t("admin.beian_tips"),placement:"top"},{default:m(()=>[s(z(Be),{class:"question-icon"})]),_:1},8,["title"])]),s(ne,{modelValue:p.beian,"onUpdate:modelValue":_[32]||(_[32]=S=>p.beian=S),class:"form-input",placeholder:r.$t("admin.beian_tips")},null,8,["modelValue","placeholder"])])):F("",!0)])]),_:1},8,["items","value"]),e("div",M3,[s(K,{theme:"dark",text:r.$t("common.save"),leftIcon:["fas","save"],onClick:g},null,8,["text"]),s(K,{theme:"light",text:r.$t("common.cancel"),onClick:$},null,8,["text"])])])])}}});const V3=Y(L3,[["__scopeId","data-v-c7ecd797"]]),z3={class:"about-site"},U3={class:"about-content"},P3={class:"info-section"},A3={class:"section-title"},D3={class:"info-text"},O3={class:"info-section"},N3={class:"info-text"},F3={class:"info-section"},q3={class:"section-title"},R3={class:"info-text"},H3={href:"https://www.showdoc.com.cn/",target:"_blank",class:"link"},E3={key:0,class:"update-section"},j3={class:"section-title update-title"},B3={class:"info-text"},G3={href:"https://www.showdoc.com.cn/help/13733",target:"_blank",class:"link"},K3={class:"info-text"},J3={class:"info-text"},W3={href:"https://www.showdoc.com.cn/help?page_id=13732",target:"_blank",class:"link"},Y3=W({__name:"AboutSite",setup(c){const{t}=te(),a=b(""),o=b(""),l=b(!1),u=b(""),v=async()=>{try{const f=await X("/api/common/version",{},"get");f&&f.data&&f.data.version&&(a.value=f.data.version)}catch(f){console.error("Failed to get current version:",f)}},d=async()=>{try{const f=await X("/api/adminUpdate/checkUpdate",{},"get");f&&f.data&&f.data.url&&(u.value=f.data.url,o.value=f.data.new_version,a.value=f.data.version,l.value=!0)}catch(f){console.error("Failed to check update:",f)}},p=async()=>{const f=j.loading(t("admin.downloading_update_package"),0);try{await X("/api/adminUpdate/download",{},"post"),f();const $=j.loading(t("admin.updating_files"),0);await X("/api/adminUpdate/updateFiles",{},"post"),$();const g=j.loading(t("admin.upgrade_success_ready_to_refresh")+t("admin.if_cache_not_auto_update_refresh_manually"),0);await X("/api/update/checkDb",{},"post"),setTimeout(()=>{window.location.reload()},7e3)}catch($){f(),j.error(t("common.update_failed")),console.error("Update failed:",$)}};return oe(()=>{v(),d()}),(f,$)=>(C(),L("div",z3,[e("div",U3,[e("div",P3,[e("h3",A3,i(f.$t("admin.version")),1),e("p",D3,[O(i(f.$t("admin.open_source_based"))+" ",1),e("b",null,i(f.$t("admin.current_version"))+": "+i(a.value),1)])]),e("div",O3,[$[3]||($[3]=e("h3",{class:"section-title"},"GitHub",-1)),e("p",N3,[O(i(f.$t("admin.issue_report"))+"：",1),$[0]||($[0]=e("a",{href:"https://github.com/star7th/showdoc/issues",target:"_blank",class:"link"}," https://github.com/star7th/showdoc/issues ",-1)),$[1]||($[1]=e("br",null,null,-1)),O(" "+i(f.$t("admin.star_tip"))+" ",1),$[2]||($[2]=e("a",{href:"https://github.com/star7th/showdoc",target:"_blank",class:"link"},"GitHub",-1))])]),e("div",F3,[e("h3",q3,i(f.$t("common.copyright")),1),e("p",R3,[e("a",H3,i(f.$t("common.showdoc")),1),O(" "+i(f.$t("admin.copyright_info")),1)])]),l.value?(C(),L("div",E3,[$[4]||($[4]=e("hr",null,null,-1)),e("h3",j3,i(f.$t("admin.update_available"))+"("+i(o.value)+")",1),e("p",B3,[O(i(f.$t("admin.update_content"))+" ",1),e("a",G3,i(f.$t("admin.update_log")),1)]),e("p",K3,i(f.$t("admin.update_tips")),1),s(K,{type:"primary",onClick:p},{default:m(()=>[O(i(f.$t("admin.click_to_update")),1)]),_:1}),$[5]||($[5]=e("br",null,null,-1)),$[6]||($[6]=e("br",null,null,-1)),e("p",J3,[O(i(f.$t("admin.update_failed_tip"))+"， ",1),e("a",W3,i(f.$t("common.click_here")),1)])])):F("",!0)])]))}});const X3=Y(Y3,[["__scopeId","data-v-a3e1bc68"]]),Q3={class:"admin-layout"},Z3={class:"admin-header"},e5={class:"header-left"},t5={class:"header-title"},a5={class:"header-right"},o5={class:"admin-container"},s5={class:"admin-sidebar"},l5={class:"sidebar-menu"},n5=["onClick"],i5={class:"menu-icon"},r5={class:"menu-label"},c5={class:"admin-content"},d5=W({__name:"AdminLayout",setup(c){const t=xe(),{t:a}=te(),o=He(),l=b(["user"]),u=()=>{o.toggleTheme()},v=q(()=>[{key:"user",label:a("admin.user_manage"),icon:"fas fa-users"},{key:"item",label:a("admin.item_manage"),icon:"fas fa-file-alt"},{key:"announcement",label:a("admin.announcement_manage"),icon:"fas fa-bullhorn"},{key:"attachment",label:a("admin.attachment_manage"),icon:"fas fa-paperclip"},{key:"ext-login",label:a("admin.ext_login"),icon:"fas fa-plug"},{key:"setting",label:a("admin.web_setting"),icon:"fas fa-cog"},{key:"about",label:a("admin.about_site"),icon:"fas fa-info-circle"}]),d={user:k2,item:p8,announcement:R8,attachment:cC,"ext-login":ux,setting:V3,about:X3},p=q(()=>d[l.value[0]]),f=g=>{l.value=[g]},$=()=>{t.push("/item/index")};return oe(()=>{l.value=["user"]}),(g,n)=>{const y=H("a-tooltip");return C(),L("div",Q3,[e("div",Z3,[e("div",e5,[s(y,{title:g.$t("item.back_to_item_list"),mouseEnterDelay:.3,destroyTooltipOnHide:!0},{default:m(()=>[e("div",{class:"icon-item",onClick:$},[...n[0]||(n[0]=[e("i",{class:"fas fa-arrow-left"},null,-1)])])]),_:1},8,["title"]),e("div",t5,i(g.$t("admin.admin_panel")),1)]),e("div",a5,[s(y,{title:z(o).theme==="light"?g.$t("common.dark_mode"):g.$t("common.light_mode"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:u},[...n[1]||(n[1]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"])])]),e("div",o5,[e("div",s5,[e("div",l5,[(C(!0),L(Ce,null,Pe(v.value,k=>(C(),L("div",{key:k.key,class:re(["menu-item",{active:l.value[0]===k.key}]),onClick:r=>f(k.key)},[e("div",i5,[e("i",{class:re(k.icon)},null,2)]),e("span",r5,i(k.label),1)],10,n5))),128))])]),e("div",c5,[p.value?(C(),B(so(p.value),{key:0})):F("",!0)])])])}}});const u5=Y(d5,[["__scopeId","data-v-bab535f1"]]),m5=W({__name:"Index",setup(c){return(t,a)=>(C(),B(u5))}}),LS=Object.freeze(Object.defineProperty({__proto__:null,default:m5},Symbol.toStringTag,{value:"Module"})),_5={class:"public-square-page"},p5={class:"page-header"},f5={class:"header-left"},v5={class:"page-title"},h5={class:"header-right"},g5={class:"search-box"},y5={class:"public-square-container"},w5={key:0,class:"project-grid"},b5=["onClick"],$5={class:"project-card-header"},k5={class:"item-icon-wrapper"},C5={key:0,class:"item-icon fas fa-file"},x5={key:1,class:"item-icon fas fa-table"},I5={key:2,class:"item-icon fas fa-terminal"},S5={key:3,class:"item-icon fas fa-chalkboard"},T5={key:4,class:"item-icon fas fa-book"},M5={class:"project-title"},L5={class:"project-desc"},V5={class:"project-card-footer"},z5={class:"meta-item"},U5={key:1,class:"empty-container"},P5={key:2,class:"loading-container"},A5={key:0,class:"pagination-wrapper"},D5=W({__name:"Index",setup(c){const{t}=te(),a=xe(),o=He(),l=b([]),u=b(0),v=b(1),d=b(12),p=b(""),f=b("title"),$=q(()=>[{label:t("item.search_title"),value:"title"},{label:t("item.search_content"),value:"content"}]),g=b(!1),n=b(!1),y=(M,V)=>t("common.pagination_info",{start:V[0],end:V[1],total:M}),k=()=>{a.push("/item/index")},r=()=>{o.toggleTheme()},_=async()=>{try{const M=await Yt();M&&M.data&&M.data.enable===1?(n.value=!0,await h()):(j.error(t("item.enable_public_square_tips")),a.push("/item/index"))}catch{j.error(t("common.op_failed")),a.push("/item/index")}},h=async()=>{if(n.value){g.value=!0;try{const M=await ns({page:v.value,count:d.value,keyword:p.value,search_type:f.value});M&&M.data&&(l.value=M.data.items||[],u.value=M.data.total||0)}catch(M){console.error("获取公开项目列表失败:",M),j.error(t("common.op_failed"))}finally{g.value=!1}}},w=()=>{v.value=1,h()},T=M=>{v.value=M,h()},x=M=>{const V="#/"+(M.item_domain||M.item_id);window.open(V,"_blank")},I=M=>({1:t("item.type_regular"),2:t("item.type_single"),3:t("item.type_runapi"),4:t("item.type_table"),5:t("item.type_whiteboard")})[String(M)]||t("item.type_regular"),S=M=>{if(!M)return"";let V;if(typeof M=="string"){if(V=new Date(M).getTime()/1e3,isNaN(V))return""}else V=M;const N=Date.now()/1e3-V;if(N<3600){const ge=Math.floor(N/60);return ge<=1?t("time.just_now"):t("time.minutes_ago",{n:ge})}if(N<86400){const ge=Math.floor(N/3600);return t("time.hours_ago",{n:ge})}if(N<604800){const ge=Math.floor(N/86400);return t("time.days_ago",{n:ge})}const A=new Date(V*1e3),P=A.getFullYear(),D=String(A.getMonth()+1).padStart(2,"0"),E=String(A.getDate()).padStart(2,"0"),ae=new Date().getFullYear();return P===ae?`${D}-${E}`:`${P}-${D}-${E}`};return oe(()=>{_()}),(M,V)=>{const U=H("a-input"),N=H("a-empty"),A=H("a-spin"),P=H("a-pagination");return C(),L("div",_5,[e("div",p5,[e("div",f5,[e("button",{class:"back-button",onClick:k},[...V[3]||(V[3]=[e("i",{class:"fas fa-arrow-left"},null,-1)])]),e("h2",v5,i(z(t)("item.public_square")),1),e("button",{class:"theme-toggle-button",onClick:r},[...V[4]||(V[4]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),e("div",h5,[e("div",g5,[s(U,{value:p.value,"onUpdate:value":V[1]||(V[1]=D=>p.value=D),placeholder:z(t)("item.search_placeholder"),onPressEnter:w},{prepend:m(()=>[s(Re,{value:f.value,"onUpdate:value":V[0]||(V[0]=D=>f.value=D),options:$.value,style:{width:"120px"}},null,8,["value","options"])]),suffix:m(()=>[e("i",{class:"fas fa-search search-icon",onClick:w})]),_:1},8,["value","placeholder"])])])]),e("div",y5,[!g.value&&l.value.length>0?(C(),L("div",w5,[(C(!0),L(Ce,null,Pe(l.value,D=>(C(),L("div",{class:"project-card",key:D.item_id,onClick:E=>x(D)},[e("div",$5,[e("div",k5,[D.item_type=="2"?(C(),L("i",C5)):D.item_type=="4"?(C(),L("i",x5)):D.item_type=="3"?(C(),L("i",I5)):D.item_type=="5"?(C(),L("i",S5)):(C(),L("i",T5))]),e("h3",M5,i(D.item_name),1)]),e("p",L5,i(D.item_description||z(t)("item.no_description_item")),1),e("div",V5,[e("span",z5,[V[5]||(V[5]=e("i",{class:"far fa-clock"},null,-1)),O(" "+i(S(D.last_update_time)),1)]),e("div",{class:re(["item-type-badge",`type-${D.item_type}`])},i(I(D.item_type)),3)])],8,b5))),128))])):F("",!0),!g.value&&l.value.length===0?(C(),L("div",U5,[s(N,{description:z(t)("item.no_public_items")},null,8,["description"])])):F("",!0),g.value?(C(),L("div",P5,[s(A,{size:"large"})])):F("",!0)]),u.value>0?(C(),L("div",A5,[s(P,{current:v.value,"onUpdate:current":V[2]||(V[2]=D=>v.value=D),"page-size":d.value,total:u.value,"show-size-changer":!1,"show-total":y,onChange:T},null,8,["current","page-size","total"])])):F("",!0)])}}});const O5=Y(D5,[["__scopeId","data-v-1a50b003"]]),VS=Object.freeze(Object.defineProperty({__proto__:null,default:O5},Symbol.toStringTag,{value:"Module"})),N5={class:"item-header"},F5={class:"header-left"},q5={class:"item-name"},R5=W({__name:"ItemHeader",props:{itemInfo:{default:()=>({})},slots:{default:()=>({})}},setup(c){const t=xe();te();const a=()=>{t.push("/item/index")};return(o,l)=>{var v;const u=H("a-tooltip");return C(),L("div",N5,[e("div",F5,[s(u,{title:o.$t("item.back_to_item_list")},{default:m(()=>[e("div",{class:"icon-item",onClick:a},[...l[0]||(l[0]=[e("i",{class:"fas fa-arrow-left"},null,-1)])])]),_:1},8,["title"]),e("div",q5,i(((v=c.itemInfo)==null?void 0:v.item_name)||""),1)]),lo(o.$slots,"right",{},void 0,!0)])}}});const Vt=Y(R5,[["__scopeId","data-v-82bc7211"]]),H5={class:"export-file-modal"},E5={class:"modal-content"},j5={class:"form-section"},B5={class:"form-label"},G5={key:0,class:"form-group"},K5={class:"form-label"},J5={key:1,class:"form-group"},W5={class:"form-label"},Y5={class:"tips"},X5={class:"tips-text"},Q5={class:"tips"},Z5={class:"tips-text"},eI={class:"modal-footer"},tI=W({__name:"index",props:{onClose:{type:Function},itemId:{}},setup(c){const{t}=te(),a=c,o=q(()=>{const V=[{text:t("item.export_format_word"),value:"word"},{text:t("item.export_format_html"),value:"html"}];return g.value&&V.splice(1,0,{text:t("item.export_format_markdown"),value:"markdown"}),V}),l=q(()=>[{text:t("item.export_all"),value:1},{text:t("item.export_cat"),value:2}]),u=b(!1),v=b(!1),d=b("word"),p=b(1),f=b(""),$=b("0"),g=b(!0),n=b([]),y=b([{page_id:"0",page_title:t("item.all_pages")}]),k=Qt(),r=(k==null?void 0:k.user_token)||"",_=q(()=>{const V=n.value.slice(0),U=[];for(let N=0;N<V.length;N++){U.push(V[N]);const A=V[N].sub;if(A&&A.length>0)for(let P=0;P<A.length;P++){U.push({cat_id:A[P].cat_id,cat_name:V[N].cat_name+" / "+A[P].cat_name});const D=A[P].sub;if(D&&D.length>0)for(let E=0;E<D.length;E++)U.push({cat_id:D[E].cat_id,cat_name:V[N].cat_name+" / "+A[P].cat_name+" / "+D[E].cat_name})}}return U.unshift({cat_id:"",cat_name:t("item.none")}),U.map(N=>({label:N.cat_name,value:N.cat_id}))}),h=q(()=>y.value.map(V=>({label:V.page_title,value:V.page_id}))),w=async V=>{try{const U=await X("/api/catalog/catListGroup",{item_id:V});U.error_code===0&&U.data&&(n.value=U.data)}catch(U){console.error("获取目录失败:",U)}},T=async V=>{if(!V){y.value=[{page_id:"0",page_title:t("item.all_pages")}],$.value="0";return}try{const U=await X("/api/catalog/getPagesBycat",{item_id:a.itemId,cat_id:V});U.error_code===0&&U.data&&(y.value=[{page_id:"0",page_title:t("item.all_pages")},...U.data],$.value="0")}catch(U){console.error("获取页面失败:",U)}},x=V=>{T(V)},I=async()=>{try{return(await X("/api/export/checkMarkdownLimit",{export_format:d.value})).error_code===0}catch(V){return console.error("检查Markdown限制失败:",V),!1}},S=async()=>{if(v.value)return;if(!await I()){await G(t("common.op_failed"));return}const U=ot();let N="";if(d.value==="word"){const A=p.value===1?"":f.value;N=dt(`${U}/api/export/word`,{item_id:a.itemId,cat_id:A,page_id:$.value,user_token:r})}else d.value==="markdown"?N=dt(`${U}/api/export/markdown`,{item_id:a.itemId,user_token:r}):d.value==="html"&&(N=dt(`${U}/api/exportHtml/export`,{item_id:a.itemId,user_token:r}));window.location.href=N,ie.success(t("common.export_success")),M(!0)},M=(V=!1)=>{u.value=!1,setTimeout(()=>{a.onClose(V)},300)};return oe(async()=>{await w(a.itemId);try{const V=await X("/api/item/info",{item_id:a.itemId});V.error_code===0&&V.data&&V.data.item_type==="3"&&(g.value=!1)}catch(V){console.error("获取项目信息失败:",V)}setTimeout(()=>{u.value=!0})}),(V,U)=>(C(),L("div",H5,[s(de,{class:re({show:u.value}),title:V.$t("item.export"),icon:["fa","fa-download"],onClose:M},{default:m(()=>[e("div",E5,[s(vt,{items:o.value,value:d.value,type:"segmented",onUpdateValue:U[3]||(U[3]=N=>d.value=N)},{word:m(()=>[e("div",j5,[e("label",B5,i(V.$t("item.export_range")),1),s(vt,{items:l.value,value:p.value,type:"segmented",onUpdateValue:U[0]||(U[0]=N=>p.value=N)},null,8,["items","value"]),p.value===2?(C(),L("div",G5,[e("label",K5,i(V.$t("page.catalog")),1),s(Re,{value:f.value,"onUpdate:value":U[1]||(U[1]=N=>f.value=N),placeholder:V.$t("page.catalog"),"show-search":!0,options:_.value,onChange:x},null,8,["value","placeholder","options"])])):F("",!0),p.value===2&&y.value.length>0?(C(),L("div",J5,[e("label",W5,i(V.$t("page.page_info")),1),s(Re,{value:$.value,"onUpdate:value":U[2]||(U[2]=N=>$.value=N),"show-search":!0,options:h.value},null,8,["value","options"])])):F("",!0)])]),markdown:m(()=>[e("div",Y5,[e("p",X5,i(V.$t("item.export_markdown_tips")),1)])]),html:m(()=>[e("div",Q5,[e("p",Z5,i(V.$t("item.export_html_tips")),1)])]),_:1},8,["items","value"])]),e("div",eI,[s(K,{text:V.$t("common.cancel"),theme:"light",onClick:M},null,8,["text"]),s(K,{text:V.$t("common.confirm"),theme:"dark",spinning:v.value,onClick:S},null,8,["text","spinning"])])]),_:1},8,["class","title"])]))}});const aI=Y(tI,[["__scopeId","data-v-f72135ff"]]);function Ja(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(aI,{itemId:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const oI={class:"change-log-modal"},sI={class:"modal-content"},lI=["onClick"],nI={key:1},iI=W({__name:"index",props:{itemId:{},onClose:{type:Function}},setup(c){const{t}=te(),a=xe(),o=c,l=q(()=>[{title:t("item.op_time"),key:"optime",width:170},{title:t("item.oper"),key:"oper",width:120},{title:t("item.op_action_type_desc"),key:"op_action_type_desc",width:120},{title:t("item.op_object_type_desc"),key:"op_object_type_desc",width:110},{title:t("item.op_object_name"),key:"op_object_name",minWidth:150},{title:t("item.remark"),key:"remark",width:300}]),u=b(!1),v=b(!1),d=b([]),p=b([]),f=b(1),$=b(10),g=b(0),n=q(()=>({current:f.value,pageSize:$.value,total:g.value})),y=x=>(x.op_action_type==="create"||x.op_action_type==="update")&&x.op_object_type==="page",k=x=>x?{create:t("item.op_create"),update:t("item.op_update"),delete:t("item.op_delete"),copy:t("item.op_copy"),move:t("item.op_move")}[x]||x:"",r=x=>x?{page:t("item.op_page"),catalog:t("item.catalog"),item:t("item.op_item"),member:t("item.op_member"),attachment:t("item.op_attachment")}[x]||x:"",_=async()=>{v.value=!0;try{const x=await X("/api/item/getChangeLog",{page:f.value,count:$.value,item_id:o.itemId},"post",!1);if(console.log("[fetchChangeLog] result:",x),x.error_code===0){const I=(f.value-1)*$.value,S=I+$.value;p.value=[...p.value.slice(0,I),...x.data.list||[],...p.value.slice(S)],d.value=p.value,g.value=parseInt(x.data.total)||0,console.log("[fetchChangeLog] logList.value:",d.value),console.log("[fetchChangeLog] total.value:",g.value)}}catch(x){console.error("获取变更日志失败:",x)}finally{v.value=!1}},h=x=>{f.value=x,_()},w=x=>{if(!x)return;const I=a.resolve({path:`/${o.itemId}/${x}`});window.open(I.href,"_blank")},T=()=>{o.onClose&&o.onClose()};return oe(()=>{u.value=!0,_()}),(x,I)=>(C(),L("div",oI,[s(de,{class:re({show:u.value}),title:x.$t("item.item_change_log_dialog_title"),icon:["fa","fa-clock-rotate-left"],width:"70%",height:"600px",onClose:T},{default:m(()=>[e("div",sI,[s(Le,{"table-header":l.value,"table-data":d.value,pagination:n.value,loading:v.value,"max-height":"calc(100vh - 350px)",onPageChange:h},{"cell-oper":m(({row:S})=>[O(i(S.oper),1)]),"cell-op_action_type_desc":m(({row:S})=>[O(i(k(S.op_action_type)),1)]),"cell-op_object_type_desc":m(({row:S})=>[O(i(r(S.op_object_type)),1)]),"cell-op_object_name":m(({row:S})=>[y(S)?(C(),L("a",{key:0,class:"page-link",onClick:M=>w(S.op_object_id)},i(S.op_object_name),9,lI)):(C(),L("span",nI,i(S.op_object_name),1))]),"cell-remark":m(({row:S})=>[O(i(S.remark),1)]),_:1},8,["table-header","table-data","pagination","loading"])])]),_:1},8,["class","title"])]))}});const rI=Y(iI,[["__scopeId","data-v-2afa0ea3"]]);function zt(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(rI,{itemId:c,onClose:l=>{t(l),me(a,o)}});a.mount(o)})}const cI={class:"header-right"},dI={class:"icon-item language-item"},uI=W({__name:"HeaderRight",props:{pageId:{default:0},itemInfo:{default:()=>({})},pageInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}}},emits:["editPage"],setup(c,{emit:t}){const a=c,o=t,l=xe(),{t:u}=te(),v=He(),d=Qe(),p=()=>{v.toggleTheme()},f=q(()=>d.newMsg),$=q(()=>[{icon:["far","fa-upload"],text:u("item.import"),value:"import"},{icon:["far","fa-download"],text:u("item.export"),value:"export"},{icon:["far","fa-users"],text:u("item.member_manage"),value:"member"},{icon:["far","fa-recycle"],text:u("item.recycle"),value:"recycle"},{icon:["far","fa-gear"],text:u("item.update_base_info"),value:"setting"},{icon:["far","fa-brain"],text:u("ai.ai_knowledge_base"),value:"ai"},{icon:["far","fa-terminal"],text:u("item.open_api"),value:"openapi"},{icon:["far","fa-clock-rotate-left"],text:u("item.change_log"),value:"changelog"},{icon:["far","fa-repeat"],text:u("item.attorn"),value:"attorn"},{icon:["far","fa-box-archive"],text:u("item.archive"),value:"archive"},{icon:["far","fa-trash-can"],text:u("item.delete_item"),value:"delete"}]),g=T=>{const x=T.value;w({key:x})},n=async()=>{var T;a.pageId&&((T=a.itemInfo)!=null&&T.item_id)&&await rt({itemId:a.itemInfo.item_id,editPageId:a.pageId,copyPageId:0})&&o("editPage")},y=async()=>{var T,x;a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id,page_id:a.pageId,page_unique_key:(T=a.pageInfo)==null?void 0:T.unique_key,page_title:(x=a.pageInfo)==null?void 0:x.page_title,item_info:a.itemInfo})},k=async()=>{v.setNewMsg(0),await sa()},r=async()=>{await oa()},_=()=>{l.push("/user/login")},h=()=>{window.open("https://www.showdoc.com.cn/help","_blank")},w=async({key:T})=>{switch(T){case"import":a.itemInfo&&await ja({itemId:a.itemInfo.item_id});break;case"export":a.itemInfo&&await Ja(a.itemInfo.item_id);break;case"member":a.itemInfo&&await yt(a.itemInfo.item_id);break;case"recycle":a.itemInfo&&await Mt(a.itemInfo.item_id);break;case"setting":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"ai":a.itemInfo&&(await la(a.itemInfo.item_id),window.location.reload());break;case"openapi":a.itemInfo&&await na(a.itemInfo.item_id);break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id);break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id);break}};return(T,x)=>{var M,V,U,N,A,P,D,E,ae;const I=H("a-tooltip"),S=H("a-badge");return C(),L("div",cI,[((M=c.itemInfo)==null?void 0:M.item_edit)==1&&c.pageId?(C(),B(I,{key:0,title:T.$t("page.edit_page"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:n},[...x[0]||(x[0]=[e("i",{class:"far fa-edit"},null,-1)])])]),_:1},8,["title"])):F("",!0),((V=c.itemInfo)==null?void 0:V.item_type)==3&&((U=c.itemInfo)!=null&&U.is_login)?(C(),B(I,{key:1,title:T.$t("item.runapi_edit_hint"),placement:"bottom"},{default:m(()=>[...x[1]||(x[1]=[e("div",{class:"icon-item disabled"},[e("i",{class:"far fa-edit"})],-1)])]),_:1},8,["title"])):F("",!0),s(I,{title:T.$t("item.share"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:y},[...x[2]||(x[2]=[e("i",{class:"far fa-share-nodes"},null,-1)])])]),_:1},8,["title"]),(N=c.itemInfo)!=null&&N.is_login?(C(),B(I,{key:2,title:T.$t("message.my_notice"),placement:"bottom"},{default:m(()=>[s(S,{count:f.value?"New":0,offset:[-5,5]},{default:m(()=>[e("div",{class:"icon-item",onClick:k},[...x[3]||(x[3]=[e("i",{class:"far fa-message"},null,-1)])])]),_:1},8,["count"])]),_:1},8,["title"])):F("",!0),(A=c.itemInfo)!=null&&A.is_login?(C(),B(I,{key:3,title:T.$t("user.user_center"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:r},[...x[4]||(x[4]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])):F("",!0),(P=c.itemInfo)!=null&&P.is_login?F("",!0):(C(),B(I,{key:4,title:T.$t("user.login"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:_},[...x[5]||(x[5]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])),(D=c.itemInfo)!=null&&D.is_login?F("",!0):(C(),B(I,{key:5,title:T.$t("item.aboutShowdoc"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:h},[...x[6]||(x[6]=[e("i",{class:"far fa-circle-info"},null,-1)])])]),_:1},8,["title"])),(E=c.itemInfo)!=null&&E.is_login?F("",!0):(C(),B(I,{key:6,title:T.$t("header.switch_language"),placement:"bottom"},{default:m(()=>[e("div",dI,[s(ht)])]),_:1},8,["title"])),s(I,{title:z(v).theme==="light"?T.$t("common.dark_mode"):T.$t("common.light_mode"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:p},[...x[7]||(x[7]=[e("i",{class:"far fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),(ae=c.itemInfo)!=null&&ae.item_manage?(C(),B(ut,{key:7,list:$.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:g},{default:m(()=>[...x[8]||(x[8]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const mI=Y(uI,[["__scopeId","data-v-675c91ff"]]),_I={class:"header-wrap"},pI={class:"logo"},fI={class:"logo-content"},vI={class:"font-bold"},hI={class:"cat-btn"},gI=W({__name:"MobileHeader",props:da({itemInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}},getPageContent:{type:Function,default:()=>{}},hideHeader:{type:Boolean,default:!1},isFullPage:{type:Boolean,default:!1}},{drawerVisible:{type:Boolean,default:!1},drawerVisibleModifiers:{}}),emits:da(["exitFullscreen"],["update:drawerVisible"]),setup(c,{emit:t}){const a=no(c,"drawerVisible"),o=()=>{a.value=!0};return(l,u)=>{var v;return C(),L("div",{class:re(["mobile-header",{"hide-element":c.hideHeader}])},[e("div",_I,[e("div",pI,[e("div",fI,[u[1]||(u[1]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",vI,i(((v=c.itemInfo)==null?void 0:v.item_name)||""),1)])]),c.isFullPage?(C(),L("div",{key:1,class:"exit-fullscreen-btn",onClick:u[0]||(u[0]=d=>l.$emit("exit-fullscreen"))},[u[3]||(u[3]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(l.$t("common.exit_fullscreen")),1)])):(C(),L("div",{key:0,class:"cat-btn-div",onClick:o},[e("div",hI,[u[2]||(u[2]=e("i",{class:"fas fa-folder-tree"},null,-1)),O(" "+i(l.$t("item.catalog")),1)])]))])],2)}}});const yI=Y(gI,[["__scopeId","data-v-2e86218e"]]),wI=W({__name:"index",props:{catId:{default:0},itemId:{default:0}},emits:["close"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),u=b(!0),v=b(!1),d=b(!1),p=b(a.itemId),f=b(0),$=b([]),g=b([{cat_id:0,cat_name:"/"}]),n=q(()=>[{label:l("catalog.copy_to"),value:!1},{label:l("catalog.move_to"),value:!0}]),y=q(()=>$.value.map(x=>({label:x.item_name,value:x.item_id}))),k=q(()=>g.value.map(x=>({label:x.cat_name,value:x.cat_id}))),r=async()=>{try{const x=await X("/api/item/myList",{},"post");x.error_code===0&&($.value=x.data||[],p.value=a.itemId)}catch(x){console.error("获取项目列表失败:",x)}},_=async x=>{try{const I=await X("/api/catalog/catListName",{item_id:x},"post");if(I.error_code===0){f.value=0;const S=(I.data||[]).map(M=>({...M,cat_id:Number(M.cat_id||0)}));g.value=[{cat_id:0,cat_name:"/"},...S]}}catch(I){console.error("获取目录列表失败:",I)}},h=x=>{_(x)},w=async()=>{if(f.value===a.catId){await G("不能将目录移动/克隆到自身");return}v.value=!0;try{const x=await X("/api/catalog/copy",{cat_id:a.catId,new_p_cat_id:f.value,to_item_id:p.value,is_del:d.value?1:0},"post");x.error_code===0?(ie.success(l("common.op_success")),T()):await G(x.error_message||l("common.op_failed"))}catch(x){console.error("复制/移动目录失败:",x),await G(l("common.op_failed"))}finally{v.value=!1}},T=()=>{o("close")};return oe(()=>{r(),_(a.itemId)}),(x,I)=>{const S=H("a-form-item"),M=H("a-form"),V=H("a-spin");return C(),B(de,{show:u.value,title:z(l)("catalog.clone_move"),width:"600px",onClose:T},{footer:m(()=>[s(K,{theme:"light",text:z(l)("common.cancel"),disabled:v.value,style:{"margin-right":"12px"},onClick:T},null,8,["text","disabled"]),s(K,{theme:"dark",text:z(l)("common.confirm"),disabled:v.value,onClick:w},null,8,["text","disabled"])]),default:m(()=>[s(V,{spinning:v.value},{default:m(()=>[s(M,{layout:"vertical"},{default:m(()=>[s(S,{label:z(l)("catalog.copy_or_move")},{default:m(()=>[s(Re,{value:d.value,"onUpdate:value":I[0]||(I[0]=U=>d.value=U),options:n.value,onChange:h},null,8,["value","options"])]),_:1},8,["label"]),s(S,{label:z(l)("catalog.target_project")},{default:m(()=>[s(Re,{value:p.value,"onUpdate:value":I[1]||(I[1]=U=>p.value=U),options:y.value,"show-search":!0,onChange:h},null,8,["value","options"])]),_:1},8,["label"]),s(S,{label:z(l)("catalog.target_catalog")},{default:m(()=>[s(Re,{value:f.value,"onUpdate:value":I[2]||(I[2]=U=>f.value=U),options:k.value},null,8,["value","options"])]),_:1},8,["label"])]),_:1})]),_:1},8,["spinning"])]),_:1},8,["show","title"])}}});const bI=Y(wI,[["__scopeId","data-v-b280b63c"]]);function $I(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(bI,{...c,onClose:()=>{t(!0),me(a,o)}});a.mount(o)})}const kI={class:"catalog-tree"},CI=["data-selected","id","onClick"],xI={class:"node-icon"},II={key:0,class:"far fa-folder-open"},SI={key:1,class:"far fa-folder-closed"},TI={key:1,class:"far fa-file-lines"},MI=["title"],LI=["onClick"],VI=W({__name:"CatalogTree",props:{itemInfo:{default:()=>({})},keyword:{default:""},getPageContent:{type:Function,default:()=>{}},searchItem:{type:Function,default:()=>{}}},emits:["reloadItem"],setup(c,{expose:t,emit:a}){const o=c,l=a,u=xe(),v=Ge(),{t:d}=te(),p=b(""),f=b([]),$=b([]),g=b([]),n=b({show:!1,x:0,y:0,node:null}),y=b(null),k=q(()=>{var Q;return((Q=o.itemInfo)==null?void 0:Q.item_edit)==1}),r=q(()=>{const Q=n.value.node;return Q?Q.type==="folder"?[{icon:["far","fa-plus"],text:d("page.new_page"),onclick:()=>A(Q)},{icon:["far","fa-folder-tree"],text:d("catalog.add_sub_cat"),onclick:()=>P(Q)},{icon:["far","fa-folder-plus"],text:d("catalog.add_sibling_cat"),onclick:()=>D(Q)},{icon:["far","fa-edit"],text:d("catalog.edit_cat"),onclick:()=>ae(Q)},{icon:["far","fa-clone"],text:d("catalog.clone_move"),onclick:()=>fe(Q)},{icon:["far","fa-trash-can"],text:d("common.delete"),onclick:()=>ee(Q)}]:[{icon:["far","fa-edit"],text:d("page.edit_page"),onclick:()=>ce(Q)},{icon:["far","fa-copy"],text:d("page.copy_page"),onclick:()=>ye(Q)},{icon:["far","fa-circle-info"],text:d("page.page_info"),onclick:()=>ze(Q)},{icon:["far","fa-clock-rotate-left"],text:d("page.history_version"),onclick:()=>Ve(Q)},{icon:["far","fa-trash-can"],text:d("page.delete_page"),onclick:()=>De(Q)}]:[]}),_=()=>{var se;if(!((se=o.itemInfo)!=null&&se.menu))return;g.value=is(o.itemInfo.menu);const Q=o.itemInfo.default_page_id||0;if(Q){const be=ma(g.value,Q);be&&($.value=be,f.value=[`page_${Q}`],ct(()=>{setTimeout(()=>{const Te=document.querySelector(`[data-node-key="page_${Q}"]`);Te&&Te.scrollIntoView({block:"center",behavior:"smooth"}),o.getPageContent(Q)},500)}))}},h=Q=>{$.value=Q},w=(Q,se,be,Te)=>{const we=x(g.value);if(y.value=we.find(le=>le.key===se),be==="folder"){const le=[...$.value],_e=le.indexOf(se);_e>-1?le.splice(_e,1):le.push(se),$.value=le}else{const le=y.value;if(le&&le.page_id){f.value=[se],o.getPageContent(le.page_id);const ke=`/${o.itemInfo.item_domain||o.itemInfo.item_id}/${le.page_id}`;v.path!==ke&&u.replace(ke)}}},T=(Q,se,be)=>{if(!k.value)return;let Te,we,le=null;if(Q&&Q.type==="click"){const _e=x(g.value);if(se?le=_e.find(Ie=>Ie.key===se):le=y.value,!le)return;const he=Q.currentTarget.getBoundingClientRect();Te=he.left,we=he.bottom+5}else Q&&(Q.type==="contextmenu"||Q.type==="mousedown")?(le=y.value,Te=Q.clientX,we=Q.clientY):(le=y.value,Te=n.value.x||0,we=n.value.y||0);le&&(n.value={show:!0,x:Te,y:we,node:le})},x=Q=>{const se=[],be=Te=>{Te.forEach(we=>{se.push(we),we.children&&we.children.length>0&&be(we.children)})};return be(Q),se},I=({event:Q,node:se})=>{k.value&&(Q.preventDefault(),Q.stopPropagation(),y.value=se,T(Q))},S=()=>{n.value.show=!1,n.value.node=null},M=async Q=>{if(p.value)return;const{dragNode:se,node:be,dropPosition:Te,dropToGap:we}=Q;if(!we&&be.type!=="folder")return;const le=(he,Ie,Me)=>{for(let Oe=0;Oe<he.length;Oe++){if(he[Oe].key===Ie)return Me(he[Oe],Oe,he);he[Oe].children&&le(he[Oe].children,Ie,Me)}},_e=[...g.value];let ke;if(le(_e,se.key,(he,Ie,Me)=>{Me.splice(Ie,1),ke=he}),!!ke){if(!we)le(_e,be.key,he=>{he.children=he.children||[],he.children.push(ke)});else if((be.children||[]).length>0&&be.expanded&&Te===1)le(_e,be.key,he=>{he.children=he.children||[],he.children.unshift(ke)});else{let he,Ie;le(_e,be.key,(Me,Oe,mt)=>{he=mt,Ie=Oe}),Ie!==void 0&&he&&(Te===-1?he.splice(Ie,0,ke):he.splice(Ie+1,0,ke))}g.value=_e,await V(_e)}},V=async Q=>{const se=[],be=(we,le,_e,ke)=>{const he=we.type==="folder"&&we.cat_id||0;se.push({cat_id:he,cat_name:we.title||"",page_id:we.page_id||0,parent_cat_id:le||0,page_cat_id:le||0,level:_e,s_number:ke+1}),we.children&&we.children.forEach((Ie,Me)=>{be(Ie,he,_e+1,Me)})};Q.forEach((we,le)=>{be(we,0,2,le)});const Te=await X("/api/catalog/batUpdate",{item_id:o.itemInfo.item_id,cats:JSON.stringify(se)},"post");Te.error_code!==0&&await G(Te.error_message||d("common.op_failed"))},U=()=>{o.searchItem(p.value)},N=()=>{p.value="",o.searchItem("")},A=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:0,copyPageId:0,catId:Q.cat_id})&&l("reloadItem")}catch(se){console.error("添加子页面失败:",se)}},P=async Q=>{const se=await it(d("catalog.add_sub_cat"),"",d("catalog.cat_name"));!se||!se.trim()||await E(Q.cat_id,se.trim())},D=async Q=>{const se=await it(d("catalog.add_sibling_cat"),"",d("catalog.cat_name"));!se||!se.trim()||await E(Q.parent_cat_id,se.trim())},E=async(Q,se)=>{try{const be=await X("/api/catalog/save",{item_id:o.itemInfo.item_id,cat_id:0,parent_cat_id:Q,cat_name:se},"post",!1);be.error_code===0?(ie.success(d("common.save_success")),l("reloadItem")):await G(be.error_message||d("common.op_failed"))}catch(be){console.error("创建目录失败:",be),await G(d("common.op_failed"))}},ae=async Q=>{const se=await it(d("catalog.edit_cat"),Q.title,d("catalog.cat_name"));se===null||se===Q.title||!se.trim()||await ge(Q.cat_id,Q.parent_cat_id,se.trim())},ge=async(Q,se,be)=>{try{const Te=await X("/api/catalog/save",{item_id:o.itemInfo.item_id,cat_id:Q,parent_cat_id:se,cat_name:be},"post",!1);Te.error_code===0?(ie.success(d("common.save_success")),l("reloadItem")):await G(Te.error_message||d("common.op_failed"))}catch(Te){console.error("编辑目录失败:",Te),await G(d("common.op_failed"))}},fe=async Q=>{await $I({catId:Q.cat_id,itemId:o.itemInfo.item_id})&&l("reloadItem")},ee=async Q=>{await Se({msg:d("catalog.confirm_cat_delete"),title:d("common.tips")})&&await J(Q.cat_id)},J=async Q=>{try{const se=await X("/api/catalog/delete",{item_id:o.itemInfo.item_id,cat_id:Q},"post",!1);se.error_code===0?(ie.success(d("common.op_success")),l("reloadItem")):await G(se.error_message||d("common.op_failed"))}catch(se){console.error("删除目录失败:",se),await G(d("common.op_failed"))}},ce=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:Q.page_id,copyPageId:0,catId:Q.page_cat_id})&&l("reloadItem")}catch(se){console.error("编辑页面失败:",se)}},ye=async Q=>{try{await rt({itemId:o.itemInfo.item_id,editPageId:0,copyPageId:Q.page_id})&&l("reloadItem")}catch(se){console.error("复制页面失败:",se)}},ze=async Q=>{try{const se=await X("/api/page/info",{page_id:Q.page_id},"post",!1);if(se.error_code===0&&se.data){const be=`本页面由 ${se.data.author_username} 于 ${se.data.addtime} 更新`;await G(be,{dangerouslyUseHTMLString:!0})}}catch(se){console.error("获取页面信息失败:",se)}},Ve=async Q=>{try{await Lt({pageId:Q.page_id})}catch(se){console.error("打开历史版本失败:",se)}},De=async Q=>{await Se({msg:d("common.confirm_delete"),title:d("common.tips")})&&await Ze(Q.page_id)},Ze=async Q=>{try{const se=await X("/api/page/delete",{page_id:Q},"post",!1);se.error_code===0?(ie.success(d("common.op_success")),l("reloadItem")):await G(se.error_message||d("common.op_failed"))}catch(se){console.error("删除页面失败:",se),await G(d("common.op_failed"))}};t({expandAll:()=>{$.value=rs(g.value)},collapseAll:()=>{$.value=[]},scrollToPage:Q=>{if(!Q||!g.value.length)return;const se=`page_${Q}`,be=ma(g.value,Q);be&&($.value=be),f.value=[se],ct(()=>{setTimeout(()=>{const Te=document.querySelector(`#node-${se}`);Te&&Te.scrollIntoView({block:"center",behavior:"smooth"})},500)})}}),qe(()=>o.itemInfo,Q=>{Q&&Q.menu&&_()},{immediate:!0,deep:!0}),qe(()=>o.keyword,Q=>{Q!==void 0&&(p.value=Q)});let Ue=null;return qe(p,Q=>{Ue&&clearTimeout(Ue),Ue=setTimeout(()=>{o.searchItem&&o.searchItem(Q)},500)}),qe(f,Q=>{ct(()=>{document.querySelectorAll(".ant-tree-node-content-wrapper").forEach(be=>{be.classList.remove("node-content-wrapper-selected")}),Q.length>0&&document.querySelectorAll(".ant-tree-treenode").forEach(Te=>{const we=Te.querySelector(".tree-node-content");if(we&&we.getAttribute("data-selected")==="true"){const le=Te.querySelector(".ant-tree-node-content-wrapper");le&&le.classList.add("node-content-wrapper-selected")}})})}),oe(()=>{_()}),(Q,se)=>{const be=H("a-input"),Te=H("a-tree");return C(),L("div",kI,[s(be,{value:p.value,"onUpdate:value":se[0]||(se[0]=we=>p.value=we),placeholder:Q.$t("common.input_keyword"),"allow-clear":"",size:"large",onPressEnter:U,onClear:N,class:"search-input"},{prefix:m(()=>[...se[1]||(se[1]=[e("i",{class:"far fa-search"},null,-1)])]),_:1},8,["value","placeholder"]),g.value.length>0?(C(),B(Te,{key:0,ref:"treeRef",selectedKeys:f.value,expandedKeys:$.value,"tree-data":g.value,draggable:k.value,selectable:!1,"block-node":!0,onExpand:h,onRightClick:I,onDrop:M,class:"tree-container"},{switcherIcon:m(({switcherCls:we})=>[e("div",{class:re(we)},[...se[2]||(se[2]=[e("i",{class:"far fa-angle-down"},null,-1)])],2)]),title:m(({key:we,title:le,type:_e,children:ke})=>[e("div",{class:re(["tree-node-content",{"node-selected":f.value.includes(we)}]),"data-selected":f.value.includes(we),id:`node-${we}`,onClick:he=>w(he,we,_e,ke)},[e("span",xI,[_e==="folder"?(C(),L(Ce,{key:0},[$.value.includes(we)&&(ke!=null&&ke.length)?(C(),L("i",II)):(C(),L("i",SI))],64)):(C(),L("i",TI))]),e("span",{class:re(["node-title",`node-${_e}`]),title:le},i(le),11,MI),k.value?(C(),L("div",{key:0,class:"node-more",onClick:lt(he=>T(he,we,_e),["stop"])},[...se[3]||(se[3]=[e("i",{class:"far fa-ellipsis"},null,-1)])],8,LI)):F("",!0)],10,CI)]),_:1},8,["selectedKeys","expandedKeys","tree-data","draggable"])):F("",!0),n.value.show?(C(),B(z(gs),{key:1,x:n.value.x,y:n.value.y,list:r.value,onClose:S},null,8,["x","y","list"])):F("",!0)])}}});const va=Y(VI,[["__scopeId","data-v-3b64837f"]]),zI={key:0,class:"catalog-actions"},UI={class:"action-item more-action-wrapper"},PI=W({__name:"CatalogActions",props:{itemId:{default:0},pageId:{default:0},pageInfo:{default:()=>({})},searchItem:{type:Function,default:()=>{}},expandAll:{type:Function,default:()=>{}},collapseAll:{type:Function,default:()=>{}}},emits:["reloadItem"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),u=q(()=>{const n=[{icon:["far","fa-recycle"],text:l("item.recycle"),value:"recycle"}];return a.pageId&&n.push({icon:["far","fa-clock-rotate-left"],text:l("page.page_history_version"),value:"history"},{icon:["far","fa-circle-info"],text:l("page.page_info"),value:"info"}),n.push({icon:["far","fa-folder-open"],text:l("catalog.expand_all"),value:"expand-all"},{icon:["far","fa-folder-closed"],text:l("catalog.collapse_all"),value:"collapse-all"}),n}),v=async()=>{if(!a.itemId){ie.info(l("common.please_select_item"));return}try{await rt({itemId:a.itemId,editPageId:0,copyPageId:0})&&o("reloadItem")}catch(n){console.error("打开页面编辑器失败:",n)}},d=async()=>{if(!a.pageId){ie.info(l("common.please_select_page"));return}try{await rt({itemId:a.itemId||0,editPageId:0,copyPageId:a.pageId})&&o("reloadItem")}catch(n){console.error("复制页面失败:",n)}},p=async()=>{const n=await it(l("catalog.add_cat"),"",l("catalog.cat_name"));!n||!n.trim()||$(n.trim(),0)},f=async n=>{switch(n.value){case"recycle":a.itemId&&await Mt(a.itemId);break;case"history":a.pageId&&await Lt({pageId:a.pageId,allowRecover:!1,allowEdit:!1});break;case"info":g();break;case"expand-all":a.expandAll();break;case"collapse-all":a.collapseAll();break}},$=async(n,y)=>{try{const k=await X("/api/catalog/save",{item_id:a.itemId,cat_id:0,parent_cat_id:y,cat_name:n},"post",!1);k.error_code===0?(ie.success(l("common.save_success")),o("reloadItem")):await G(k.error_message||l("common.save_failed"))}catch(k){console.error("创建目录失败:",k),await G(l("common.save_failed"))}},g=async()=>{if(!a.pageInfo)return;const n=`本页面由 ${a.pageInfo.author_username} 于 ${a.pageInfo.addtime} 更新`;await G(n,{dangerouslyUseHTMLString:!0})};return(n,y)=>{const k=H("a-tooltip");return c.itemId?(C(),L("div",zI,[s(k,{title:n.$t("page.new_page"),placement:"top"},{default:m(()=>[e("div",{class:"action-item",onClick:v},[...y[0]||(y[0]=[e("i",{class:"far fa-plus"},null,-1)])])]),_:1},8,["title"]),s(k,{title:n.$t("page.copy_page"),placement:"top"},{default:m(()=>[e("div",{class:"action-item",onClick:d},[...y[1]||(y[1]=[e("i",{class:"far fa-clone"},null,-1)])])]),_:1},8,["title"]),s(k,{title:n.$t("catalog.add_cat"),placement:"top"},{default:m(()=>[e("div",{class:"action-item",onClick:p},[...y[2]||(y[2]=[e("i",{class:"far fa-folder-plus"},null,-1)])])]),_:1},8,["title"]),e("div",UI,[s(ut,{list:u.value,trigger:"hover",placement:"top",onSelect:f},{default:m(()=>[...y[3]||(y[3]=[e("div",{class:"more-trigger"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])])])):F("",!0)}}});const ha=Y(PI,[["__scopeId","data-v-2787ec52"]]),AI={key:0,class:"page-comments"},DI={class:"comments-header"},OI={class:"comments-title"},NI={key:0,class:"comments-count"},FI={key:0,class:"comments-list"},qI=["id"],RI={class:"comment-main"},HI={class:"comment-header"},EI={class:"username"},jI={class:"time"},BI=["textContent"],GI={class:"comment-actions"},KI={key:0,class:"comment-replies"},JI={class:"reply-header"},WI={class:"username"},YI={class:"time"},XI=["textContent"],QI={key:1,class:"reply-form"},ZI={class:"reply-form-actions"},e4={key:1,class:"comments-empty"},t4={key:2,class:"comments-pagination"},a4={key:3,class:"comment-form"},o4={class:"comment-form-actions"},s4={key:4,class:"comment-login-tip"},Ft=20,l4=W({__name:"PageComment",props:{pageId:{default:0},itemInfo:{default:()=>({})}},setup(c){const t=c,a=xe(),{t:o}=te(),l=Qe(),u=b([]),v=b(0),d=b(1),p=b(!1),f=b(!1),$=b(""),g=b(0),n=b(""),y=b(""),k=b(!1),r=b(!1);let _=null;const h=()=>{k.value=l.isLoggedIn},w=async()=>{if(t.pageId){p.value=!0;try{const A=await cs({page_id:t.pageId,page:d.value,count:Ft});A.error_code===0&&A.data&&(u.value=A.data.comments||[],v.value=A.data.total||0)}catch(A){console.error("加载评论失败:",A)}finally{p.value=!1}}},T=async()=>{if(!$.value.trim()){ie.warning(o("pageComment.placeholder"));return}f.value=!0;try{(await _a({page_id:t.pageId,content:$.value.trim(),parent_id:0})).error_code===0&&($.value="",ie.success(o("pageComment.success")),d.value=1,await w(),setTimeout(()=>{const P=document.querySelector(".page-comments");P&&P.scrollIntoView({behavior:"smooth",block:"start"})},0))}catch(A){console.error("发表评论失败:",A)}finally{f.value=!1}},x=(A,P)=>{g.value=A,n.value=P,y.value=""},I=()=>{g.value=0,n.value="",y.value=""},S=async A=>{if(!y.value.trim()){ie.warning(o("pageComment.replyPlaceholder"));return}f.value=!0;try{(await _a({page_id:t.pageId,content:y.value.trim(),parent_id:A})).error_code===0&&(I(),ie.success(o("pageComment.replySuccess")),await w())}catch(P){console.error("发表回复失败:",P)}finally{f.value=!1}},M=async A=>{try{await Se({title:o("tips"),content:o("pageComment.deleteConfirm"),confirmText:o("common.confirm"),cancelText:o("common.cancel")})&&(await ds(A)).error_code===0&&(ie.success(o("pageComment.delete")+o("common.success")),await w())}catch(P){P!=="cancel"&&console.error("删除评论失败:",P)}},V=A=>{d.value=A,w(),setTimeout(()=>{const P=document.querySelector(".page-comments");P&&P.scrollIntoView({behavior:"smooth",block:"start"})},0)},U=()=>{const A=a.currentRoute.value.fullPath;a.push({path:"/user/login",query:{redirect:A}})},N=()=>{_&&(clearTimeout(_),_=null),t.pageId&&t.itemInfo&&(t.itemInfo.allow_comment==1||t.itemInfo.allow_comment===!0)?(r.value=!0,_=window.setTimeout(()=>{w()},1e3)):r.value=!1};return qe(()=>t.pageId,N,{immediate:!0}),qe(()=>t.itemInfo,N,{deep:!0,immediate:!0}),oe(()=>{h()}),Xe(()=>{_&&(clearTimeout(_),_=null)}),(A,P)=>{const D=H("a-pagination");return r.value?(C(),L("div",AI,[e("div",DI,[e("span",OI,i(A.$t("pageComment.title")),1),v.value>0?(C(),L("span",NI,i(A.$t("pageComment.total",{count:v.value})),1)):F("",!0)]),u.value.length>0?(C(),L("div",FI,[(C(!0),L(Ce,null,Pe(u.value,E=>(C(),L("div",{class:"comment-item",key:E.comment_id,id:"comment-"+E.comment_id},[e("div",RI,[e("div",HI,[e("span",EI,"👤 "+i(E.username),1),e("span",jI,i(E.addtime_text),1)]),e("div",{class:"comment-content",textContent:i(E.content)},null,8,BI),e("div",GI,[k.value?(C(),B(K,{key:0,type:"text",size:"small",onClick:ae=>x(E.comment_id,E.username)},{default:m(()=>[O(i(A.$t("pageComment.reply")),1)]),_:1},8,["onClick"])):F("",!0),E.can_delete?(C(),B(K,{key:1,type:"text",size:"small",onClick:ae=>M(E.comment_id)},{default:m(()=>[O(i(A.$t("pageComment.delete")),1)]),_:1},8,["onClick"])):F("",!0)])]),E.replies&&E.replies.length>0?(C(),L("div",KI,[(C(!0),L(Ce,null,Pe(E.replies,ae=>(C(),L("div",{class:"reply-item",key:ae.comment_id},[e("div",JI,[e("span",WI,"↪ "+i(ae.username),1),e("span",YI,i(ae.addtime_text),1),ae.can_delete?(C(),B(K,{key:0,type:"text",size:"small",onClick:ge=>M(ae.comment_id)},{default:m(()=>[O(i(A.$t("pageComment.delete")),1)]),_:1},8,["onClick"])):F("",!0)]),e("div",{class:"reply-content",textContent:i(ae.content)},null,8,XI)]))),128))])):F("",!0),g.value===E.comment_id?(C(),L("div",QI,[s(tt,{modelValue:y.value,"onUpdate:modelValue":P[0]||(P[0]=ae=>y.value=ae),rows:2,maxlength:500,placeholder:A.$t("pageComment.replyPlaceholder",{username:n.value})},null,8,["modelValue","placeholder"]),e("div",ZI,[s(K,{size:"small",onClick:I},{default:m(()=>[O(i(A.$t("pageComment.cancel")),1)]),_:1}),s(K,{type:"primary",size:"small",loading:f.value,onClick:ae=>S(E.comment_id)},{default:m(()=>[O(i(A.$t("pageComment.submitReply")),1)]),_:1},8,["loading","onClick"])])])):F("",!0)],8,qI))),128))])):p.value?F("",!0):(C(),L("div",e4,i(A.$t("pageComment.empty")),1)),v.value>Ft?(C(),L("div",t4,[s(D,{current:d.value,"page-size":Ft,total:v.value,onChange:V,small:""},null,8,["current","total"])])):F("",!0),k.value?(C(),L("div",a4,[s(tt,{modelValue:$.value,"onUpdate:modelValue":P[1]||(P[1]=E=>$.value=E),rows:3,maxlength:500,placeholder:A.$t("pageComment.placeholder")},null,8,["modelValue","placeholder"]),e("div",o4,[s(K,{type:"primary",size:"small",loading:f.value,onClick:T},{default:m(()=>[O(i(A.$t("pageComment.submit")),1)]),_:1},8,["loading"])])])):(C(),L("div",s4,[e("span",null,i(A.$t("pageComment.loginTip")),1),s(K,{type:"text",onClick:U},{default:m(()=>[O(i(A.$t("pageComment.loginButton")),1)]),_:1})]))])):F("",!0)}}});const n4=Y(l4,[["__scopeId","data-v-70d33d28"]]),i4={key:0,class:"page-feedback"},r4={class:"feedback-title"},c4={class:"feedback-buttons"},d4=W({__name:"PageFeedback",props:{pageId:{default:0},itemInfo:{default:()=>({})}},setup(c){const t=c;te();const a=b(0),o=b(0),l=b(0),u=b(!1),v=b(!1);let d=null;const p=async()=>{if(t.pageId)try{const g=await ms(t.pageId);g.error_code===0&&g.data&&(a.value=g.data.helpful_count||0,o.value=g.data.unhelpful_count||0,l.value=g.data.user_feedback||0)}catch(g){console.error("加载反馈统计失败:",g)}},f=async g=>{if(t.pageId){l.value===g&&(g=0),u.value=!0;try{const n=await us({page_id:t.pageId,feedback_type:g});n.error_code===0&&n.data&&(a.value=n.data.helpful_count||0,o.value=n.data.unhelpful_count||0,l.value=n.data.user_feedback||0,n.data.message&&ie.success(n.data.message))}catch(n){console.error("提交反馈失败:",n)}finally{u.value=!1}}},$=()=>{d&&(clearTimeout(d),d=null),t.pageId&&t.itemInfo&&(t.itemInfo.allow_feedback==1||t.itemInfo.allow_feedback===!0)?(v.value=!0,d=window.setTimeout(()=>{p()},1e3)):v.value=!1};return qe(()=>t.pageId,$,{immediate:!0}),qe(()=>t.itemInfo,$,{deep:!0,immediate:!0}),Xe(()=>{d&&(clearTimeout(d),d=null)}),(g,n)=>v.value?(C(),L("div",i4,[e("div",r4,i(g.$t("pageFeedback.title")),1),e("div",c4,[s(K,{type:l.value===1?"primary":"default",size:"small",loading:u.value,onClick:n[0]||(n[0]=y=>f(1))},{default:m(()=>[n[2]||(n[2]=e("i",{class:"fas fa-thumbs-up"},null,-1)),O(" "+i(g.$t("pageFeedback.helpful"))+" ("+i(a.value)+") ",1)]),_:1},8,["type","loading"]),s(K,{type:l.value===2?"primary":"default",size:"small",loading:u.value,onClick:n[1]||(n[1]=y=>f(2))},{default:m(()=>[n[3]||(n[3]=e("i",{class:"fas fa-thumbs-down"},null,-1)),O(" "+i(g.$t("pageFeedback.unhelpful"))+" ("+i(o.value)+") ",1)]),_:1},8,["type","loading"])])])):F("",!0)}});const u4=Y(d4,[["__scopeId","data-v-b7304daa"]]),m4={key:0,class:"pos"},_4={class:"drawer-content"},p4={class:"doc-container",id:"doc-container"},f4={key:0,id:"left-side"},v4={id:"content-side"},h4={id:"p-content"},g4={class:"doc-title-box"},y4={class:"doc-title"},w4={class:"doc-actions"},b4={class:"doc-body"},$4={class:"page-content-main",id:"page-content-main"},k4={key:1,class:"empty-tips"},C4={id:"feedback-area"},x4={key:0,id:"comment-area"},I4={key:1,id:"right-side"},S4=W({__name:"index",props:{itemInfo:{default:()=>({})}},emits:["reloadItem"],setup(c,{emit:t}){const a=c,o=t,l=Ge(),u=xe(),{t:v}=te(),d=_s(),p=b(),f=b(!0),$=b(!0),g=b(!1),n=b(!0),y=b("pc"),k=b(!1),r=b(!1),_=b(0),h=b(0),w=b(""),T=b(""),x=b(null),I=b(0),S=b(0),M=b(0),V=b(""),U=b(!1),N=b(!1),A=b(a.itemInfo||{}),P=b(null),D=b(0),E=b({}),ae=b(!1),ge=b(0),fe=()=>window.innerWidth<768||U.value,ee=q(()=>{var le;return((le=A.value)==null?void 0:le.item_edit)==1}),J=async()=>{var le;if((le=A.value)!=null&&le.item_id)try{const _e=await X("/api/item/getAiKnowledgeBaseConfig",{item_id:A.value.item_id});if(_e.error_code===0&&_e.data){let ke=!1;_e.data.ai_config?ke=_e.data.ai_config.enabled>0:_e.data.enabled!==void 0?ke=_e.data.enabled>0:_e.data.ai_knowledge_base_enabled!==void 0&&(ke=_e.data.ai_knowledge_base_enabled>0),ae.value=ke}else ae.value=!1}catch{ae.value=!1}},ce=(le,_e)=>{if(!_e||!le)return le;const ke=_e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),he=new RegExp(`(${ke})`,"gi");return le.replace(he,"<mark>$1</mark>")},ye=async le=>{if(le<=0)return;fe()&&k.value&&le!==ge.value&&(k.value=!1),ge.value=le;const _e=Date.now(),ke=E.value[le]||0;if(_e-ke<1e3)return;E.value[le]=_e,se();const he=!!V.value,Ie={page_id:le};he&&(Ie.with_path=1);try{const Me=await X("/api/page/info",Ie,"post",!1);if(Me.error_code===0&&Me.data){let Oe=It(Me.data.page_content||"",A.value.global_param);he&&V.value&&(Oe=ce(Oe,V.value)),T.value=Oe,d.setOpenCatId(Me.data.cat_id),w.value=Me.data.page_title,he&&(Me.data.from_search_result=!0),x.value=Me.data,I.value=Me.data.cat_id,S.value=Me.data.item_id,M.value=Me.data.attachment_count||0;const _t=`/${A.value.item_domain||A.value.item_id}/${le}`;l.path!==_t&&u.replace(_t),setTimeout(()=>{var pt;h.value=le,we(),document.title=`${w.value}--ShowDoc`,(pt=p.value)!=null&&pt.scrollToPage&&!V.value&&p.value.scrollToPage(le)},0)}}catch(Me){console.error("获取页面内容失败:",Me),await G(v("fetch_page_content_failed"))}},ze=async()=>{x.value&&await Ba({itemId:x.value.item_id,pageId:x.value.page_id,manage:!1,onClose:()=>{}})},Ve=async le=>{var _e,ke;if(V.value=le,le){const he={page_title:`${v("search_results_for")} "${le}"`,cat_id:0,is_search_result:!0};x.value=he,w.value=he.page_title;try{const Ie=(_e=A.value)==null?void 0:_e.item_id;if(Ie){const Me=await X("/api/item/info",{item_id:Ie,keyword:le},"post",!1);Me.error_code===0&&Me.data&&(A.value=Me.data,T.value="",h.value=0,J())}}catch(Ie){console.error("搜索项目失败:",Ie)}}else{h.value||(x.value=null);try{const he=(ke=A.value)==null?void 0:ke.item_id;if(he){const Ie=await ps(String(he));Ie.error_code===0&&Ie.data&&(A.value=Ie.data,Ie.data.default_page_id&&await ye(Ie.data.default_page_id))}}catch(he){console.error("加载项目失败:",he)}}},De=({index:le,checked:_e})=>{var ke;(ke=A.value)!=null&&ke.item_edit&&(T.value=Da(T.value,le,_e),Ze())},Ze=()=>{P.value&&clearTimeout(P.value),P.value=window.setTimeout(async()=>{if(h.value)try{await X("/api/page/save",{page_id:h.value,item_id:A.value.item_id,cat_id:I.value,page_title:w.value,is_urlencode:1,page_content:encodeURIComponent(T.value)},"post",!1)}catch(le){console.error("保存任务列表失败:",le)}},800)},je=()=>{p.value&&p.value.expandAll()},Ye=()=>{p.value&&p.value.collapseAll()},Ke=()=>{o("reloadItem")},Ue=()=>{$.value=!1,g.value=!0,n.value=!1,y.value="mobile"},Q=()=>{if(!fe())return;const le=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;le<100||le<_.value?r.value=!1:r.value=!0,_.value=le},se=()=>{fe()&&Ue()},be=()=>{U.value=!U.value,U.value?Ue():($.value=!0,g.value=!1,n.value=!0,y.value="pc",r.value=!1)},Te=()=>{window.location.reload()},we=()=>{const le=window.location.hash;le==="#comment-area"||le==="#feedback-area"?setTimeout(()=>{const _e=document.querySelector(le);_e&&_e.scrollIntoView({behavior:"smooth",block:"start"})},1500):document.body.scrollTop=document.documentElement.scrollTop=0};return qe(()=>a.itemInfo,le=>{le&&(A.value=le,le.menu&&le.menu.catalogs&&le.menu.catalogs.length===0&&le.menu.pages&&le.menu.pages.length===0?N.value=!0:N.value=!1,setTimeout(()=>{J()},100))},{immediate:!0}),qe(()=>T.value,(le,_e)=>{le!==_e&&le&&D.value++}),oe(()=>{se(),window.addEventListener("scroll",Q)}),ya(()=>{window.removeEventListener("scroll",Q)}),(le,_e)=>{var he;const ke=H("a-drawer");return f.value?(C(),L("div",{key:0,class:re(["show-regular-item",y.value])},[g.value?(C(),L("div",m4)):F("",!0),$.value?(C(),B(Vt,{key:1,"item-info":A.value},{right:m(()=>[s(mI,{"page-id":h.value,"item-info":A.value,"page-info":x.value,"search-item":Ve},null,8,["page-id","item-info","page-info"])]),_:1},8,["item-info"])):F("",!0),g.value?(C(),B(yI,{key:2,drawerVisible:k.value,"onUpdate:drawerVisible":_e[0]||(_e[0]=Ie=>k.value=Ie),"item-info":A.value,"search-item":Ve,"get-page-content":ye,"hide-header":r.value,"is-full-page":U.value,onExitFullscreen:Te},null,8,["drawerVisible","item-info","hide-header","is-full-page"])):F("",!0),s(ke,{visible:k.value,onClose:_e[1]||(_e[1]=Ie=>k.value=!1),placement:"right",width:"80%",closable:!0,"mask-closable":!0,title:"目录"},{default:m(()=>[e("div",_4,[s(va,{ref_key:"catalogTreeRef",ref:p,keyword:V.value,"item-info":A.value,"get-page-content":ye,"search-item":Ve,onReloadItem:Ke},null,8,["keyword","item-info"]),A.value&&ee.value?(C(),B(ha,{key:0,"item-id":A.value.item_id,"page-id":h.value,"page-info":x.value,"expand-all":je,"collapse-all":Ye,"search-item":Ve,onReloadItem:Ke},null,8,["item-id","page-id","page-info"])):F("",!0)])]),_:1},8,["visible"]),e("div",p4,[n.value?(C(),L("div",f4,[s(va,{ref_key:"catalogTreeRef",ref:p,keyword:V.value,"item-info":A.value,"get-page-content":ye,"search-item":Ve,onReloadItem:Ke},null,8,["keyword","item-info"]),A.value&&ee.value?(C(),B(ha,{key:0,"item-id":A.value.item_id,"page-id":h.value,"page-info":x.value,"expand-all":je,"collapse-all":Ye,"search-item":Ve,onReloadItem:Ke},null,8,["item-id","page-id","page-info"])):F("",!0)])):F("",!0),e("div",v4,[e("div",h4,[V.value&&x.value?(C(),B(ys,{key:0,"page-info":x.value,"item-info":A.value,keyword:V.value},null,8,["page-info","item-info","keyword"])):F("",!0),e("div",g4,[e("span",y4,i(w.value),1),e("span",w4,[M.value?(C(),L("i",{key:0,class:"far fa-paperclip attachment-icon",onClick:ze})):F("",!0),h.value&&!fe()?(C(),L("i",{key:1,class:re([U.value?"far fa-compress":"far fa-expand","full-page-icon"]),onClick:be},null,2)):F("",!0)])]),e("div",b4,[e("div",$4,[h.value?(C(),B(St,{key:`${h.value}-${U.value}`,modelValue:T.value,"onUpdate:modelValue":_e[2]||(_e[2]=Ie=>T.value=Ie),mode:"preview",onTaskToggle:De},null,8,["modelValue"])):N.value?(C(),L("div",k4,[..._e[3]||(_e[3]=[e("div",{class:"icon"},[e("i",{class:"far fa-exclamation-triangle"})],-1),e("div",{class:"text"},[e("p",null,"当前项目是空的，你可以点击左下方的 + 以手动添加页面。")],-1)])])):F("",!0)]),e("div",C4,[h.value&&A.value&&!fe()?(C(),B(u4,{key:0,"page-id":h.value,"item-info":A.value},null,8,["page-id","item-info"])):F("",!0)]),fe()?F("",!0):(C(),L("div",x4,[h.value&&A.value?(C(),B(n4,{key:0,"page-id":h.value,"item-info":A.value},null,8,["page-id","item-info"])):F("",!0)]))])])]),!fe()&&!U.value?(C(),L("div",I4,[(C(),B(aa,{key:D.value}))])):F("",!0)]),s(ta,{visibilityHeight:100}),ae.value&&((he=A.value)!=null&&he.item_id)?(C(),B(ws,{key:3,"item-id":A.value.item_id,"item-name":A.value.item_name},null,8,["item-id","item-name"])):F("",!0)],2)):F("",!0)}}});const T4=Y(S4,[["__scopeId","data-v-44b8cc98"]]),M4={class:"header-right"},L4={class:"icon-item language-item"},V4=W({__name:"HeaderRight",props:{itemInfo:{default:()=>({})},pageId:{default:0},pageInfo:{default:()=>({})}},emits:["editPage","reload"],setup(c,{emit:t}){const a=c,o=t,l=xe(),{t:u}=te(),v=He(),d=()=>{v.toggleTheme()},p=q(()=>{const r=[{value:"export",icon:["far","fa-arrow-down-to-bracket"],text:u("item.export")}];return a.pageId&&r.push({value:"history",icon:["far","fa-rectangle-history"],text:u("page.page_history_version")}),r.push({value:"update",icon:["far","fa-edit"],text:u("item.updateBaseInfo")},{value:"attorn",icon:["far","fa-recycle"],text:u("item.attorn")},{value:"changelog",icon:["far","fa-clock-rotate-left"],text:u("item.change_log")},{value:"archive",icon:["far","fa-box-archive"],text:u("item.archive")},{value:"delete",icon:["far","fa-trash-can"],text:u("item.delete_item")}),r}),f=()=>{var r;a.pageId&&l.push(`/page/edit/${(r=a.itemInfo)==null?void 0:r.item_id}/${a.pageId}`),o("editPage")},$=async()=>{var r,_;a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id,page_id:a.pageId,page_unique_key:(r=a.pageInfo)==null?void 0:r.unique_key,page_title:(_=a.pageInfo)==null?void 0:_.page_title,item_info:a.itemInfo})},g=async()=>{a.itemInfo&&await yt(a.itemInfo.item_id)},n=()=>{l.push("/user/login")},y=()=>{ie.info(u("common.coming_soon"))},k=async r=>{switch(r.value){case"export":a.itemInfo&&await Ja(a.itemInfo.item_id);break;case"history":a.pageId&&await Lt({pageId:a.pageId,allowRecover:!1,allowEdit:!1});break;case"update":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id);break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id);break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id);break}};return(r,_)=>{var w,T,x,I,S,M,V;const h=H("a-tooltip");return C(),L("div",M4,[((w=c.itemInfo)==null?void 0:w.item_edit)==1?(C(),L("div",{key:0,class:"icon-item",onClick:f},[s(h,{title:r.$t("page.edit_page"),placement:"bottom"},{default:m(()=>[..._[0]||(_[0]=[e("i",{class:"far fa-edit"},null,-1)])]),_:1},8,["title"])])):F("",!0),e("div",{class:"icon-item",onClick:$},[s(h,{title:r.$t("item.share"),placement:"bottom"},{default:m(()=>[..._[1]||(_[1]=[e("i",{class:"far fa-share-nodes"},null,-1)])]),_:1},8,["title"])]),((T=c.itemInfo)==null?void 0:T.item_manage)==1?(C(),L("div",{key:1,class:"icon-item",onClick:g},[s(h,{title:r.$t("item.member_manage"),placement:"bottom"},{default:m(()=>[..._[2]||(_[2]=[e("i",{class:"fal fa-users"},null,-1)])]),_:1},8,["title"])])):F("",!0),((x=c.itemInfo)==null?void 0:x.is_login)!=1?(C(),L("div",{key:2,class:"icon-item",onClick:n},[s(h,{title:r.$t("user.login"),placement:"bottom"},{default:m(()=>[..._[3]||(_[3]=[e("i",{class:"far fa-user"},null,-1)])]),_:1},8,["title"])])):F("",!0),((I=c.itemInfo)==null?void 0:I.item_edit)==1&&((S=c.itemInfo)==null?void 0:S.item_manage)!=1?(C(),L("div",{key:3,class:"icon-item",onClick:y},[s(h,{title:r.$t("item.export"),placement:"bottom"},{default:m(()=>[..._[4]||(_[4]=[e("i",{class:"far fa-arrow-down-to-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),((M=c.itemInfo)==null?void 0:M.is_login)!=1?(C(),B(h,{key:4,title:r.$t("header.switch_language"),placement:"bottom"},{default:m(()=>[e("div",L4,[s(ht)])]),_:1},8,["title"])):F("",!0),s(h,{title:z(v).theme==="light"?r.$t("common.dark_mode"):r.$t("common.light_mode"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:d},[..._[5]||(_[5]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),((V=c.itemInfo)==null?void 0:V.item_manage)==1?(C(),B(ut,{key:5,list:p.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:k},{default:m(()=>[..._[6]||(_[6]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const z4=Y(V4,[["__scopeId","data-v-37b2ae01"]]),U4={class:"attachment-modal"},P4={key:0,class:"upload-actions"},A4={class:"file-name"},D4=W({__name:"index",props:{itemId:{},pageId:{},manage:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}}},setup(c){const t=io.PRESENTED_IMAGE_SIMPLE,a=c,o=b(!0),l=b([]),u=b(!1),v=q(()=>{var y,k,r;return[{title:((y=a.$t)==null?void 0:y.call(a,"page.add_time"))||"上传时间",key:"addtime",width:170},{title:((k=a.$t)==null?void 0:k.call(a,"page.file_name"))||"文件名",key:"display_name",ellipsis:!0},{title:((r=a.$t)==null?void 0:r.call(a,"common.operation"))||"操作",key:"action",width:150}]}),d=async()=>{if(a.pageId){u.value=!0;try{const y=await X("/api/page/uploadList",{page_id:a.pageId});l.value=y.data||[]}catch(y){console.error("加载附件列表失败:",y)}finally{u.value=!1}}},p=y=>{y.url&&window.open(y.url,"_blank")},f=async y=>{var r,_,h;if(await Se({title:((r=a.$t)==null?void 0:r.call(a,"common.confirm_delete"))||"确认删除",content:((_=a.$t)==null?void 0:_.call(a,"page.confirm_delete_attachment"))||"确定要删除这个附件吗？"}))try{await X("/api/page/deleteUploadFile",{file_id:y.file_id,page_id:a.pageId}),ie.success(((h=a.$t)==null?void 0:h.call(a,"common.delete_success"))||"删除成功"),await d()}catch(w){console.error("删除附件失败:",w)}},$=()=>{var y;ie.info(((y=a.$t)==null?void 0:y.call(a,"common.coming_soon"))||"功能开发中...")},g=()=>{var y;ie.info(((y=a.$t)==null?void 0:y.call(a,"common.coming_soon"))||"功能开发中...")},n=()=>{o.value=!1,a.onClose()};return oe(()=>{d()}),(y,k)=>{const r=H("a-button"),_=H("a-tooltip"),h=H("a-table"),w=H("a-empty");return C(),B(de,{show:o.value,title:y.$t("page.attachment"),width:"700px",onClose:n},{footer:m(()=>[s(K,{onClick:n},{default:m(()=>[O(i(y.$t("common.close")),1)]),_:1})]),default:m(()=>[e("div",U4,[c.manage?(C(),L("div",P4,[s(r,{type:"primary",onClick:$},{default:m(()=>[k[0]||(k[0]=e("i",{class:"fas fa-upload"},null,-1)),O(" "+i(y.$t("page.upload")),1)]),_:1}),s(r,{onClick:g},{default:m(()=>[k[1]||(k[1]=e("i",{class:"fas fa-folder-open"},null,-1)),O(" "+i(y.$t("page.from_file_hub")),1)]),_:1})])):F("",!0),s(h,{"data-source":l.value,columns:v.value,pagination:!1,loading:u.value,"row-key":"file_id",size:"small"},{bodyCell:m(({column:T,record:x})=>[T.key==="addtime"?(C(),L(Ce,{key:0},[O(i(x.addtime),1)],64)):T.key==="display_name"?(C(),B(_,{key:1,title:x.display_name},{default:m(()=>[e("span",A4,i(x.display_name),1)]),_:2},1032,["title"])):T.key==="action"?(C(),L(Ce,{key:2},[s(r,{type:"link",size:"small",onClick:I=>p(x)},{default:m(()=>[O(i(y.$t("common.download")),1)]),_:1},8,["onClick"]),c.manage?(C(),B(r,{key:0,type:"link",size:"small",onClick:I=>f(x)},{default:m(()=>[O(i(y.$t("common.delete")),1)]),_:1},8,["onClick"])):F("",!0)],64)):F("",!0)]),_:1},8,["data-source","columns","loading"]),!u.value&&l.value.length===0?(C(),B(w,{key:1,description:y.$t("page.no_attachment"),image:z(t)},null,8,["description","image"])):F("",!0)])]),_:1},8,["show","title"])}}});const O4=Y(D4,[["__scopeId","data-v-845e85a3"]]);function N4(c){return new Promise(t=>{const{app:a,mountNode:o}=ve(O4,{...c,onClose:()=>{t(),me(a,o)}});a.mount(o)})}const F4={key:0,class:"pos"},q4={class:"header-wrap"},R4={class:"logo"},H4={class:"logo-content"},E4={class:"font-bold"},j4={class:"page-wrapper"},B4={class:"page-title-box"},G4={id:"doc-title",class:"page-title"},K4={id:"page_md_content",class:"page_content_main"},J4={key:1,class:"loading"},W4={key:1,class:"attachment-icon"},Y4={key:3,class:"toc-side"},X4=W({__name:"index",props:{itemInfo:{}},setup(c){const t=c,{t:a}=te(),o=b(""),l=b(0),u=b(""),v=b(0),d=b(0),p=b(null),f=b(!1),$=b(!1);let g=null;const n=q(()=>window.innerWidth<1e3||$.value),y=b(!1),k=b(0),r=()=>{if(!n.value)return;const V=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;V<100||V<k.value?y.value=!1:y.value=!0,k.value=V},_=async V=>{var N,A,P,D,E,ae,ge,fe;if(!V&&!((D=(P=(A=(N=t.itemInfo)==null?void 0:N.menu)==null?void 0:A.pages)==null?void 0:P[0])!=null&&D.page_id))return;const U=V||((fe=(ge=(ae=(E=t.itemInfo)==null?void 0:E.menu)==null?void 0:ae.pages)==null?void 0:ge[0])==null?void 0:fe.page_id);if(U)try{const ee=await X("/api/page/info",{page_id:U});o.value=It(ee.data.page_content),u.value=ee.data.page_title,v.value=ee.data.cat_id,d.value=ee.data.attachment_count||0,p.value=ee.data,l.value=0,await ct(),l.value=U,document.title=u.value+"--ShowDoc"}catch(ee){console.error("获取页面内容失败:",ee),o.value="### "+a("common.load_failed")}},h=async({index:V,checked:U})=>{var N;((N=t.itemInfo)==null?void 0:N.item_edit)==1&&(o.value=Da(o.value,V,U),g&&clearTimeout(g),g=window.setTimeout(async()=>{try{await X("/api/page/save",{page_id:l.value,item_id:t.itemInfo.item_id,cat_id:v.value,page_title:u.value,is_urlencode:1,page_content:encodeURIComponent(o.value)},"post",!1)}catch(A){console.error("保存失败:",A)}},800))},w=async()=>{var V;l.value&&((V=t.itemInfo)!=null&&V.item_id)&&await rt({itemId:t.itemInfo.item_id,editPageId:l.value,copyPageId:0})&&await _(l.value)},T=()=>{window.location.href="/item/index"},x=()=>{window.location.reload()},I=()=>{$.value=!$.value},S=()=>{n.value||M()},M=()=>{const V=document.querySelector(".toc-side"),U=document.querySelector(".toc-list");if(!V||!U)return;const N=window.innerWidth,A=(N-850)/2+850,P=A+40;console.log("屏幕宽度:",N),console.log("内容区右边缘:",A),console.log("TOC left值:",P),V.setAttribute("style",`right: auto; left: ${P}px;`)};return oe(async()=>{if(await _(),S(),!n.value){const V=U=>{setTimeout(()=>{M()},U)};V(500),V(1e3),V(1500),V(2e3)}window.addEventListener("resize",S),window.addEventListener("scroll",r)}),Xe(()=>{g&&clearTimeout(g),window.removeEventListener("resize",S)}),ya(()=>{window.removeEventListener("scroll",r)}),(V,U)=>{var A,P,D;const N=H("a-spin");return C(),L("div",{class:re(["show-single-page-item",{"mobile-view":n.value}])},[n.value?(C(),L("div",F4)):F("",!0),n.value?F("",!0):(C(),B(Vt,{key:1,"item-info":c.itemInfo},{right:m(()=>[s(z4,{"page-id":l.value,"item-info":c.itemInfo,"page-info":p.value,onEditPage:w},null,8,["page-id","item-info","page-info"])]),_:1},8,["item-info"])),n.value?(C(),L("div",{key:2,class:re(["mobile-header",{"hide-element":y.value}])},[e("div",q4,[e("div",R4,[e("div",H4,[U[3]||(U[3]=e("img",{class:"logo-img",src:Tt,alt:"logo"},null,-1)),e("span",E4,i(((A=c.itemInfo)==null?void 0:A.item_name)||""),1)])]),$.value?(C(),L("div",{key:1,class:"exit-fullscreen-btn",onClick:x},[U[5]||(U[5]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(V.$t("common.exit_fullscreen")),1)])):(C(),L("div",{key:0,class:"back-btn",onClick:T},[U[4]||(U[4]=e("i",{class:"far fa-arrow-left"},null,-1)),O(" "+i(V.$t("common.back")),1)]))])],2)):F("",!0),e("div",{class:re(["content-container",{"mobile-content":n.value}])},[e("div",j4,[e("div",B4,[e("h2",G4,i(u.value),1),!n.value&&!$.value?(C(),L("i",{key:0,class:re([$.value?"far fa-compress":"far fa-expand","full-page-icon"]),onClick:I},null,2)):F("",!0)]),$.value?(C(),L("div",{key:0,class:"fullscreen-cancel-btn",onClick:I},[U[6]||(U[6]=e("i",{class:"far fa-compress"},null,-1)),e("span",null,i(V.$t("common.exit_fullscreen")),1)])):F("",!0),e("div",K4,[o.value?(C(),B(St,{key:`${l.value}-${$.value}`,modelValue:o.value,"onUpdate:modelValue":U[0]||(U[0]=E=>o.value=E),mode:"preview",readonly:((P=c.itemInfo)==null?void 0:P.item_edit)!=1,onTaskToggle:h},null,8,["modelValue","readonly"])):(C(),L("div",J4,[s(N,{size:"large",tip:V.$t("common.loading")},null,8,["tip"])]))]),d.value?(C(),L("div",W4,[e("i",{class:"far fa-paperclip",onClick:U[1]||(U[1]=E=>f.value=!0)})])):F("",!0)])],2),l.value&&!n.value&&!$.value?(C(),L("div",Y4,[s(aa)])):F("",!0),s(ta,{right:n.value?20:40,bottom:n.value?20:40},null,8,["right","bottom"]),f.value?(C(),B(z(N4),{key:4,"item-id":(D=p.value)==null?void 0:D.item_id,"page-id":l.value,onClose:U[2]||(U[2]=E=>f.value=!1)},null,8,["item-id","page-id"])):F("",!0)],2)}}});const Q4=Y(X4,[["__scopeId","data-v-a1c5dfdc"]]),Z4={class:"header-right float-right"},e7={class:"text-center"},t7=W({__name:"HeaderRight",props:{itemInfo:{}},emits:["save","export","import","reload"],setup(c,{emit:t}){const a=c,o=t,{t:l}=te(),u=xe(),v=b(!1),d=q(()=>[{value:"update",icon:["fa-regular","fa-edit"],text:l("item.updateBaseInfo")},{value:"attorn",icon:["fa-regular","fa-recycle"],text:l("item.attornItem")},{value:"changelog",icon:["fa-regular","fa-clock-rotate-left"],text:l("item.change_log")},{value:"archive",icon:["fa-regular","fa-box-archive"],text:l("item.archiveItem")},{value:"delete",icon:["fa-regular","fa-trash-can"],text:l("item.deleteItem"),danger:!0}]),p=async()=>{a.itemInfo&&await gt({item_domain:a.itemInfo.item_domain,item_id:a.itemInfo.item_id})},f=async()=>{a.itemInfo&&await yt(a.itemInfo.item_id)},$=()=>{u.push("/user/login")},g=()=>{window.open("https://www.showdoc.com.cn/help","_blank")},n=()=>{v.value=!0},y=_=>{const h=_.target;h.files&&h.files[0]&&(o("import",h.files[0]),v.value=!1)},k=async _=>{switch(_.value){case"update":a.itemInfo&&await at({item_id:a.itemInfo.item_id});break;case"attorn":a.itemInfo&&await bt(a.itemInfo.item_id)&&r();break;case"changelog":a.itemInfo&&await zt(a.itemInfo.item_id);break;case"archive":a.itemInfo&&await wt(a.itemInfo.item_id)&&r();break;case"delete":a.itemInfo&&await $t(a.itemInfo.item_id)&&r();break}},r=()=>{u.push("/item/index"),setTimeout(()=>{window.location.reload()},200)};return(_,h)=>{const w=H("a-tooltip");return C(),L("div",Z4,[e("div",{class:"icon-item",onClick:p},[s(w,{title:_.$t("item.share"),placement:"bottom"},{default:m(()=>[...h[3]||(h[3]=[e("i",{class:"fa-regular fa-share-nodes"},null,-1)])]),_:1},8,["title"])]),c.itemInfo.item_manage==1?(C(),L("div",{key:0,class:"icon-item",onClick:h[0]||(h[0]=T=>_.$emit("save"))},[s(w,{title:_.$t("common.save"),placement:"bottom"},{default:m(()=>[...h[4]||(h[4]=[e("i",{class:"fa-regular fa-save"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_edit==1?(C(),L("div",{key:1,class:"icon-item",onClick:h[1]||(h[1]=T=>_.$emit("export"))},[s(w,{title:_.$t("item.export"),placement:"bottom"},{default:m(()=>[...h[5]||(h[5]=[e("i",{class:"fa-regular fa-arrow-down-to-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),L("div",{key:2,class:"icon-item",onClick:n},[s(w,{title:_.$t("item.import"),placement:"bottom"},{default:m(()=>[...h[6]||(h[6]=[e("i",{class:"fa-regular fa-arrow-up-from-bracket"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),L("div",{key:3,class:"icon-item",onClick:f},[s(w,{title:_.$t("item.memberManage"),placement:"bottom"},{default:m(()=>[...h[7]||(h[7]=[e("i",{class:"fa-regular fa-users"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.is_login!=1?(C(),L("div",{key:4,class:"icon-item",onClick:$},[s(w,{title:_.$t("user.login"),placement:"bottom"},{default:m(()=>[...h[8]||(h[8]=[e("i",{class:"fa-regular fa-user"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.is_login!=1?(C(),L("div",{key:5,class:"icon-item",onClick:g},[s(w,{title:_.$t("item.aboutShowdoc"),placement:"bottom"},{default:m(()=>[...h[9]||(h[9]=[e("i",{class:"fa-regular fa-circle-info"},null,-1)])]),_:1},8,["title"])])):F("",!0),c.itemInfo.item_manage==1?(C(),B(ut,{key:6,list:d.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:k},{default:m(()=>[...h[10]||(h[10]=[e("div",{class:"icon-item"},[e("i",{class:"fa-regular fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0),v.value?(C(),B(de,{key:7,show:v.value,title:_.$t("item.importExcel"),onClose:h[2]||(h[2]=T=>v.value=!1)},{default:m(()=>[e("div",e7,[e("input",{type:"file",name:"xlfile",id:"xlf",accept:".xlsx,.xls",onChange:y},null,32)])]),_:1},8,["show","title"])):F("",!0)])}}});const a7=Y(t7,[["__scopeId","data-v-64b494b3"]]),o7={class:"table-item-container"},s7=W({__name:"index",props:{itemInfo:{}},emits:["reload"],setup(c,{emit:t}){const a=c,o=t;Ge(),xe();const{t:l,locale:u}=te(),v=He(),d=Qe(),p=b(null),f=b({}),$=b(0),g=b(0),n=b(0),y=b(0),k=b(!1),r=b("light"),_=async ee=>{const J=ee||$.value,ce=await X("/api/page/info",{page_id:J});if(ce.data&&ce.data.page_content){let ye;try{ye=JSON.parse(fs(ce.data.page_content))}catch{ye={}}if(f.value=ye,a.itemInfo.item_edit==1&&T())return;n.value=a.itemInfo.item_edit==1?1:0,await h(),a.itemInfo.item_edit==1&&x()}},h=async()=>{if(!x_spreadsheet)return!1;const ee=n.value?"edit":"read",J=document.getElementById("table-item");J&&(J.innerHTML=""),p.value=null,await ct(),p.value=x_spreadsheet("#table-item",{mode:ee,showToolbar:!0,row:{len:800,height:25},view:{height:()=>document.documentElement.clientHeight-90}}).loadData(f.value),p.value.on("cell-edited",(ce,ye,ze)=>{w()})},w=async()=>{if(p.value)try{await X("/api/page/save",{page_id:$.value,page_title:a.itemInfo.item_name,item_id:a.itemInfo.item_id,is_urlencode:1,page_content:encodeURIComponent(JSON.stringify(p.value.getData()))}),D(),I()}catch(ee){console.error("保存失败:",ee)}},T=()=>{const ee="page_content_"+$.value,J=localStorage.getItem(ee);if(!J)return!1;try{const ce=JSON.parse(J);return JSON.stringify(ce)!==JSON.stringify(f.value)?(confirm(l("page.draftTips"))&&(f.value=ce,h()),localStorage.removeItem(ee),!0):(localStorage.removeItem(ee),!1)}catch(ce){return console.error("解析草稿数据失败:",ce),localStorage.removeItem(ee),!1}},x=()=>{const ee="page_content_"+$.value;setInterval(()=>{if(p.value){const J=JSON.stringify(p.value.getData());localStorage.setItem(ee,J)}},30*1e3)},I=()=>{for(let ee=0;ee<localStorage.length;ee++){const J=localStorage.key(ee);J&&J.indexOf("page_content_")>-1&&localStorage.removeItem(J)}},S=async()=>{$.value>0&&(await X("/api/page/setLock",{page_id:$.value,item_id:a.itemInfo.item_id}),g.value=1)},M=async()=>{g.value&&(await X("/api/page/setLock",{page_id:$.value,item_id:a.itemInfo.item_id,lock_to:1e3}),g.value=0)},V=()=>{y.value=window.setInterval(()=>{g.value&&S()},3*60*1e3)},U=async()=>{const ee=await X("/api/page/isLock",{page_id:$.value});ee.data.lock>0?ee.data.is_cur_user>0?(g.value=1,n.value=1,h(),V()):(j.error(l("item.locking")+ee.data.lock_username),a.itemInfo.item_edit=!1,clearInterval(y.value),I()):(S(),n.value=1,h(),V())},N=()=>{if(!p.value)return;const J=(ce=>{const ye=XLSX.utils.book_new();return ce.forEach(ze=>{const Ve=[[]],De=ze.rows;for(let je=0;je<De.len;++je){const Ye=De[je];Ye&&(Ve[je]=[],Object.keys(Ye.cells).forEach(Ke=>{const Ue=+Ke;isNaN(Ue)||(Ve[je][Ue]=Ye.cells[Ke].text)}))}const Ze=XLSX.utils.aoa_to_sheet(Ve);XLSX.utils.book_append_sheet(ye,Ze,ze.name)}),ye})(p.value.getData());XLSX.writeFile(J,"showdoc.xlsx")},A=ee=>{if(!ee)return;const J=ye=>{const ze=[];return ye.SheetNames.forEach(Ve=>{const De={name:Ve,rows:{}},Ze=ye.Sheets[Ve];XLSX.utils.sheet_to_json(Ze,{raw:!1,header:1}).forEach((Ye,Ke)=>{const Ue={};Ye.forEach((Q,se)=>{Ue[se]={text:Q}}),De.rows[Ke]={cells:Ue}}),ze.push(De)}),ze},ce=new FileReader;ce.onload=ye=>{var De;const ze=(De=ye.target)==null?void 0:De.result;if(!ze)return;const Ve=J(XLSX.read(ze,{type:"array"}));Ve&&p.value&&(p.value.loadData(Ve),setTimeout(()=>{w()},500))},ce.readAsArrayBuffer(ee)},P=()=>{const ee=new URLSearchParams({page_id:$.value.toString(),item_id:a.itemInfo.item_id.toString(),lock_to:"1000",user_token:d.userToken}),J=ot()+"/api/page/setLock";if("sendBeacon"in navigator)navigator.sendBeacon(J,ee);else{const ce=new XMLHttpRequest;ce.open("POST",J,!1),ce.send(ee)}},D=()=>{localStorage.getItem("table_item_auto_save_tips")||(j.info(l("item.tableItemAutoSaveTips")),localStorage.setItem("table_item_auto_save_tips","1"))},E=()=>{o("reload")},ae=ee=>new Promise((J,ce)=>{const ye=document.createElement("script");ye.src=ee,ye.onload=()=>J(),ye.onerror=ce,document.head.appendChild(ye)}),ge=ee=>{const J=document.createElement("link");J.rel="stylesheet",J.href=ee,document.head.appendChild(J)},fe=async()=>{try{const ee=Et();await ae(`${ee}xspreadsheet/xspreadsheet.js`),await Promise.all([ae(`${ee}xspreadsheet/locale/zh-cn.js`),ae(`${ee}xspreadsheet/locale/en.js`)]),await ae(`${ee}xspreadsheet/xlsx.full.min.js`),k.value=!0,x_spreadsheet&&(u.value==="en-US"?x_spreadsheet.locale("en"):x_spreadsheet.locale("zh-cn"),a.itemInfo.menu&&a.itemInfo.menu.pages&&a.itemInfo.menu.pages[0]&&($.value=a.itemInfo.menu.pages[0].page_id,_(),a.itemInfo.item_edit==1&&U()))}catch(ee){console.error("加载依赖失败:",ee)}};return oe(()=>{r.value=v.theme,v.theme==="dark"&&v.setTheme("light");const ee=Et();ge(`${ee}xspreadsheet/xspreadsheet.css`),fe(),window.addEventListener("beforeunload",P)}),Xe(()=>{clearInterval(y.value),M(),window.removeEventListener("beforeunload",P),r.value!==v.theme&&v.setTheme(r.value),setTimeout(()=>{E()},500)}),(ee,J)=>(C(),L("div",o7,[s(Vt,{"item-info":c.itemInfo},{right:m(()=>[s(a7,{"item-info":c.itemInfo,onSave:w,onExport:N,onImport:A,onReload:E},null,8,["item-info"])]),_:1},8,["item-info"]),J[0]||(J[0]=e("div",{id:"table-item"},null,-1))]))}});const l7=Y(s7,[["__scopeId","data-v-be7749fa"]]),n7={class:"header-right"},i7=W({__name:"HeaderRight",props:{itemInfo:{default:()=>({})},pageId:{default:0}},emits:["save","exportImage","clearCanvas"],setup(c){const t=c,a=xe(),{t:o}=te(),l=He(),u=()=>{l.toggleTheme()},v=q(()=>[{value:"update",icon:["far","fa-edit"],text:o("item.base_info")},{value:"archive",icon:["far","fa-box-archive"],text:o("item.archive")},{value:"attorn",icon:["far","fa-recycle"],text:o("item.attorn")},{value:"changelog",icon:["far","fa-clock-rotate-left"],text:o("item.change_log")},{value:"delete",icon:["far","fa-trash-can"],text:o("item.delete_item"),danger:!0}]),d=async()=>{t.itemInfo&&await gt({item_domain:t.itemInfo.item_domain,item_id:t.itemInfo.item_id,page_id:t.pageId})},p=async()=>{t.itemInfo&&await yt(t.itemInfo.item_id)},f=()=>{a.push("/user/login")},$=async g=>{switch(g.value){case"update":t.itemInfo&&await at({item_id:t.itemInfo.item_id});break;case"archive":t.itemInfo&&await wt(t.itemInfo.item_id);break;case"attorn":t.itemInfo&&await bt(t.itemInfo.item_id);break;case"changelog":t.itemInfo&&await zt(t.itemInfo.item_id);break;case"delete":t.itemInfo&&await $t(t.itemInfo.item_id);break}};return(g,n)=>{var k,r,_,h,w;const y=H("a-tooltip");return C(),L("div",n7,[s(y,{title:g.$t("item.share"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:d},[...n[2]||(n[2]=[e("i",{class:"far fa-share-nodes"},null,-1)])])]),_:1},8,["title"]),((k=c.itemInfo)==null?void 0:k.item_manage)==1?(C(),B(y,{key:0,title:g.$t("common.save"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:n[0]||(n[0]=T=>g.$emit("save"))},[...n[3]||(n[3]=[e("i",{class:"far fa-save"},null,-1)])])]),_:1},8,["title"])):F("",!0),((r=c.itemInfo)==null?void 0:r.item_edit)==1?(C(),B(y,{key:1,title:g.$t("item.export"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:n[1]||(n[1]=T=>g.$emit("exportImage"))},[...n[4]||(n[4]=[e("i",{class:"far fa-download"},null,-1)])])]),_:1},8,["title"])):F("",!0),((_=c.itemInfo)==null?void 0:_.item_manage)==1?(C(),B(y,{key:2,title:g.$t("item.member_manage"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:p},[...n[5]||(n[5]=[e("i",{class:"far fa-users"},null,-1)])])]),_:1},8,["title"])):F("",!0),((h=c.itemInfo)==null?void 0:h.is_login)!=1?(C(),B(y,{key:3,title:g.$t("user.login"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item",onClick:f},[...n[6]||(n[6]=[e("i",{class:"far fa-user"},null,-1)])])]),_:1},8,["title"])):F("",!0),s(y,{title:z(l).theme==="light"?g.$t("common.dark_mode"):g.$t("common.light_mode"),placement:"bottom"},{default:m(()=>[e("div",{class:"icon-item theme-toggle-item",onClick:u},[...n[7]||(n[7]=[e("i",{class:"fas fa-circle-half-stroke"},null,-1)])])]),_:1},8,["title"]),((w=c.itemInfo)==null?void 0:w.item_manage)==1?(C(),B(ut,{key:4,list:v.value,trigger:"hover",placement:"bottom",offsetX:-80,onSelect:$},{default:m(()=>[...n[8]||(n[8]=[e("div",{class:"icon-item"},[e("i",{class:"far fa-ellipsis"})],-1)])]),_:1},8,["list"])):F("",!0)])}}});const r7=Y(i7,[["__scopeId","data-v-9d42b2dd"]]),c7={class:"whiteboard-toolbar"},d7={class:"tool-left"},u7={class:"width-wrap"},m7={class:"label"},_7={class:"btn-text"},p7={class:"btn-text"},f7={class:"tool-right"},v7={class:"btn-text"},h7={class:"btn-text"},g7={class:"btn-text"},y7={class:"text-style-pop"},w7={class:"row",style:{display:"flex","align-items":"center",gap:"8px","margin-bottom":"8px"}},b7={class:"label",style:{"min-width":"56px"}},$7={class:"row",style:{display:"flex","align-items":"center",gap:"8px"}},k7={class:"label",style:{"min-width":"56px"}},C7={class:"btn-text"},x7={style:{display:"flex",gap:"16px","flex-wrap":"wrap","align-items":"center",padding:"12px"}},I7={class:"btn-text"},S7={class:"btn-text"},T7={class:"btn-text"},M7={class:"btn-text"},L7={class:"btn-text"},V7={class:"btn-text"},z7={class:"btn-text"},U7={class:"btn-text"},P7={class:"btn-text"},A7={class:"btn-text"},D7={class:"btn-text"},O7={class:"btn-text"},N7=W({__name:"Toolbar",props:{isReadOnly:{type:Boolean},brushColor:{},brushWidth:{},isDrawing:{type:Boolean},isErasing:{type:Boolean},isInsertingText:{type:Boolean},pendingShapeType:{},textFontSize:{},textColor:{},fontSizeOptions:{},isFullscreen:{type:Boolean}},emits:["update:brushColor","update:brushWidth","update:textFontSize","update:textColor","toggle-drawing","toggle-eraser","toggle-text-insert","insert-rect","insert-circle","insert-triangle","insert-arrow","undo","redo","clear-canvas","export-image","export-svg","export-json","import-image","import-json","zoom-out","zoom-in","fit-to-viewport","zoom-reset","toggle-fullscreen","apply-brush","apply-text-font-size","apply-text-color"],setup(c,{emit:t}){const a=t,o=b(null),l=b(null),u=g=>{a("update:brushColor",g),a("apply-brush")},v=g=>{a("update:brushWidth",g),a("apply-brush")},d=g=>{a("update:textFontSize",g),a("apply-text-font-size")},p=g=>{a("update:textColor",g),a("apply-text-color")},f=()=>{o.value&&(o.value.value="",o.value.click())},$=()=>{l.value&&(l.value.value="",l.value.click())};return(g,n)=>{const y=H("a-color-picker"),k=H("a-tooltip"),r=H("a-slider"),_=H("a-input-number"),h=H("a-button"),w=H("a-select-option"),T=H("a-select"),x=H("a-popover");return C(),L("div",c7,[e("div",d7,[s(k,{title:g.$t("item.whiteboard_color")||"颜色"},{default:m(()=>[s(y,{value:c.brushColor,size:"small",disabled:c.isReadOnly,onChange:u},null,8,["value","disabled"])]),_:1},8,["title"]),e("div",u7,[e("span",m7,i(g.$t("item.whiteboard_width")||"粗细"),1),s(r,{class:"width-slider",min:1,max:50,step:1,value:c.brushWidth,disabled:c.isReadOnly,onChange:v},null,8,["value","disabled"]),s(_,{value:c.brushWidth,min:1,max:50,size:"small",disabled:c.isReadOnly,style:{width:"60px"},onChange:v},null,8,["value","disabled"])]),n[21]||(n[21]=e("span",{class:"divider"},null,-1)),s(k,{title:c.isDrawing?g.$t("item.whiteboard_drawing_on")||"绘制中":g.$t("item.whiteboard_drawing_off")||"停止绘制"},{default:m(()=>[s(h,{size:"small",type:c.isDrawing?"primary":"default",disabled:c.isReadOnly,onClick:n[0]||(n[0]=I=>g.$emit("toggle-drawing"))},{icon:m(()=>[e("i",{class:re(c.isDrawing?"fa-solid fa-pen":"fa-solid fa-hand-pointer")},null,2)]),default:m(()=>[e("span",_7,i(c.isDrawing?g.$t("item.whiteboard_draw")||"绘制":g.$t("item.whiteboard_select")||"选择"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_eraser")||"橡皮擦"},{default:m(()=>[s(h,{size:"small",type:c.isErasing?"primary":"default",disabled:c.isReadOnly,onClick:n[1]||(n[1]=I=>g.$emit("toggle-eraser"))},{icon:m(()=>[...n[20]||(n[20]=[e("i",{class:"fa-solid fa-eraser"},null,-1)])]),default:m(()=>[e("span",p7,i(g.$t("item.whiteboard_eraser")||"橡皮擦"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"])]),e("div",f7,[s(k,{title:g.$t("common.undo")||"撤销"},{default:m(()=>[s(h,{size:"small",disabled:c.isReadOnly,onClick:n[2]||(n[2]=I=>g.$emit("undo"))},{icon:m(()=>[...n[22]||(n[22]=[e("i",{class:"fa-solid fa-rotate-left"},null,-1)])]),default:m(()=>[e("span",v7,i(g.$t("common.undo")||"撤销"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),s(k,{title:g.$t("common.redo")||"重做"},{default:m(()=>[s(h,{size:"small",disabled:c.isReadOnly,onClick:n[3]||(n[3]=I=>g.$emit("redo"))},{icon:m(()=>[...n[23]||(n[23]=[e("i",{class:"fa-solid fa-rotate-right"},null,-1)])]),default:m(()=>[e("span",h7,i(g.$t("common.redo")||"重做"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),n[41]||(n[41]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_insert_text")||"插入文字"},{default:m(()=>[s(h,{size:"small",type:c.isInsertingText?"primary":"default",disabled:c.isReadOnly,onClick:n[4]||(n[4]=I=>g.$emit("toggle-text-insert"))},{icon:m(()=>[...n[24]||(n[24]=[e("i",{class:"fa-solid fa-i-cursor"},null,-1)])]),default:m(()=>[e("span",g7,i(g.$t("item.whiteboard_insert_text")||"插入文字"),1)]),_:1},8,["type","disabled"])]),_:1},8,["title"]),s(x,{placement:"bottom",trigger:"click",overlayStyle:{width:"260px"}},{content:m(()=>[e("div",y7,[e("div",w7,[e("span",b7,i(g.$t("item.whiteboard_font_size")||"字号"),1),s(T,{value:c.textFontSize,size:"small",style:{width:"100px"},disabled:c.isReadOnly,onChange:d},{default:m(()=>[(C(!0),L(Ce,null,Pe(c.fontSizeOptions,I=>(C(),B(w,{key:I,value:I},{default:m(()=>[O(i(I),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])]),e("div",$7,[e("span",k7,i(g.$t("item.whiteboard_font_color")||"字体颜色"),1),s(y,{value:c.textColor,size:"small",disabled:c.isReadOnly,onChange:p},null,8,["value","disabled"])])])]),default:m(()=>[s(h,{size:"small",disabled:c.isReadOnly},{icon:m(()=>[...n[25]||(n[25]=[e("i",{class:"fa-solid fa-font"},null,-1)])]),default:m(()=>[e("span",C7,i(g.$t("item.whiteboard_text_style")||"文本样式"),1)]),_:1},8,["disabled"])]),_:1}),n[42]||(n[42]=e("span",{class:"divider"},null,-1)),s(x,{placement:"bottom",trigger:"click",overlayStyle:{width:"480px"}},{content:m(()=>[e("div",x7,[s(h,{size:"small",type:c.pendingShapeType==="rect"?"primary":"default",disabled:c.isReadOnly,onClick:n[5]||(n[5]=I=>g.$emit("insert-rect")),style:{"min-width":"80px",height:"40px"}},{default:m(()=>[n[26]||(n[26]=e("i",{class:"fa-regular fa-square",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_rect")||"方形"),1)]),_:1},8,["type","disabled"]),s(h,{size:"small",type:c.pendingShapeType==="circle"?"primary":"default",disabled:c.isReadOnly,onClick:n[6]||(n[6]=I=>g.$emit("insert-circle")),style:{"min-width":"80px",height:"40px"}},{default:m(()=>[n[27]||(n[27]=e("i",{class:"fa-regular fa-circle",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_circle")||"圆形"),1)]),_:1},8,["type","disabled"]),s(h,{size:"small",type:c.pendingShapeType==="triangle"?"primary":"default",disabled:c.isReadOnly,onClick:n[7]||(n[7]=I=>g.$emit("insert-triangle")),style:{"min-width":"80px",height:"40px"}},{default:m(()=>[n[28]||(n[28]=e("i",{class:"fa-solid fa-caret-up",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_triangle")||"三角形"),1)]),_:1},8,["type","disabled"]),s(h,{size:"small",type:c.pendingShapeType==="arrow"?"primary":"default",disabled:c.isReadOnly,onClick:n[8]||(n[8]=I=>g.$emit("insert-arrow")),style:{"min-width":"80px",height:"40px"}},{default:m(()=>[n[29]||(n[29]=e("i",{class:"fa-solid fa-arrow-right",style:{"font-size":"16px","margin-right":"6px"}},null,-1)),O(" "+i(g.$t("item.whiteboard_shape_arrow")||"箭头"),1)]),_:1},8,["type","disabled"])])]),default:m(()=>[s(h,{size:"small",type:c.pendingShapeType?"primary":"default",disabled:c.isReadOnly},{icon:m(()=>[...n[30]||(n[30]=[e("i",{class:"fa-solid fa-draw-polygon"},null,-1)])]),default:m(()=>[e("span",I7,i(g.$t("item.whiteboard_insert_shape")||"插入形状"),1)]),_:1},8,["type","disabled"])]),_:1}),s(k,{title:g.$t("item.whiteboard_insert_image")||"插入图片"},{default:m(()=>[s(h,{size:"small",disabled:c.isReadOnly,onClick:f},{icon:m(()=>[...n[31]||(n[31]=[e("i",{class:"fa-solid fa-image"},null,-1)])]),default:m(()=>[e("span",S7,i(g.$t("item.whiteboard_insert_image")||"插入图片"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),e("input",{ref_key:"imgFile",ref:o,type:"file",accept:"image/*",style:{display:"none"},onChange:n[9]||(n[9]=I=>g.$emit("import-image",I))},null,544),n[43]||(n[43]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_zoom_out")||"缩小"},{default:m(()=>[s(h,{size:"small",onClick:n[10]||(n[10]=I=>g.$emit("zoom-out"))},{icon:m(()=>[...n[32]||(n[32]=[e("i",{class:"fa-solid fa-magnifying-glass-minus"},null,-1)])]),default:m(()=>[e("span",T7,i(g.$t("item.whiteboard_zoom_out")||"缩小"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_zoom_in")||"放大"},{default:m(()=>[s(h,{size:"small",onClick:n[11]||(n[11]=I=>g.$emit("zoom-in"))},{icon:m(()=>[...n[33]||(n[33]=[e("i",{class:"fa-solid fa-magnifying-glass-plus"},null,-1)])]),default:m(()=>[e("span",M7,i(g.$t("item.whiteboard_zoom_in")||"放大"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_fit")||"适屏"},{default:m(()=>[s(h,{size:"small",onClick:n[12]||(n[12]=I=>g.$emit("fit-to-viewport"))},{icon:m(()=>[...n[34]||(n[34]=[e("i",{class:"fa-solid fa-maximize"},null,-1)])]),default:m(()=>[e("span",L7,i(g.$t("item.whiteboard_fit")||"适屏"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_actual_size")||"1:1"},{default:m(()=>[s(h,{size:"small",onClick:n[13]||(n[13]=I=>g.$emit("zoom-reset"))},{icon:m(()=>[...n[35]||(n[35]=[e("i",{class:"fa-solid fa-compress"},null,-1)])]),default:m(()=>[e("span",V7,i(g.$t("item.whiteboard_actual_size")||"1:1"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:c.isFullscreen?g.$t("item.whiteboard_exit_fullscreen")||"退出全屏":g.$t("item.whiteboard_fullscreen")||"全屏编辑"},{default:m(()=>[s(h,{size:"small",type:c.isFullscreen?"primary":"default",onClick:n[14]||(n[14]=I=>g.$emit("toggle-fullscreen"))},{icon:m(()=>[e("i",{class:re(c.isFullscreen?"fa-solid fa-compress":"fa-solid fa-expand")},null,2)]),default:m(()=>[e("span",z7,i(c.isFullscreen?g.$t("item.whiteboard_exit_fullscreen")||"退出全屏":g.$t("item.whiteboard_fullscreen")||"全屏编辑"),1)]),_:1},8,["type"])]),_:1},8,["title"]),n[44]||(n[44]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_export_png")||"导出 PNG"},{default:m(()=>[s(h,{size:"small",onClick:n[15]||(n[15]=I=>g.$emit("export-image"))},{icon:m(()=>[...n[36]||(n[36]=[e("i",{class:"fa-solid fa-image"},null,-1)])]),default:m(()=>[e("span",U7,i(g.$t("item.whiteboard_export_png")||"导出PNG"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_export_svg")||"导出 SVG"},{default:m(()=>[s(h,{size:"small",onClick:n[16]||(n[16]=I=>g.$emit("export-svg"))},{icon:m(()=>[...n[37]||(n[37]=[e("i",{class:"fa-solid fa-file-code"},null,-1)])]),default:m(()=>[e("span",P7,i(g.$t("item.whiteboard_export_svg")||"导出SVG"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_export_json")||"导出 JSON"},{default:m(()=>[s(h,{size:"small",onClick:n[17]||(n[17]=I=>g.$emit("export-json"))},{icon:m(()=>[...n[38]||(n[38]=[e("i",{class:"fa-solid fa-code"},null,-1)])]),default:m(()=>[e("span",A7,i(g.$t("item.whiteboard_export_json")||"导出JSON"),1)]),_:1})]),_:1},8,["title"]),s(k,{title:g.$t("item.whiteboard_import_json")||"导入 JSON"},{default:m(()=>[s(h,{size:"small",disabled:c.isReadOnly,onClick:$},{icon:m(()=>[...n[39]||(n[39]=[e("i",{class:"fa-solid fa-file-import"},null,-1)])]),default:m(()=>[e("span",D7,i(g.$t("item.whiteboard_import_json")||"导入JSON"),1)]),_:1},8,["disabled"])]),_:1},8,["title"]),e("input",{ref_key:"jsonFile",ref:l,type:"file",accept:"application/json",style:{display:"none"},onChange:n[18]||(n[18]=I=>g.$emit("import-json",I))},null,544),n[45]||(n[45]=e("span",{class:"divider"},null,-1)),s(k,{title:g.$t("item.whiteboard_clear")||"清空画布"},{default:m(()=>[s(h,{size:"small",danger:"",disabled:c.isReadOnly,onClick:n[19]||(n[19]=I=>g.$emit("clear-canvas"))},{icon:m(()=>[...n[40]||(n[40]=[e("i",{class:"fa-solid fa-trash-can"},null,-1)])]),default:m(()=>[e("span",O7,i(g.$t("item.whiteboard_clear")||"清空画布"),1)]),_:1},8,["disabled"])]),_:1},8,["title"])])])}}});const F7=Y(N7,[["__scopeId","data-v-3b8c6dc0"]]);function q7(){const c=b(!1),t=b(!1);return{isLoaded:c,isLoading:t,loadFabric:()=>new Promise((o,l)=>{if(window.fabric){c.value=!0,o();return}if(t.value){const v=setInterval(()=>{window.fabric&&(clearInterval(v),c.value=!0,o())},100);return}t.value=!0;const u=document.createElement("script");u.src=`${Et()}whiteboard/fabric.min.js`,u.onload=()=>{c.value=!0,t.value=!1,o()},u.onerror=()=>{t.value=!1,l(new Error("Failed to load Fabric.js"))},document.head.appendChild(u)})}}function R7(c,t){const a=b(null),o=b(null),l=()=>{const $=(window.innerHeight||document.documentElement.clientHeight||0)*.9-120;return Math.max($,480)},u=(f,$)=>{if(!window.fabric)return;const g=document.getElementById("whiteboard-canvas");if(!g)return;const n=document.querySelector("#whiteboard-item .canvas-inner")||g.parentElement;let y=Math.max((n==null?void 0:n.clientWidth)||0,600),k=Math.max((n==null?void 0:n.clientHeight)||0,0);if(k<=0){k=l();try{n&&(n.style.height=k+"px")}catch{}}else k=Math.max(k,480);const _=document.documentElement.getAttribute("data-theme")==="dark"?"#2d2d2d":"#ffffff";a.value=new window.fabric.Canvas("whiteboard-canvas",{isDrawingMode:!f,width:y,height:k,selection:!f,backgroundColor:_}),a.value.on("path:created",()=>{$&&$()}),a.value.on("object:modified",()=>{$&&$()}),a.value.on("object:removed",()=>{$&&$()}),v()},v=()=>{const f=document.querySelector("#whiteboard-item .canvas-wrap"),$=document.querySelector("#whiteboard-item .canvas-inner");if(!f)return;const g=()=>{if(!a.value)return;let n=$&&$.clientWidth||f.clientWidth,y=$&&$.clientHeight||f.clientHeight;if(y<=0||y<480){y=l();try{$?$.style.height=y+"px":f.style.height=y+"px"}catch{}}n<=0&&(n=Math.max(document.documentElement.clientWidth||window.innerWidth||0,600)),n>0&&y>0&&(a.value.setWidth(n),a.value.setHeight(y),a.value.renderAll())};if(window.ResizeObserver)o.value=new window.ResizeObserver(g),o.value.observe(f);else{const n=class{constructor(y){ia(this,"cb");this.cb=y}observe(){window.addEventListener("resize",this.cb)}disconnect(){window.removeEventListener("resize",this.cb)}};o.value=new n(g),o.value.observe(f)}window.addEventListener("resize",g),setTimeout(g,16),setTimeout(g,200),setTimeout(g,800)},d=()=>{try{o.value&&o.value.disconnect&&o.value.disconnect()}catch{}a.value&&a.value.dispose()};return Xe(d),{canvas:a,initCanvas:u,getViewportCanvasHeight:l,setBackgroundColor:f=>{a.value&&a.value.setBackgroundColor(f,a.value.renderAll.bind(a.value))},cleanup:d}}function H7(c,t,a,o={}){const l=b([]),u=b([]),v=b(null),d=b(0),p=()=>{if(!c.value)return"{}";const h=c.value.toJSON(),{backgroundColor:w,...T}=h,x={__canvasSize:{width:c.value.getWidth(),height:c.value.getHeight()},...T};return JSON.stringify(x)},f=async(h=!1)=>{var w,T;if(!(!t.value||!c.value))try{await X("/api/page/save",{page_id:t.value,page_title:(w=a.value)==null?void 0:w.item_name,item_id:(T=a.value)==null?void 0:T.item_id,is_urlencode:1,page_content:encodeURIComponent(p())},"post",!1,"form"),d.value=Date.now(),h||j.success("已保存")}catch{h||j.error("保存失败")}},$=()=>{if(!a.value||!a.value.item_edit)return;v.value&&(clearTimeout(v.value),v.value=null);const w=Date.now()-d.value,T=1e4,x=2e3,I=Math.max(T-w,0),S=Math.max(x,I);v.value=setTimeout(()=>{f(!0)},S)},g=()=>{n(),u.value=[],$()},n=()=>{if(!c.value)return;const h=p(),w=50;l.value.push(h),l.value.length>w&&l.value.shift()},y=()=>{if(l.value.length<=1)return;const h=l.value.pop();u.value.push(h);const w=l.value[l.value.length-1];r(w)},k=()=>{if(u.value.length===0)return;const h=u.value.pop();h&&(l.value.push(h),r(h))},r=h=>{try{const w=JSON.parse(h);if(w&&w.__canvasSize){const{width:T,height:x}=w.__canvasSize;T&&x&&o.applyCustomSize&&o.applyCustomSize(T,x)}c.value.loadFromJSON(w,()=>{var T;c.value.renderAll(),((T=a.value)==null?void 0:T.item_edit)==0&&o.applyReadOnlyMode&&o.applyReadOnlyMode(),o.onContentLoaded&&o.onContentLoaded(),o.onContentLoadedFromJSON&&o.onContentLoadedFromJSON()})}catch{}};return{undoStack:l,redoStack:u,onContentChanged:g,undo:y,redo:k,save:f,loadPageContent:async()=>{var h;try{const w=await X("/api/page/info",{page_id:t.value},"post",!1,"form");if(!c.value)return;let T=(h=w==null?void 0:w.data)==null?void 0:h.page_content;if(T)try{const x=JSON.parse(Zt(T));if(x&&x.__canvasSize){const{width:I,height:S}=x.__canvasSize;I&&S&&o.applyCustomSize&&o.applyCustomSize(I,S)}c.value.loadFromJSON(x,()=>{var I;c.value.renderAll(),((I=a.value)==null?void 0:I.item_edit)==0&&o.applyReadOnlyMode&&o.applyReadOnlyMode(),o.onContentLoaded&&o.onContentLoaded(),n()})}catch{n()}else n()}catch{n()}},serialize:p}}function E7(c){const t=()=>"cell",a=()=>document.documentElement.getAttribute("data-theme")==="dark"?"#2d2d2d":"#ffffff";return{applyBrush:(v,d,p,f,$,g)=>{if(!c.value)return;const n=v.value!==void 0?v.value:v,y=d.value!==void 0?d.value:d,k=p.value!==void 0?p.value:p,r=f.value!==void 0?f.value:f,_=$.value!==void 0?$.value:$,h=g.value!==void 0?g.value:g;c.value.isDrawingMode=n||r?!1:y,c.value.freeDrawingBrush||(c.value.freeDrawingBrush=new window.fabric.PencilBrush(c.value));const w=k?a():_;c.value.freeDrawingBrush.color=w,c.value.freeDrawingBrush.width=h;try{c.value.freeDrawingCursor=k?t():"crosshair";const T=c.value.isDrawingMode?k?t():"crosshair":"default";c.value.setCursor(T),c.value.requestRenderAll()}catch{}},deleteSelectedObjects:()=>{if(!c.value)return;const v=c.value.getActiveObject();v&&(v.type==="activeSelection"?(v.forEachObject(d=>c.value.remove(d)),c.value.discardActiveObject()):c.value.remove(v),c.value.requestRenderAll())},applyReadOnlyMode:()=>{if(c.value){c.value.isDrawingMode=!1,c.value.selection=!1,c.value.skipTargetFind=!0;try{c.value.forEachObject(v=>{v.selectable=!1,v.evented=!1,v.hasControls&&(v.hasControls=!1)})}catch{}c.value.discardActiveObject&&c.value.discardActiveObject(),c.value.requestRenderAll&&c.value.requestRenderAll()}}}}function j7(){return{insertShapeAtPosition:(t,a,o,l,u,v,d)=>{if(!t)return;let p=null;const f=window.fabric;switch(a){case"rect":{const $=Math.max(60,v*10),g=Math.max(40,v*7);p=new f.Rect({left:o-$/2,top:l-g/2,width:$,height:g,fill:"transparent",stroke:u,strokeWidth:v});break}case"circle":{const $=Math.max(30,v*5);p=new f.Circle({left:o-$,top:l-$,radius:$,fill:"transparent",stroke:u,strokeWidth:v});break}case"triangle":{const $=Math.max(70,v*12),g=Math.max(60,v*10);p=new f.Triangle({left:o-$/2,top:l-g/2,width:$,height:g,fill:"transparent",stroke:u,strokeWidth:v});break}case"arrow":{const $=Math.max(120,v*20),g=Math.max(10,v*3),n=$-g*.9,y=0,k=new f.Line([0,0,n,y],{stroke:u,strokeWidth:v,selectable:!1,evented:!1}),r=new f.Triangle({left:n+g*.05,top:-g*.9,width:g*2,height:g*2,angle:90,fill:u,selectable:!1,evented:!1});p=new f.Group([k,r],{left:o,top:l-v/2});break}}p&&(p.set({cornerStyle:"circle",transparentCorners:!1}),t.add(p),t.setActiveObject(p),t.requestRenderAll(),d&&d())}}}function B7(c,t,a){const o=b(!1),l=b(!1),u=()=>{c.value&&(window.addEventListener("keydown",v),window.addEventListener("keyup",d),c.value.on("mouse:down",()=>{o.value&&(l.value=!0,c.value.setCursor("grab"),c.value.renderAll())}),c.value.on("mouse:move",n=>{if(l.value){const y=n.e,k=new window.fabric.Point(y.movementX,y.movementY);c.value.relativePan(k)}}),c.value.on("mouse:up",()=>{l.value=!1,c.value.setCursor("default"),c.value.renderAll()}),c.value.on("mouse:wheel",n=>{const y=n.e;if(!y.ctrlKey)return;y.preventDefault(),y.stopPropagation();let k=c.value.getZoom();k*=Math.pow(.999,y.deltaY),k=Math.max(.25,Math.min(k,4));const r=new window.fabric.Point(y.offsetX,y.offsetY);c.value.zoomToPoint(r,k)}))},v=n=>{n.code==="Space"&&(o.value=!0,c.value&&(c.value.isDrawingMode=!1)),n.code==="Delete"||n.code},d=n=>{if(n.code==="Space"&&(o.value=!1,c.value)){c.value.isDrawingMode=t.value;try{const y=c.value.isDrawingMode?a.value?"cell":"crosshair":"default";c.value.setCursor(y),c.value.requestRenderAll()}catch{}}},p=()=>{if(!c.value)return;const n=Math.min(c.value.getZoom()*1.1,4);c.value.setZoom(n),c.value.requestRenderAll()},f=()=>{if(!c.value)return;const n=Math.max(c.value.getZoom()/1.1,.25);c.value.setZoom(n),c.value.requestRenderAll()},$=()=>{c.value&&(c.value.setViewportTransform([1,0,0,1,0,0]),c.value.requestRenderAll())};return{bindPanAndWheel:u,zoomIn:p,zoomOut:f,zoomReset:$,fitToViewport:()=>{const n=document.querySelector("#whiteboard-item .canvas-inner"),y=document.querySelector("#whiteboard-item .canvas-wrap");if(!n||!y||!c.value)return;n.style.width="",n.style.height="";const k=n.clientWidth||y.clientWidth,r=n.clientHeight||y.clientHeight||480;c.value.setWidth(k),c.value.setHeight(Math.max(r,480)),$(),c.value.renderAll()},spacePressed:o,panning:l}}function G7(c,t,a){const o=b(null),l=b(!1),u=b({x:0,y:0,width:0,height:0}),v=()=>{var h;const r=((h=c.value)==null?void 0:h.item_id)||"0",_=t.value||"0";return`whiteboard:size:${r}:${_}`},d=()=>{try{const r=localStorage.getItem(v());if(!r)return null;const _=JSON.parse(r);if(_&&typeof _.width=="number"&&typeof _.height=="number")return _}catch{}return null},p=(r,_)=>{try{localStorage.setItem(v(),JSON.stringify({width:r,height:_}))}catch{}},f=()=>{try{localStorage.removeItem(v())}catch{}},$=(r,_)=>{const h=document.querySelector("#whiteboard-item .canvas-inner"),w=document.querySelector("#whiteboard-item .canvas-wrap");if(!h||!a.value)return;const T=480,x=1e4,I=Math.max(T,Math.min(r||0,x)),S=Math.max(T,Math.min(_||0,x));h.style.width=I+"px",h.style.height=S+"px",w&&(w.scrollLeft=w.scrollWidth),a.value.setWidth(I),a.value.setHeight(S),a.value.renderAll()},g=r=>{const _=document.querySelector("#whiteboard-item .canvas-inner");_&&(l.value=!0,u.value={x:r.clientX,y:r.clientY,width:_.clientWidth,height:_.clientHeight},document.addEventListener("mousemove",n),document.addEventListener("mouseup",y,{once:!0}))},n=r=>{if(!l.value)return;const _=(r.clientX-u.value.x)*2.5,h=(r.clientY-u.value.y)*2.5,w=Math.round(u.value.width+_),T=Math.round(u.value.height+h);o.value={width:w,height:T},$(w,T)},y=()=>{l.value&&(l.value=!1,document.removeEventListener("mousemove",n),o.value&&p(o.value.width,o.value.height))};return{customCanvasSize:o,resizing:l,loadSavedSize:d,saveCustomSize:p,clearSavedSize:f,applyCustomSize:$,onResizeHandleDown:g,onResizeHandleUp:y,fitToViewport:()=>{const r=document.querySelector("#whiteboard-item .canvas-inner"),_=document.querySelector("#whiteboard-item .canvas-wrap");if(!r||!_||!a.value)return;r.style.width="",r.style.height="",o.value=null,f();const h=r.clientWidth||_.clientWidth,w=Math.max(r.clientHeight||_.clientHeight||window.innerHeight-150,480);a.value.setWidth(h),a.value.setHeight(w),a.value.renderAll()}}}function K7(c,t,a){const o=b(null),l=b(null);return{imgFile:o,jsonFile:l,clearCanvas:()=>{c.value&&(c.value.clear(),c.value.setBackgroundColor("#ffffff",c.value.renderAll.bind(c.value)))},exportImage:()=>{if(!c.value)return;const y=c.value.toDataURL({format:"png",quality:1}),k=document.createElement("a");k.href=y,k.download="showdoc-whiteboard.png",k.click()},exportSVG:()=>{if(c.value)try{const y=c.value.toSVG(),k=new Blob([y],{type:"image/svg+xml"}),r=URL.createObjectURL(k),_=document.createElement("a");_.href=r,_.download="showdoc-whiteboard.svg",_.click(),URL.revokeObjectURL(r)}catch{}},exportJSON:()=>{const y=a(),k=new Blob([y],{type:"application/json"}),r=URL.createObjectURL(k),_=document.createElement("a");_.href=r,_.download="showdoc-whiteboard.json",_.click(),URL.revokeObjectURL(r)},importJSON:y=>{var _;const k=(_=y.target.files)==null?void 0:_[0];if(!k)return;const r=new FileReader;r.onload=()=>{try{const h=String(r.result||"")}catch{}},r.readAsText(k)},importImage:y=>{var _;const k=(_=y.target.files)==null?void 0:_[0];if(!k||!c.value)return;const r=new FileReader;r.onload=()=>{const h=r.result,w=new Image;w.onload=()=>{const T=c.value.getWidth(),x=c.value.getHeight(),I=Math.min(T/w.width,x/w.height,1);window.fabric.Image.fromURL(h,M=>{M.set({left:(T-w.width*I)/2,top:(x-w.height*I)/2,selectable:!0,hasControls:!0,cornerStyle:"circle",transparentCorners:!1}),M.scale(I),c.value.add(M),c.value.setActiveObject(M),c.value.requestRenderAll()},{crossOrigin:"anonymous"})},w.src=h},r.readAsDataURL(k)},triggerImageUpload:()=>{o.value&&(o.value.value="",o.value.click())},triggerImport:()=>{l.value&&(l.value.value="",l.value.click())}}}const J7=["onKeydown"],W7={key:0,class:"item-header"},Y7={class:"canvas-wrap"},X7={class:"canvas-inner"},Q7=W({__name:"index",props:{itemInfo:{}},setup(c){const t=c;xe();const{t:a}=te(),o=He(),{isLoaded:l,loadFabric:u}=q7(),{canvas:v,initCanvas:d,setBackgroundColor:p}=R7(q(()=>t.itemInfo),b("")),f=b(""),$=q(()=>!(t.itemInfo&&t.itemInfo.item_edit==1)),g=q(()=>!(t.itemInfo&&t.itemInfo.is_login==1)),n=b(!1),y=()=>o.theme==="dark"?"#e0e0e0":"#2c3e50",k=()=>o.theme==="dark"?"#e0e0e0":"#2c3e50",r=b(!0),_=b(!1),h=b(y()),w=b(4),T=b(!1),x=b(24),I=b(k()),S=[12,14,16,18,20,24,28,32,36,48,64,80,96,120];qe(()=>o.theme,ue=>{if(!v.value)return;p(ue==="dark"?"#2d2d2d":"#ffffff");const Z="#2c3e50",pe="#e0e0e0",$e=ue==="dark"?pe:Z,Ae=ue==="dark"?pe:Z,Ne=ue==="dark"?Z:pe,et=ue==="dark"?Z:pe;h.value===Ne&&(h.value=$e),I.value===et&&(I.value=Ae),D($.value,r.value,_.value,T.value,h.value,w.value),v.value.requestRenderAll()});const M=b(null),{customCanvasSize:V,loadSavedSize:U,applyCustomSize:N,onResizeHandleDown:A,fitToViewport:P}=G7(q(()=>t.itemInfo),f,v),{applyBrush:D,deleteSelectedObjects:E,applyReadOnlyMode:ae}=E7(v),{insertShapeAtPosition:ge}=j7(),{bindPanAndWheel:fe,zoomIn:ee,zoomOut:J,zoomReset:ce}=B7(v,r,_),{exportImage:ye,exportSVG:ze,exportJSON:Ve,importJSON:De,importImage:Ze,clearCanvas:je}=K7(v,q(()=>t.itemInfo),()=>""),{undo:Ye,redo:Ke,onContentChanged:Ue,save:Q,loadPageContent:se}=H7(v,f,q(()=>t.itemInfo),{applyCustomSize:(ue,R)=>{V.value={width:ue,height:R},N(ue,R)},applyReadOnlyMode:()=>{ae()},onContentLoaded:()=>{D($.value,r.value,_.value,T.value,h.value,w.value);const ue=o.theme==="dark"?"#2d2d2d":"#ffffff";p(ue)},onContentLoadedFromJSON:()=>{const ue=o.theme==="dark"?"#2d2d2d":"#ffffff";p(ue)}}),be=()=>{$.value||(r.value=!r.value,_.value=!1,T.value=!1,M.value=null,D())},Te=()=>{$.value||(_.value=!_.value,_.value&&(r.value=!0),T.value=!1,M.value=null,D())},we=()=>{$.value||(T.value=!T.value,T.value?(r.value=!1,_.value=!1,M.value=null):(r.value=!0,_.value=!1),D())},le=()=>{n.value=!n.value,n.value?document.documentElement.requestFullscreen():document.exitFullscreen()},_e=async()=>{if($.value){j.warning(a("item.whiteboard_no_edit_permission")||"没有编辑权限");return}await Q()},ke=()=>{var R,Z;if(!v.value)return;const ue=(Z=(R=v.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text")){const pe=Number(ue.fontSize)||24;x.value=Math.max(1,Math.min(pe,300)),ue.fill&&(I.value=ue.fill)}};oe(async()=>{var ue,R,Z,pe;o.initTheme(),f.value=((pe=(Z=(R=(ue=t.itemInfo)==null?void 0:ue.menu)==null?void 0:R.pages)==null?void 0:Z[0])==null?void 0:pe.page_id)||"",await ct(),await u(),l.value&&setTimeout(async()=>{d($.value,Ue),D($.value,r.value,_.value,T.value,h.value,w.value);const $e=U();$e&&(V.value=$e,N($e.width,$e.height)),fe(),v.value&&(v.value.on("selection:created",ke),v.value.on("selection:updated",ke),v.value.on("mouse:down",he)),window.addEventListener("keydown",Ie),window.addEventListener("keyup",Me),await se()},0)});const he=ue=>{if($.value||!v.value)return;const R=ue==null?void 0:ue.e,Z=v.value.getPointer(R);if(M.value){ge(v.value,M.value,Z.x,Z.y,h.value,w.value,Ue);return}if(!T.value)return;const pe=window.fabric,$e=new pe.Textbox("",{left:Z.x,top:Z.y,width:300,fontSize:x.value,fill:I.value,editable:!0,splitByGrapheme:!0,cornerStyle:"circle",transparentCorners:!1});v.value.add($e),v.value.setActiveObject($e),v.value.requestRenderAll();try{$e.enterEditing(),$e.selectionStart=0,$e.selectionEnd=0}catch{}$e.on("editing:exited",()=>{T.value=!1,r.value=!1,_.value=!1,D($.value,r.value,_.value,T.value,h.value,w.value);try{v.value&&(v.value.setCursor("default"),v.value.requestRenderAll())}catch{}Ue()}),Ue()},Ie=ue=>{if(ue.code==="Delete"||ue.code==="Backspace"){if(T.value)return;E()}},Me=ue=>{},Oe=()=>{var R,Z;if(!v.value)return;const ue=(Z=(R=v.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text"))try{ue.set("fontSize",x.value),v.value.requestRenderAll(),Ue()}catch{}},mt=()=>{var R,Z;if(!v.value)return;const ue=(Z=(R=v.value).getActiveObject)==null?void 0:Z.call(R);if(ue&&(ue.type==="textbox"||ue.type==="text"))try{ue.set("fill",I.value),v.value.requestRenderAll(),Ue()}catch{}},_t=()=>{M.value="rect",r.value=!1,_.value=!1,T.value=!1,D($.value,r.value,_.value,T.value,h.value,w.value);try{v.value&&v.value.setCursor("crosshair")}catch{}},pt=()=>{M.value="circle",r.value=!1,_.value=!1,T.value=!1,D($.value,r.value,_.value,T.value,h.value,w.value);try{v.value&&v.value.setCursor("crosshair")}catch{}},Ut=()=>{M.value="triangle",r.value=!1,_.value=!1,T.value=!1,D($.value,r.value,_.value,T.value,h.value,w.value);try{v.value&&v.value.setCursor("crosshair")}catch{}},Pt=()=>{M.value="arrow",r.value=!1,_.value=!1,T.value=!1,D($.value,r.value,_.value,T.value,h.value,w.value);try{v.value&&v.value.setCursor("crosshair")}catch{}};return Xe(()=>{if(window.removeEventListener("keydown",Ie),window.removeEventListener("keyup",Me),v.value)try{v.value.off("mouse:down",he),v.value.off("selection:created",ke),v.value.off("selection:updated",ke),v.value.dispose()}catch{}}),(ue,R)=>{const Z=H("a-tooltip");return C(),L("div",{id:"whiteboard-item",class:re({fullscreen:n.value}),onKeydown:[Fe(lt(_e,["ctrl","prevent"]),["83"]),Fe(lt(_e,["meta","prevent"]),["83"])]},[n.value?F("",!0):(C(),L("div",W7,[s(Vt,{itemInfo:c.itemInfo},{right:m(()=>[s(r7,{itemInfo:c.itemInfo,pageId:f.value,onSave:_e,onExportImage:z(ye),onClearCanvas:z(je)},null,8,["itemInfo","pageId","onExportImage","onClearCanvas"])]),_:1},8,["itemInfo"])])),s(F7,{isReadOnly:$.value,isVisitor:g.value,brushColor:h.value,brushWidth:w.value,isDrawing:r.value,isErasing:_.value,isInsertingText:T.value,pendingShapeType:M.value,textFontSize:x.value,textColor:I.value,fontSizeOptions:S,isFullscreen:n.value,"onUpdate:brushColor":R[0]||(R[0]=pe=>h.value=pe),"onUpdate:brushWidth":R[1]||(R[1]=pe=>w.value=pe),"onUpdate:textFontSize":R[2]||(R[2]=pe=>x.value=pe),"onUpdate:textColor":R[3]||(R[3]=pe=>I.value=pe),onToggleDrawing:be,onToggleEraser:Te,onToggleTextInsert:we,onInsertRect:_t,onInsertCircle:pt,onInsertTriangle:Ut,onInsertArrow:Pt,onUndo:z(Ye),onRedo:z(Ke),onClearCanvas:z(je),onExportImage:z(ye),onExportSvg:z(ze),onExportJson:z(Ve),onImportImage:z(Ze),onImportJson:z(De),onZoomOut:z(J),onZoomIn:z(ee),onFitToViewport:z(P),onZoomReset:z(ce),onToggleFullscreen:le,onApplyBrush:z(D),onApplyTextFontSize:Oe,onApplyTextColor:mt},null,8,["isReadOnly","isVisitor","brushColor","brushWidth","isDrawing","isErasing","isInsertingText","pendingShapeType","textFontSize","textColor","isFullscreen","onUndo","onRedo","onClearCanvas","onExportImage","onExportSvg","onExportJson","onImportImage","onImportJson","onZoomOut","onZoomIn","onFitToViewport","onZoomReset","onApplyBrush"]),e("div",Y7,[e("div",X7,[R[5]||(R[5]=e("canvas",{id:"whiteboard-canvas"},null,-1)),$.value?F("",!0):(C(),B(Z,{key:0,title:ue.$t("item.whiteboard_drag_resize")||"拖动调整尺寸",placement:"top"},{default:m(()=>[e("div",{class:"resize-handle",onMousedown:R[4]||(R[4]=lt((...pe)=>z(A)&&z(A)(...pe),["prevent"]))},null,32)]),_:1},8,["title"]))])])],42,J7)}}});const Z7=Y(Q7,[["__scopeId","data-v-8eade7bf"]]),eS={class:"item-show-container"},tS={key:5,class:"loading-container"},aS=W({__name:"Index",setup(c){const t=Ge(),a=xe(),o=Qe(),l=b(!1),u=b(null),v=b(""),d=b(1),p=q(()=>{if(!u.value)return!1;const w=u.value.item_type;return w==1||w==3||w==0||w=="0"}),f=async(w="")=>{l.value=!0;const T=t.params.item_id||0,x=t.params.page_id||t.query.page_id||0;try{const I={item_id:T,keyword:w};w||(I.default_page_id=x);const S=await X("/api/item/info",I,"post",!1);if(l.value=!1,S.error_code===0){const M=S.data;if(M.default_page_id<=0)if(M.item_type==1&&M.menu){const V=$(M.menu);V&&(M.default_page_id=V)}else M.menu&&M.menu.pages&&M.menu.pages[0]&&(M.default_page_id=M.menu.pages[0].page_id);M.item_type==3&&(M.item_manage=!1,M.item_edit=!1),u.value=M,d.value=d.value+1,document.title=M.item_name+"--ShowDoc",M.show_watermark>0&&k()}else S.error_code===10307||S.error_code===10303?a.replace({path:"/item/password/"+T,query:{page_id:x,redirect:a.currentRoute.value.fullPath}}):S.error_code===10312?a.replace({path:"/user/login/",query:{redirect:a.currentRoute.value.fullPath}}):S.error_code===10104?a.replace({path:"/captcha/index",query:{item_id:T,type:"visit_item",redirect:a.currentRoute.value.fullPath}}):j.error(S.error_message)}catch(I){l.value=!1,console.error("获取项目信息失败:",I)}},$=w=>{if(!w)return null;if(w.pages&&w.pages.length>0&&w.pages[0])return w.pages[0].page_id;if(!w.catalogs||w.catalogs.length===0)return null;const T=x=>{if(!x||x.length===0)return null;for(const I of x){if(I.pages&&I.pages.length>0&&I.pages[0])return I.pages[0].page_id;if(I.catalogs&&I.catalogs.length>0){const S=T(I.catalogs);if(S)return S}}return null};return T(w.catalogs)},g=w=>{v.value=w,u.value=null,f(w)},n=()=>{f(v.value)},y=w=>{const T=w.getFullYear(),x=String(w.getMonth()+1).padStart(2,"0"),I=String(w.getDate()).padStart(2,"0");return`${T}/${x}/${I}`},k=async()=>{if(o.loadUserInfo(),o.userInfo&&o.userInfo.username)r(o.userInfo);else try{await o.fetchUserInfo(),o.userInfo&&o.userInfo.username&&r(o.userInfo)}catch(w){console.error("获取用户信息失败，无法显示水印:",w)}},r=w=>{let T=w.username+"，"+y(new Date);w.name&&(T+="，"+w.name),setTimeout(()=>{_(T)},500)},_=w=>{h();const T=document.createElement("div");T.id="watermark-container",Object.assign(T.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none",zIndex:"9999999",overflow:"hidden"});const x=document.createElement("canvas"),I=x.getContext("2d");if(!I)return;const S=200,M=120;x.width=S,x.height=M,I.save(),I.translate(S/2,M/2),I.rotate(-30*Math.PI/180),I.font="14px Arial",I.fillStyle="rgba(0, 0, 0, 0.05)",I.textAlign="center",I.textBaseline="middle",I.fillText(w,0,0),I.restore();const V=x.toDataURL("image/png");Object.assign(T.style,{backgroundImage:`url(${V})`,backgroundRepeat:"repeat"}),document.body.appendChild(T);const U=new MutationObserver(()=>{document.getElementById("watermark-container")||document.body.appendChild(T)});U.observe(document.body,{childList:!0,subtree:!0}),T.observer=U},h=()=>{const w=document.getElementById("watermark-container");if(w){const T=w.observer;T&&T.disconnect(),w.remove()}};return qe(()=>t.params.item_id,()=>{f()}),oe(()=>{f()}),Xe(()=>{h(),document.title="ShowDoc"}),(w,T)=>{const x=H("a-spin");return C(),L("div",eS,[u.value&&p.value?(C(),B(T4,{key:d.value,"item-info":u.value,"search-keyword":v.value,onSearch:g,onReloadItem:n},null,8,["item-info","search-keyword"])):F("",!0),u.value&&u.value.item_type==2?(C(),B(Q4,{key:d.value,"item-info":u.value},null,8,["item-info"])):F("",!0),u.value&&u.value.item_type==4?(C(),B(l7,{key:d.value,"item-info":u.value},null,8,["item-info"])):F("",!0),u.value&&u.value.item_type==5?(C(),B(Z7,{key:d.value,"item-info":u.value},null,8,["item-info"])):F("",!0),u.value&&u.value.is_login?(C(),B(Na,{key:4,popup:!0})):F("",!0),l.value?(C(),L("div",tS,[s(x,{spinning:l.value,size:"large"},null,8,["spinning"])])):F("",!0)])}}});const oS=Y(aS,[["__scopeId","data-v-3a8d9929"]]),zS=Object.freeze(Object.defineProperty({__proto__:null,default:oS},Symbol.toStringTag,{value:"Module"}));export{dS as I,uS as L,xS as M,mS as R,vS as S,fS as V,_S as a,pS as b,hS as c,gS as d,yS as e,wS as f,bS as g,$S as h,kS as i,CS as j,IS as k,SS as l,TS as m,MS as n,LS as o,VS as p,zS as q};
